<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">;?add Modified by Tuncay. Just renamed functions, so it have the &quot;DLL_&quot; prefix.</span>
<span class="cm">/*</span>
<span class="cm">       |~) _  _ _     _ _ _ __/~\ _ |    |~\| |    |` _  _  |~\    _ _  _ _ . _  _|</span>
<span class="cm">       |~\(/__\(_)|_|| (_(/_  \_/| ||\/  |_/|_|_  ~|~(_)|   |_/|_|| | || | ||(/__\.</span>
<span class="cm">                                     /</span>
<span class="cm"> - Humble 36L wrapper to create and use DLL resources in AutoHotkey Scripting Language -</span>


<span class="cm">                  By SKAN - Suresh Kumar A N  ( arian.suresh@gmail.com )</span>
<span class="cm">                    Created/Last Modified : 05-Sep-2009 | Version: 0.6</span>


<span class="cm">  For usage, please refer Forum Topic : www.autohotkey.com/forum/viewtopic.php?t=62180</span>

<span class="cm">*/</span>



<span class="n">Dll_PackFiles</span><span class="p">(</span> <span class="n">Folder</span><span class="p">,</span> <span class="n">DLL</span><span class="p">,</span> <span class="n">Section</span><span class="o">=</span><span class="s">&quot;Files&quot;</span> <span class="p">)</span> <span class="p">{</span>
<span class="w"> </span><span class="nb">IfNotExist</span><span class="p">,</span><span class="nv">%DLL%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span><span class="n">DLL</span><span class="p">,</span><span class="o">%</span> <span class="n">DLL_CreateEmpty</span><span class="p">(</span> <span class="n">DLL</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">StringUpper</span><span class="p">,</span> <span class="n">Folder</span><span class="p">,</span> <span class="n">Folder</span>
<span class="w"> </span><span class="nb">IfEqual</span><span class="p">,</span><span class="n">Section</span><span class="p">,,</span> <span class="n">StringTrimLeft</span><span class="p">,</span><span class="n">Section</span><span class="p">,</span><span class="n">Folder</span><span class="p">,</span><span class="mi">3</span>
<span class="w"> </span><span class="nb">If </span><span class="n">hUPD</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;BeginUpdateResource&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">DLL</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">Bin</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="n">Ix</span><span class="o">:=</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%Folder%</span>\<span class="o">*.*</span>  <span class="p">{</span>
  <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Bin</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w">  </span><span class="nb">FileRead</span><span class="p">,</span> <span class="n">Bin</span><span class="p">,</span> <span class="nv">%A_LoopFileLongPath%</span>
<span class="w">  </span><span class="nb">If </span><span class="n">nSize</span> <span class="o">:=</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">Bin</span><span class="p">)</span>
  <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;UpdateResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hUpd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;CharUpper&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Section</span><span class="p">,</span> <span class="n">Str</span> <span class="p">),</span> <span class="n">Str</span>
 <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;CharUpper&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="nv">A_LoopFileName</span><span class="p">,</span> <span class="n">Str</span> <span class="p">),</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Bin</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">nSize</span> <span class="p">),</span><span class="n">Ix</span><span class="o">:=</span><span class="n">Ix</span><span class="o">+</span><span class="mi">1</span>
<span class="p">}</span> <span class="n">Return</span> <span class="n">Ix</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;EndUpdateResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hUpd</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="p">}</span>



<span class="n">Dll_CreateEmpty</span><span class="p">(</span> <span class="n">F</span><span class="o">=</span><span class="s">&quot;empty.dll&quot;</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">  ; Creates an Empty Resource-Only DLL (size: 1024 bytes)</span>
<span class="c-Singleline">; By SKAN : 05-Sep-2010  | Posted @ www.autohotkey.com/forum/viewtopic.php?p=322224#322224</span>
<span class="w"> </span><span class="nb">IfNotEqual</span><span class="p">,</span><span class="nv">A_Tab</span><span class="p">,</span> <span class="o">%</span> <span class="n">TS</span><span class="o">:=</span><span class="nv">A_NowUTC</span><span class="p">,</span> <span class="n">EnvSub</span><span class="p">,</span><span class="n">TS</span><span class="p">,</span><span class="mi">1970</span><span class="p">,</span><span class="n">S</span>
 <span class="n">Src</span> <span class="o">:=</span> <span class="s">&quot;0X5A4DY3CXB8YB8X4550YBCX2014CYCCX210E00E0YD0X7010BYD8X400YE4X1000YE8X1000YECX78A&quot;</span>
 <span class="o">.</span> <span class="s">&quot;E0000YF0X1000YF4X200YF8X10005YFCX10005Y100X4Y108X3000Y10CX200Y114X2Y118X40000Y11CX200&quot;</span>
 <span class="o">.</span> <span class="s">&quot;0Y120X100000Y124X1000Y12CX10Y140X1000Y144X10Y158X2000Y15CX8Y1B0X7273722EY1B4X63Y1B8X1&quot;</span>
 <span class="o">.</span> <span class="s">&quot;0Y1BCX1000Y1C0X200Y1C4X200Y1D4X40000040Y1D8X6C65722EY1DCX636FY1E0X8Y1E4X2000Y1E8X200Y&quot;</span>
 <span class="o">.</span> <span class="s">&quot;1ECX400Y1FCX42000040&quot;</span><span class="p">,</span>              <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Trg</span><span class="p">,</span><span class="mi">1024</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span> <span class="nf">Numput</span><span class="p">(</span> <span class="n">TS</span><span class="p">,</span><span class="n">Trg</span><span class="p">,</span><span class="mi">192</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">Src</span><span class="p">,</span> <span class="n">XY</span>
   <span class="nf">Mod</span><span class="p">(</span> <span class="nv">A_Index</span><span class="p">,</span><span class="mi">2</span> <span class="p">)</span> <span class="o">?</span> <span class="n">O</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="nv">A_LoopField</span> <span class="o">:</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="s">&quot;0x&quot;</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">Trg</span><span class="p">,</span> <span class="n">O</span> <span class="p">)</span>
 <span class="n">H</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;_lcreat&quot;</span><span class="p">,</span><span class="n">Str</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span>  <span class="n">B</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;_lwrite&quot;</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">Str</span><span class="p">,</span><span class="n">Trg</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">1024</span> <span class="p">)</span>
<span class="nb">Return</span> <span class="p">(</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;_lclose&quot;</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">H</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">B</span> <span class="p">)</span> <span class="o">?</span> <span class="n">F</span> <span class="o">:</span>
<span class="p">}</span>



<span class="n">Dll_Read</span><span class="p">(</span> <span class="n">ByRef</span> <span class="n">Var</span><span class="p">,</span> <span class="n">Filename</span><span class="p">,</span> <span class="n">Section</span><span class="p">,</span> <span class="n">Key</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">          ; Functionality and Parameters are</span>
 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Var</span><span class="p">,</span><span class="mi">64</span> <span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Var</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span><span class="c-Singleline">      ; identical to IniRead command ;-)</span>
<span class="w"> </span><span class="nb">If </span><span class="n">hMod</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Filename</span> <span class="p">)</span>
<span class="w">  </span><span class="nb">If </span><span class="n">hRes</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;FindResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hMod</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Key</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Section</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="n">hData</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;LoadResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hMod</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hRes</span> <span class="p">)</span>
<span class="w">    </span><span class="nb">If </span><span class="n">pData</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;LockResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hData</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Return</span> <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Var</span><span class="p">,</span><span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;SizeofResource&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hMod</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hRes</span> <span class="p">),</span><span class="mi">32</span><span class="p">)</span>
     <span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Var</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">pData</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">nSize</span> <span class="p">)</span>
     <span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;FreeLibrary&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hMod</span> <span class="p">)</span>
<span class="nb">Return</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;FreeLibrary&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hMod</span> <span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span>
<span class="p">}</span>
</pre></div>
