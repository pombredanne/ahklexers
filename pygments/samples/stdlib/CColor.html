<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="o">/*</span>
<span class="w">	</span>Function<span class="o">:</span><span class="w">	</span>CColor
<span class="w">				</span>Set<span class="w"> </span>text<span class="w"> </span><span class="kr">and</span><span class="w"> </span>background<span class="w"> </span>color<span class="w"> </span>for<span class="w"> </span>some<span class="w"> </span><span class="k">Gui</span><span class="w"> </span>controls<span class="p">.</span><span class="w"> </span>
<span class="w">				</span>Supported<span class="w"> </span>types<span class="o">:</span><span class="w"> </span>Edit<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>ListBox<span class="p">,</span><span class="w"> </span>ComboBox<span class="p">,</span><span class="w"> </span>DropDownList<span class="p">,</span><span class="w"> </span>CheckBox<span class="p">,</span><span class="w"> </span>RadioButton<span class="p">,</span><span class="w"> </span>ListView<span class="p">,</span><span class="w"> </span>TreeView<span class="p">,</span><span class="w"> </span>RichEdit
<span class="w">   </span>
<span class="w">	</span>Parameters<span class="o">:</span><span class="w">   </span>
<span class="w">		</span>Hwnd<span class="w">		</span><span class="o">-</span><span class="w">  </span>Handle<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>control<span class="p">.</span>
<span class="w">		</span>Background<span class="w">  </span><span class="o">-</span><span class="w">  </span>Background<span class="w"> </span>color<span class="p">.</span><span class="w"> </span>HTML<span class="w"> </span>color<span class="w"> </span>name<span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="mi">6</span><span class="o">-</span>digit<span class="w"> </span>RGB<span class="w"> </span>value<span class="p">.</span><span class="w"> </span>Optional<span class="p">.</span>
<span class="w">		</span>Foreground<span class="w">  </span><span class="o">-</span><span class="w">  </span>Foreground<span class="w"> </span>color<span class="p">.</span><span class="w"> </span>HTML<span class="w"> </span>color<span class="w"> </span>name<span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="mi">6</span><span class="o">-</span>digit<span class="w"> </span>RGB<span class="w"> </span>value<span class="p">.</span><span class="w"> </span>Optional<span class="p">.</span>
<span class="w">	  </span>
<span class="w">	</span>Remarks<span class="o">:</span>
<span class="w">		</span>You<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>redraw<span class="w"> </span>the<span class="w"> </span>window<span class="w"> </span>for<span class="w"> </span>changes<span class="w"> </span>to<span class="w"> </span>take<span class="w"> </span>effect<span class="p">.</span><span class="w"> </span>For<span class="w"> </span>some<span class="w"> </span>controls<span class="p">,</span><span class="w"> </span>it<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>needed<span class="w"> </span>to<span class="w"> </span>explicitelly<span class="w"> </span>specify<span class="w"> </span>
<span class="w">		</span>foreground<span class="w"> </span><span class="nf">color</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;cRed&quot;</span><span class="p">)</span><span class="w"> </span>when<span class="w"> </span>creating<span class="w"> </span><span class="k">control</span><span class="p">,</span><span class="w"> </span>otherwise<span class="w"> </span>text<span class="w"> </span>will<span class="w"> </span>stay<span class="w"> </span>black<span class="p">.</span>

<span class="w">		</span>On<span class="w"> </span>tha<span class="w"> </span>first<span class="w"> </span>call<span class="w"> </span>for<span class="w"> </span>a<span class="w"> </span>specific<span class="w"> </span><span class="k">control</span><span class="w"> </span>class<span class="w"> </span>the<span class="w"> </span>function<span class="w"> </span>registers<span class="w"> </span>itself<span class="w"> </span>as<span class="w"> </span>message<span class="w"> </span>handler<span class="w"> </span>for<span class="w"> </span>WM_CTLCOLOR
<span class="w">		</span>message<span class="w"> </span>of<span class="w"> </span>appropriate<span class="w"> </span>class<span class="p">.</span>

<span class="w">		</span>Buttons<span class="w"> </span>are<span class="w"> </span>always<span class="w"> </span>drawn<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>system<span class="w"> </span>colors<span class="p">.</span><span class="w"> </span>Drawing<span class="w"> </span>buttons<span class="w"> </span>requires<span class="w"> </span>several<span class="w"> </span>different<span class="w"> </span>brushes<span class="o">-</span>face<span class="p">,</span><span class="w"> </span>highlight<span class="w"> </span><span class="kr">and</span><span class="w"> </span>shadow<span class="w"> </span>
<span class="w">		</span>but<span class="w"> </span>the<span class="w"> </span>WM_CTLCOLORBTN<span class="w"> </span>message<span class="w"> </span>allows<span class="w"> </span>only<span class="w"> </span>one<span class="w"> </span>brush<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>returned<span class="p">.</span><span class="w"> </span>To<span class="w"> </span>provide<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span>appearance<span class="w"> </span>for<span class="w"> </span>push<span class="w"> </span>buttons<span class="p">,</span><span class="w"> </span>use<span class="w"> </span>an<span class="w"> </span>owner<span class="o">-</span>drawn<span class="w"> </span>button<span class="p">.</span>

<span class="w">	</span><span class="nl">About:</span>
<span class="w">		</span>o<span class="w"> </span>Version<span class="w"> </span><span class="mf">1.0</span><span class="w"> </span>by<span class="w"> </span>majkinetor<span class="p">.</span>
<span class="w">		</span>o<span class="w"> </span>Original<span class="w"> </span>code<span class="w"> </span><span class="nf">by</span><span class="w"> </span><span class="p">(</span>de<span class="p">)</span>nick<span class="p">,</span><span class="w"> </span>See<span class="o">:</span><span class="w"> </span><span class="o">&lt;</span>http<span class="o">://</span>www<span class="p">.</span>autohotkey<span class="p">.</span>com<span class="o">/</span>forum<span class="o">/</span>topic39055<span class="p">.</span>html<span class="o">&gt;</span><span class="p">.</span>
<span class="w">		</span>o<span class="w"> </span>Licensed<span class="w"> </span>under<span class="w"> </span>BSD<span class="w"> </span><span class="o">&lt;</span>http<span class="o">://</span>creativecommons<span class="p">.</span>org<span class="o">/</span>licenses<span class="o">/</span>BSD<span class="o">/&gt;</span><span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">CColor</span><span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span>Background<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Foreground<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">CColor_</span><span class="p">(</span>Background<span class="p">,</span><span class="w"> </span>Foreground<span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Hwnd<span class="o">+</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">CColor_</span><span class="p">(</span>Wp<span class="p">,</span><span class="w"> </span>Lp<span class="p">,</span><span class="w"> </span>Msg<span class="p">,</span><span class="w"> </span>Hwnd<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>WM_CTLCOLOREDIT<span class="o">=</span><span class="mh">0x0133</span><span class="p">,</span><span class="w"> </span>WM_CTLCOLORLISTBOX<span class="o">=</span><span class="mh">0x134</span><span class="p">,</span><span class="w"> </span>WM_CTLCOLORSTATIC<span class="o">=</span><span class="mh">0x0138</span>
<span class="w">		  </span><span class="p">,</span>LVM_SETBKCOLOR<span class="o">=</span><span class="mh">0x1001</span><span class="p">,</span><span class="w"> </span>LVM_SETTEXTCOLOR<span class="o">=</span><span class="mh">0x1024</span><span class="p">,</span><span class="w"> </span>LVM_SETTEXTBKCOLOR<span class="o">=</span><span class="mh">0x1026</span><span class="p">,</span><span class="w"> </span>TVM_SETTEXTCOLOR<span class="o">=</span><span class="mh">0x111E</span><span class="p">,</span><span class="w"> </span>TVM_SETBKCOLOR<span class="o">=</span><span class="mh">0x111D</span>
<span class="w">		  </span><span class="p">,</span>BS_CHECKBOX<span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span>BS_RADIOBUTTON<span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>ES_READONLY<span class="o">=</span><span class="mh">0x800</span>
<span class="w">		  </span><span class="p">,</span>CLR_NONE<span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>CSILVER<span class="o">=</span><span class="mh">0xC0C0C0</span><span class="p">,</span><span class="w"> </span>CGRAY<span class="o">=</span><span class="mh">0x808080</span><span class="p">,</span><span class="w"> </span>CWHITE<span class="o">=</span><span class="mh">0xFFFFFF</span><span class="p">,</span><span class="w"> </span>CMAROON<span class="o">=</span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span>CRED<span class="o">=</span><span class="mh">0x0FF</span><span class="p">,</span><span class="w"> </span>CPURPLE<span class="o">=</span><span class="mh">0x800080</span><span class="p">,</span><span class="w"> </span>CFUCHSIA<span class="o">=</span><span class="mh">0xFF00FF</span><span class="p">,</span><span class="w"> </span>CGREEN<span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span><span class="w"> </span>CLIME<span class="o">=</span><span class="mh">0xFF00</span><span class="p">,</span><span class="w"> </span>COLIVE<span class="o">=</span><span class="mh">0x8080</span><span class="p">,</span><span class="w"> </span>CYELLOW<span class="o">=</span><span class="mh">0xFFFF</span><span class="p">,</span><span class="w"> </span>CNAVY<span class="o">=</span><span class="mh">0x800000</span><span class="p">,</span><span class="w"> </span>CBLUE<span class="o">=</span><span class="mh">0xFF0000</span><span class="p">,</span><span class="w"> </span>CTEAL<span class="o">=</span><span class="mh">0x808000</span><span class="p">,</span><span class="w"> </span>CAQUA<span class="o">=</span><span class="mh">0xFFFF00</span>
<span class="w"> 		  </span><span class="p">,</span>CLASSES<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Button,ComboBox,Edit,ListBox,Static,RICHEDIT50W,SysListView32,SysTreeView32&quot;</span>
<span class="w">	</span>
<span class="w">	</span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Msg<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">      </span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>adrSetTextColor
<span class="w">			</span>adrSetTextColor<span class="w">	</span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SetTextColor&quot;</span><span class="p">)</span>
<span class="w">		   </span><span class="p">,</span>adrSetBkColor<span class="w">	</span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SetBkColor&quot;</span><span class="p">)</span>
<span class="w">		   </span><span class="p">,</span>adrSetBkMode<span class="w">	</span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SetBkMode&quot;</span><span class="p">)</span>
<span class="w">	</span>
<span class="w">      </span><span class="c1">;Set the colors (RGB -&gt; BGR)</span>
<span class="w">		</span>BG<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">!</span>Wp<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>C<span class="nv">%Wp%</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>C<span class="nv">%Wp%</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;0x&quot;</span><span class="w"> </span>SubStr<span class="p">(</span>WP<span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>SubStr<span class="p">(</span>WP<span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>SubStr<span class="p">(</span>WP<span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>
<span class="w">		</span>FG<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">!</span>Lp<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>C<span class="nv">%Lp%</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>C<span class="nv">%Lp%</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;0x&quot;</span><span class="w"> </span>SubStr<span class="p">(</span>LP<span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>SubStr<span class="p">(</span>LP<span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>SubStr<span class="p">(</span>LP<span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="w">	  </span><span class="c1">;Activate message handling with OnMessage() on the first call for a class </span>
<span class="w">		</span><span class="k">WinGetClass</span><span class="p">,</span><span class="w"> </span>class<span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%Hwnd%</span><span class="w"> </span>
<span class="w">		</span><span class="kr">If</span><span class="w"> </span>class<span class="w"> </span>not<span class="w"> </span>in<span class="w"> </span><span class="nv">%CLASSES%</span><span class="w"> </span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nb">A_ThisFunc</span><span class="w"> </span><span class="s">&quot;&gt; Unsupported control class: &quot;</span><span class="w"> </span>class

<span class="w">		</span><span class="k">ControlGet</span><span class="p">,</span><span class="w"> </span>style<span class="p">,</span><span class="w"> </span>Style<span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%Hwnd%</span><span class="w"> </span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>class<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Edit&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Style<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>ES_READONLY<span class="p">)</span><span class="w"> </span>
<span class="w">			</span>class<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Static&quot;</span>
<span class="w">	</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>class<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Button&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>style<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>BS_RADIOBUTTON<span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>style<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>BS_CHECKBOX<span class="p">)</span><span class="w"> </span>
<span class="w">				 </span>class<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Static&quot;</span><span class="w"> </span>
<span class="w">			</span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">A_ThisFunc</span><span class="w"> </span><span class="s">&quot;&gt; Unsupported control class: &quot;</span><span class="w"> </span>class
<span class="w">		</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>class<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ComboBox&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">			</span><span class="nf">VarSetCapacity</span><span class="p">(</span>CBBINFO<span class="p">,</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">52</span><span class="p">,</span><span class="w"> </span>CBBINFO<span class="p">),</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetComboBoxInfo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span>Hwnd<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>CBBINFO<span class="p">)</span><span class="w"> </span>
<span class="w">			</span>hwnd<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>CBBINFO<span class="p">,</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span><span class="w">		</span><span class="c1">;hwndList</span>
<span class="w">			</span><span class="nv">%hwnd%</span>BG<span class="w"> </span><span class="o">:=</span><span class="w"> </span>BG<span class="p">,</span><span class="w"> </span><span class="nv">%hwnd%</span>FG<span class="w"> </span><span class="o">:=</span><span class="w"> </span>FG<span class="p">,</span><span class="w"> </span><span class="nv">%hwnd%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>BG<span class="w"> </span><span class="o">?</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;CreateSolidBrush&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span>BG<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="w">			</span>IfEqual<span class="p">,</span><span class="w"> </span>CTLCOLORLISTBOX<span class="p">,,</span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>CTLCOLORLISTBOX<span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>OnMessage<span class="p">(</span>WM_CTLCOLORLISTBOX<span class="p">,</span><span class="w"> </span><span class="nb">A_ThisFunc</span><span class="p">)</span><span class="w"> </span>

<span class="w">			</span><span class="kr">If</span><span class="w"> </span><span class="nf">NumGet</span><span class="p">(</span>CBBINFO<span class="p">,</span><span class="mi">44</span><span class="p">)</span><span class="w">	</span><span class="c1">;hwndEdit</span>
<span class="w">				</span>Hwnd<span class="w"> </span><span class="o">:=</span><span class="w">  </span>Numget<span class="p">(</span>CBBINFO<span class="p">,</span><span class="mi">44</span><span class="p">),</span><span class="w"> </span>class<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Edit&quot;</span>
<span class="w">		</span><span class="p">}</span><span class="w"> </span>

<span class="w">		</span><span class="kr">if</span><span class="w"> </span>class<span class="w"> </span>in<span class="w"> </span>SysListView32<span class="p">,</span>SysTreeView32
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span>m<span class="w"> </span><span class="o">:=</span><span class="w"> </span>class<span class="o">=</span><span class="s">&quot;SysListView32&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;LVM&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;TVM&quot;</span><span class="w"> </span>
<span class="w">			</span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span><span class="nv">%m%</span>_SETBKCOLOR<span class="p">,</span><span class="w"> </span><span class="p">,</span>BG<span class="p">,</span><span class="w"> </span><span class="p">,</span>ahk_id<span class="w"> </span><span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span><span class="nv">%m%</span>_SETTEXTCOLOR<span class="p">,</span><span class="w"> </span><span class="p">,</span>FG<span class="p">,</span><span class="w"> </span><span class="p">,</span>ahk_id<span class="w"> </span><span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span><span class="nv">%m%</span>_SETTEXTBKCOLOR<span class="p">,</span><span class="w"> </span><span class="p">,</span>CLR_NONE<span class="p">,</span><span class="w"> </span><span class="p">,</span>ahk_id<span class="w"> </span><span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="k">return</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>class<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RICHEDIT50W&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span>f<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;RichEdit_SetBgColor&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%f%</span><span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span><span class="o">-</span>BG<span class="p">)</span>

<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>CTLCOLOR<span class="nv">%Class%</span><span class="p">)</span>
<span class="w">			</span>CTLCOLOR<span class="nv">%Class%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>OnMessage<span class="p">(</span>WM_CTLCOLOR<span class="nv">%Class%</span><span class="p">,</span><span class="w"> </span><span class="nb">A_ThisFunc</span><span class="p">)</span><span class="w"> </span>

<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nv">%Hwnd%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>BG<span class="w"> </span><span class="o">?</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;CreateSolidBrush&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span>BG<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>CLR_NONE<span class="p">,</span><span class="w">  </span><span class="nv">%Hwnd%</span>BG<span class="w"> </span><span class="o">:=</span><span class="w"> </span>BG<span class="p">,</span><span class="w">  </span><span class="nv">%Hwnd%</span>FG<span class="w"> </span><span class="o">:=</span><span class="w"> </span>FG
<span class="w">   </span><span class="p">}</span><span class="w"> </span>
<span class="w"> </span>
<span class="w"> </span><span class="c1">; Message handler </span>
<span class="w">	</span><span class="k">critical</span><span class="w">					</span><span class="c1">;its OK, always in new thread.</span>

<span class="w">	</span>Hwnd<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Lp<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>hDC<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Wp<span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="nv">%Hwnd%</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span>adrSetBkMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hDC<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="nv">%Hwnd%</span>FG<span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span>adrSetTextColor<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span>hDC<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>FG<span class="p">)</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="nv">%Hwnd%</span>BG<span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span>adrSetBkColor<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span>hDC<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>BG<span class="p">)</span>
<span class="w">		</span><span class="nf">return</span><span class="w"> </span><span class="p">(</span><span class="nv">%Hwnd%</span><span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">	Function:	CColor</span>
<span class="cm">				Set text and background color for some Gui controls. </span>
<span class="cm">				Supported types: Edit, Text, ListBox, ComboBox, DropDownList, CheckBox, RadioButton, ListView, TreeView, RichEdit</span>
<span class="cm">   </span>
<span class="cm">	Parameters:   </span>
<span class="cm">		Hwnd		-  Handle of the control.</span>
<span class="cm">		Background  -  Background color. HTML color name or 6-digit RGB value. Optional.</span>
<span class="cm">		Foreground  -  Foreground color. HTML color name or 6-digit RGB value. Optional.</span>
<span class="cm">	  </span>
<span class="cm">	Remarks:</span>
<span class="cm">		You need to redraw the window for changes to take effect. For some controls, it may be needed to explicitelly specify </span>
<span class="cm">		foreground color (&quot;cRed&quot;) when creating control, otherwise text will stay black.</span>

<span class="cm">		On tha first call for a specific control class the function registers itself as message handler for WM_CTLCOLOR</span>
<span class="cm">		message of appropriate class.</span>

<span class="cm">		Buttons are always drawn with the default system colors. Drawing buttons requires several different brushes-face, highlight and shadow </span>
<span class="cm">		but the WM_CTLCOLORBTN message allows only one brush to be returned. To provide a custom appearance for push buttons, use an owner-drawn button.</span>

<span class="cm">	About:</span>
<span class="cm">		o Version 1.0 by majkinetor.</span>
<span class="cm">		o Original code by (de)nick, See: &lt;http://www.autohotkey.com/forum/topic39055.html&gt;.</span>
<span class="cm">		o Licensed under BSD &lt;http://creativecommons.org/licenses/BSD/&gt;.</span>
<span class="cm"> */</span>
<span class="n">CColor</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">Background</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Foreground</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">CColor_</span><span class="p">(</span><span class="n">Background</span><span class="p">,</span> <span class="n">Foreground</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">CColor_</span><span class="p">(</span><span class="n">Wp</span><span class="p">,</span> <span class="n">Lp</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span> <span class="p">{</span> 
<span class="w">	</span><span class="nb">static</span> 
<span class="w">	</span><span class="nb">static</span> <span class="n">WM_CTLCOLOREDIT</span><span class="o">=</span><span class="mh">0x0133</span><span class="p">,</span> <span class="n">WM_CTLCOLORLISTBOX</span><span class="o">=</span><span class="mh">0x134</span><span class="p">,</span> <span class="n">WM_CTLCOLORSTATIC</span><span class="o">=</span><span class="mh">0x0138</span>
		  <span class="p">,</span><span class="n">LVM_SETBKCOLOR</span><span class="o">=</span><span class="mh">0x1001</span><span class="p">,</span> <span class="n">LVM_SETTEXTCOLOR</span><span class="o">=</span><span class="mh">0x1024</span><span class="p">,</span> <span class="n">LVM_SETTEXTBKCOLOR</span><span class="o">=</span><span class="mh">0x1026</span><span class="p">,</span> <span class="n">TVM_SETTEXTCOLOR</span><span class="o">=</span><span class="mh">0x111E</span><span class="p">,</span> <span class="n">TVM_SETBKCOLOR</span><span class="o">=</span><span class="mh">0x111D</span>
		  <span class="p">,</span><span class="n">BS_CHECKBOX</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">BS_RADIOBUTTON</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ES_READONLY</span><span class="o">=</span><span class="mh">0x800</span>
		  <span class="p">,</span><span class="n">CLR_NONE</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">CSILVER</span><span class="o">=</span><span class="mh">0xC0C0C0</span><span class="p">,</span> <span class="n">CGRAY</span><span class="o">=</span><span class="mh">0x808080</span><span class="p">,</span> <span class="n">CWHITE</span><span class="o">=</span><span class="mh">0xFFFFFF</span><span class="p">,</span> <span class="n">CMAROON</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">CRED</span><span class="o">=</span><span class="mh">0x0FF</span><span class="p">,</span> <span class="n">CPURPLE</span><span class="o">=</span><span class="mh">0x800080</span><span class="p">,</span> <span class="n">CFUCHSIA</span><span class="o">=</span><span class="mh">0xFF00FF</span><span class="p">,</span> <span class="n">CGREEN</span><span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span> <span class="n">CLIME</span><span class="o">=</span><span class="mh">0xFF00</span><span class="p">,</span> <span class="n">COLIVE</span><span class="o">=</span><span class="mh">0x8080</span><span class="p">,</span> <span class="n">CYELLOW</span><span class="o">=</span><span class="mh">0xFFFF</span><span class="p">,</span> <span class="n">CNAVY</span><span class="o">=</span><span class="mh">0x800000</span><span class="p">,</span> <span class="n">CBLUE</span><span class="o">=</span><span class="mh">0xFF0000</span><span class="p">,</span> <span class="n">CTEAL</span><span class="o">=</span><span class="mh">0x808000</span><span class="p">,</span> <span class="n">CAQUA</span><span class="o">=</span><span class="mh">0xFFFF00</span>
 		  <span class="p">,</span><span class="n">CLASSES</span> <span class="o">:=</span> <span class="s">&quot;Button,ComboBox,Edit,ListBox,Static,RICHEDIT50W,SysListView32,SysTreeView32&quot;</span>
	
	<span class="n">If</span> <span class="p">(</span><span class="n">Msg</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>      
		<span class="n">if</span> <span class="o">!</span><span class="n">adrSetTextColor</span>
			<span class="n">adrSetTextColor</span>	<span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;SetTextColor&quot;</span><span class="p">)</span>
		   <span class="p">,</span><span class="n">adrSetBkColor</span>	<span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;SetBkColor&quot;</span><span class="p">)</span>
		   <span class="p">,</span><span class="n">adrSetBkMode</span>	<span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;Gdi32.dll&quot;</span><span class="p">),</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;SetBkMode&quot;</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">	</span>
<span class="c-Singleline">      ;Set the colors (RGB -&gt; BGR)</span>
		<span class="n">BG</span> <span class="o">:=</span> <span class="o">!</span><span class="n">Wp</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">C</span><span class="nv">%Wp%</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">C</span><span class="nv">%Wp%</span> <span class="o">:</span> <span class="s">&quot;0x&quot;</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">WP</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">WP</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">WP</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
		<span class="n">FG</span> <span class="o">:=</span> <span class="o">!</span><span class="n">Lp</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">C</span><span class="nv">%Lp%</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">C</span><span class="nv">%Lp%</span> <span class="o">:</span> <span class="s">&quot;0x&quot;</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">LP</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">LP</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">LP</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">	  ;Activate message handling with OnMessage() on the first call for a class </span>
<span class="w">		</span><span class="nb">WinGetClass</span><span class="p">,</span> <span class="n">class</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%Hwnd%</span> 
<span class="w">		</span><span class="nb">If </span><span class="n">class</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nv">%CLASSES%</span> 
<span class="w">			</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Unsupported control class: &quot;</span> <span class="n">class</span>

<span class="w">		</span><span class="nb">ControlGet</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%Hwnd%</span> 
		<span class="n">if</span> <span class="p">(</span><span class="n">class</span> <span class="o">=</span> <span class="s">&quot;Edit&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Style</span> <span class="o">&amp;</span> <span class="n">ES_READONLY</span><span class="p">)</span> 
			<span class="n">class</span> <span class="o">:=</span> <span class="s">&quot;Static&quot;</span>
	
		<span class="n">if</span> <span class="p">(</span><span class="n">class</span> <span class="o">=</span> <span class="s">&quot;Button&quot;</span><span class="p">)</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">&amp;</span> <span class="n">BS_RADIOBUTTON</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">style</span> <span class="o">&amp;</span> <span class="n">BS_CHECKBOX</span><span class="p">)</span> 
				 <span class="n">class</span> <span class="o">:=</span> <span class="s">&quot;Static&quot;</span> 
<span class="w">			</span><span class="nb">else</span> <span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Unsupported control class: &quot;</span> <span class="n">class</span>
		
		<span class="n">if</span> <span class="p">(</span><span class="n">class</span> <span class="o">=</span> <span class="s">&quot;ComboBox&quot;</span><span class="p">)</span> <span class="p">{</span> 
			<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CBBINFO</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">52</span><span class="p">,</span> <span class="n">CBBINFO</span><span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetComboBoxInfo&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CBBINFO</span><span class="p">)</span> 
			<span class="n">hwnd</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CBBINFO</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span><span class="c-Singleline">		;hwndList</span>
			<span class="nv">%hwnd%</span><span class="n">BG</span> <span class="o">:=</span> <span class="n">BG</span><span class="p">,</span> <span class="nv">%hwnd%</span><span class="n">FG</span> <span class="o">:=</span> <span class="n">FG</span><span class="p">,</span> <span class="nv">%hwnd%</span> <span class="o">:=</span> <span class="n">BG</span> <span class="o">?</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateSolidBrush&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">BG</span><span class="p">)</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span>

<span class="w">			</span><span class="nb">IfEqual</span><span class="p">,</span> <span class="n">CTLCOLORLISTBOX</span><span class="p">,,</span><span class="n">SetEnv</span><span class="p">,</span> <span class="n">CTLCOLORLISTBOX</span><span class="p">,</span> <span class="o">%</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">WM_CTLCOLORLISTBOX</span><span class="p">,</span> <span class="nv">A_ThisFunc</span><span class="p">)</span> 

<span class="w">			</span><span class="nb">If </span><span class="nf">NumGet</span><span class="p">(</span><span class="n">CBBINFO</span><span class="p">,</span><span class="mi">44</span><span class="p">)</span><span class="c-Singleline">	;hwndEdit</span>
				<span class="n">Hwnd</span> <span class="o">:=</span>  <span class="nf">Numget</span><span class="p">(</span><span class="n">CBBINFO</span><span class="p">,</span><span class="mi">44</span><span class="p">),</span> <span class="n">class</span> <span class="o">:=</span> <span class="s">&quot;Edit&quot;</span>
		<span class="p">}</span> 

<span class="w">		</span><span class="nb">if </span><span class="n">class</span> <span class="ow">in</span> <span class="n">SysListView32</span><span class="p">,</span><span class="n">SysTreeView32</span>
		<span class="p">{</span>
			<span class="n">m</span> <span class="o">:=</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;SysListView32&quot;</span> <span class="o">?</span> <span class="s">&quot;LVM&quot;</span> <span class="o">:</span> <span class="s">&quot;TVM&quot;</span> 
<span class="w">			</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="nv">%m%</span><span class="n">_SETBKCOLOR</span><span class="p">,</span> <span class="p">,</span><span class="n">BG</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="nv">%m%</span><span class="n">_SETTEXTCOLOR</span><span class="p">,</span> <span class="p">,</span><span class="n">FG</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="nv">%m%</span><span class="n">_SETTEXTBKCOLOR</span><span class="p">,</span> <span class="p">,</span><span class="n">CLR_NONE</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%Hwnd%</span>
<span class="w">			</span><span class="nb">return</span>
		<span class="p">}</span>

		<span class="n">if</span> <span class="p">(</span><span class="n">class</span> <span class="o">=</span> <span class="s">&quot;RICHEDIT50W&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="nb">return</span> <span class="n">f</span> <span class="o">:=</span> <span class="s">&quot;RichEdit_SetBgColor&quot;</span><span class="p">,</span> <span class="nv">%f%</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="o">-</span><span class="n">BG</span><span class="p">)</span>

		<span class="n">if</span> <span class="p">(</span><span class="o">!</span><span class="n">CTLCOLOR</span><span class="nv">%Class%</span><span class="p">)</span>
			<span class="n">CTLCOLOR</span><span class="nv">%Class%</span> <span class="o">:=</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">WM_CTLCOLOR</span><span class="nv">%Class%</span><span class="p">,</span> <span class="nv">A_ThisFunc</span><span class="p">)</span> 

<span class="w">		</span><span class="nb">return</span> <span class="nv">%Hwnd%</span> <span class="o">:=</span> <span class="n">BG</span> <span class="o">?</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateSolidBrush&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">BG</span><span class="p">)</span> <span class="o">:</span> <span class="n">CLR_NONE</span><span class="p">,</span>  <span class="nv">%Hwnd%</span><span class="n">BG</span> <span class="o">:=</span> <span class="n">BG</span><span class="p">,</span>  <span class="nv">%Hwnd%</span><span class="n">FG</span> <span class="o">:=</span> <span class="n">FG</span>
   <span class="p">}</span><span class="c-Singleline"> </span>
<span class="c-Singleline"> </span>
<span class="c-Singleline"> ; Message handler </span>
<span class="w">	</span><span class="nb">critical</span><span class="c-Singleline">					;its OK, always in new thread.</span>

	<span class="n">Hwnd</span> <span class="o">:=</span> <span class="n">Lp</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hDC</span> <span class="o">:=</span> <span class="n">Wp</span> <span class="o">+</span> <span class="mi">0</span>
	<span class="n">If</span> <span class="p">(</span><span class="nv">%Hwnd%</span><span class="p">)</span> <span class="p">{</span> 
		<span class="nf">DllCall</span><span class="p">(</span><span class="n">adrSetBkMode</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">if</span> <span class="p">(</span><span class="nv">%Hwnd%</span><span class="n">FG</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="n">adrSetTextColor</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">FG</span><span class="p">)</span>
		<span class="n">if</span> <span class="p">(</span><span class="nv">%Hwnd%</span><span class="n">BG</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="n">adrSetBkColor</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">BG</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="p">(</span><span class="nv">%Hwnd%</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>
