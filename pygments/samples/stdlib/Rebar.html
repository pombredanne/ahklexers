<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">  Title:    Rebar</span>
<span class="cm"> 			Rebar control act as container for child windows. </span>
<span class="cm"> 			An application assigns child windows, which are often other controls, to a rebar control band. </span>
<span class="cm"> 			Rebar controls contain one or more bands, and each band can have any combination of a gripper bar, a bitmap, a text label, and a child window. </span>
<span class="cm"> 			However, bands cannot contain more than one child window. As you dynamically reposition a rebar control band, the rebar control manages the size </span>
<span class="cm">			and position of the child window assigned to that band.</span>
<span class="cm"> 			(See rebar.png)</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm">  Function: Add</span>
<span class="cm"> 			Add a rebar to the GUI.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			hGui	- Handle of the GUI.</span>
<span class="cm"> 			Style	- White space separated list of styles. See bellow for details. By default &quot;VARHEIGHT DBLCLKTOGGLE&quot;. Integer styles are allowed.</span>
<span class="cm"> 			hIL		- Handle of the image list associated with the control. Optional.</span>
<span class="cm">			Pos		- Position of the rebar in usual AHK style. Optional.</span>
<span class="cm">			Handler - Notification handler.</span>
<span class="cm"> </span>
<span class="cm">  Styles:</span>
<span class="cm"> 			autosize	 - The rebar control will automatically change the layout of the bands when the size or position of the control changes.</span>
<span class="cm"> 			bandborders  - The rebar control displays narrow lines to separate adjacent bands.</span>
<span class="cm"> 			dblclktoggle - The rebar band will toggle its maximized or minimized state when the user double-clicks the band. Without this style, the maximized or minimized state is toggled when the user single-clicks on the band.</span>
<span class="cm"> 			fixedorder	 - The rebar control always displays bands in the same order. You can move bands to different rows, but the band order is static.</span>
<span class="cm"> 			varheight	 - The rebar control displays bands at the minimum required height, when possible. Without this style, the rebar control displays all bands at the same height, using the height of the tallest visible band to determine the height of other bands.</span>
<span class="cm"> 			verticalgripper - The size grip will be displayed vertically instead of horizontally in a vertical rebar control.</span>
<span class="cm"> 			vertical	 - Causes the control to be displayed vertically.</span>
<span class="cm"> </span>
<span class="cm">  Handler:</span>
<span class="cm">	&gt;		Handler(hCtrl, Event)</span>
<span class="cm">			</span>
<span class="cm">			Event	- C (Chevron click) L (Layout change)  H (Height change).</span>
<span class="cm">  </span>
<span class="cm">  Returns:</span>
<span class="cm"> 			Handle to the newly created control or 0 if function failes. Error message is returned on invalid usage.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_Add(hGui, Style=&quot;&quot;, hIL=&quot;&quot;, Pos=&quot;&quot;, Handler=&quot;&quot;) {</span>
<span class="cm">	static MODULEID, ICC_COOL_CLASSES := 0x400, RB_SETBARINFO=0x404, RB_SETUNICODEFORMAT=0x2005</span>
<span class="cm">	static WS_CHILD := 0x40000000, WS_VISIBLE := 0x10000000,  WS_CLIPSIBLINGS = 0x4000000, WS_CLIPCHILDREN = 0x2000000</span>
<span class="cm">	static RBS_VERTICALGRIPPER=0x4000, RBS_DBLCLKTOGGLE=0x8000, RBS_AUTOSIZE=0x2000, RBS_VARHEIGHT=0x200, RBS_NODIVIDER=0x40, RBS_BANDBORDERS=0x400, CCS_NORESIZE=0x4, CCS_NOPARENTALIGN=0x8, RBS_VERTICAL=0x80, RBS_BORDER=0x800000, RBS_FIXEDORDER = 0x800</span>
<span class="cm"> </span>
<span class="cm">	if MODULEID =</span>
<span class="cm">	{</span>
<span class="cm">		VarSetCapacity(ICC, 8),  NumPut(8, ICC, 0), NumPut(ICC_COOL_CLASSES, ICC, 4)</span>
<span class="cm">		if !DllCall(&quot;comctl32.dll\InitCommonControlsEx&quot;, &quot;uint&quot;, &amp;ICC) </span>
<span class="cm">			return A_ThisFunc &quot;&gt; Can&#39;t initialize common controls&quot; </span>

<span class="cm">		old := OnMessage(0x4E, &quot;Rebar_onNotify&quot;), 	MODULEID := 30608</span>
<span class="cm">		if old != Rebar_onNotify</span>
<span class="cm">			Rebar(&quot;oldNotify&quot;, RegisterCallback(old))</span>
<span class="cm">	}</span>
<span class="cm">	ifEqual, Style,, SetEnv, Style, VARHEIGHT DBLCLKTOGGLE</span>

<span class="cm">	hStyle := 0</span>
<span class="cm">	loop, parse, Style, %A_Tab%%A_Space%, %A_Tab%%A_Space%</span>
<span class="cm">		ifEqual, A_LoopField,,continue</span>
<span class="cm">		else hStyle |= A_LoopField+0 ? A_LoopField : RBS_%A_LoopField%</span>

<span class="cm">	ifEqual, hStyle, ,return A_ThisFunc &quot;&gt; Some of the styles are invalid: &quot; Style</span>

<span class="cm">	if (Pos != &quot;&quot;){</span>
<span class="cm">		x := y := 0, w := h := 100</span>
<span class="cm">		loop, parse, Pos, %A_Tab%%A_Space%, %A_Tab%%A_Space%</span>
<span class="cm">		{</span>
<span class="cm">			ifEqual, A_LoopField, , continue</span>
<span class="cm">			p := SubStr(A_LoopField, 1, 1)</span>
<span class="cm">			if p not in x,y,w,h</span>
<span class="cm">				return A_ThisFunc &quot;&gt; Invalid position specifier: &quot; p</span>
<span class="cm">			%p% := SubStr(A_LoopField, 2)</span>
<span class="cm">		}</span>
<span class="cm">		hStyle |= CCS_NOPARENTALIGN | CCS_NORESIZE</span>
<span class="cm">	}</span>

<span class="cm">	hRebar := DllCall(&quot;CreateWindowEx&quot; </span>
<span class="cm">             , &quot;uint&quot;, 0</span>
<span class="cm">             , &quot;str&quot;,  &quot;ReBarWindow32&quot; </span>
<span class="cm">             , &quot;uint&quot;, 0 </span>
<span class="cm">             , &quot;uint&quot;, WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN | hStyle</span>
<span class="cm">             , &quot;uint&quot;, x, &quot;uint&quot;, y, &quot;uint&quot;, w, &quot;uint&quot;, h</span>
<span class="cm">             , &quot;uint&quot;, hGui </span>
<span class="cm">             , &quot;uint&quot;, MODULEID </span>
<span class="cm">             , &quot;uint&quot;, 0 </span>
<span class="cm">             , &quot;uint&quot;, 0, &quot;Uint&quot;) </span>
<span class="cm">    ifEqual, hRebar, 0, return 0</span>

<span class="cm">	if hIL {</span>
<span class="cm">		VarSetCapacity(RBI, 12), NumPut(12, RBI), NumPut(1, RBI, 4), NumPut(hIL, RBI, 8)</span>
<span class="cm">		SendMessage, RB_SETBARINFO, 0, &amp;RBI, , ahk_id %hRebar%</span>
<span class="cm">	}</span>

<span class="cm">	if IsFunc(Handler)</span>
<span class="cm">		Rebar(hRebar &quot;handler&quot;, Handler)</span>

<span class="cm">	SendMessage, RB_SETUNICODEFORMAT,0,,,ahk_id %hRebar%		;!!! doesn&#39;t seem have effect, but again, no harm to call it</span>
<span class="cm">	return hRebar</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  Count</span>
<span class="cm">			Retrieves the number of bands in a rebar control.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_Count(hRebar) {</span>
<span class="cm">	static RB_GETBANDCOUNT=0x40C	</span>
<span class="cm">    SendMessage, RB_GETBANDCOUNT,,,,ahk_id %hRebar%</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  DeleteBand</span>
<span class="cm"> 			Deletes a band from a rebar control.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			Nonzero if successful, or zero otherwise.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_DeleteBand(hRebar, WhichBand){</span>
<span class="cm">	static RB_DELETEBAND = 0x402</span>
<span class="cm">	WhichBand := WhichBand &gt;= 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1</span>

<span class="cm">  ;free the bitmap if it is set</span>
<span class="cm">	if h := Rebar_GetBand(hRebar, WhichBand, &quot;B&quot;)</span>
<span class="cm">		DllCall(&quot;DeleteObject&quot;, &quot;uint&quot;, h)</span>

<span class="cm">	SendMessage, RB_DELETEBAND,WhichBand,,,ahk_id %hRebar%</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetBand</span>
<span class="cm"> 			Get band information.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID.</span>
<span class="cm"> 			pQ			- Query parameter: S (Style), L (Length), C (Color), I (Icon index), T (Text), N (identificatioN), B (Bitmap handle).</span>
<span class="cm">			o1..o7		- Reference to output variables.</span>

<span class="cm"> Returns:</span>
<span class="cm"> 			o1</span>
<span class="cm"> */ </span>
<span class="cm">Rebar_GetBand(hRebar, WhichBand, pQ=&quot;&quot;, ByRef o1=&quot;&quot;, ByRef o2=&quot;&quot;, ByRef o3=&quot;&quot;, ByRef o4=&quot;&quot;, ByRef o5=&quot;&quot;, ByRef o6=&quot;&quot;, ByRef o7=&quot;&quot;) {</span>
<span class="cm">	static RBBIM_ID=0x100, RBBIM_COLORS=0x2, RBBIM_IMAGE=0x8, RBBIM_CHILD = 0x10, RBBIM_STYLE = 0x1, RBBIM_TEXT = 0x4, RBBIM_CHILDSIZE = 0x20, RBBIM_SIZE = 0x40, RBBIM_IDEALSIZE = 0x200, RBBIM_BACKGROUND=0X80</span>
<span class="cm">	static RB_GETBANDINFO=0x405</span>

<span class="cm">	hMask := RBBIM_TEXT | RBBIM_STYLE | RBBIM_SIZE | RBBIM_COLORS | RBBIM_IMAGE | RBBIM_ID</span>
<span class="cm">	WhichBand := WhichBand &gt;= 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1 </span>

<span class="cm">	</span>
<span class="cm">	VarSetCapacity(BAND, 80, 0), NumPut(80,BAND), NumPut(hMask, BAND, 4)</span>
<span class="cm">	VarSetCapacity(wTxt, 64), NumPut(&amp;wTxt, BAND, 20), NumPut(64, BAND, 24)</span>
<span class="cm">    SendMessage, RB_GETBANDINFO, WhichBand, &amp;BAND, ,ahk_id %hRebar%</span>
<span class="cm">	ifEqual, Errorlevel, 0, return A_ThisFunc &quot;&gt; Can&#39;t get band info.&quot;</span>

<span class="cm">	loop, parse, pQ</span>
<span class="cm">	{</span>
<span class="cm">		if A_LoopField = T</span>
<span class="cm">			cch := NumGet(BAND, 24), VarSetCapacity(o%A_Index%, cch)</span>
<span class="cm">			, DllCall(&quot;WideCharToMultiByte&quot; , &quot;UInt&quot;, 0, &quot;UInt&quot;, 0, &quot;UInt&quot;, &amp;wTxt, &quot;Int&quot;, cch, &quot;str&quot;, o%A_Index% , &quot;Int&quot;, cch , &quot;UInt&quot;, 0, &quot;UInt&quot;, 0)</span>
<span class="cm">		 </span>
<span class="cm">		if A_LoopField = S</span>
<span class="cm">			o%A_Index% := Rebar_getStyle(NumGet(BAND, 8))</span>

<span class="cm">		if A_LoopField = L</span>
<span class="cm">			o%A_Index% := NumGet(BAND, 44)</span>
<span class="cm">	</span>
<span class="cm">		if A_LoopField = I</span>
<span class="cm">			img := NumGet(BAND, 28),   o%A_Index% := (pNames ? A_LoopField &quot;=&quot; : &quot;&quot;) (img = 4294967295 ? 0 : img+1)</span>

<span class="cm">		if A_LoopField = C</span>
<span class="cm">			o%A_Index% := Rebar_getColor(NumGet(BAND, 12), 1) &quot; &quot; Rebar_getColor( NumGet(BAND, 16), 1)</span>

<span class="cm">		;private, not exposed</span>
<span class="cm">		if A_LoopField = N		;id</span>
<span class="cm">			o%A_Index% := NumGet(BAND, 52)</span>

<span class="cm">		if A_LoopField = B		;handle to bmp, so I can release it if band is deleted</span>
<span class="cm">			o%A_Index% := NumGet(BAND, 48)</span>
<span class="cm">	}</span>
<span class="cm">	</span>
<span class="cm">	return o1</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetLayout</span>
<span class="cm">			Get layout of bands in rebar. Layout is single line string containing information about position of bars in the rebar control.</span>
<span class="cm">			Return value of this function is fed into &lt;SetLayout&gt; later, to restore layout.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_GetLayout(hRebar){</span>
<span class="cm">	loop, % ReBar_Count(hRebar)</span>
<span class="cm">		Rebar_GetBand(hRebar, A_Index, &quot;NLS&quot;, n, l, s),  res .= n &quot; &quot; l &quot; &quot; (InStr(s, &quot;break&quot;) ? 1 : 0) &quot;|&quot;</span>
<span class="cm">	return SubStr(res, 1, -1)</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetRect</span>
<span class="cm"> 			Get band rectangle.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			pQ			- Query parameter: set x,y,w,h to return appropriate value, or leave blank to return all in single line.</span>
<span class="cm"> 			o1 .. o4	- Output variables.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			String with 4 values separated by space or requested information.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_GetRect(hRebar, WhichBand=&quot;&quot;, pQ=&quot;&quot;, ByRef o1=&quot;&quot;, ByRef o2=&quot;&quot;, ByRef o3=&quot;&quot;, ByRef o4=&quot;&quot;) {</span>
<span class="cm">	static RB_GETRECT = 0x409</span>

<span class="cm">	if pQ =</span>
<span class="cm">		retAll := true, pQ := &quot;xywh&quot;</span>

<span class="cm">	VarSetCapacity(RECT, 16)</span>
<span class="cm">	if WhichBand =</span>
<span class="cm">		 DllCall(&quot;GetClientRect&quot;, &quot;uint&quot;, hRebar, &quot;uint&quot;, &amp;RECT)</span>
<span class="cm">	else {</span>
<span class="cm">		WhichBand := WhichBand &gt;= 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1</span>
<span class="cm">	    SendMessage, RB_GETRECT , WhichBand, &amp;RECT, ,ahk_id %hRebar%</span>
<span class="cm">		IfEqual, ErrorLevel, 0, return A_ThisFunc &quot;&gt; Can&#39;t get band rect.&quot;</span>
<span class="cm">	}</span>

<span class="cm">	xx := NumGet(RECT, 0, &quot;Int&quot;), yy := NumGet(RECT, 4, &quot;Int&quot;)</span>
<span class="cm">	loop, parse, pQ</span>
<span class="cm">		if A_LoopField = x</span>
<span class="cm">			o%A_Index% := xx</span>
<span class="cm">		else if A_LoopField = y</span>
<span class="cm">			o%A_Index% := yy</span>
<span class="cm">		else if A_LoopField = w</span>
<span class="cm">			o%A_Index% := NumGet(RECT, 8, &quot;Int&quot;) - xx</span>
<span class="cm">		else if A_LoopField = h</span>
<span class="cm">			o%A_Index% := NumGet(RECT, 12, &quot;Int&quot;) - yy</span>

<span class="cm">	return retAll ? o1 &quot; &quot; o2 &quot; &quot; o3 &quot; &quot; o4 : o1</span>

<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: Height</span>
<span class="cm"> 			Returns the height of the rebar control.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_Height(hRebar){</span>
<span class="cm">	static RB_GETBARHEIGHT = 0x41B</span>
<span class="cm">	SendMessage, RB_GETBARHEIGHT,,,, ahk_id %hRebar%</span>
<span class="cm">	return Errorlevel</span>
<span class="cm">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:	Id2Index</span>
<span class="cm">			Returns 1 based position of the band with given id.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Id	- ID of the band.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_ID2Index(hRebar, Id){</span>
<span class="cm">	static RB_IDTOINDEX=0x410</span>
<span class="cm">	SendMessage, RB_IDTOINDEX, Id,,, ahk_id %hRebar%</span>
<span class="cm">	return Errorlevel+1</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Insert</span>
<span class="cm"> 			Inserts a new band in a rebar control.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			hCtrl			- Control to be hosted by the band.</span>
<span class="cm"> 			o1 .. o8		- Named parameters. See below.</span>
<span class="cm"> </span>
<span class="cm"> Named parameters:</span>
<span class="cm"> 			S				- Band styles separated by white space. By default &quot;gripperalways&quot;. See bellow.</span>
<span class="cm"> 			L				- Length of the band. By default, width of the child control is used + 10px</span>
<span class="cm"> 			mW				- Minimum width of the child control.</span>
<span class="cm"> 			mH				- Minimum height of the child control. By default the height of the child control.</span>
<span class="cm"> 			I				- Header icon index.</span>
<span class="cm"> 			T				- Header text.</span>
<span class="cm"> 			C				- Background and foreground color separated by space.</span>
<span class="cm"> 			BG				- Background bitmap.</span>
<span class="cm"> 			P				- 1-based position of the band. Set to 0 add the band to the end (default).</span>
<span class="cm"> </span>
<span class="cm"> Band styles:</span>
<span class="cm"> 			break			- The band is on a new line.</span>
<span class="cm"> 			childedge		- The band has an edge at the top and bottom of the child window.</span>
<span class="cm"> 			fixedbmp		- The background bitmap does not move when the band is resized.</span>
<span class="cm"> 			fixedsize		- The band can&#39;t be sized. With this style, the sizing grip is not displayed on the band.</span>
<span class="cm"> 			gripperalways	- The band will always have a sizing grip, even if it is the only band in the rebar.</span>
<span class="cm"> 			hidden			- The band will not be visible. Don&#39;t use this flag in Insert function. Instead, insert the band without this flag, then use &lt;SetBand&gt; to hide it. To restore it afterwards, use SetBand with &quot;S show&quot; parameter.</span>
<span class="cm"> 			nogripper		- The band will never have a sizing grip, even if there is more than one band in the rebar.</span>
<span class="cm"> 			usechevron		- Show a chevron button if the band is smaller than ideal.</span>
<span class="cm"> 			novert			- Don&#39;t show when vertical.</span>
<span class="cm"> 			hidetitle		- Keep band title hidden.</span>
<span class="cm"> 			*				- Default styles for the band. For instance &quot;* break&quot; will set band style to default plus &quot;break&quot; style.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			ID of the newly created band or 0 if it fails.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			For some reason, using the Gui, Font to change font size before adding ComboBox child to the band will make it buggy in a sense</span>
<span class="cm">			that ComboBox list will not be able to show (although you can still select items using arrows). </span>


<span class="cm">	</span>
<span class="cm"> */</span>
<span class="cm">Rebar_Insert(hRebar, hCtrl, o1=&quot;&quot;, o2=&quot;&quot;, o3=&quot;&quot;, o4=&quot;&quot;, o5=&quot;&quot;, o6=&quot;&quot;, o7=&quot;&quot;, o8=&quot;&quot;, o9=&quot;&quot;){</span>
<span class="cm">	static RB_INSERTBANDA=0x401</span>

<span class="cm">	if !(hCtrl+0)</span>
<span class="cm">		return A_ThisFunc &quot;&gt; Invalid child handle: &quot; hCtrl</span>

<span class="cm">	pos := Rebar_compileBand(BAND, hCtrl, o1, o2, o3, o4, o5, o6, o7, o8, o9)</span>
<span class="cm">	if pos is not Integer</span>
<span class="cm">		return pos</span>
<span class="cm">	</span>
<span class="cm">	SendMessage, RB_INSERTBANDA, pos, &amp;BAND,, ahk_id %hReBar% </span>
<span class="cm">	ifEqual, ErrorLevel, 0, return 0</span>
<span class="cm">	return 	NumGet(BAND, 52)   ;return ID</span>
<span class="cm">}</span>


<span class="cm">/*</span>
<span class="cm">  Function: Lock</span>
<span class="cm"> 			Locks or unlcoks the rebar (sets or removes &quot;nogripper&quot; style for all bands in rebar)</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			Lock - Leave empty to lock, set to &quot;-&quot; to unlock, set to &quot;~&quot; to toggle.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_Lock(hRebar, Lock=&quot;&quot;) {</span>
<span class="cm">	if Lock !=</span>
<span class="cm">		if Lock not in -,~</span>
<span class="cm">			return A_ThisFunc &quot;&gt; Invalid parameter: &quot; Lock</span>

<span class="cm">	c := Rebar_Count(hRebar)</span>
<span class="cm">	if Lock = ~</span>
<span class="cm">		Lock := InStr(Rebar_GetBand(hRebar, c, &quot;S&quot;), &quot;nogripper&quot;) ? &quot;-&quot; : &quot;&quot;</span>
<span class="cm">	</span>
<span class="cm">	loop, %c%</span>
<span class="cm">		Rebar_SetBandStyle(hRebar, A_Index, Lock &quot;nogripper&quot;)</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	MoveBand</span>
<span class="cm"> 			Moves a band from one index to another.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			From - 1-based index of the band to be moved.</span>
<span class="cm"> 			To	 - 1-based index of the new band position. By default 1 (i.e. move to top).</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			TRUE if successful, or FALSE otherwise.</span>
<span class="cm"> */</span>
<span class="cm">Rebar_MoveBand(hRebar, From, To=1){</span>
<span class="cm">	static RB_MOVEBAND = 0x427</span>
<span class="cm">	SendMessage, RB_MOVEBAND, From-1, To-1, ,ahk_id %hRebar%</span>
<span class="cm">	res := ErrorLevel</span>
<span class="cm">	Rebar_ShowBand(hRebar, 1)		;?! without this it doesn&#39;t work ... it doesn&#39;t have to be 1, but just one show command. 1 is safe as you will alawyas have 1st band visible.</span>
<span class="cm">	return res</span>
<span class="cm">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:	SetBand</span>
<span class="cm">			Sets characteristics of an existing band in a rebar control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			WhichBand	- Band position or ID that is about to be changed.</span>
<span class="cm">			o1 .. o9	- Named parameters. Any named parameter that can be specified in &lt;Add&gt; function can be used here.</span>

<span class="cm"> Returns:</span>
<span class="cm">			TRUE if successful, FALSE otherwise.</span>

<span class="cm"> */</span>
<span class="cm">Rebar_SetBand(hRebar, WhichBand, o1=&quot;&quot;, o2=&quot;&quot;, o3=&quot;&quot;, o4=&quot;&quot;, o5=&quot;&quot;, o6=&quot;&quot;, o7=&quot;&quot;, o8=&quot;&quot;, o9=&quot;&quot;){</span>
<span class="cm">	static RB_SETBANDINFOA = 0x406</span>
<span class="cm">	WhichBand := WhichBand &gt; 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1</span>

<span class="cm">	p := Rebar_compileBand(BAND, 0, o1, o2, o3, o4, o5, o6, o7, o8, o9)</span>

<span class="cm">	SendMessage, RB_SETBANDINFOA, WhichBand, &amp;BAND, ,ahk_id %hRebar%</span>
<span class="cm">	if (p != -1)</span>
<span class="cm">		Rebar_MoveBand(hRebar, WhichBand+1, p+1)</span>
<span class="cm">		</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: SetBandState</span>
<span class="cm"> 			Minimize or maximize the band.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			State		- Set &quot;-&quot; to minimize, &quot;+&quot; to maximize to full width, &quot;*&quot; to maximize to ideal width (this is the width of the control when it is added to the band).</span>
<span class="cm"> */</span>
<span class="cm">Rebar_SetBandState(hRebar, WhichBand, State) {</span>
<span class="cm">	static RB_MAXIMIZEBAND=0x41F, RB_MINIMIZEBAND=0x41E</span>
<span class="cm">	</span>
<span class="cm">	WhichBand := WhichBand &gt; 10000 ? Rebar_Id2Index(hRebar, WhichBand)-1 : WhichBand-1</span>
<span class="cm">	if (State = &quot;-&quot;)</span>
<span class="cm">		SendMessage, RB_MINIMIZEBAND, WhichBand,, , ahk_id %hRebar%</span>
<span class="cm">	else if State in +,*</span>
<span class="cm">		SendMessage, RB_MAXIMIZEBAND, WhichBand, State = &quot;*&quot; ? 1 : 0, , ahk_id %hRebar%</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: SetBandWidth</span>
<span class="cm"> 			Sets the width for a band.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID.</span>
<span class="cm"> 			Width		- Width.</span>
<span class="cm"> </span>
<span class="cm">  Returns:</span>
<span class="cm"> 			TRUE if the value was set and FALSE otherwise.</span>
<span class="cm"> */	 </span>
<span class="cm">Rebar_SetBandWidth(hRebar, WhichBand, Width) {</span>
<span class="cm">	static RB_SETBANDINFOA = 0x406</span>
<span class="cm">	WhichBand := WhichBand &gt; 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1</span>
<span class="cm">	</span>
<span class="cm">	VarSetCapacity( BAND, 80 )</span>
<span class="cm">	 ,NumPut(80	   ,BAND)</span>
<span class="cm">	 ,NumPut(0x40  ,BAND, 4)	;mask</span>
<span class="cm">	 ,NumPut(Width ,BAND, 44)    ;cx </span>
<span class="cm">	SendMessage, RB_SETBANDINFOA, WhichBand, &amp;BAND, ,ahk_id %hRebar%</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetBandStyle</span>
<span class="cm">			Sets the style for a band.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			WhichBand	- Band position or ID.</span>
<span class="cm">			Style		- List of styles to add/remove for the band. Use - prefix to remove the style.</span>

<span class="cm"> Returns:</span>
<span class="cm">			TRUE if successful, or FALSE otherwise.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			If you want to to replace band styles completely use &lt;SetBand&gt; function with S parameter.</span>
<span class="cm">			This function toggles desired styles.</span>
<span class="cm"> */</span>

<span class="cm">Rebar_SetBandStyle(hRebar, WhichBand, Style) {</span>
<span class="cm">	static RB_SETBANDINFOA = 0x406, RB_GETBANDINFO=0x405</span>
<span class="cm">	WhichBand := WhichBand &gt;= 10000 ? Rebar_Id2Index(hrebar, WhichBand)-1 : WhichBand-1</span>

<span class="cm">	VarSetCapacity( BAND, 80 ),  NumPut(80 ,BAND),  NumPut(1,BAND, 4)</span>
<span class="cm">	StringReplace, Style, Style, ?, ,A</span>
<span class="cm">    SendMessage, RB_GETBANDINFO, WhichBand, &amp;BAND, ,ahk_id %hRebar%</span>

<span class="cm">	hStyle := Rebar_getStyle( Style, true, hNegStyle) | NumGet(BAND,8),   hStyle &amp;= hNegStyle</span>
<span class="cm">	ifEqual, hStyle, ,return A_ThisFunc &quot;&gt; Some of the styles are invalid: &quot; Style</span>

<span class="cm">	NumPut(hStyle ,BAND, 8)		;style</span>
<span class="cm">	SendMessage, RB_SETBANDINFOA, WhichBand, &amp;BAND, ,ahk_id %hRebar%</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  SetLayout</span>
<span class="cm">			Set layout of bands in rebar.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Layout	- String with information about position of bands in rebar control.</span>
<span class="cm">					  Use &lt;GetLayout&gt; function to get this string. Layout syntax is:</span>
<span class="cm">			</span>
<span class="cm">			&gt; id1 len1 break1|id2 len2 break2|....|idN lenN breakN</span>

<span class="cm"> */</span>
<span class="cm">Rebar_SetLayout(hRebar, Layout) {</span>
<span class="cm">	loop, parse, Layout, |</span>
<span class="cm">	{</span>
<span class="cm">		StringSplit, L, A_LoopField, %A_Space%</span>
<span class="cm">		pos := Rebar_ID2Index(hRebar, L1)</span>
<span class="cm">		, Rebar_SetBandStyle(hRebar, pos, (L3 ? &quot;&quot; : &quot;-&quot;) &quot;break&quot;)</span>
<span class="cm">		, Rebar_SetBandWidth(hRebar, pos, L2)</span>
<span class="cm">		, Rebar_MoveBand(hRebar, pos , A_Index)</span>
<span class="cm">	}</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm">	Function: SizeToRect</span>

<span class="cm">	Parameters:</span>
<span class="cm">			RECT	- Reference to rectangle structure. If omited, parents rectangle will be used (GetClientRect).</span>

<span class="cm">	Remarks:</span>
<span class="cm">			The rebar bands will be arranged and wrapped as necessary to fit the rectangle. </span>
<span class="cm">			Bands that have the VARIABLEHEIGHT style will be resized as evenly as possible to fit the rectangle. </span>
<span class="cm">			The height of a horizontal rebar or the width of a vertical rebar may change, depending on the new layout.</span>

<span class="cm"> */</span>
<span class="cm">Rebar_SizeToRect(hRebar, ByRef RECT=&quot;~`a &quot;){</span>
<span class="cm">	static RB_SIZETORECT = 0x417</span>
<span class="cm">	</span>
<span class="cm">	hParent := DllCall(&quot;GetParent&quot;, &quot;uint&quot;, hRebar)</span>
<span class="cm">	</span>
<span class="cm">	if (RECT != &quot;~`a &quot;)</span>
<span class="cm">		VarSetCapacity(RECT, 16),  DllCall(&quot;GetClientRect&quot;, &quot;uint&quot;, hParent, &quot;uint&quot;, &amp;RECT)</span>

<span class="cm">	SendMessage, RB_SIZETORECT, 0, &amp;RECT, , ahk_id %hRebar%</span>
<span class="cm">	return ErrorLevel</span>
<span class="cm">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:  ShowBand</span>
<span class="cm"> 			Shows or hides the band.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			bShow		- True to show the band (default), FALSE to hide it. </span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			TRUE if successful, or FALSE otherwise.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			This function can also be used to resize the band to mach the parents size. </span>
<span class="cm">			Put call to this function inside GuiSize routine. Update to first band will reposition all bands to match the Gui size.</span>
<span class="cm">return</span>

<span class="cm"> */</span>
<span class="cm">Rebar_ShowBand(hRebar, WhichBand, bShow=true) {</span>
<span class="cm">	static RB_SHOWBAND=0x423</span>
<span class="cm">	WhichBand := WhichBand &gt;= 10000 ? Rebar_Id2Index(hRebar, WhichBand)-1 : WhichBand-1</span>

<span class="cm">    SendMessage, RB_SHOWBAND, WhichBand, bShow,,ahk_id %hRebar%</span>
<span class="cm">	return Errorlevel</span>
<span class="cm">}</span>


<span class="cm">;================================== PRIVATE ===========================================</span>

<span class="cm">; hCtrl - if 0 band is changing, if handle band is adding</span>
<span class="cm">Rebar_compileBand(ByRef BAND, hCtrl, ByRef o1=&quot;&quot;, ByRef o2=&quot;&quot;, ByRef o3=&quot;&quot;, ByRef o4=&quot;&quot;, ByRef o5=&quot;&quot;, ByRef o6=&quot;&quot;, ByRef o7=&quot;&quot;, ByRef o8=&quot;&quot;, ByRef o9=&quot;&quot;){</span>
<span class="cm">	static RBBIM_ID=0x100, RBBIM_COLORS=0x2, RBBIM_IMAGE=0x8, RBBIM_CHILD = 0x10, RBBIM_STYLE = 0x1, RBBIM_TEXT = 0x4, RBBIM_CHILDSIZE = 0x20, RBBIM_SIZE = 0x40, RBBIM_IDEALSIZE = 0x200, RBBIM_BACKGROUND=0X80</span>
<span class="cm">	static id=10000, NP_T		;Text is made static so buffer can outlive call to this function.</span>

<span class="cm">	if hCtrl</span>
<span class="cm">		ControlGetPos, , ,wIdeal, NP_mH, , ahk_id %hCtrl%</span>

<span class="cm">	NP_T =</span>
<span class="cm">	loop, 10 { </span>
<span class="cm">		if (o%A_index% = &quot;&quot;)</span>
<span class="cm">			break</span>
<span class="cm">		j := InStr( o%A_index%, A_Space ),  prop := SubStr( o%A_index%, 1, j-1), NP_%prop% := SubStr( o%A_index%, j+1, 100) </span>
<span class="cm">	}</span>

<span class="cm">	if NP_C !=</span>
<span class="cm">		NP_C .= &quot; &quot;, j := InStr(NP_C, A_Space), bg := Rebar_getColor( SubStr(NP_C, 1, j-1)), fg := Rebar_getColor( SubStr(NP_C, j+1) )</span>

<span class="cm">  ;handle styles	</span>
<span class="cm">	if NP_S !=</span>
<span class="cm">		if (hStyle := Rebar_getStyle( NP_S, true )) = &quot;&quot;</span>
<span class="cm">			return A_ThisFunc &quot;&gt; Some of the styles are invalid.&quot;</span>

<span class="cm">  ;set mask</span>
<span class="cm">	hMask := (NP_T != &quot;&quot; ? RBBIM_TEXT : 0)</span>
<span class="cm">			|(hStyle ? RBBIM_STYLE : 0) </span>
<span class="cm">			|(NP_BG != &quot;&quot; ? RBBIM_BACKGROUND : 0) </span>
<span class="cm">			|(NP_I ? RBBIM_IMAGE : 0)  </span>
<span class="cm">			|(NP_C != &quot;&quot; ? RBBIM_COLORS : 0) </span>
<span class="cm">			|(hCtrl ? RBBIM_SIZE | RBBIM_CHILD | RBBIM_IDEALSIZE | RBBIM_ID : 0) ;RBBIM_SIZE only on update</span>
<span class="cm">			|(NP_mW or NP_mH ? RBBIM_CHILDSIZE : 0) </span>

<span class="cm">  ;set calculated </span>
<span class="cm">	hBmp := (NP_BG  != &quot;&quot;) ? DllCall(&quot;LoadImage&quot;, &quot;uint&quot;, 0, &quot;str&quot;, NP_BG, &quot;uint&quot;, 0, &quot;uint&quot;, 0, &quot;uint&quot;, 0, &quot;uint&quot;, 0x10) : 0</span>
<span class="cm">	NP_L := (NP_L+0 != &quot;&quot;) ? NP_L : wIdeal + 10		;if no len is specified use controls width + something for header</span>
<span class="cm">	id	 += hCtrl ? 1 : 0</span>
<span class="cm"> </span>
<span class="cm">	VarSetCapacity(BAND, 80, 0)</span>
<span class="cm">	 ,NumPut(80		,BAND)			;cbSize</span>
<span class="cm">	 ,NumPut(hMask	,BAND, 4)		;mask</span>
<span class="cm">	 ,NumPut(hStyle	,BAND, 8)		;style</span>
<span class="cm">	 ,NumPut(fg		,BAND, 12)      ;clrFore</span>
<span class="cm">	 ,NumPut(bg		,BAND, 16)      ;clrBack</span>
<span class="cm">	 ,NumPut(&amp;NP_T	,BAND, 20)      ;lpText </span>
<span class="cm">	 ,NumPut(NP_I-1	,BAND, 28)		;iImage</span>
<span class="cm">	 ,NumPut(hCtrl	,BAND, 32)      ;hwndChild </span>
<span class="cm">	 ,NumPut(NP_mW	,BAND, 36)		;cyMinChild </span>
<span class="cm">	 ,NumPut(NP_mH	,BAND, 40)		;cyMinChild </span>
<span class="cm">	 ,NumPut(NP_L 	,BAND, 44)      ;cx </span>
<span class="cm">	 ,NumPut(hBmp	,BAND, 48)		;hbmBack</span>
<span class="cm">	 ,NumPut(id		,BAND, 52)		;wID</span>
<span class="cm">	 ,NumPut(wIdeal	,BAND, 68)		;cxIdeal		;Ideal width of the band, in pixels. If the band is maximized to the ideal width (see RB_MAXIMIZEBAND), the rebar control will attempt to make the band this width.</span>
<span class="cm">	 ;NumPut(lparam	,BAND, 72)		;lParam			;Application-defined value.</span>

<span class="cm">	 return (NP_P+0 != &quot;&quot;) ? NP_P-1 : -1			;return position on which to add band</span>
<span class="cm">}</span>


<span class="cm">;=========================================================== PRIVATE =======================================================</span>
<span class="cm">;Required function by Forms framework.</span>
<span class="cm">Rebar_add2Form(hParent, Txt, Opt) {</span>
<span class="cm">	static f := &quot;Form_Parse&quot;</span>
<span class="cm">	</span>
<span class="cm">	%f%(Opt, &quot;x# y# w# h# style IL* g*&quot;, x,y,w,h,style,il,handler)</span>
<span class="cm">	pos := (x!=&quot;&quot; ? &quot; x&quot; x : &quot;&quot;) (y!=&quot;&quot; ? &quot; y&quot; y : &quot;&quot;) (w!=&quot;&quot; ? &quot; w&quot; w : &quot;&quot;) (h!=&quot;&quot; ? &quot; h&quot; h : &quot;&quot;)</span>
<span class="cm">	return Rebar_Add(hParent, style, il, pos, handler)</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm">  Function has 3 purposes :</span>
<span class="cm"> 	o List evaluation: hex value out of list of style names</span>
<span class="cm"> 	o Hex evaluation: list of style names out of hex value</span>
<span class="cm"> 	o Negative list evaluation: hex value out of negative styles</span>
<span class="cm"> </span>
<span class="cm">  The problem is that style list can also contain numbers or be number (for instance: &quot;novert 0x40 break&quot; or just &quot;0x40&quot;). This is the purpose of pHex parameter that forces list evaluation or hex evaluation.</span>
<span class="cm">  Negative list evaulation is returned only if input variable is fed into the function. </span>
<span class="cm"> </span>
<span class="cm">  The function is generic in sense that only statics need to be changed for any module to use it with its own styles.</span>
<span class="cm"> 	o List of styles with prefix STYLE goes in first static row</span>
<span class="cm"> 	o Ordered list of styles to be used for hex evaluation</span>
<span class="cm">    o DEFAULT style is hex combination of default styles for control. * in list of style names is replaced with default styles.</span>
<span class="cm"> </span>
<span class="cm">  pStyle    - Hex value of the style or named style</span>
<span class="cm">  pHex	    - Force pStyle as hex input.</span>
<span class="cm">  pNegStyle - Hex value of the negative styles</span>
<span class="cm"> */</span>
<span class="cm">Rebar_getStyle( pStyle, pHex = false, ByRef hNegStyle=&quot;&quot;){</span>
<span class="cm">	static STYLE_HIDDEN=0x8, STYLE_BREAK=1, STYLE_FIXEDSIZE=0x2, STYLE_FIXEDBMP=0x20, STYLE_NOVERT=0x10, STYLE_VARIABLEHEIGHT=0x40, STYLE_CHILDEDGE=0x4, STYLE_USECHEVRON=0x200, STYLE_GRIPPERALWAYS = 0x80, STYLE_HIDETITLE = 0x400, STYLE_NOGRIPPER = 0x100</span>
<span class="cm">	static styles = &quot;hidden,break,fixedbmp,novert,usechevron,fixedsize,gripperalways,hiddetittle,nogripper&quot;, STYLE_DEFAULT = 0x80	;GRIPPERALWAYS</span>

<span class="cm">  ;get hex value of named style</span>
<span class="cm">	if (pStyle+0 = &quot;&quot;) or pHex </span>
<span class="cm">	{</span>
<span class="cm">		StringReplace, pStyle, pStyle, *, DEFAULT, A</span>

<span class="cm">		hStyle := 0, hNegStyle := 0xFFFFFFFF</span>
<span class="cm">		loop, parse, pStyle, %A_Tab%%A_Space%, %A_Tab%%A_Space%</span>
<span class="cm">		{</span>
<span class="cm">			ifEqual, A_LoopField,,continue</span>
<span class="cm">			if SubStr(A_LoopField, 1,1) = &quot;-&quot;</span>
<span class="cm">				s := SubStr(A_LoopField, 2), s := STYLE_%s%, hNegStyle &amp;= ~s</span>
<span class="cm">			else hStyle |= A_LoopField+0 ? A_LoopField : STYLE_%A_LoopField%</span>
<span class="cm">		}</span>
<span class="cm">		return hStyle</span>
<span class="cm">	}</span>

<span class="cm">  ;return name of the style from hex</span>
<span class="cm">	else {</span>
<span class="cm">		loop, parse, styles, `,</span>
<span class="cm">			if (pStyle &amp; STYLE_%A_LoopField%)</span>
<span class="cm">				style .= A_LoopField &quot; &quot;</span>
<span class="cm">		return SubStr(style, 1,-1)</span>
<span class="cm">	}</span>
<span class="cm">}</span>

<span class="cm">/*</span>
<span class="cm"> Converts AHK color (RGB without &quot;0x&quot;) to Win color or vice-versa</span>

<span class="cm"> pColor	- Color to convert. Can be AHK color or Win color</span>
<span class="cm"> pAHK	- if true, input is AHK color, if false, input is Win color</span>
<span class="cm"> */</span>
<span class="cm">Rebar_getColor(pColor, pAHK = false) {</span>

<span class="cm"> ;convert to win</span>
<span class="cm">	if !pAHK {</span>
<span class="cm">		pColor := &quot;0x&quot; pColor</span>
<span class="cm">		return ((pColor &amp; 0xFF) &lt;&lt; 16) + (pColor &amp; 0xFF00) + ((pColor &gt;&gt; 16) &amp; 0xFF) </span>
<span class="cm">	}</span>

<span class="cm"> ;convert to rgb </span>
<span class="cm">	oldFormat := A_FormatInteger </span>
<span class="cm">    SetFormat, integer, hex  ; Show RGB color extracted below in hex format.  </span>

<span class="cm">	pColor := (pColor &amp; 0xff00) + ((pColor &amp; 0xff0000) &gt;&gt; 16) + ((pColor &amp; 0xff) &lt;&lt; 16) </span>
<span class="cm">    StringTrimLeft, pColor, pColor, 2 </span>
<span class="cm">    loop, % 6-strlen(pColor) </span>
<span class="cm">      pColor = 0%pColor% </span>

<span class="cm">	SetFormat, integer, %oldFormat% </span>
<span class="cm">	StringUpper, pColor, pColor</span>
<span class="cm">	return pColor</span>
<span class="cm">}</span>


<span class="cm">Rebar_onNotify(Wparam, Lparam, Msg, Hwnd) {</span>
<span class="cm">	static MODULEID := 30608, oldNotify=&quot;*&quot;</span>
<span class="cm">	static RBN_LAYOUTCHANGED = -833, RBN_HEIGHTCHANGE = -831, RBN_CHEVRONPUSHED = -841, RBN_CHILDSIZE = -839</span>

<span class="cm">	if (_ := (NumGet(Lparam+4))) != MODULEID</span>
<span class="cm">	 ifLess _, 10000, return	;if ahk control, return asap (AHK increments control ID starting from 1. Custom controls use IDs &gt; 10000. Its unlikely that u will use more then 10K ahk controls.</span>
<span class="cm">	 else {</span>
<span class="cm">		ifEqual, oldNotify, *, SetEnv, oldNotify, % Rebar(&quot;oldNotify&quot;)		</span>
<span class="cm">		if oldNotify !=</span>
<span class="cm">			return DllCall(oldNotify, &quot;uint&quot;, Wparam, &quot;uint&quot;, Lparam, &quot;uint&quot;, Msg, &quot;uint&quot;, Hwnd)</span>
<span class="cm">	 }</span>

<span class="cm">	hw := NumGet(Lparam+0),  code := NumGet(Lparam+8, 0, &quot;Int&quot;),  handler := Rebar(hw &quot;Handler&quot;)	</span>
<span class="cm">	ifEqual, handler, ,return</span>

<span class="cm">	if (code = RBN_CHEVRONPUSHED)</span>
<span class="cm">		%handler%(hw, &quot;C&quot;)</span>

<span class="cm">	if (code = RBN_HEIGHTCHANGE)</span>
<span class="cm">		%handler%(hw, &quot;H&quot;)</span>

<span class="cm">	if (code = RBN_LAYOUTCHANGED)</span>
<span class="cm">		%handler%(hw, &quot;L&quot;)</span>

<span class="cm">;	if (code = RBN_CHILDSIZE)	;spammer msg</span>
<span class="cm">;		%handler%(hw, &quot;S&quot;)</span>

<span class="cm">}</span>

<span class="cm">Rebar_malloc(pSize){</span>
<span class="cm">	static MEM_COMMIT=0x1000, PAGE_READWRITE=0x04</span>
<span class="cm">	return DllCall(&quot;VirtualAlloc&quot;, &quot;uint&quot;, 0, &quot;uint&quot;, pSize, &quot;uint&quot;, MEM_COMMIT, &quot;uint&quot;, PAGE_READWRITE)</span>
<span class="cm">}</span>

<span class="cm">Rebar_mfree(pAdr) {</span>
<span class="cm">	static MEM_RELEASE = 0x8000</span>
<span class="cm">	return DllCall(&quot;VirtualFree&quot;, &quot;uint&quot;, pAdr, &quot;uint&quot;, 0, &quot;uint&quot;, MEM_RELEASE)</span>
<span class="cm">}</span>

<span class="cm">;Mini storage function</span>
<span class="cm">Rebar(var=&quot;&quot;, value=&quot;~`a&quot;) { </span>
<span class="cm">	static</span>
<span class="cm">	_ := %var%</span>
<span class="cm">	ifNotEqual, value, ~`a, SetEnv, %var%, %value%</span>
<span class="cm">	return _</span>
<span class="cm">}</span>

<span class="cm">/* Group: Examples</span>
<span class="cm">	(start code)</span>
<span class="cm">		Gui, +LastFound +Resize </span>
<span class="cm">		hGui := WinExist() </span>
<span class="cm">		Gui, Show, w400 h140 hide			;set window size, mandatory</span>

<span class="cm">	  ;create edit</span>
<span class="cm">		Gui, Add, Edit, HWNDhEdit w100 h100</span>

<span class="cm">	  ;create combo</span>
<span class="cm">		Gui, Add, ComboBox, HWNDhCombo w80, item 1 |item 2|item 3</span>

<span class="cm">	  ;create rebar	</span>
<span class="cm">		hRebar := Rebar_Add(hGui)</span>
<span class="cm">		ReBar_Insert(hRebar, hEdit, &quot;mw 100&quot;, &quot;L 400&quot;, &quot;T Log &quot;)	;Insert edit band, set lenght of the band to 400</span>
<span class="cm">																	; minimum width of edit to 100, set text to &quot;Log &quot;</span>
<span class="cm">		ReBar_Insert(hRebar, hCombo, &quot;L 300&quot;, &quot;P 1&quot;)				;Insert combo band at the top, set length of the band to 300</span>

<span class="cm">		Gui, Show</span>
<span class="cm">	return </span>
<span class="cm">	(end code)</span>
<span class="cm"> */</span>

<span class="cm">/* Group: About</span>
<span class="cm">	o Ver 2.02 by majkinetor. </span>
<span class="cm">	o MSDN Reference: &lt;http://msdn.microsoft.com/en-us/library/bb774375(VS.85).aspx&gt;.</span>
<span class="cm">	o Licenced under GNU GPL &lt;http://creativecommons.org/licenses/GPL/2.0/&gt;.</span>
<span class="cm">*/</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">  Title:    Rebar</span>
<span class="cm"> 			Rebar control act as container for child windows. </span>
<span class="cm"> 			An application assigns child windows, which are often other controls, to a rebar control band. </span>
<span class="cm"> 			Rebar controls contain one or more bands, and each band can have any combination of a gripper bar, a bitmap, a text label, and a child window. </span>
<span class="cm"> 			However, bands cannot contain more than one child window. As you dynamically reposition a rebar control band, the rebar control manages the size </span>
<span class="cm">			and position of the child window assigned to that band.</span>
<span class="cm"> 			(See rebar.png)</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm">  Function: Add</span>
<span class="cm"> 			Add a rebar to the GUI.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			hGui	- Handle of the GUI.</span>
<span class="cm"> 			Style	- White space separated list of styles. See bellow for details. By default &quot;VARHEIGHT DBLCLKTOGGLE&quot;. Integer styles are allowed.</span>
<span class="cm"> 			hIL		- Handle of the image list associated with the control. Optional.</span>
<span class="cm">			Pos		- Position of the rebar in usual AHK style. Optional.</span>
<span class="cm">			Handler - Notification handler.</span>
<span class="cm"> </span>
<span class="cm">  Styles:</span>
<span class="cm"> 			autosize	 - The rebar control will automatically change the layout of the bands when the size or position of the control changes.</span>
<span class="cm"> 			bandborders  - The rebar control displays narrow lines to separate adjacent bands.</span>
<span class="cm"> 			dblclktoggle - The rebar band will toggle its maximized or minimized state when the user double-clicks the band. Without this style, the maximized or minimized state is toggled when the user single-clicks on the band.</span>
<span class="cm"> 			fixedorder	 - The rebar control always displays bands in the same order. You can move bands to different rows, but the band order is static.</span>
<span class="cm"> 			varheight	 - The rebar control displays bands at the minimum required height, when possible. Without this style, the rebar control displays all bands at the same height, using the height of the tallest visible band to determine the height of other bands.</span>
<span class="cm"> 			verticalgripper - The size grip will be displayed vertically instead of horizontally in a vertical rebar control.</span>
<span class="cm"> 			vertical	 - Causes the control to be displayed vertically.</span>
<span class="cm"> </span>
<span class="cm">  Handler:</span>
<span class="cm">	&gt;		Handler(hCtrl, Event)</span>
<span class="cm">			</span>
<span class="cm">			Event	- C (Chevron click) L (Layout change)  H (Height change).</span>
<span class="cm">  </span>
<span class="cm">  Returns:</span>
<span class="cm"> 			Handle to the newly created control or 0 if function failes. Error message is returned on invalid usage.</span>
<span class="cm"> */</span>
<span class="n">Rebar_Add</span><span class="p">(</span><span class="n">hGui</span><span class="p">,</span> <span class="n">Style</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">hIL</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Pos</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MODULEID</span><span class="p">,</span> <span class="n">ICC_COOL_CLASSES</span> <span class="o">:=</span> <span class="mh">0x400</span><span class="p">,</span> <span class="n">RB_SETBARINFO</span><span class="o">=</span><span class="mh">0x404</span><span class="p">,</span> <span class="n">RB_SETUNICODEFORMAT</span><span class="o">=</span><span class="mh">0x2005</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">WS_CHILD</span> <span class="o">:=</span> <span class="mh">0x40000000</span><span class="p">,</span> <span class="n">WS_VISIBLE</span> <span class="o">:=</span> <span class="mh">0x10000000</span><span class="p">,</span>  <span class="n">WS_CLIPSIBLINGS</span> <span class="o">=</span> <span class="mh">0x4000000</span><span class="p">,</span> <span class="n">WS_CLIPCHILDREN</span> <span class="o">=</span> <span class="mh">0x2000000</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RBS_VERTICALGRIPPER</span><span class="o">=</span><span class="mh">0x4000</span><span class="p">,</span> <span class="n">RBS_DBLCLKTOGGLE</span><span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span> <span class="n">RBS_AUTOSIZE</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">RBS_VARHEIGHT</span><span class="o">=</span><span class="mh">0x200</span><span class="p">,</span> <span class="n">RBS_NODIVIDER</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">RBS_BANDBORDERS</span><span class="o">=</span><span class="mh">0x400</span><span class="p">,</span> <span class="n">CCS_NORESIZE</span><span class="o">=</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">CCS_NOPARENTALIGN</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">RBS_VERTICAL</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">RBS_BORDER</span><span class="o">=</span><span class="mh">0x800000</span><span class="p">,</span> <span class="n">RBS_FIXEDORDER</span> <span class="o">=</span> <span class="mh">0x800</span>
<span class="w"> </span>
<span class="w">	</span><span class="nb">if </span><span class="n">MODULEID</span> <span class="o">=</span>
	<span class="p">{</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">ICC</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICC</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">ICC_COOL_CLASSES</span><span class="p">,</span> <span class="n">ICC</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
		<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;comctl32.dll\InitCommonControlsEx&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ICC</span><span class="p">)</span> 
<span class="w">			</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Can&#39;t initialize common controls&quot;</span> 

		<span class="n">old</span> <span class="o">:=</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="mh">0x4E</span><span class="p">,</span> <span class="s">&quot;Rebar_onNotify&quot;</span><span class="p">),</span> 	<span class="n">MODULEID</span> <span class="o">:=</span> <span class="mi">30608</span>
<span class="w">		</span><span class="nb">if </span><span class="n">old</span> <span class="o">!=</span> <span class="n">Rebar_onNotify</span>
			<span class="n">Rebar</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">,</span> <span class="nf">RegisterCallback</span><span class="p">(</span><span class="n">old</span><span class="p">))</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Style</span><span class="p">,,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">VARHEIGHT</span> <span class="n">DBLCLKTOGGLE</span>

	<span class="n">hStyle</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">hStyle</span> <span class="o">|=</span> <span class="nv">A_LoopField</span><span class="o">+</span><span class="mi">0</span> <span class="o">?</span> <span class="nv">A_LoopField</span> <span class="o">:</span> <span class="n">RBS_</span><span class="nv">%A_LoopField%</span>

<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">hStyle</span><span class="p">,</span> <span class="p">,</span><span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Some of the styles are invalid: &quot;</span> <span class="n">Style</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">){</span>
		<span class="n">x</span> <span class="o">:=</span> <span class="n">y</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">h</span> <span class="o">:=</span> <span class="mi">100</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
		<span class="p">{</span>
<span class="w">			</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="p">,</span> <span class="n">continue</span>
			<span class="n">p</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">			</span><span class="nb">if </span><span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span>
<span class="w">				</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid position specifier: &quot;</span> <span class="n">p</span>
			<span class="nv">%p%</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
		<span class="p">}</span>
		<span class="n">hStyle</span> <span class="o">|=</span> <span class="n">CCS_NOPARENTALIGN</span> <span class="o">|</span> <span class="n">CCS_NORESIZE</span>
	<span class="p">}</span>

	<span class="n">hRebar</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span>
             <span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span>  <span class="s">&quot;ReBarWindow32&quot;</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">WS_CHILD</span> <span class="o">|</span> <span class="n">WS_VISIBLE</span> <span class="o">|</span> <span class="n">WS_CLIPSIBLINGS</span> <span class="o">|</span> <span class="n">WS_CLIPCHILDREN</span> <span class="o">|</span> <span class="n">hStyle</span>
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">h</span>
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hGui</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">MODULEID</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span> 
             <span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span> 
<span class="w">    </span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">hRebar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="mi">0</span>

<span class="w">	</span><span class="nb">if </span><span class="n">hIL</span> <span class="p">{</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RBI</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">RBI</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">RBI</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">hIL</span><span class="p">,</span> <span class="n">RBI</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SETBARINFO</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RBI</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">if </span><span class="nf">IsFunc</span><span class="p">(</span><span class="n">Handler</span><span class="p">)</span>
		<span class="n">Rebar</span><span class="p">(</span><span class="n">hRebar</span> <span class="s">&quot;handler&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SETUNICODEFORMAT</span><span class="p">,</span><span class="mi">0</span><span class="p">,,,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span><span class="c-Singleline">		;!!! doesn&#39;t seem have effect, but again, no harm to call it</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hRebar</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  Count</span>
<span class="cm">			Retrieves the number of bands in a rebar control.</span>
<span class="cm"> */</span>
<span class="n">Rebar_Count</span><span class="p">(</span><span class="n">hRebar</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_GETBANDCOUNT</span><span class="o">=</span><span class="mh">0x40C</span>	
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_GETBANDCOUNT</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  DeleteBand</span>
<span class="cm"> 			Deletes a band from a rebar control.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			Nonzero if successful, or zero otherwise.</span>
<span class="cm"> */</span>
<span class="n">Rebar_DeleteBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_DELETEBAND</span> <span class="o">=</span> <span class="mh">0x402</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ;free the bitmap if it is set</span>
<span class="w">	</span><span class="nb">if </span><span class="n">h</span> <span class="o">:=</span> <span class="n">Rebar_GetBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="s">&quot;B&quot;</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_DELETEBAND</span><span class="p">,</span><span class="n">WhichBand</span><span class="p">,,,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetBand</span>
<span class="cm"> 			Get band information.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID.</span>
<span class="cm"> 			pQ			- Query parameter: S (Style), L (Length), C (Color), I (Icon index), T (Text), N (identificatioN), B (Bitmap handle).</span>
<span class="cm">			o1..o7		- Reference to output variables.</span>

<span class="cm"> Returns:</span>
<span class="cm"> 			o1</span>
<span class="cm"> */</span> 
<span class="n">Rebar_GetBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">pQ</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RBBIM_ID</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">RBBIM_COLORS</span><span class="o">=</span><span class="mh">0x2</span><span class="p">,</span> <span class="n">RBBIM_IMAGE</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">RBBIM_CHILD</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span> <span class="n">RBBIM_STYLE</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span> <span class="n">RBBIM_TEXT</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span> <span class="n">RBBIM_CHILDSIZE</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="n">RBBIM_SIZE</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span> <span class="n">RBBIM_IDEALSIZE</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span> <span class="n">RBBIM_BACKGROUND</span><span class="o">=</span><span class="mh">0X80</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_GETBANDINFO</span><span class="o">=</span><span class="mh">0x405</span>

	<span class="n">hMask</span> <span class="o">:=</span> <span class="n">RBBIM_TEXT</span> <span class="o">|</span> <span class="n">RBBIM_STYLE</span> <span class="o">|</span> <span class="n">RBBIM_SIZE</span> <span class="o">|</span> <span class="n">RBBIM_COLORS</span> <span class="o">|</span> <span class="n">RBBIM_IMAGE</span> <span class="o">|</span> <span class="n">RBBIM_ID</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span> 

	
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="n">BAND</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">hMask</span><span class="p">,</span> <span class="n">BAND</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wTxt</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wTxt</span><span class="p">,</span> <span class="n">BAND</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">BAND</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_GETBANDINFO</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">Errorlevel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Can&#39;t get band info.&quot;</span>

<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">pQ</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">T</span>
			<span class="n">cch</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">o</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="n">cch</span><span class="p">)</span>
			<span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span> <span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wTxt</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">cch</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">o</span><span class="nv">%A_Index%</span> <span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">cch</span> <span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">		 </span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">S</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="n">Rebar_getStyle</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">L</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="w">	</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">I</span>
			<span class="n">img</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>   <span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="p">(</span><span class="n">pNames</span> <span class="o">?</span> <span class="nv">A_LoopField</span> <span class="s">&quot;=&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">img</span> <span class="o">=</span> <span class="mi">4294967295</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">img</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">C</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="n">Rebar_getColor</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="n">Rebar_getColor</span><span class="p">(</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">		;private, not exposed</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">N</span><span class="c-Singleline">		;id</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">52</span><span class="p">)</span>

<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">B</span><span class="c-Singleline">		;handle to bmp, so I can release it if band is deleted</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">o1</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetLayout</span>
<span class="cm">			Get layout of bands in rebar. Layout is single line string containing information about position of bars in the rebar control.</span>
<span class="cm">			Return value of this function is fed into &lt;SetLayout&gt; later, to restore layout.</span>
<span class="cm"> */</span>
<span class="n">Rebar_GetLayout</span><span class="p">(</span><span class="n">hRebar</span><span class="p">){</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="o">%</span> <span class="n">ReBar_Count</span><span class="p">(</span><span class="n">hRebar</span><span class="p">)</span>
		<span class="n">Rebar_GetBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="nv">A_Index</span><span class="p">,</span> <span class="s">&quot;NLS&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span>  <span class="n">res</span> <span class="o">.=</span> <span class="n">n</span> <span class="s">&quot; &quot;</span> <span class="n">l</span> <span class="s">&quot; &quot;</span> <span class="p">(</span><span class="nf">InStr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;break&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="s">&quot;|&quot;</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetRect</span>
<span class="cm"> 			Get band rectangle.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			pQ			- Query parameter: set x,y,w,h to return appropriate value, or leave blank to return all in single line.</span>
<span class="cm"> 			o1 .. o4	- Output variables.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			String with 4 values separated by space or requested information.</span>
<span class="cm"> */</span>
<span class="n">Rebar_GetRect</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">pQ</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_GETRECT</span> <span class="o">=</span> <span class="mh">0x409</span>

<span class="w">	</span><span class="nb">if </span><span class="n">pQ</span> <span class="o">=</span>
		<span class="n">retAll</span> <span class="o">:=</span> <span class="nv">true</span><span class="p">,</span> <span class="n">pQ</span> <span class="o">:=</span> <span class="s">&quot;xywh&quot;</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">WhichBand</span> <span class="o">=</span>
		 <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetClientRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hRebar</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="p">{</span>
		<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>
<span class="w">	    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_GETRECT</span> <span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">		</span><span class="nb">IfEqual</span><span class="p">,</span> <span class="nv">ErrorLevel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Can&#39;t get band rect.&quot;</span>
	<span class="p">}</span>

	<span class="n">xx</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="n">yy</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">pQ</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">x</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="n">xx</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">y</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="n">yy</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">w</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">xx</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="nv">A_LoopField</span> <span class="o">=</span> <span class="n">h</span>
			<span class="n">o</span><span class="nv">%A_Index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">yy</span>

<span class="w">	</span><span class="nb">return</span> <span class="n">retAll</span> <span class="o">?</span> <span class="n">o1</span> <span class="s">&quot; &quot;</span> <span class="n">o2</span> <span class="s">&quot; &quot;</span> <span class="n">o3</span> <span class="s">&quot; &quot;</span> <span class="n">o4</span> <span class="o">:</span> <span class="n">o1</span>

<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: Height</span>
<span class="cm"> 			Returns the height of the rebar control.</span>
<span class="cm"> */</span>
<span class="n">Rebar_Height</span><span class="p">(</span><span class="n">hRebar</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_GETBARHEIGHT</span> <span class="o">=</span> <span class="mh">0x41B</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_GETBARHEIGHT</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">Errorlevel</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:	Id2Index</span>
<span class="cm">			Returns 1 based position of the band with given id.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Id	- ID of the band.</span>
<span class="cm"> */</span>
<span class="n">Rebar_ID2Index</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">Id</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_IDTOINDEX</span><span class="o">=</span><span class="mh">0x410</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_IDTOINDEX</span><span class="p">,</span> <span class="n">Id</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">Errorlevel</span><span class="o">+</span><span class="mi">1</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Insert</span>
<span class="cm"> 			Inserts a new band in a rebar control.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			hCtrl			- Control to be hosted by the band.</span>
<span class="cm"> 			o1 .. o8		- Named parameters. See below.</span>
<span class="cm"> </span>
<span class="cm"> Named parameters:</span>
<span class="cm"> 			S				- Band styles separated by white space. By default &quot;gripperalways&quot;. See bellow.</span>
<span class="cm"> 			L				- Length of the band. By default, width of the child control is used + 10px</span>
<span class="cm"> 			mW				- Minimum width of the child control.</span>
<span class="cm"> 			mH				- Minimum height of the child control. By default the height of the child control.</span>
<span class="cm"> 			I				- Header icon index.</span>
<span class="cm"> 			T				- Header text.</span>
<span class="cm"> 			C				- Background and foreground color separated by space.</span>
<span class="cm"> 			BG				- Background bitmap.</span>
<span class="cm"> 			P				- 1-based position of the band. Set to 0 add the band to the end (default).</span>
<span class="cm"> </span>
<span class="cm"> Band styles:</span>
<span class="cm"> 			break			- The band is on a new line.</span>
<span class="cm"> 			childedge		- The band has an edge at the top and bottom of the child window.</span>
<span class="cm"> 			fixedbmp		- The background bitmap does not move when the band is resized.</span>
<span class="cm"> 			fixedsize		- The band can&#39;t be sized. With this style, the sizing grip is not displayed on the band.</span>
<span class="cm"> 			gripperalways	- The band will always have a sizing grip, even if it is the only band in the rebar.</span>
<span class="cm"> 			hidden			- The band will not be visible. Don&#39;t use this flag in Insert function. Instead, insert the band without this flag, then use &lt;SetBand&gt; to hide it. To restore it afterwards, use SetBand with &quot;S show&quot; parameter.</span>
<span class="cm"> 			nogripper		- The band will never have a sizing grip, even if there is more than one band in the rebar.</span>
<span class="cm"> 			usechevron		- Show a chevron button if the band is smaller than ideal.</span>
<span class="cm"> 			novert			- Don&#39;t show when vertical.</span>
<span class="cm"> 			hidetitle		- Keep band title hidden.</span>
<span class="cm"> 			*				- Default styles for the band. For instance &quot;* break&quot; will set band style to default plus &quot;break&quot; style.</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			ID of the newly created band or 0 if it fails.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			For some reason, using the Gui, Font to change font size before adding ComboBox child to the band will make it buggy in a sense</span>
<span class="cm">			that ComboBox list will not be able to show (although you can still select items using arrows). </span>


<span class="cm">	</span>
<span class="cm"> */</span>
<span class="n">Rebar_Insert</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_INSERTBANDA</span><span class="o">=</span><span class="mh">0x401</span>

	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">hCtrl</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid child handle: &quot;</span> <span class="n">hCtrl</span>

	<span class="n">pos</span> <span class="o">:=</span> <span class="n">Rebar_compileBand</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">o3</span><span class="p">,</span> <span class="n">o4</span><span class="p">,</span> <span class="n">o5</span><span class="p">,</span> <span class="n">o6</span><span class="p">,</span> <span class="n">o7</span><span class="p">,</span> <span class="n">o8</span><span class="p">,</span> <span class="n">o9</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Integer</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">pos</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_INSERTBANDA</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hReBar%</span> 
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">ErrorLevel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">return</span> 	<span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">52</span><span class="p">)</span><span class="c-Singleline">   ;return ID</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm">  Function: Lock</span>
<span class="cm"> 			Locks or unlcoks the rebar (sets or removes &quot;nogripper&quot; style for all bands in rebar)</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			Lock - Leave empty to lock, set to &quot;-&quot; to unlock, set to &quot;~&quot; to toggle.</span>
<span class="cm"> */</span>
<span class="n">Rebar_Lock</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">Lock</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Lock</span> <span class="o">!=</span>
<span class="w">		</span><span class="nb">if </span><span class="n">Lock</span> <span class="ow">not</span> <span class="ow">in</span> <span class="o">-</span><span class="p">,</span><span class="o">~</span>
<span class="w">			</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid parameter: &quot;</span> <span class="n">Lock</span>

	<span class="n">c</span> <span class="o">:=</span> <span class="n">Rebar_Count</span><span class="p">(</span><span class="n">hRebar</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Lock</span> <span class="o">=</span> <span class="o">~</span>
		<span class="n">Lock</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span><span class="n">Rebar_GetBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s">&quot;S&quot;</span><span class="p">),</span> <span class="s">&quot;nogripper&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;-&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="nv">%c%</span>
		<span class="n">Rebar_SetBandStyle</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="nv">A_Index</span><span class="p">,</span> <span class="n">Lock</span> <span class="s">&quot;nogripper&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	MoveBand</span>
<span class="cm"> 			Moves a band from one index to another.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			From - 1-based index of the band to be moved.</span>
<span class="cm"> 			To	 - 1-based index of the new band position. By default 1 (i.e. move to top).</span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			TRUE if successful, or FALSE otherwise.</span>
<span class="cm"> */</span>
<span class="n">Rebar_MoveBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">From</span><span class="p">,</span> <span class="n">To</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_MOVEBAND</span> <span class="o">=</span> <span class="mh">0x427</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_MOVEBAND</span><span class="p">,</span> <span class="n">From</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">To</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
	<span class="n">res</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span>
	<span class="n">Rebar_ShowBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="c-Singleline">		;?! without this it doesn&#39;t work ... it doesn&#39;t have to be 1, but just one show command. 1 is safe as you will alawyas have 1st band visible.</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">res</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:	SetBand</span>
<span class="cm">			Sets characteristics of an existing band in a rebar control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			WhichBand	- Band position or ID that is about to be changed.</span>
<span class="cm">			o1 .. o9	- Named parameters. Any named parameter that can be specified in &lt;Add&gt; function can be used here.</span>

<span class="cm"> Returns:</span>
<span class="cm">			TRUE if successful, FALSE otherwise.</span>

<span class="cm"> */</span>
<span class="n">Rebar_SetBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_SETBANDINFOA</span> <span class="o">=</span> <span class="mh">0x406</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>

	<span class="n">p</span> <span class="o">:=</span> <span class="n">Rebar_compileBand</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">o3</span><span class="p">,</span> <span class="n">o4</span><span class="p">,</span> <span class="n">o5</span><span class="p">,</span> <span class="n">o6</span><span class="p">,</span> <span class="n">o7</span><span class="p">,</span> <span class="n">o8</span><span class="p">,</span> <span class="n">o9</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SETBANDINFOA</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">Rebar_MoveBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: SetBandState</span>
<span class="cm"> 			Minimize or maximize the band.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			State		- Set &quot;-&quot; to minimize, &quot;+&quot; to maximize to full width, &quot;*&quot; to maximize to ideal width (this is the width of the control when it is added to the band).</span>
<span class="cm"> */</span>
<span class="n">Rebar_SetBandState</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">State</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_MAXIMIZEBAND</span><span class="o">=</span><span class="mh">0x41F</span><span class="p">,</span> <span class="n">RB_MINIMIZEBAND</span><span class="o">=</span><span class="mh">0x41E</span>
	
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">State</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_MINIMIZEBAND</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="n">State</span> <span class="ow">in</span> <span class="o">+</span><span class="p">,</span><span class="o">*</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_MAXIMIZEBAND</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">State</span> <span class="o">=</span> <span class="s">&quot;*&quot;</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: SetBandWidth</span>
<span class="cm"> 			Sets the width for a band.</span>
<span class="cm"> </span>
<span class="cm">  Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID.</span>
<span class="cm"> 			Width		- Width.</span>
<span class="cm"> </span>
<span class="cm">  Returns:</span>
<span class="cm"> 			TRUE if the value was set and FALSE otherwise.</span>
<span class="cm"> */</span>	 
<span class="n">Rebar_SetBandWidth</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">Width</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_SETBANDINFOA</span> <span class="o">=</span> <span class="mh">0x406</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>
	
	<span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">BAND</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">80</span>	   <span class="p">,</span><span class="n">BAND</span><span class="p">)</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mh">0x40</span>  <span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c-Singleline">	;mask</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">Width</span> <span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span><span class="c-Singleline">    ;cx </span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SETBANDINFOA</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetBandStyle</span>
<span class="cm">			Sets the style for a band.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			WhichBand	- Band position or ID.</span>
<span class="cm">			Style		- List of styles to add/remove for the band. Use - prefix to remove the style.</span>

<span class="cm"> Returns:</span>
<span class="cm">			TRUE if successful, or FALSE otherwise.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			If you want to to replace band styles completely use &lt;SetBand&gt; function with S parameter.</span>
<span class="cm">			This function toggles desired styles.</span>
<span class="cm"> */</span>

<span class="n">Rebar_SetBandStyle</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">Style</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_SETBANDINFOA</span> <span class="o">=</span> <span class="mh">0x406</span><span class="p">,</span> <span class="n">RB_GETBANDINFO</span><span class="o">=</span><span class="mh">0x405</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hrebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">BAND</span><span class="p">,</span> <span class="mi">80</span> <span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="mi">80</span> <span class="p">,</span><span class="n">BAND</span><span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="o">?</span><span class="p">,</span> <span class="p">,</span><span class="n">A</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_GETBANDINFO</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>

	<span class="n">hStyle</span> <span class="o">:=</span> <span class="n">Rebar_getStyle</span><span class="p">(</span> <span class="n">Style</span><span class="p">,</span> <span class="nv">true</span><span class="p">,</span> <span class="n">hNegStyle</span><span class="p">)</span> <span class="o">|</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>   <span class="n">hStyle</span> <span class="o">&amp;=</span> <span class="n">hNegStyle</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">hStyle</span><span class="p">,</span> <span class="p">,</span><span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Some of the styles are invalid: &quot;</span> <span class="n">Style</span>

	<span class="nf">NumPut</span><span class="p">(</span><span class="n">hStyle</span> <span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="c-Singleline">		;style</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SETBANDINFOA</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BAND</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  SetLayout</span>
<span class="cm">			Set layout of bands in rebar.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Layout	- String with information about position of bands in rebar control.</span>
<span class="cm">					  Use &lt;GetLayout&gt; function to get this string. Layout syntax is:</span>
<span class="cm">			</span>
<span class="cm">			&gt; id1 len1 break1|id2 len2 break2|....|idN lenN breakN</span>

<span class="cm"> */</span>
<span class="n">Rebar_SetLayout</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">Layout</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="o">|</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="nv">%A_Space%</span>
		<span class="n">pos</span> <span class="o">:=</span> <span class="n">Rebar_ID2Index</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">L1</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">Rebar_SetBandStyle</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">L3</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="s">&quot;break&quot;</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">Rebar_SetBandWidth</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">Rebar_MoveBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">pos</span> <span class="p">,</span> <span class="nv">A_Index</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">	Function: SizeToRect</span>

<span class="cm">	Parameters:</span>
<span class="cm">			RECT	- Reference to rectangle structure. If omited, parents rectangle will be used (GetClientRect).</span>

<span class="cm">	Remarks:</span>
<span class="cm">			The rebar bands will be arranged and wrapped as necessary to fit the rectangle. </span>
<span class="cm">			Bands that have the VARIABLEHEIGHT style will be resized as evenly as possible to fit the rectangle. </span>
<span class="cm">			The height of a horizontal rebar or the width of a vertical rebar may change, depending on the new layout.</span>

<span class="cm"> */</span>
<span class="n">Rebar_SizeToRect</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">RECT</span><span class="o">=</span><span class="s">&quot;~`a &quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_SIZETORECT</span> <span class="o">=</span> <span class="mh">0x417</span>
	
	<span class="n">hParent</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetParent&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hRebar</span><span class="p">)</span>
	
	<span class="n">if</span> <span class="p">(</span><span class="n">RECT</span> <span class="o">!=</span> <span class="s">&quot;~`a &quot;</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>  <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetClientRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hParent</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SIZETORECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> Function:  ShowBand</span>
<span class="cm"> 			Shows or hides the band.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			WhichBand	- Band position or ID. Leave blank to get dimensions of the rebar control itself.</span>
<span class="cm"> 			bShow		- True to show the band (default), FALSE to hide it. </span>
<span class="cm"> </span>
<span class="cm"> Returns:</span>
<span class="cm"> 			TRUE if successful, or FALSE otherwise.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			This function can also be used to resize the band to mach the parents size. </span>
<span class="cm">			Put call to this function inside GuiSize routine. Update to first band will reposition all bands to match the Gui size.</span>
<span class="cm">return</span>

<span class="cm"> */</span>
<span class="n">Rebar_ShowBand</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">bShow</span><span class="o">=</span><span class="nv">true</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RB_SHOWBAND</span><span class="o">=</span><span class="mh">0x423</span>
	<span class="n">WhichBand</span> <span class="o">:=</span> <span class="n">WhichBand</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="o">?</span> <span class="n">Rebar_Id2Index</span><span class="p">(</span><span class="n">hRebar</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">WhichBand</span><span class="o">-</span><span class="mi">1</span>

<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">RB_SHOWBAND</span><span class="p">,</span> <span class="n">WhichBand</span><span class="p">,</span> <span class="n">bShow</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hRebar%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">Errorlevel</span>
<span class="p">}</span><span class="c-Singleline"></span>


<span class="c-Singleline">;================================== PRIVATE ===========================================</span>

<span class="c-Singleline">; hCtrl - if 0 band is changing, if handle band is adding</span>
<span class="n">Rebar_compileBand</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">BAND</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RBBIM_ID</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">RBBIM_COLORS</span><span class="o">=</span><span class="mh">0x2</span><span class="p">,</span> <span class="n">RBBIM_IMAGE</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">RBBIM_CHILD</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span> <span class="n">RBBIM_STYLE</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span> <span class="n">RBBIM_TEXT</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span> <span class="n">RBBIM_CHILDSIZE</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="n">RBBIM_SIZE</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span> <span class="n">RBBIM_IDEALSIZE</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span> <span class="n">RBBIM_BACKGROUND</span><span class="o">=</span><span class="mh">0X80</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">id</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">NP_T</span><span class="c-Singleline">		;Text is made static so buffer can outlive call to this function.</span>

<span class="w">	</span><span class="nb">if </span><span class="n">hCtrl</span>
<span class="w">		</span><span class="nb">ControlGetPos</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span><span class="n">wIdeal</span><span class="p">,</span> <span class="n">NP_mH</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>

	<span class="n">NP_T</span> <span class="o">=</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="mi">10</span> <span class="p">{</span> 
		<span class="n">if</span> <span class="p">(</span><span class="n">o</span><span class="nv">%A_index%</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="nb">break</span>
		<span class="n">j</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span> <span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="nv">A_Space</span> <span class="p">),</span>  <span class="n">prop</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span> <span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">NP_</span><span class="nv">%prop%</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span> <span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> 
	<span class="p">}</span>

<span class="w">	</span><span class="nb">if </span><span class="n">NP_C</span> <span class="o">!=</span>
		<span class="n">NP_C</span> <span class="o">.=</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">j</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span><span class="n">NP_C</span><span class="p">,</span> <span class="nv">A_Space</span><span class="p">),</span> <span class="n">bg</span> <span class="o">:=</span> <span class="n">Rebar_getColor</span><span class="p">(</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">NP_C</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">fg</span> <span class="o">:=</span> <span class="n">Rebar_getColor</span><span class="p">(</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">NP_C</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ;handle styles	</span>
<span class="w">	</span><span class="nb">if </span><span class="n">NP_S</span> <span class="o">!=</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">hStyle</span> <span class="o">:=</span> <span class="n">Rebar_getStyle</span><span class="p">(</span> <span class="n">NP_S</span><span class="p">,</span> <span class="nv">true</span> <span class="p">))</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="w">			</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Some of the styles are invalid.&quot;</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ;set mask</span>
	<span class="n">hMask</span> <span class="o">:=</span> <span class="p">(</span><span class="n">NP_T</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">RBBIM_TEXT</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
			<span class="o">|</span><span class="p">(</span><span class="n">hStyle</span> <span class="o">?</span> <span class="n">RBBIM_STYLE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> 
			<span class="o">|</span><span class="p">(</span><span class="n">NP_BG</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">RBBIM_BACKGROUND</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> 
			<span class="o">|</span><span class="p">(</span><span class="n">NP_I</span> <span class="o">?</span> <span class="n">RBBIM_IMAGE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>  
			<span class="o">|</span><span class="p">(</span><span class="n">NP_C</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">RBBIM_COLORS</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> 
			<span class="o">|</span><span class="p">(</span><span class="n">hCtrl</span> <span class="o">?</span> <span class="n">RBBIM_SIZE</span> <span class="o">|</span> <span class="n">RBBIM_CHILD</span> <span class="o">|</span> <span class="n">RBBIM_IDEALSIZE</span> <span class="o">|</span> <span class="n">RBBIM_ID</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span><span class="c-Singleline"> ;RBBIM_SIZE only on update</span>
			<span class="o">|</span><span class="p">(</span><span class="n">NP_mW</span> <span class="ow">or</span> <span class="n">NP_mH</span> <span class="o">?</span> <span class="n">RBBIM_CHILDSIZE</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span><span class="c-Singleline"> </span>

<span class="c-Singleline">  ;set calculated </span>
	<span class="n">hBmp</span> <span class="o">:=</span> <span class="p">(</span><span class="n">NP_BG</span>  <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;LoadImage&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">NP_BG</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span>
	<span class="n">NP_L</span> <span class="o">:=</span> <span class="p">(</span><span class="n">NP_L</span><span class="o">+</span><span class="mi">0</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">NP_L</span> <span class="o">:</span> <span class="n">wIdeal</span> <span class="o">+</span> <span class="mi">10</span><span class="c-Singleline">		;if no len is specified use controls width + something for header</span>
	<span class="n">id</span>	 <span class="o">+=</span> <span class="n">hCtrl</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span>
 
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">80</span>		<span class="p">,</span><span class="n">BAND</span><span class="p">)</span><span class="c-Singleline">			;cbSize</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">hMask</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c-Singleline">		;mask</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">hStyle</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="c-Singleline">		;style</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">fg</span>		<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="c-Singleline">      ;clrFore</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">bg</span>		<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span><span class="c-Singleline">      ;clrBack</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">NP_T</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="c-Singleline">      ;lpText </span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">NP_I</span><span class="o">-</span><span class="mi">1</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span><span class="c-Singleline">		;iImage</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">hCtrl</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="c-Singleline">      ;hwndChild </span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">NP_mW</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span><span class="c-Singleline">		;cyMinChild </span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">NP_mH</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span><span class="c-Singleline">		;cyMinChild </span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">NP_L</span> 	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span><span class="c-Singleline">      ;cx </span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">hBmp</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span><span class="c-Singleline">		;hbmBack</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">id</span>		<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">52</span><span class="p">)</span><span class="c-Singleline">		;wID</span>
	 <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="n">wIdeal</span>	<span class="p">,</span><span class="n">BAND</span><span class="p">,</span> <span class="mi">68</span><span class="p">)</span><span class="c-Singleline">		;cxIdeal		;Ideal width of the band, in pixels. If the band is maximized to the ideal width (see RB_MAXIMIZEBAND), the rebar control will attempt to make the band this width.</span>
<span class="c-Singleline">	 ;NumPut(lparam	,BAND, 72)		;lParam			;Application-defined value.</span>

<span class="w">	 </span><span class="nb">return</span> <span class="p">(</span><span class="n">NP_P</span><span class="o">+</span><span class="mi">0</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">NP_P</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="c-Singleline">			;return position on which to add band</span>
<span class="p">}</span><span class="c-Singleline"></span>


<span class="c-Singleline">;=========================================================== PRIVATE =======================================================</span>
<span class="c-Singleline">;Required function by Forms framework.</span>
<span class="n">Rebar_add2Form</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">Opt</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">f</span> <span class="o">:=</span> <span class="s">&quot;Form_Parse&quot;</span>
	
	<span class="nv">%f%</span><span class="p">(</span><span class="n">Opt</span><span class="p">,</span> <span class="s">&quot;x# y# w# h# style IL* g*&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="n">il</span><span class="p">,</span><span class="n">handler</span><span class="p">)</span>
	<span class="n">pos</span> <span class="o">:=</span> <span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot; x&quot;</span> <span class="n">x</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot; y&quot;</span> <span class="n">y</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">w</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot; w&quot;</span> <span class="n">w</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot; h&quot;</span> <span class="n">h</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Rebar_Add</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function has 3 purposes :</span>
<span class="cm"> 	o List evaluation: hex value out of list of style names</span>
<span class="cm"> 	o Hex evaluation: list of style names out of hex value</span>
<span class="cm"> 	o Negative list evaluation: hex value out of negative styles</span>
<span class="cm"> </span>
<span class="cm">  The problem is that style list can also contain numbers or be number (for instance: &quot;novert 0x40 break&quot; or just &quot;0x40&quot;). This is the purpose of pHex parameter that forces list evaluation or hex evaluation.</span>
<span class="cm">  Negative list evaulation is returned only if input variable is fed into the function. </span>
<span class="cm"> </span>
<span class="cm">  The function is generic in sense that only statics need to be changed for any module to use it with its own styles.</span>
<span class="cm"> 	o List of styles with prefix STYLE goes in first static row</span>
<span class="cm"> 	o Ordered list of styles to be used for hex evaluation</span>
<span class="cm">    o DEFAULT style is hex combination of default styles for control. * in list of style names is replaced with default styles.</span>
<span class="cm"> </span>
<span class="cm">  pStyle    - Hex value of the style or named style</span>
<span class="cm">  pHex	    - Force pStyle as hex input.</span>
<span class="cm">  pNegStyle - Hex value of the negative styles</span>
<span class="cm"> */</span>
<span class="n">Rebar_getStyle</span><span class="p">(</span> <span class="n">pStyle</span><span class="p">,</span> <span class="n">pHex</span> <span class="o">=</span> <span class="nv">false</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">hNegStyle</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">STYLE_HIDDEN</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">STYLE_BREAK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">STYLE_FIXEDSIZE</span><span class="o">=</span><span class="mh">0x2</span><span class="p">,</span> <span class="n">STYLE_FIXEDBMP</span><span class="o">=</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">STYLE_NOVERT</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">STYLE_VARIABLEHEIGHT</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">STYLE_CHILDEDGE</span><span class="o">=</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">STYLE_USECHEVRON</span><span class="o">=</span><span class="mh">0x200</span><span class="p">,</span> <span class="n">STYLE_GRIPPERALWAYS</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span> <span class="n">STYLE_HIDETITLE</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">,</span> <span class="n">STYLE_NOGRIPPER</span> <span class="o">=</span> <span class="mh">0x100</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">styles</span> <span class="o">=</span> <span class="s">&quot;hidden,break,fixedbmp,novert,usechevron,fixedsize,gripperalways,hiddetittle,nogripper&quot;</span><span class="p">,</span> <span class="n">STYLE_DEFAULT</span> <span class="o">=</span> <span class="mh">0x80</span><span class="c-Singleline">	;GRIPPERALWAYS</span>

<span class="c-Singleline">  ;get hex value of named style</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">pStyle</span><span class="o">+</span><span class="mi">0</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pHex</span> 
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">pStyle</span><span class="p">,</span> <span class="n">pStyle</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">DEFAULT</span><span class="p">,</span> <span class="n">A</span>

		<span class="n">hStyle</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hNegStyle</span> <span class="o">:=</span> <span class="mh">0xFFFFFFFF</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">pStyle</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
		<span class="p">{</span>
<span class="w">			</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">			</span><span class="nb">if </span><span class="nf">SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
				<span class="n">s</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">s</span> <span class="o">:=</span> <span class="n">STYLE_</span><span class="nv">%s%</span><span class="p">,</span> <span class="n">hNegStyle</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">s</span>
<span class="w">			</span><span class="nb">else</span> <span class="n">hStyle</span> <span class="o">|=</span> <span class="nv">A_LoopField</span><span class="o">+</span><span class="mi">0</span> <span class="o">?</span> <span class="nv">A_LoopField</span> <span class="o">:</span> <span class="n">STYLE_</span><span class="nv">%A_LoopField%</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">hStyle</span>
	<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ;return name of the style from hex</span>
<span class="w">	</span><span class="nb">else</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="se">`,</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">pStyle</span> <span class="o">&amp;</span> <span class="n">STYLE_</span><span class="nv">%A_LoopField%</span><span class="p">)</span>
				<span class="n">style</span> <span class="o">.=</span> <span class="nv">A_LoopField</span> <span class="s">&quot; &quot;</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Converts AHK color (RGB without &quot;0x&quot;) to Win color or vice-versa</span>

<span class="cm"> pColor	- Color to convert. Can be AHK color or Win color</span>
<span class="cm"> pAHK	- if true, input is AHK color, if false, input is Win color</span>
<span class="cm"> */</span>
<span class="n">Rebar_getColor</span><span class="p">(</span><span class="n">pColor</span><span class="p">,</span> <span class="n">pAHK</span> <span class="o">=</span> <span class="nv">false</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>

<span class="c-Singleline"> ;convert to win</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">pAHK</span> <span class="p">{</span>
		<span class="n">pColor</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="n">pColor</span>
<span class="w">		</span><span class="nb">return</span> <span class="p">((</span><span class="n">pColor</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">pColor</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">pColor</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> 
	<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline"> ;convert to rgb </span>
	<span class="n">oldFormat</span> <span class="o">:=</span> <span class="nv">A_FormatInteger</span> 
<span class="w">    </span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">hex</span><span class="c-Singleline">  ; Show RGB color extracted below in hex format.  </span>

	<span class="n">pColor</span> <span class="o">:=</span> <span class="p">(</span><span class="n">pColor</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">pColor</span> <span class="o">&amp;</span> <span class="mh">0xff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">pColor</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> 
<span class="w">    </span><span class="nb">StringTrimLeft</span><span class="p">,</span> <span class="n">pColor</span><span class="p">,</span> <span class="n">pColor</span><span class="p">,</span> <span class="mi">2</span> 
<span class="w">    </span><span class="nb">loop</span><span class="p">,</span> <span class="o">%</span> <span class="mi">6</span><span class="o">-</span><span class="nf">strlen</span><span class="p">(</span><span class="n">pColor</span><span class="p">)</span> 
      <span class="n">pColor</span> <span class="o">=</span> <span class="mi">0</span><span class="nv">%pColor%</span> 

<span class="w">	</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="nv">%oldFormat%</span> 
<span class="w">	</span><span class="nb">StringUpper</span><span class="p">,</span> <span class="n">pColor</span><span class="p">,</span> <span class="n">pColor</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pColor</span>
<span class="p">}</span>


<span class="n">Rebar_onNotify</span><span class="p">(</span><span class="n">Wparam</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MODULEID</span> <span class="o">:=</span> <span class="mi">30608</span><span class="p">,</span> <span class="n">oldNotify</span><span class="o">=</span><span class="s">&quot;*&quot;</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">RBN_LAYOUTCHANGED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">833</span><span class="p">,</span> <span class="n">RBN_HEIGHTCHANGE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">831</span><span class="p">,</span> <span class="n">RBN_CHEVRONPUSHED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">841</span><span class="p">,</span> <span class="n">RBN_CHILDSIZE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">839</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">_</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">4</span><span class="p">)))</span> <span class="o">!=</span> <span class="n">MODULEID</span>
<span class="w">	 </span><span class="nb">ifLess</span> <span class="n">_</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">return</span><span class="c-Singleline">	;if ahk control, return asap (AHK increments control ID starting from 1. Custom controls use IDs &gt; 10000. Its unlikely that u will use more then 10K ahk controls.</span>
<span class="w">	 </span><span class="nb">else</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">%</span> <span class="n">Rebar</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">)</span>		
<span class="w">		</span><span class="nb">if </span><span class="n">oldNotify</span> <span class="o">!=</span>
<span class="w">			</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="n">oldNotify</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Wparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span>
	 <span class="p">}</span>

	<span class="n">hw</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">0</span><span class="p">),</span>  <span class="n">code</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span>  <span class="n">handler</span> <span class="o">:=</span> <span class="n">Rebar</span><span class="p">(</span><span class="n">hw</span> <span class="s">&quot;Handler&quot;</span><span class="p">)</span>	
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="p">,</span><span class="n">return</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">RBN_CHEVRONPUSHED</span><span class="p">)</span>
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">RBN_HEIGHTCHANGE</span><span class="p">)</span>
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;H&quot;</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">RBN_LAYOUTCHANGED</span><span class="p">)</span>
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;L&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">;	if (code = RBN_CHILDSIZE)	;spammer msg</span>
<span class="c-Singleline">;		%handler%(hw, &quot;S&quot;)</span>

<span class="p">}</span>

<span class="n">Rebar_malloc</span><span class="p">(</span><span class="n">pSize</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MEM_COMMIT</span><span class="o">=</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">PAGE_READWRITE</span><span class="o">=</span><span class="mh">0x04</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;VirtualAlloc&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pSize</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">MEM_COMMIT</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">PAGE_READWRITE</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Rebar_mfree</span><span class="p">(</span><span class="n">pAdr</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MEM_RELEASE</span> <span class="o">=</span> <span class="mh">0x8000</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;VirtualFree&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pAdr</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">MEM_RELEASE</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;Mini storage function</span>
<span class="n">Rebar</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">&quot;~`a&quot;</span><span class="p">)</span> <span class="p">{</span> 
<span class="w">	</span><span class="nb">static</span>
	<span class="n">_</span> <span class="o">:=</span> <span class="nv">%var%</span>
<span class="w">	</span><span class="nb">ifNotEqual</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">~</span><span class="se">`a</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="nv">%var%</span><span class="p">,</span> <span class="nv">%value%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">_</span>
<span class="p">}</span>

<span class="cm">/* Group: Examples</span>
<span class="cm">	(start code)</span>
<span class="cm">		Gui, +LastFound +Resize </span>
<span class="cm">		hGui := WinExist() </span>
<span class="cm">		Gui, Show, w400 h140 hide			;set window size, mandatory</span>

<span class="cm">	  ;create edit</span>
<span class="cm">		Gui, Add, Edit, HWNDhEdit w100 h100</span>

<span class="cm">	  ;create combo</span>
<span class="cm">		Gui, Add, ComboBox, HWNDhCombo w80, item 1 |item 2|item 3</span>

<span class="cm">	  ;create rebar	</span>
<span class="cm">		hRebar := Rebar_Add(hGui)</span>
<span class="cm">		ReBar_Insert(hRebar, hEdit, &quot;mw 100&quot;, &quot;L 400&quot;, &quot;T Log &quot;)	;Insert edit band, set lenght of the band to 400</span>
<span class="cm">																	; minimum width of edit to 100, set text to &quot;Log &quot;</span>
<span class="cm">		ReBar_Insert(hRebar, hCombo, &quot;L 300&quot;, &quot;P 1&quot;)				;Insert combo band at the top, set length of the band to 300</span>

<span class="cm">		Gui, Show</span>
<span class="cm">	return </span>
<span class="cm">	(end code)</span>
<span class="cm"> */</span>

<span class="cm">/* Group: About</span>
<span class="cm">	o Ver 2.02 by majkinetor. </span>
<span class="cm">	o MSDN Reference: &lt;http://msdn.microsoft.com/en-us/library/bb774375(VS.85).aspx&gt;.</span>
<span class="cm">	o Licenced under GNU GPL &lt;http://creativecommons.org/licenses/GPL/2.0/&gt;.</span>
<span class="cm">*/</span>
</pre></div>
