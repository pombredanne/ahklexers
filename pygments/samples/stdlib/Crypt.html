<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="n">Crypt_Hash</span><span class="p">(</span><span class="n">pData</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="n">SID</span> <span class="o">=</span> <span class="s">&quot;CRC32&quot;</span><span class="p">,</span> <span class="n">nInitial</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CALG_SHA</span> <span class="o">:=</span> <span class="n">CALG_SHA1</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">CALG_MD5</span> <span class="o">:=</span> <span class="mh">0x8003</span>
<span class="w">	</span><span class="nb">If </span><span class="n">Not</span>	<span class="n">CALG_</span><span class="nv">%SID%</span>
	<span class="p">{</span>
		<span class="n">FormatI</span> <span class="o">:=</span> <span class="nv">A_FormatInteger</span>
<span class="w">		</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">H</span>
		<span class="n">sHash</span> <span class="o">:=</span> <span class="nf">DllCall(</span><span class="s">&quot;ntdll\RtlComputeCrc32&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nInitial</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pData</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="nv">%FormatI%</span>
<span class="w">		</span><span class="nb">StringUpper</span><span class="p">,</span>	<span class="n">sHash</span><span class="p">,</span> <span class="n">sHash</span>
<span class="w">		</span><span class="nb">StringReplace</span><span class="p">,</span>	<span class="n">sHash</span><span class="p">,</span> <span class="n">sHash</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="mo">000000</span>
<span class="w">		</span><span class="nb">Return</span>	<span class="nf">SubStr(</span><span class="n">sHash</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptAcquireContextA&quot;</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mh">0xF0000000</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptCreateHash&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">CALG_</span><span class="nv">%SID%</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptHashData&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pData</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptGetHashParam&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">VarSetCapacity(</span><span class="n">HashVal</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptGetHashParam&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">HashVal</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptDestroyHash&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptReleaseContext&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

	<span class="n">FormatI</span> <span class="o">:=</span> <span class="nv">A_FormatInteger</span>
<span class="w">	</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">H</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span>	<span class="nv">%nSize%</span>
		<span class="n">sHash</span> <span class="o">.=</span> <span class="nf">SubStr(</span><span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HashVal</span> <span class="o">+</span> <span class="nv">A_Index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="nv">%FormatI%</span>
<span class="w">	</span><span class="nb">StringReplace</span><span class="p">,</span>	<span class="n">sHash</span><span class="p">,</span> <span class="n">sHash</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">All</span>
<span class="w">	</span><span class="nb">StringUpper</span><span class="p">,</span>	<span class="n">sHash</span><span class="p">,</span> <span class="n">sHash</span>
<span class="w">	</span><span class="nb">Return</span>	<span class="n">sHash</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Require Windows XP or Higher!</span>
<span class="n">Crypt_AES</span><span class="p">(</span><span class="n">pData</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="n">sPassword</span><span class="p">,</span> <span class="n">SID</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="n">bEncrypt</span> <span class="o">=</span> <span class="nv">True</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CALG_AES_256</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">CALG_AES_192</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">CALG_AES_128</span> <span class="o">:=</span> <span class="mh">0x660E</span>
	<span class="n">CALG_SHA</span> <span class="o">:=</span> <span class="n">CALG_SHA1</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">CALG_MD5</span> <span class="o">:=</span> <span class="mh">0x8003</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptAcquireContextA&quot;</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mh">0xF0000000</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptCreateHash&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">CALG_SHA1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptHashData&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sPassword</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="nf">StrLen(</span><span class="n">sPassword</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptDeriveKey&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">CALG_AES_</span><span class="nv">%SID%</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">SID</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hKey</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptDestroyHash&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hHash</span><span class="p">)</span>
	<span class="n">If</span>	<span class="n">bEncrypt</span>
		<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptEncrypt&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hKey</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="nv">True</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pData</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="o">+</span><span class="mi">16</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Else</span>	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptDecrypt&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hKey</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="nv">True</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pData</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptDestroyKey&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hKey</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;advapi32\CryptReleaseContext&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hProv</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Return</span>	<span class="n">nSize</span>
<span class="p">}</span>
</pre></div>
