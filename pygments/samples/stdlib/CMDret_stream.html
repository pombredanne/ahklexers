<LINK href="styles.css" rel="stylesheet" type="text/css">

New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; ******************************************************************</span>
<span class="c-Singleline">; CMDret-AHK functions by corrupt</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; CMDret_Stream</span>
<span class="c-Singleline">; version 0.03 beta</span>
<span class="c-Singleline">; Updated: Feb 19, 2007</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; CMDret code modifications and/or contributions have been made by:</span>
<span class="c-Singleline">; Laszlo, shimanov, toralf, Wdb</span>
<span class="c-Singleline">; ******************************************************************</span>
<span class="c-Singleline">; Usage:</span>
<span class="c-Singleline">; CMDin - command to execute</span>
<span class="c-Singleline">; CMDname - type of output to process (Optional)</span>
<span class="c-Singleline">; WorkingDir - full path to working directory (Optional)</span>
<span class="c-Singleline">; ******************************************************************</span>
<span class="c-Singleline">; Known Issues:</span>
<span class="c-Singleline">; - If using dir be sure to specify a path (example: cmd /c dir c:\)</span>
<span class="c-Singleline">; or specify a working directory</span>
<span class="c-Singleline">; - Running 16 bit console applications may not produce output. Use</span>
<span class="c-Singleline">; a 32 bit application to start the 16 bit process to receive output</span>
<span class="c-Singleline">; ******************************************************************</span>
<span class="c-Singleline">; Additional requirements:</span>
<span class="c-Singleline">; - Your script must also contain a CMDret_Output function</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; CMDret_Output(CMDout, CMDname=&quot;&quot;)</span>
<span class="c-Singleline">; Usage:</span>
<span class="c-Singleline">; CMDout - each line of output returned (1 line each time)</span>
<span class="c-Singleline">; CMDname - type of output to process (Optional)</span>
<span class="c-Singleline">; ******************************************************************</span>
<span class="c-Singleline">; Code Start</span>
<span class="c-Singleline">; ******************************************************************</span><span class="w"></span>

<span class="n">CMDret_Stream</span><span class="p">(</span><span class="n">CMDin</span><span class="p">,</span> <span class="n">CMDname</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">WorkingDir</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf">  Global</span> <span class="n">cmdretPID</span>
<span class="w">  </span><span class="n">tcWrk</span><span class="p"> </span><span class="o">:=</span> <span class="n">WorkingDir</span><span class="o">=</span><span class="mi">0</span> <span class="o">?</span> <span class="s">&quot;Int&quot;</span> <span class="o">:</span> <span class="s">&quot;Str&quot;</span>
<span class="w">  </span><span class="n">idltm</span><span class="p"> </span><span class="o">:=</span> <span class="nv">A_TickCount</span> <span class="o">+</span> <span class="mi">20</span>
<span class="w">  </span><span class="n">LivePos</span><span class="p"> =</span> <span class="mi">1</span><span class="nf"></span>
<span class="nf">  VarSetCapacity</span><span class="p">(</span><span class="n">CMDout</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="nf"></span>
<span class="nf">  VarSetCapacity</span><span class="p">(</span><span class="n">sui</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">  VarSetCapacity</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">  VarSetCapacity</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> 4 {</span><span class="w"></span>
<span class="w">    </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pa</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">12</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">    DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pa</span><span class="o">+</span><span class="mi">8</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
  <span class="p">}</span>
<span class="w">  </span><span class="n">IF</span><span class="p"> (</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreatePipe&quot;</span><span class="p">,</span> <span class="s">&quot;UInt*&quot;</span><span class="p">,</span><span class="n">hRead</span><span class="p">,</span> <span class="s">&quot;UInt*&quot;</span><span class="p">,</span><span class="n">hWrite</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pa</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> 4</span><span class="w"></span>
<span class="w">      </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">68</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">    DllCall</span><span class="p">(</span><span class="s">&quot;GetStartupInfo&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sui</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> 4 {</span><span class="w"></span>
<span class="w">      </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="o">+</span><span class="mi">44</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">257</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="o">+</span><span class="mi">60</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="n">hWrite</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="o">+</span><span class="mi">64</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="n">hWrite</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="o">+</span><span class="mi">48</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">0</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">}</span>
<span class="w">    </span><span class="n">IF</span><span class="p"> (</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateProcess&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">CMDin</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">tcWrk</span><span class="p">,</span> <span class="n">WorkingDir</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">sui</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">      </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> 4</span><span class="w"></span>
<span class="w">        </span> <span class="n">cmdretPID</span> <span class="o">+=</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pi</span><span class="o">+</span><span class="mi">8</span><span class="o">+</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">8</span>
<span class="w">      </span><span class="nb">Loop</span><span class="w"> </span><span class="s">{</span><span class="w"></span>
<span class="w">        </span> <span class="n">idltm2</span> <span class="o">:=</span> <span class="nv">A_TickCount</span> <span class="o">-</span> <span class="n">idltm</span>
<span class="w">        </span><span class="n">If</span><span class="p"> (</span><span class="n">idltm2</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="p">{</span><span class="nf"></span>
<span class="nf">          DllCall</span><span class="p">(</span><span class="s">&quot;Sleep&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="w">          </span><span class="nb">Continue</span><span class="w"></span>
<span class="w">        </span> <span class="p">}</span>
<span class="w">        </span><span class="n">IF</span><span class="p"> (</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PeekNamedPipe&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hRead</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">bSize</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">          </span><span class="nb">Process</span><span class="p">,</span><span class="s"> Exist</span><span class="p">,</span><span class="s"> %cmdretPID%</span><span class="w"></span>
<span class="w">          </span> <span class="n">IF</span> <span class="p">(</span><span class="nv">ErrorLevel</span> <span class="n">OR</span> <span class="n">bSize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">            </span><span class="n">IF</span><span class="p"> (</span><span class="n">bSize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nf"></span>
<span class="nf">              VarSetCapacity</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">,</span> <span class="n">bSize</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">              </span><span class="n">IF</span><span class="p"> (</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReadFile&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">hRead</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span> <span class="n">lpBuffer</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">bSize</span><span class="p">,</span> <span class="s">&quot;UInt*&quot;</span><span class="p">,</span><span class="n">bRead</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">                </span><span class="n">IF</span><span class="p"> (</span><span class="n">bRead</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">                  </span><span class="n">IF</span><span class="p"> (</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">bRead</span><span class="p">)</span> <span class="p">{</span><span class="nf"></span>
<span class="nf">                    VarSetCapacity</span><span class="p">(</span><span class="n">CMcpy</span><span class="p">,</span> <span class="n">bRead</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="w">                    </span><span class="n">bRead2</span><span class="p"> =</span> <span class="nv">%bRead%</span>
<span class="w">                    </span><span class="nb">Loop</span><span class="w"> </span><span class="s">{</span><span class="w"></span>
<span class="w">                      </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;RtlZeroMemory&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CMcpy</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">bRead</span><span class="p">)</span>
<span class="w">                      </span><span class="n">NULLptr</span><span class="p"> </span><span class="o">:=</span><span class="nf"> StrLen</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">)</span>
<span class="w">                      </span><span class="n">cpsize</span><span class="p"> </span><span class="o">:=</span> <span class="n">bread</span> <span class="o">-</span> <span class="n">NULLptr</span><span class="nf"></span>
<span class="nf">                      DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CMcpy</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">lpBuffer</span> <span class="o">+</span> <span class="n">NULLptr</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">cpsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="nf"></span>
<span class="nf">                      DllCall</span><span class="p">(</span><span class="s">&quot;RtlZeroMemory&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">lpBuffer</span> <span class="o">+</span> <span class="n">NULLptr</span><span class="p">),</span> <span class="n">Int</span><span class="p">,</span> <span class="n">cpsize</span><span class="p">)</span><span class="nf"></span>
<span class="nf">                      DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">lpBuffer</span> <span class="o">+</span> <span class="n">NULLptr</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CMcpy</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">cpsize</span><span class="p">)</span>
<span class="w">                      </span><span class="n">bRead2</span><span class="p"> </span><span class="o">--</span>
<span class="w">                      </span><span class="n">IF</span><span class="p"> (</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">bRead2</span><span class="p">)</span>
<span class="w">                        </span><span class="nb">break</span><span class="w"></span>
<span class="w">                    </span> <span class="p">}</span>
                  <span class="p">}</span><span class="nf"></span>
<span class="nf">              VarSetCapacity</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                  </span><span class="n">CMDout</span><span class="p"> </span><span class="o">.=</span> <span class="n">lpBuffer</span>
<span class="w">                  </span><span class="n">bRead</span><span class="p"> =</span> <span class="mi">0</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
<span class="w">          </span><span class="nb">ELSE</span><span class="w"></span>
<span class="w">            </span> <span class="n">break</span>
        <span class="p">}</span>
<span class="w">        </span><span class="nb">ELSE</span><span class="w"></span>
<span class="w">          </span> <span class="n">break</span>
<span class="w">        </span><span class="n">idltm</span><span class="p"> </span><span class="o">:=</span> <span class="nv">A_TickCount</span>
<span class="w">        </span><span class="n">LiveFound</span><span class="p"> </span><span class="o">:=</span><span class="nf"> RegExMatch</span><span class="p">(</span><span class="n">CMDout</span><span class="p">,</span> <span class="s">&quot;m)^(.*)&quot;</span><span class="p">,</span> <span class="n">LiveOut</span><span class="p">,</span> <span class="n">LivePos</span><span class="p">)</span>
<span class="w">        </span><span class="n">If</span><span class="p"> (</span><span class="n">LiveFound</span><span class="p">)</span>
<span class="w">          </span><span class="nb">SetTimer</span><span class="p">,</span><span class="s"> cmdretSTR</span><span class="p">,</span><span class="s"> 5</span><span class="w"></span>
<span class="w">      </span> <span class="p">}</span>
      <span class="n">cmdretPID</span><span class="o">=</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span><span class="s">&quot;CloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">hWrite</span><span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span><span class="s">&quot;CloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">hRead</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="w">  </span><span class="nb">StringTrimLeft</span><span class="p">,</span><span class="s"> LiveRes</span><span class="p">,</span><span class="s"> CMDout</span><span class="p">,</span><span class="s"> %LivePos%</span><span class="w"></span>
<span class="w">  </span><span class="nf"> If </span><span class="n">LiveRes</span> <span class="o">&lt;&gt;</span>
<span class="w">    </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> Parse</span><span class="p">,</span><span class="s"> LiveRes</span><span class="p">,</span><span class="s"> `n</span><span class="w"></span>
<span class="w">    </span> <span class="p">{</span>
<span class="w">      </span><span class="n">FileLine</span><span class="p"> =</span> <span class="nv">%A_LoopField%</span>
<span class="w">      </span><span class="nb">StringTrimRight</span><span class="p">,</span><span class="s"> FileLine</span><span class="p">,</span><span class="s"> FileLine</span><span class="p">,</span><span class="s"> 1</span><span class="w"></span>
<span class="w">      </span> <span class="n">CMDret_Output</span><span class="p">(</span><span class="n">FileLine</span><span class="p">,</span> <span class="n">CMDname</span><span class="p">)</span>
    <span class="p">}</span>
<span class="w">  </span><span class="nb">StringTrimLeft</span><span class="p">,</span><span class="s"> CMDout</span><span class="p">,</span><span class="s"> CMDout</span><span class="p">,</span><span class="s"> 1</span><span class="w"></span>
<span class="w">  </span> <span class="n">cmdretPID</span> <span class="o">=</span> <span class="mi">0</span><span class="nf"></span>
<span class="nf">  Return</span><span class="p">,</span> <span class="n">CMDout</span>
<span class="nl">cmdretSTR:</span>
<span class="nb">SetTimer</span><span class="p">,</span><span class="s"> cmdretSTR</span><span class="p">,</span><span class="s"> Off</span><span class="w"></span>

<span class="n">If</span><span class="p"> (</span><span class="n">LivePosLast</span> <span class="o">&lt;&gt;</span> <span class="n">LiveFound</span><span class="p">)</span> <span class="p">{</span>
<span class="w">  </span><span class="n">FileLine</span><span class="p"> =</span> <span class="nv">%LiveOut1%</span>
<span class="w">  </span><span class="n">LivePos</span><span class="p"> </span><span class="o">:=</span> <span class="n">LiveFound</span> <span class="o">+</span><span class="nf"> StrLen</span><span class="p">(</span><span class="n">FileLine</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="w">  </span><span class="n">LivePosLast</span><span class="p"> </span><span class="o">:=</span> <span class="n">LivePos</span>
  <span class="n">CMDret_Output</span><span class="p">(</span><span class="n">FileLine</span><span class="p">,</span> <span class="n">CMDname</span><span class="p">)</span>
<span class="p">}</span><span class="nf"></span>
<span class="nf">Return</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
