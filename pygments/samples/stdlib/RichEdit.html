<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="cm">/* Title:		RichEdit</span>

<span class="cm">				This module allows you to create and programmatically set text properties in rich edit control.</span>
<span class="cm">				Besides that, it contains functions that work with standard edit controls. Each function contains</span>
<span class="cm">				description for which kind of control it can be used - any control supporting edit control interface</span>
<span class="cm">				(Edit, RichEdit, HiEdit...) or just rich edit control.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> Function:		Add</span>
<span class="cm">				Create rich edit version 4.1 control. (requires at least Windows XP SP1)</span>

<span class="cm"> Parameters:</span>
<span class="cm">				HParent	- Handle of the parent of the control.</span>
<span class="cm">				X..H	- Position.</span>
<span class="cm">				Style	- White space separated list of control styles. Any integer style or one of the style keywords (see below).</span>
<span class="cm">						  Invalid styles are skipped. &quot;*MULTILINE WANTRETURN VSCROLL*&quot; by default.</span>
<span class="cm">				Text	- Control text.</span>
<span class="cm"> Styles:</span>
<span class="cm">     DISABLENOSCROLL - Disables scroll bars instead of hiding them when they are not needed.</span>
<span class="cm">     BORDER			- Displays the control with a sunken border style so that the rich edit control appears recessed into its parent window.</span>
<span class="cm">     HIDDEN			- Don&#39;t show the control.</span>
<span class="cm">     VSCROLL		- Enble vertical scroll bar.</span>
<span class="cm">     HSCROLL		- Enable horizontal scroll bar. If this style is present control starts with wrap mode deactivated. Otherwise, wrap mode is active.</span>
<span class="cm">     SCROLL			- Enable both scroll bars.</span>
<span class="cm">     AUTOHSCROLL	- Automatically scrolls text to the right by 10 characters when the user types a character at the end of the line. When the user presses the ENTER key, the control scrolls all text back to position zero.</span>
<span class="cm">     AUTOVSCROLL	- Automatically scrolls text up one page when the user presses the ENTER key on the last line.</span>
<span class="cm">     CENTER			- Centers text in a single-line or multiline edit control.</span>
<span class="cm">     LEFT			- Left aligns text.</span>
<span class="cm">     MULTILINE		- Designates a multiline edit control. The default is single-line edit control.</span>
<span class="cm">     NOHIDESEL		- Negates the default behavior for an edit control. The default behavior hides the selection when the control loses the input focus and inverts the selection when the control receives the input focus. If you specify *NOHIDESEL*, the selected text is inverted, even if the control does not have the focus.</span>
<span class="cm">     NUMBER			- Allows only digits to be entered into the edit control.</span>
<span class="cm">     PASSWORD		- Displays an asterisk (*) for each character typed into the edit control. This style is valid only for single-line edit controls.</span>
<span class="cm">     READONLY		- Prevents the user from typing or editing text in the edit control.</span>
<span class="cm">     RIGHT			- Right aligns text in a single-line or multiline edit control.</span>
<span class="cm">     SELECTIONBAR	- When set, there is small left margin (wider than default) where cursor changes to right-up arrow allowing full line(s) selection. This style also requires use of *MULTILINE* style.</span>
<span class="cm">     WANTRETURN		- Specifies that a carriage return be inserted when the user presses the ENTER key while entering text into a multiline edit control in a dialog box. If you do not specify this style, pressing the ENTER key has the same effect as pressing the dialog box&#39;s default push button. This style has no effect on a single-line edit control.</span>

<span class="cm"> Returns:</span>
<span class="cm">	Control&#39;s handle or 0. Error message on problem.</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  Gui, +LastFound</span>
<span class="cm">  hwnd := WinExist()</span>
<span class="cm">  hRichEdit := RichEdit_Add(hwnd, 5, 5, 200, 300)</span>
<span class="cm">  Gui, Show, w210 h310</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Add</span><span class="p">(</span><span class="n">HParent</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Style</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">WS_CLIPCHILDREN</span><span class="o">=</span><span class="mh">0x2000000</span><span class="p">,</span> <span class="n">WS_VISIBLE</span><span class="o">=</span><span class="mh">0x10000000</span><span class="p">,</span> <span class="n">WS_CHILD</span><span class="o">=</span><span class="mh">0x40000000</span>
		<span class="p">,</span><span class="n">ES_DISABLENOSCROLL</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">EX_BORDER</span><span class="o">=</span><span class="mh">0x200</span>
		<span class="p">,</span><span class="n">ES_LEFT</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ES_CENTER</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ES_RIGHT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ES_MULTILINE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ES_AUTOVSCROLL</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">ES_AUTOHSCROLL</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">ES_NOHIDESEL</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">ES_NUMBER</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">ES_PASSWORD</span><span class="o">=</span><span class="mh">0x20</span><span class="p">,</span><span class="n">ES_READONLY</span><span class="o">=</span><span class="mh">0x800</span><span class="p">,</span><span class="n">ES_WANTRETURN</span><span class="o">=</span><span class="mh">0x1000</span><span class="c-Singleline">  ;, ES_SELECTIONBAR = 0x1000000</span>
		<span class="p">,</span><span class="n">ES_HSCROLL</span><span class="o">=</span><span class="mh">0x100000</span><span class="p">,</span> <span class="n">ES_VSCROLL</span><span class="o">=</span><span class="mh">0x200000</span><span class="p">,</span> <span class="n">ES_SCROLL</span><span class="o">=</span><span class="mh">0x300000</span>
		<span class="p">,</span><span class="n">MODULEID</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">MODULEID</span>
		<span class="n">init</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span> <span class="s">&quot;Msftedit.dll&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">),</span> <span class="n">MODULEID</span> <span class="o">:=</span> <span class="mo">091009</span>


<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Style</span><span class="p">,,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">MULTILINE</span> <span class="n">WANTRETURN</span> <span class="n">VSCROLL</span>
	<span class="n">hStyle</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span><span class="s">&quot; &quot;</span> <span class="n">Style</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot; hidden &quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">WS_VISIBLE</span><span class="p">,</span>  <span class="n">hExStyle</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">IfEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="p">,</span><span class="n">continue</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="nv">A_LoopField</span> <span class="ow">is</span> <span class="n">integer</span>
			 <span class="n">hStyle</span> <span class="o">|=</span> <span class="nv">A_LoopField</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">ES_</span><span class="nv">%A_LOOPFIELD%</span><span class="p">)</span>
			 <span class="n">hStyle</span> <span class="o">|=</span> <span class="n">v</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="n">EX_</span><span class="nv">%A_LOOPFIELD%</span><span class="p">)</span>
			 <span class="n">hExStyle</span> <span class="o">|=</span> <span class="n">v</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;SELECTIONBAR&quot;</span><span class="p">)</span>
       <span class="n">selectionbar</span> <span class="o">:=</span> <span class="nv">true</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">continue</span>
	<span class="p">}</span>
<span class="w">	</span><span class="cm">/*</span>
<span class="cm">		class   := A_OSVersion = &quot;WIN_95&quot; ? &quot;RICHEDIT&quot; : &quot;RichEdit20A&quot;</span>
<span class="cm">		hModule := DllCall(&quot;LoadLibrary&quot;, &quot;str&quot;,  (class=&quot;RichEdit20A&quot; ? &quot;riched20.dll&quot; : &quot;riched32.dll&quot;)  )</span>

<span class="cm">		http://www.soulfree.net/tag/391</span>
<span class="cm">		RE version - DLL (hModule)- class</span>
<span class="cm">		1.0	       - Riched32.dll - RichEdit</span>
<span class="cm">		2.0	       - Riched20.dll - RichEdit20A or RichEdit20W (ANSI or Unicode window classes)</span>
<span class="cm">		3.0	       - Riched20.dll - ?</span>
<span class="cm">		4.1	       - Msftedit.dll - RICHEDIT50W</span>

<span class="cm">		2.0 not compatible w/ EM_CONVPOSITION, EM_GETIMECOLOR, EM_GETIMEOPTIONS, EM_GETPUNCTUATION,</span>
<span class="cm">		  EM_GETWORDWRAPMODE, EM_SETIMECOLOR, EM_SETIMEOPTIONS, EM_SETPUNCTUATION, EM_SETWORDWRAPMODE</span>

<span class="cm">		Windows XP SP1	Includes Rich Edit 4.1, Rich Edit 3.0, and a Rich Edit 1.0 emulator.</span>
<span class="cm">		Windows XP	Includes Rich Edit 3.0 with a Rich Edit 1.0 emulator.</span>
<span class="cm">		Windows Me	Includes Rich Edit 1.0 and 3.0.</span>
<span class="cm">		Windows 2000	Includes Rich Edit 3.0 with a Rich Edit 1.0 emulator.</span>
<span class="cm">		Windows NT 4.0	Includes Rich Edit 1.0 and 2.0.</span>
<span class="cm">		Windows 98	Includes Rich Edit 1.0 and 2.0.</span>
<span class="cm">		Windows 95	Includes only Rich Edit 1.0. However, Riched20.dll is compatible with Windows 95 and may be installed by an application that requires it.</span>
<span class="cm">     */</span>

	<span class="n">hCtrl</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hExStyle</span><span class="c-Singleline">			; ExStyle</span>
                  <span class="p">,</span> <span class="s">&quot;str&quot;</span> <span class="p">,</span> <span class="s">&quot;RICHEDIT50W&quot;</span><span class="c-Singleline">		; ClassName</span>
                  <span class="p">,</span> <span class="s">&quot;str&quot;</span> <span class="p">,</span> <span class="n">Text</span><span class="c-Singleline">				; WindowName</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">WS_CHILD</span> <span class="o">|</span> <span class="n">hStyle</span><span class="c-Singleline">	; Edit Style</span>
                  <span class="p">,</span> <span class="s">&quot;int&quot;</span> <span class="p">,</span> <span class="n">X</span><span class="c-Singleline">					; Left</span>
                  <span class="p">,</span> <span class="s">&quot;int&quot;</span> <span class="p">,</span> <span class="n">Y</span><span class="c-Singleline">					; Top</span>
                  <span class="p">,</span> <span class="s">&quot;int&quot;</span> <span class="p">,</span> <span class="n">W</span><span class="c-Singleline">					; Width</span>
                  <span class="p">,</span> <span class="s">&quot;int&quot;</span> <span class="p">,</span> <span class="n">H</span><span class="c-Singleline">					; Height</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">HParent</span><span class="c-Singleline">				; hWndParent</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">MODULEID</span><span class="c-Singleline">			; hMenu</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="c-Singleline">					; hInstance</span>
                  <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span><span class="c-Singleline">			; must return uint.</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hCtrl</span><span class="p">,</span>  <span class="n">selectionbar</span> <span class="o">?</span> <span class="n">RichEdit_SetOptions</span><span class="p">(</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;OR&quot;</span><span class="p">,</span> <span class="s">&quot;SELECTIONBAR&quot;</span> <span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function:  AutoUrlDetect</span>
<span class="cm"> 			 Enable, disable, or toggle automatic detection of URLs in the RichEdit control.</span>

<span class="cm">  Parameters:</span>
<span class="cm"> 			Flag - Specify true to enable automatic URL detection or false to disable it. Specify</span>
<span class="cm">             *&quot;^&quot;* to toggle its current state. Omit to only return current state without any change.</span>

<span class="cm">  Returns:</span>
<span class="cm"> 			If auto-URL detection is active, the return value is 1.</span>
<span class="cm"> 			If auto-URL detection is inactive, the return value is 0.</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  MsgBox, % RichEdit_AutoUrlDetect( hRichEdit, true )</span>
<span class="cm">  MsgBox, % RichEdit_AutoUrlDetect( hRichEdit, &quot;^&quot; )</span>
<span class="cm">  MsgBox, % &quot;Current state: &quot; RichEdit_AutoUrlDetect( hRichEdit )</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_AutoUrlDetect</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Flag</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>  <span class="p">{</span><span class="c-Singleline">	;wParam Specify TRUE to enable automatic URL detection or FALSE to disable it.</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_AUTOURLDETECT</span><span class="o">=</span><span class="mh">0x45B</span><span class="p">,</span> <span class="n">EM_GETAUTOURLDETECT</span><span class="o">=</span><span class="mh">0x45C</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">Flag</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">Flag</span> <span class="o">=</span><span class="s">&quot;^&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETAUTOURLDETECT</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Flag</span><span class="p">,,</span> <span class="n">return</span> <span class="nv">ERRORLEVEL</span>
		<span class="n">Flag</span> <span class="o">:=</span> <span class="o">!</span><span class="nv">ERRORLEVEL</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_AUTOURLDETECT</span><span class="p">,</span> <span class="n">Flag</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Flag</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: CanPaste</span>
<span class="cm">           Determines whether an Edit control can paste a specified clipboard format.</span>

<span class="cm"> Parameters:</span>
<span class="cm">           ClipboardFormat - Specifies the Clipboard Formats to try. To try any format currently on the clipboard, set this parameter to zero.</span>
<span class="cm">							 The default is 0x1 (CF_TEXT).</span>

<span class="cm"> Returns:</span>
<span class="cm">           True if the clipboard format can be pasted otherwise false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">           For additional information on clipboard formats, see the following:</span>
<span class="cm">           &lt;http://msdn.microsoft.com/en-us/library/ms649013(VS.85).aspx&gt;</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;Paste&gt;, &lt;PasteSpecial&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  If RichEdit_CanPaste( hRichEdit, 0 )</span>
<span class="cm">    RichEdit_Paste( hRichEdit )</span>
<span class="cm">  Else</span>
<span class="cm">    MsgBox, Cannot paste your clipboard into control..</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_CanPaste</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">ClipboardFormat</span><span class="o">=</span><span class="mh">0x1</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">EM_CANPASTE</span> <span class="o">:=</span> <span class="mi">1074</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_CANPASTE</span><span class="p">,</span><span class="n">ClipboardFormat</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">    </span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: CharFromPos</span>
<span class="cm">           Gets information about the character closest to a specified point in the client area of the Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">           X, Y - The coordinates of a point in the Edit control&#39;s client area relative to the upper-left corner of the client area.</span>

<span class="cm"> Returns:</span>
<span class="cm">           The character index of the specified point or the character index to</span>
<span class="cm">           the last character if the given point is beyond the last character in the control.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_CharFromPos</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">EM_CHARFROMPOS</span><span class="o">:=</span><span class="mh">0xD7</span>

<span class="w">	</span><span class="nb">WinGetClass</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">if </span><span class="n">cls</span> <span class="ow">in</span> <span class="n">RICHEDIT50W</span>
		 <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">POINTL</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">lParam</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">POINTL</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">POINTL</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">POINTL</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">lParam</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Y</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">|</span><span class="n">X</span>

<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_CHARFROMPOS</span><span class="p">,,</span><span class="n">lParam</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">    </span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Clear</span>
<span class="cm">    Send to an Edit control or combo box to delete (clear) the current selection.</span>

<span class="cm"> Remarks:</span>
<span class="cm">    To delete the current selection and place the deleted content on the clipboard, use the Cut operation.</span>
<span class="cm">			</span>
<span class="cm"> Related:</span>
<span class="cm">    &lt;Cut&gt;, &lt;Copy&gt;, &lt;Paste&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Clear</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">static</span> <span class="n">WM_CLEAR</span><span class="o">=</span><span class="mh">0x303</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">WM_CLEAR</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:		Convert</span>
<span class="cm">				Convert twips to pixels or vice-versa.</span>

<span class="cm"> Parameters:</span>
<span class="cm">				Input		- Twips (Input&gt;0) or pixels (Input&lt;0).</span>
<span class="cm">				Direction	- 0 (default) or 1. Pixels are not always square (the height and width are not the same).</span>
<span class="cm">							  Therefore, it is necessary to pass in the desired &quot;direction&quot; to use, horizontal (0) or vertical (1).</span>
<span class="cm"> Returns:</span>
<span class="cm">				Rounded value.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Convert</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Direction</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">twipsPerInch</span> <span class="o">=</span> <span class="mi">1440</span><span class="p">,</span> <span class="n">LOGPIXELSX</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span> <span class="n">LOGPIXELSY</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">tpi0</span><span class="p">,</span> <span class="n">tpi1</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">tpi0</span>
		<span class="n">dc</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">tpi0</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32.dll\GetDeviceCaps&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">LOGPIXELSX</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">tpi1</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32.dll\GetDeviceCaps&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">LOGPIXELSY</span><span class="p">)</span>
		<span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">)</span>

<span class="w">   </span><span class="nb">return</span> <span class="p">(</span><span class="n">Input</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="n">Input</span> <span class="o">*</span> <span class="n">tpi</span><span class="nv">%Direction%</span><span class="p">)</span> <span class="o">//</span> <span class="n">twipsPerInch</span>  <span class="o">:</span> <span class="p">(</span><span class="o">-</span><span class="n">Input</span><span class="o">*</span><span class="n">twipsPerInch</span><span class="p">)</span> <span class="o">//</span> <span class="n">tpi</span><span class="nv">%Direction%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: Copy</span>
<span class="cm">    Copy selection of the Edit control.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;Cut&gt;, &lt;Clear&gt;, &lt;Paste&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Copy</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">WM_COPY</span><span class="o">:=</span><span class="mh">0x301</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">WM_COPY</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: Cut</span>
<span class="cm">    Cut selection from the Edit control.</span>

<span class="cm"> Related:</span>
<span class="cm">    &lt;Copy&gt;, &lt;Clear&gt;, &lt;Paste&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Cut</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">WM_CUT</span><span class="o">:=</span><span class="mh">0x300</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">WM_CUT</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	FindText</span>
<span class="cm">			Find desired text in the Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Text	- Text to be searched for.</span>
<span class="cm">			CpMin	- Start searching at this character position. By default 0.</span>
<span class="cm">			CpMax	- End searching at this character position. When searching forward, a value of Â–1 extends the search range to the end of the text.</span>
<span class="cm">			Flags	- Space separated combination of search flags. See below.</span>

<span class="cm"> Flags:</span>
<span class="cm">			WHOLEWORD	- If set, the operation searches only for whole words that match the search string. If not set, the operation also searches for word fragments that match the search string.</span>
<span class="cm">			MATCHCASE	- If set, the search operation is case-sensitive. If not set, the search operation is case-insensitive.</span>
<span class="cm">			DOWN		- Rich Edit only: If set, the search is from the end of the current selection to the end of the document.</span>
<span class="cm">						  If not set, the search is from the end of the current selection to the beginning of the document.</span>
<span class="cm">			UNICODE		- Transforms Text into the Unicode charset before searching for it.</span>
<span class="cm"> Returns:</span>
<span class="cm">			The zero-based character position of the next match, or -1 if there are no more matches.</span>

<span class="cm"> Remarks</span>
<span class="cm">			The *CpMin* member always specifies the starting-point of the search, and *CpMax* specifies the end point.</span>
<span class="cm">			When searching backward, *CpMin* must be equal to or greater than *CpMax*.</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  ^f::</span>
<span class="cm">    RichEdit_HideSelection( hRichEdit, false )</span>
<span class="cm">    Dlg_Find( hwnd, &quot;OnFind&quot;, &quot;d&quot; )</span>
<span class="cm">  return</span>

<span class="cm">  OnFind(Event, Flags, FindText, ReplaceText)  {</span>
<span class="cm">    global hRichEdit</span>

<span class="cm">    IfNotEqual, Event, F,  return</span>
<span class="cm">    RichEdit_GetSel(hRichEdit, min, max)</span>
<span class="cm">    word := InStr(Flags,&quot;w&quot;) ? &quot; WHOLEWORD&quot; : &quot;&quot;</span>
<span class="cm">    case := InStr(Flags,&quot;c&quot;) ? &quot; MATCHCASE&quot; : &quot;&quot;</span>
<span class="cm">    InStr( Flags, &quot;d&quot; ) ? (pos:=max+1 , direction:=&quot; DOWN&quot;)</span>
<span class="cm">                        : (pos:=max-1)</span>

<span class="cm">    ; search control for word</span>
<span class="cm">    pos:=RichEdit_FindText(hRichEdit,FindText,pos,-1,&quot;unicode&quot; direction word case)</span>

<span class="cm">    ; highlight found match</span>
<span class="cm">  	if pos != -1</span>
<span class="cm">  		RichEdit_SetSel(hRichEdit, pos, pos+StrLen(FindText))</span>

<span class="cm">  	Else</span>
<span class="cm">      MsgBox, no matches found..</span>
<span class="cm">  }</span>
<span class="cm">  return</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_FindText</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">CpMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CpMax</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Flags</span><span class="o">=</span><span class="s">&quot;UNICODE&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_FINDTEXT</span><span class="o">=</span><span class="mi">1080</span><span class="p">,</span> <span class="n">FR_DOWN</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FR_WHOLEWORD</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">FR_MATCHCASE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">FR_UNICODE</span><span class="o">=</span><span class="mi">0</span>
	<span class="n">hFlags</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Flags</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span><span class="p">,</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">hFlags</span> <span class="o">|=</span> <span class="n">FR_</span><span class="nv">%A_LOOPFIELD%</span>

<span class="w">	</span><span class="nb">If </span><span class="nf">InStr</span><span class="p">(</span><span class="n">Flags</span><span class="p">,</span> <span class="s">&quot;Unicode&quot;</span><span class="p">)</span> <span class="p">{</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">uText</span><span class="p">,</span> <span class="p">(</span><span class="n">len</span><span class="o">:=</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Text</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">Text</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span> <span class="n">uText</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">len</span> <span class="p">)</span>
		<span class="n">txtAdr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">uText</span>
	<span class="p">}</span> <span class="n">else</span> <span class="n">txtAdr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">Text</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">FT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">CpMin</span><span class="p">,</span>   <span class="n">FT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">CpMax</span><span class="p">,</span>   <span class="n">FT</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">txtAdr</span><span class="p">,</span>  <span class="n">FT</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_FINDTEXT</span><span class="p">,</span> <span class="n">hFlags</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">FT</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">Return</span> <span class="nv">ErrorLevel</span><span class="o">=</span><span class="mi">4294967295</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	FindWordBreak</span>
<span class="cm">			Finds the next word break in rich edit conttrol, before or after the specified character position or retrieves information about the character at that position.</span>

<span class="cm"> Parameters:</span>
<span class="cm">		    CharIndex	- Zero-based character starting position.</span>
<span class="cm">			Flag		- One of the flags list below.</span>

<span class="cm"> Flag:</span>
<span class="cm">			CLASSIFY	- Returns the character class and word-break flags of the character at the specified position.</span>
<span class="cm">			ISDELIMITER - Returns true if the character at the specified position is a delimiter, or false otherwise.</span>
<span class="cm">			LEFT		- Finds the nearest character before the specified position that begins a word.</span>
<span class="cm">			LEFTBREAK	- Finds the next word end before the specified position. This value is the same as PREVBREAK.</span>
<span class="cm">			MOVEWORDLEFT  - Finds the next character that begins a word before the specified position. This value is used during CTRL+LEFT ARROW key processing.</span>
<span class="cm">			MOVEWORDRIGHT - Finds the next character that begins a word after the specified position. This value is used during CTRL+right key processing.</span>
<span class="cm">			RIGHT		- Finds the next character that begins a word after the specified position.</span>
<span class="cm">			RIGHTBREAK	- Finds the next end-of-word delimiter after the specified position. This value is the same as NEXTBREAK.</span>

<span class="cm"> Returns:</span>
<span class="cm">		  The message returns a value based on the wParam parameter.</span>
<span class="cm">			o CLASSIFY		- Returns the character class and word-break flags of the character at the specified position.</span>
<span class="cm">			o ISDELIMITER	- Returns true if the character at the specified position is a delimiter, otherwise it returns false.</span>
<span class="cm">			o Other			- Returns the character index of the word break.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_FindWordBreak</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">CharIndex</span><span class="p">,</span> <span class="n">Flag</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>  <span class="n">EM_FINDWORDBREAK</span><span class="o">=</span><span class="mi">1100</span>
			<span class="p">,</span> <span class="n">WB_CLASSIFY</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">WB_ISDELIMITER</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">WB_LEFT</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">WB_LEFTBREAK</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">WB_MOVEWORDLEFT</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">WB_MOVEWORDNEXT</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">WB_MOVEWORDPREV</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">WB_MOVEWORDRIGHT</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">WB_NEXTBREAK</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">WB_PREVBREAK</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">WB_RIGHT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">WB_RIGHTBREAK</span><span class="o">=</span><span class="mi">7</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_FINDWORDBREAK</span><span class="p">,</span> <span class="n">WB_</span><span class="nv">%Flag%</span><span class="p">,</span> <span class="n">CharIndex</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: FixKeys</span>
<span class="cm">	  	   Fix Tab and Esc key handling in rich edit control.</span>

<span class="cm"> Returns:</span>
<span class="cm">		  True or false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">	Whenever you press Escape in a multiline edit control it sends a WM_CLOSE message to its parent. Both the regular edit control and the rich edit control have this problem.</span>
<span class="cm">	This is by Microsoft design. There is also similar undesired behavior for {Tab} key which is used by the system to navigate over controls with &quot;tabstop&quot; flag. RichEdit is designed</span>
<span class="cm">	to use ^{Tab} instead. This function subclasses the control to prevent such behavior.</span>

<span class="cm">	However, before using this function be sure to know what subclassing is and what kind of effects</span>
<span class="cm">	it may introduce to your particular script. There is also other method to solve this problem via</span>
<span class="cm">	hotkey handling while rich edit control has focus.</span>

<span class="cm"> Reference:</span>
<span class="cm">	o WM_GETDLGCODE @ MSDN: &lt;http://msdn.microsoft.com/en-us/library/ms645425(VS.85).aspx&gt;</span>
<span class="cm">	o William Willing blog: &lt;http://www.williamwilling.com/blog/?p=28&gt;.</span>
<span class="cm">	o WinAsm Forum: &lt;http://www.winasm.net/forum/index.php?showtopic=487&gt;.</span>
<span class="cm">	o CodeGuru: &lt;http://www.codeguru.com/cpp/controls/editctrl/keyboard/article.php/c513/&gt;.</span>
<span class="cm">	o Strange Microsoft solution for VB (that doesn&#39;t work): &lt;http://support.microsoft.com/kb/q143273/&gt;.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_FixKeys</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">oldProc</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetWindowLong&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">oldProc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="mi">0</span>
	<span class="n">wndProc</span> <span class="o">:=</span> <span class="nf">RegisterCallback</span><span class="p">(</span><span class="s">&quot;RichEdit_wndProc&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">oldProc</span><span class="p">)</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">,</span> <span class="p">,</span> <span class="n">return</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetWindowLong&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: GetLine</span>
<span class="cm">			Get the text of the desired line from an Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			LineNumber	- Zero-based index of the line. -1 means current line.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The return value is the text.</span>
<span class="cm">			The return value is empty string if the line number specified by the line parameter is greater than the number of lines in the Edit control.</span>

<span class="cm"> Related:</span>
<span class="cm">     &lt;GetText&gt;, &lt;LineIndex&gt;, &lt;LineLength&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetLine</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">LineNumber</span><span class="o">=-</span><span class="mi">1</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_GETLINE</span><span class="o">=</span><span class="mi">196</span><span class="c-Singleline">	  ;The return value is the number of characters copied. The return value is zero if the line number specified by the line parameter is greater than the number of lines in the HiEdit control</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">LineNumber</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">LineNumber</span> <span class="o">:=</span> <span class="n">RichEdit_LineFromChar</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">RichEdit_LineIndex</span><span class="p">(</span><span class="n">hEdit</span><span class="p">))</span>
	<span class="n">len</span> <span class="o">:=</span> <span class="n">RichEdit_LineLength</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">LineNumber</span><span class="p">)</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">len</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">len</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span><span class="c-Singleline">		; HiEdit bug! if line contains only 1 word SendMessage returns FAIL.</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETLINE</span><span class="p">,</span> <span class="n">LineNumber</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">txt</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">if </span><span class="nv">ErrorLevel</span> <span class="o">=</span> <span class="n">FAIL</span>
<span class="w">		</span><span class="nb">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Failed to get line with code: &quot;</span> <span class="nv">A_LastError</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">?</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="n">txt</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetLineCount</span>
<span class="cm">			Gets the number of lines in a multiline Edit control.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The return value is an integer specifying the total number of text lines in the multiline edit control or rich edit control.</span>
<span class="cm">			If the control has no text, the return value is 1. The return value will never be less than 1.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			The function retrieves the total number of text lines, not just the number of lines that are currently visible.</span>
<span class="cm">			If the Wordwrap feature is enabled, the number of lines can change when the dimensions of the editing window change.</span>

<span class="cm"> Related:</span>
<span class="cm">     &lt;GetTextLength&gt;, &lt;LineLength&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetLineCount</span><span class="p">(</span><span class="n">hEdit</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_GETLINECOUNT</span><span class="o">=</span><span class="mh">0xBA</span>
<span class="w"> 	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETLINECOUNT</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">Return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetOptions</span>
<span class="cm">			Get the options for a rich edit control.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			See &lt;SetOptions&gt; for details.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetOptions</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>  <span class="n">EM_GETOPTIONS</span><span class="o">=</span><span class="mi">1102</span>
			<span class="p">,</span><span class="mi">1</span><span class="o">=</span><span class="s">&quot;AUTOWORDSELECTION&quot;</span><span class="p">,</span> <span class="mi">64</span><span class="o">=</span><span class="s">&quot;AUTOVSCROLL&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="o">=</span><span class="s">&quot;AUTOHSCROLL&quot;</span><span class="p">,</span>  <span class="mi">256</span><span class="o">=</span><span class="s">&quot;NOHIDESEL&quot;</span><span class="p">,</span> <span class="mi">2048</span><span class="o">=</span><span class="s">&quot;READONLY&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="o">=</span><span class="s">&quot;WANTRETURN&quot;</span><span class="p">,</span> <span class="mi">16777216</span><span class="o">=</span><span class="s">&quot;SELECTIONBAR&quot;</span>
			<span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="s">&quot;1,64,128,256,2048,4096,16777216&quot;</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">hCtrl</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETOPTIONS</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
		<span class="n">o</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span>
	<span class="p">}</span> <span class="n">else</span> <span class="n">o</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="se">`,</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">&amp;</span> <span class="nv">A_LoopField</span><span class="p">)</span>
			<span class="n">res</span> <span class="o">.=</span> <span class="nv">%A_LoopField%</span> <span class="s">&quot; &quot;</span>

<span class="w">	</span><span class="nb">return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetCharFormat</span>
<span class="cm">			Determines the character formatting in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Face	- Optional byref parameter will contain the name of the font.</span>
<span class="cm">			Style	- Optional byref parameter will contain a space separated list</span>
<span class="cm">					  of styles. See &lt;SetCharFormat&gt; for list of styles.</span>
<span class="cm">			TextColor		- Text forground color. If starts with &quot;-&quot; the color is AUTOCOLOR.</span>
<span class="cm">			BackColor		- Text background color. If starts with &quot;-&quot; the color is AUTOCOLOR.</span>
<span class="cm">			Mode	- If empty, this optional parameter retrieves the formatting to all text in the</span>
<span class="cm">					  control. Otherwise, pass &quot;SELECTION&quot; (default) to get formatting of the current selection. If the selection</span>
<span class="cm">					  is empty, the function will get the character of the insertion point.</span>

<span class="cm"> Remarks:</span>
<span class="cm">		Function will get the attributes of the first character.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;SetCharFormat&gt;, &lt;SetBgColor&gt;</span>
<span class="cm"> </span>
<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  RichEdit_GetCharFormat(hRichEdit, face, style, color)</span>
<span class="cm">  MsgBox, Face = %Face% `nstyle = %style%  `ncolor = %color%</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetCharFormat</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Face</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Style</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">TextColor</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">BackColor</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="o">=</span><span class="s">&quot;SELECTION&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_GETCHARFORMAT</span><span class="o">=</span><span class="mi">1082</span><span class="p">,</span> <span class="n">SCF_SELECTION</span><span class="o">=</span><span class="mi">1</span>
  		  <span class="p">,</span> <span class="n">CFM_CHARSET</span><span class="o">:=</span><span class="mh">0x8000000</span><span class="p">,</span> <span class="n">CFM_BACKCOLOR</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span> <span class="n">CFM_COLOR</span><span class="o">:=</span><span class="mh">0x40000000</span><span class="p">,</span> <span class="n">CFM_FACE</span><span class="o">:=</span><span class="mh">0x20000000</span><span class="p">,</span> <span class="n">CFM_OFFSET</span><span class="o">:=</span><span class="mh">0x10000000</span><span class="p">,</span> <span class="n">CFM_SIZE</span><span class="o">:=</span><span class="mh">0x80000000</span><span class="p">,</span> <span class="n">CFM_WEIGHT</span><span class="o">=</span><span class="mh">0x400000</span><span class="p">,</span> <span class="n">CFM_UNDERLINETYPE</span><span class="o">=</span><span class="mh">0x800000</span>
		  <span class="p">,</span> <span class="n">CFE_HIDDEN</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">CFE_BOLD</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CFE_ITALIC</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">CFE_LINK</span><span class="o">=</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">CFE_PROTECTED</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">CFE_STRIKEOUT</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">CFE_UNDERLINE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">CFE_SUPERSCRIPT</span><span class="o">=</span><span class="mh">0x30000</span><span class="p">,</span> <span class="n">CFE_SUBSCRIPT</span><span class="o">=</span><span class="mh">0x30000</span>
		  <span class="p">,</span> <span class="n">CFM_ALL2</span><span class="o">=</span><span class="mh">0xFEFFFFFF</span><span class="p">,</span> <span class="n">COLOR_WINDOW</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">COLOR_WINDOWTEXT</span><span class="o">=</span><span class="mi">8</span>
		  <span class="p">,</span> <span class="n">styles</span><span class="o">=</span><span class="s">&quot;HIDDEN BOLD ITALIC LINK PROTECTED STRIKEOUT UNDERLINE SUPERSCRIPT SUBSCRIPT&quot;</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="n">CF</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">CFM_ALL2</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETCHARFORMAT</span><span class="p">,</span> <span class="n">SCF_</span><span class="nv">%Mode%</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CF</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>

	<span class="n">Face</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MulDiv&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CF</span><span class="o">+</span><span class="mi">26</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">)</span>

	<span class="n">Style</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">dwEffects</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="nv">%A_SPACE%</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">CFE_</span><span class="nv">%A_LoopField%</span> <span class="o">&amp;</span> <span class="n">dwEffects</span><span class="p">)</span>
			<span class="n">Style</span> <span class="o">.=</span> <span class="nv">A_LoopField</span> <span class="s">&quot; &quot;</span>
    <span class="n">s</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">20</span><span class="p">,</span>  <span class="n">o</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
	<span class="n">Style</span> <span class="o">.=</span> <span class="s">&quot;s&quot;</span> <span class="n">s</span> <span class="p">(</span><span class="n">o</span> <span class="o">?</span> <span class="s">&quot; o&quot;</span> <span class="n">o</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

	<span class="n">oldFormat</span> <span class="o">:=</span> <span class="nv">A_FormatInteger</span>
<span class="w">    </span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">hex</span>
	
	<span class="n">if</span> <span class="p">(</span><span class="n">dwEffects</span> <span class="o">&amp;</span> <span class="n">CFM_BACKCOLOR</span><span class="p">)</span>
		 <span class="n">BackColor</span> <span class="o">:=</span> <span class="s">&quot;-&quot;</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetSysColor&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">COLOR_WINDOW</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">BackColor</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">BackColor</span> <span class="o">:=</span> <span class="p">(</span><span class="n">BackColor</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">BackColor</span> <span class="o">&amp;</span> <span class="mh">0xff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">BackColor</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">dwEffects</span> <span class="o">&amp;</span> <span class="n">CFM_COLOR</span><span class="p">)</span>
		 <span class="n">TextColor</span> <span class="o">:=</span> <span class="s">&quot;-&quot;</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetSysColor&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">COLOR_WINDOWTEXT</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">TextColor</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">TextColor</span> <span class="o">:=</span> <span class="p">(</span><span class="n">TextColor</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">TextColor</span> <span class="o">&amp;</span> <span class="mh">0xff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">TextColor</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>

<span class="w">    </span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="nv">%oldFormat%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: GetRedo</span>
<span class="cm"> 			Determine whether there are any actions in the rich edit control redo queue, and</span>
<span class="cm">			optionally retrieve the type of the next redo action.</span>

<span class="cm">  Parameters:</span>
<span class="cm"> 			name - This optional parameter is the name of the variable in which to store the</span>
<span class="cm">             type of redo action, if any.</span>

<span class="cm">  Name Types:</span>
<span class="cm">      UNKNOWN - The type of undo action is unknown.</span>
<span class="cm">      TYPING - Typing operation.</span>
<span class="cm">      DELETE - Delete operation.</span>
<span class="cm">      DRAGDROP - Drag-and-drop operation.</span>
<span class="cm">      CUT - Cut operation.</span>
<span class="cm">      PASTE - Paste operation.</span>

<span class="cm">  Returns:</span>
<span class="cm"> 			If there are actions in the control redo queue, the return value is a nonzero value.</span>
<span class="cm"> 			If the redo queue is empty, the return value is zero.</span>

<span class="cm">  Related:</span>
<span class="cm">		&lt;Redo&gt;, &lt;GetUndo&gt;, &lt;Undo&gt;, &lt;SetUndoLimit&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  If RichEdit_GetRedo( hRichEdit, name )</span>
<span class="cm">    MsgBox, The next redo is a %name% type</span>
<span class="cm">  Else</span>
<span class="cm">    MsgBox, Nothing left to redo.</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetRedo</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_CANREDO</span><span class="o">=</span><span class="mi">1109</span><span class="p">,</span> <span class="n">EM_GETREDONAME</span><span class="o">=</span><span class="mi">1111</span><span class="p">,</span><span class="n">UIDs</span><span class="o">=</span><span class="s">&quot;UNKNOWN,TYPING,DELETE,DRAGDROP,CUT,PASTE&quot;</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_CANREDO</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
	<span class="n">nRedo</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span>

	<span class="n">If</span> <span class="p">(</span> <span class="n">nRedo</span> <span class="o">&amp;&amp;</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&quot;-&quot;</span> <span class="p">)</span>  <span class="p">{</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETREDONAME</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">		</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">UIDs</span><span class="p">,</span> <span class="se">`,</span>
			<span class="n">If</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">=</span> <span class="nv">ErrorLevel</span><span class="p">)</span>  <span class="p">{</span>
				<span class="n">name</span> <span class="o">:=</span> <span class="nv">A_LoopField</span>
<span class="w">				</span><span class="nb">break</span>
			<span class="p">}</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">nRedo</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: GetModify</span>
<span class="cm">      Gets the state of the modification flag for the Edit control.</span>
<span class="cm">      The flag indicates whether the contents of the control has been modified.</span>

<span class="cm"> Returns:</span>
<span class="cm">      True if the content of Edit control has been modified, false otherwise.</span>
<span class="cm">      </span>
<span class="cm">  Related:</span>
<span class="cm">      &lt;SetModify&gt;, &lt;Save&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetModify</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">EM_GETMODIFY</span><span class="o">=</span><span class="mh">0xB8</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_GETMODIFY</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">    </span><span class="nb">Return</span> <span class="nv">ErrorLevel</span> <span class="o">=</span> <span class="mi">4294967295</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetParaFormat</span>
<span class="cm">			Retrieves the paragraph formatting of the current selection in a rich edit control. (*** not implemented ***)	</span>
<span class="cm"> */</span><span class="c-Singleline"></span>
<span class="c-Singleline">; Num,Align,Line,Ident,Space,Tabs</span>
<span class="n">RichEdit_GetParaFormat</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_GETPARAFORMAT</span><span class="o">=</span><span class="mi">1085</span>
		   <span class="p">,</span><span class="n">PFM_ALL2</span><span class="o">=</span><span class="mh">0xc0fffdff</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PF</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">188</span><span class="p">,</span> <span class="n">PF</span><span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">PFM_ALL2</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETPARAFORMAT</span><span class="p">,,</span> <span class="o">&amp;</span><span class="n">PF</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetRect</span>
<span class="cm"> 			Gets the formatting rectangle of the Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Left..Bottom	- Output variables, can be omitted.</span>

<span class="cm"> Returns:</span>
<span class="cm"> 			Space separated rectangle.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetRect</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span><span class="n">ByRef</span> <span class="n">Left</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">ByRef</span> <span class="n">Top</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">ByRef</span> <span class="n">Right</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">ByRef</span> <span class="n">Bottom</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">static</span> <span class="n">EM_GETRECT</span><span class="o">:=</span><span class="mh">0xB2</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_GETRECT</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">RECT</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
      <span class="n">Left</span>  <span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
    <span class="p">,</span> <span class="n">Top</span>   <span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
    <span class="p">,</span> <span class="n">Right</span> <span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
    <span class="p">,</span> <span class="n">Bottom</span><span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span>  <span class="n">Left</span> <span class="s">&quot; &quot;</span> <span class="n">Top</span> <span class="s">&quot; &quot;</span> <span class="n">Right</span> <span class="s">&quot; &quot;</span> <span class="n">Bottom</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">  Function: GetSel</span>
<span class="cm"> 			Retrieve the starting and ending character positions of the selection in a rich edit control.</span>

<span class="cm">  Parameters:</span>
<span class="cm"> 			cpMin -	The optional name of the variable in which to store the character position index immediately</span>
<span class="cm">              preceding the first character in the range.</span>
<span class="cm"> 			cpMin -	The optional name of the variable in which to store the character position index immediately</span>
<span class="cm">              following the last character in the range.</span>

<span class="cm">  Returns:</span>
<span class="cm"> 			Returns *cpMin*. If there is no selection this is cursor position.</span>

<span class="cm">  Related:</span>
<span class="cm">      &lt;GetText&gt;, &lt;GetTextLength&gt;, &lt;SetSel&gt;, &lt;SetText&gt;, &lt;HideSelection&gt;, &lt;LineFromChar&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetSel</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">cpMin</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">cpMax</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_EXGETSEL</span><span class="o">=</span><span class="mh">0x434</span>
  <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_EXGETSEL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">CHARRANGE</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
  <span class="n">cpMin</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="n">cpMax</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">return</span> <span class="n">cpMin</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  GetText</span>
<span class="cm">			Retrieves a specified range of characters from a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			CpMin -	Beginning of range of characters to retrieve.</span>
<span class="cm">			CpMax -	End of range of characters to retrieve.</span>
<span class="cm">			CodePage - If *UNICODE* or *U*, this optional parameter will use unicode code page</span>
<span class="cm">					in the translation. Otherwise it will default to using ansi. (*** needs rework ***)</span>

<span class="cm"> Note:</span>
<span class="cm">			If the *CpMin* and *CpMax* are omitted, the current selection is retrieved.</span>
<span class="cm">			The range includes everything if *CpMin* is 0 and *CpMax* is Â–1.</span>

<span class="cm"> Returns:</span>
<span class="cm">			Returns the retrieved text.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;GetSel&gt;, &lt;GetLine&gt;, &lt;GetTextLength&gt;, &lt;SetText&gt;, &lt;SetSel&gt;, &lt;FindText&gt;</span>
<span class="cm">			</span>
<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  MsgBox, % RichEdit_GetText( hRichEdit ) ; get current selection</span>
<span class="cm">  MsgBox, % RichEdit_GetText( hRichEdit, 0, -1 ) ; get all</span>
<span class="cm">  MsgBox, % RichEdit_GetText( hRichEdit, 4, 10 ) ; get range</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetText</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">CpMin</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">CpMax</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">CodePage</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_EXGETSEL</span><span class="o">=</span><span class="mh">0x434</span><span class="p">,</span> <span class="n">EM_GETTEXTEX</span><span class="o">=</span><span class="mh">0x45E</span><span class="p">,</span> <span class="n">EM_GETTEXTRANGE</span><span class="o">=</span><span class="mh">0x44B</span><span class="p">,</span> <span class="n">GT_SELECTION</span><span class="o">=</span><span class="mi">2</span>

	<span class="n">bufferLength</span> <span class="o">:=</span> <span class="n">RichEdit_GetTextLength</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;CLOSE&quot;</span><span class="p">,</span> <span class="s">&quot;UNICODE&quot;</span> <span class="p">)</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">CpMin</span> <span class="n">CpMax</span> <span class="o">=</span> <span class="s">&quot;--&quot;</span><span class="p">)</span>
		<span class="n">MODE</span> <span class="o">:=</span> <span class="n">GT_SELECTION</span><span class="p">,</span> <span class="n">CpMin</span><span class="o">:=</span><span class="n">CpMax</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">CpMin</span><span class="o">=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">CpMax</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">MODE</span> <span class="o">:=</span> <span class="n">GT_ALL</span>      <span class="p">,</span> <span class="n">CpMin</span><span class="o">:=</span><span class="n">CpMax</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">CpMin</span><span class="o">+</span><span class="mi">0</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cpMax</span><span class="o">+</span><span class="mi">0</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">lpwstr</span><span class="p">,</span> <span class="n">bufferLength</span><span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">TEXTRANGE</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">CpMin</span><span class="p">,</span> <span class="n">TEXTRANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">CpMax</span><span class="p">,</span> <span class="n">TEXTRANGE</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lpwstr</span><span class="p">,</span> <span class="n">TEXTRANGE</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETTEXTRANGE</span><span class="p">,,</span> <span class="o">&amp;</span><span class="n">TEXTRANGE</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span><span class="c-Singleline"></span>
<span class="c-Singleline">		; If not unicode, return ansi from string pointer..</span>
		<span class="n">if</span> <span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">RichEdit_TextMode</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">),</span> <span class="s">&quot;MULTICODEPAGE&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MulDiv&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lpwstr</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">		;..else, convert Unicode to Ansi..</span>
		<span class="n">nSz</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;lstrlenW&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">lpwstr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">ansi</span><span class="p">,</span> <span class="n">nSz</span> <span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span> <span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span>       <span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span>
									<span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">LPWSTR</span> <span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">nSz</span><span class="o">+</span><span class="mi">1</span>
									<span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">ansi</span>    <span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">nSz</span><span class="o">+</span><span class="mi">1</span>
									<span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span>       <span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">ansi</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">ansi</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nv">errorlevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid use of cpMin or cpMax parameter.&quot;</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">GETTEXTEX</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>          <span class="p">,</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">BUFFER</span><span class="p">,</span> <span class="n">bufferLength</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">bufferLength</span><span class="p">,</span> <span class="n">GETTEXTEX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">MODE</span><span class="p">,</span> <span class="n">GETTEXTEX</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span> <span class="p">(</span><span class="n">CodePage</span><span class="o">=</span><span class="s">&quot;unicode&quot;</span> <span class="o">||</span> <span class="n">CodePage</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1200</span> <span class="o">:</span> <span class="mi">0</span>  <span class="p">,</span> <span class="n">GETTEXTEX</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETTEXTEX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GETTEXTEX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BUFFER</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">BUFFER</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">BUFFER</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetTextLength</span>
<span class="cm">			Calculates text length in various ways for a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			flag     - Space separated list of one or more options.  See below list.</span>
<span class="cm">			codepage - If *UNICODE* or *U*, this optional parameter will use unicode code page</span>
<span class="cm">                in the translation. Otherwise it will default to using ansi.</span>

<span class="cm"> Flag Options:</span>
<span class="cm">     DEFAULT  - Returns the number of characters. This is the default.</span>
<span class="cm">     USECRLF  - Computes the answer by using CR/LFs at the end of paragraphs.</span>
<span class="cm">     PRECISE  - Computes a precise answer. This approach could necessitate a conversion</span>
<span class="cm">                and thereby take longer. This flag cannot be used with the *CLOSE* flag.</span>
<span class="cm">     CLOSE    - Computes an approximate (close) answer. It is obtained quickly and can</span>
<span class="cm">                be used to set the buffer size. This flag cannot be used with the *PRECISE*</span>
<span class="cm">                flag.</span>
<span class="cm">     NUMCHARS - Returns the number of characters. This flag cannot be used with the</span>
<span class="cm">                *NUMBYTES* flag.</span>
<span class="cm">     NUMBYTES - Returns the number of bytes. This flag cannot be used with the *NUMCHARS*</span>
<span class="cm">                flag.</span>

<span class="cm"> Returns:</span>
<span class="cm">     If the operation succeeds, the return value is the number of TCHARs in the edit</span>
<span class="cm">     control, depending on the setting of the flags.</span>
<span class="cm">     If the operation fails, the return value is blank.</span>

<span class="cm"> Remarks:</span>
<span class="cm">     This message is a fast and easy way to determine the number of characters in the</span>
<span class="cm">     Unicode version of the rich edit control. However, for a non-Unicode target code</span>
<span class="cm">     page you will potentially be converting to a combination of single-byte and double-byte</span>
<span class="cm">     characters.</span>

<span class="cm"> Related:</span>
<span class="cm">     &lt;LineLength&gt;, &lt;LimitText&gt;, &lt;GetSel&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  MsgBox, % &quot;DEFAULT  = &quot; RichEdit_GetTextLength(hRichEdit, &quot;DEFAULT&quot; )  &quot;`n&quot;</span>
<span class="cm">          . &quot;USECRLF  = &quot; RichEdit_GetTextLength(hRichEdit, &quot;USECRLF&quot; )  &quot;`n&quot;</span>
<span class="cm">          . &quot;PRECISE  = &quot; RichEdit_GetTextLength(hRichEdit, &quot;PRECISE&quot; )  &quot;`n&quot;</span>
<span class="cm">          . &quot;CLOSE    = &quot; RichEdit_GetTextLength(hRichEdit, &quot;CLOSE&quot; )    &quot;`n&quot;</span>
<span class="cm">          . &quot;NUMCHARS = &quot; RichEdit_GetTextLength(hRichEdit, &quot;NUMCHARS&quot; ) &quot;`n&quot;</span>
<span class="cm">          . &quot;NUMBYTES = &quot; RichEdit_GetTextLength(hRichEdit, &quot;NUMBYTES&quot; ) &quot;`n&quot;</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetTextLength</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Flags</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CodePage</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_GETTEXTLENGTHEX</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">GTL_DEFAULT</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">GTL_USECRLF</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">GTL_PRECISE</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">GTL_CLOSE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">GTL_NUMCHARS</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">GTL_NUMBYTES</span><span class="o">=</span><span class="mi">16</span>

<span class="w">  </span><span class="nl">hexFlags:</span><span class="o">=</span><span class="mi">0</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Flags</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
		<span class="n">hexFlags</span> <span class="o">|=</span> <span class="n">GTL_</span><span class="nv">%A_LOOPFIELD%</span>

  <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">GETTEXTLENGTHEX</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
  <span class="nf">NumPut</span><span class="p">(</span><span class="n">hexFlags</span><span class="p">,</span> <span class="n">GETTEXTLENGTHEX</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">((</span><span class="n">codepage</span><span class="o">=</span><span class="s">&quot;unicode&quot;</span><span class="o">||</span><span class="n">codepage</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1200</span> <span class="o">:</span> <span class="mi">1252</span><span class="p">,</span> <span class="n">GETTEXTLENGTHEX</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETTEXTLENGTHEX</span> <span class="o">|</span> <span class="n">WM_USER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">GETTEXTLENGTHEX</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">  </span><span class="nb">IfEqual</span><span class="p">,</span> <span class="nv">ERRORLEVEL</span><span class="p">,</span><span class="mh">0x80070057</span><span class="p">,</span> <span class="n">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nv">errorlevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid combination of parameters.&quot;</span>
<span class="w">  </span><span class="nb">IfEqual</span><span class="p">,</span> <span class="nv">ERRORLEVEL</span><span class="p">,</span><span class="n">FAIL</span>      <span class="p">,</span> <span class="n">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nv">errorlevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid control handle.&quot;</span>
<span class="w">  </span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetUndo</span>
<span class="cm">    Determine whether there are any actions in the Edit control undo queue, and optionally retrieve</span>
<span class="cm">    the type of the next undo action.</span>

<span class="cm"> Parameters:</span>
<span class="cm">    Name - Optional byref parameter will contain the type of undo action, if any.</span>

<span class="cm"> Types:</span>
<span class="cm">    UNKNOWN	 - The type of undo action is unknown.</span>
<span class="cm">    TYPING	 - Typing operation.</span>
<span class="cm">    DELETE	 - Delete operation.</span>
<span class="cm">    DRAGDROP - Drag-and-drop operation.</span>
<span class="cm">    CUT		 - Cut operation.</span>
<span class="cm">    PASTE	 - Paste operation.</span>

<span class="cm"> Returns:</span>
<span class="cm">    If there are actions in the control undo queue, the return value is a nonzero value.</span>
<span class="cm">    If the undo queue is empty, the return value is zero.</span>

<span class="cm"> Related:</span>
<span class="cm">    &lt;Undo&gt;, &lt;SetUndoLimit&gt;, &lt;GetRedo&gt;, &lt;Redo&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  If RichEdit_GetRedo( hRichEdit, name )</span>
<span class="cm">    MsgBox, The next redo is a %name% type</span>
<span class="cm">  Else MsgBox, Nothing left to redo.</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_GetUndo</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Name</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_CANUNDO</span><span class="o">=</span><span class="mh">0xC6</span><span class="p">,</span><span class="n">EM_GETUNDONAME</span><span class="o">=</span><span class="mi">86</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span>
        <span class="p">,</span><span class="n">UIDs</span><span class="o">=</span><span class="s">&quot;UNKNOWN,TYPING,DELETE,DRAGDROP,CUT,PASTE&quot;</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_CANUNDO</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
  <span class="n">nUndo</span> <span class="o">:=</span> <span class="nv">ERRORLEVEL</span>

  <span class="n">If</span> <span class="p">(</span> <span class="n">nUndo</span> <span class="o">&amp;&amp;</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&quot;-&quot;</span> <span class="p">)</span>  <span class="p">{</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_GETUNDONAME</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">    </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">UIDs</span><span class="p">,</span> <span class="se">`,</span>
      <span class="n">If</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">=</span> <span class="nv">errorlevel</span><span class="p">)</span>  <span class="p">{</span>
        <span class="n">name</span> <span class="o">:=</span> <span class="nv">A_LoopField</span>
<span class="w">        </span><span class="nb">break</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="w">  </span><span class="nb">return</span> <span class="n">nUndo</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  HideSelection</span>
<span class="cm">    Hides or shows the selection in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">    State - True or false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">    This function is noticeable when it is set to false and the rich edit control isn&#39;t the active control or window.  The example included in &lt;FindText&gt; demonstrates use.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;SetSel&gt;, &lt;GetSel&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_HideSelection</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">State</span><span class="o">=</span><span class="nv">true</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_HIDESELECTION</span> <span class="o">=</span> <span class="mi">1087</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_HIDESELECTION</span><span class="p">,</span><span class="nv">%State%</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  LineFromChar</span>
<span class="cm">			Determines which line contains the specified character in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			CharIndex -	Zero-based integer index of the character. -1 (default) means current line.</span>

<span class="cm"> Returns:</span>
<span class="cm">			Zero-based index of the line.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;LineIndex&gt;, &lt;GetLineCount&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_LineFromChar</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">CharIndex</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_EXLINEFROMCHAR</span><span class="o">=</span><span class="mi">1078</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_EXLINEFROMCHAR</span><span class="p">,,</span><span class="n">CharIndex</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">  </span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	LineIndex</span>
<span class="cm">			Returns the character index of the first character of a specified line in an Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			LineNumber	- Line number for which to retreive character index. -1 (default) means current line.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The character index of the line specified, or -1 if the specified line number is greater than the number of lines.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;LineLength&gt;, &lt;LineFromChar&gt;, &lt;GetLine&gt;, &lt;GetLineCount&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_LineIndex</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">LineNumber</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_LINEINDEX</span><span class="o">=</span><span class="mi">187</span>
<span class="w"> 	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_LINEINDEX</span><span class="p">,</span> <span class="n">LineNumber</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">Return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	LineLength</span>
<span class="cm">			Returns the length of a line in an Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			LineNumber	- Line number for which to retreive line length. -1 (default) means current line.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The length (in characters) of the line.</span>
<span class="cm">			</span>
<span class="cm"> Related:</span>
<span class="cm">			&lt;GetTextLength&gt;, &lt;LineIndex&gt;, &lt;LineFromChar&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_LineLength</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">LineNumber</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_LINELENGTH</span><span class="o">=</span><span class="mi">193</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_LINELENGTH</span><span class="p">,</span> <span class="n">RichEdit_LineIndex</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">LineNumber</span><span class="p">),,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">Return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: LineScroll</span>
<span class="cm">			Scrolls the text in the Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			XScroll -	The number of characters to scroll horizontally.  Use a</span>
<span class="cm">								negative number to scroll to the left and a positive number to</span>
<span class="cm">								scroll to the right.</span>
<span class="cm">			YScroll -	The number of lines to scroll vertically.  Use a negative</span>
<span class="cm">						    number to scroll up and a positive number to scroll down.</span>
<span class="cm"> Remarks:</span>
<span class="cm">			This message does not move the caret.</span>
<span class="cm">			This function can be used to scroll horizontally past the last character of any line.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_LineScroll</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span><span class="n">XScroll</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">YScroll</span><span class="o">=</span><span class="mi">0</span><span class="p">){</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">EM_LINESCROLL</span><span class="o">:=</span><span class="mh">0xB6</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_LINESCROLL</span><span class="p">,</span> <span class="n">XScroll</span><span class="p">,</span> <span class="n">YScroll</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  LimitText</span>
<span class="cm">			Sets an upper limit to the amount of text the user can type or paste into a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			txtSize -	Specifies the maximum amount of text that can be entered. If this parameter is zero,</span>
<span class="cm">               the default maximum is used, which is 64K characters. A Component Object Model (COM)</span>
<span class="cm">               object counts as a single character.</span>

<span class="cm"> Returns:</span>
<span class="cm">			This function does not return a value.</span>

<span class="cm"> Remarks:</span>
<span class="cm">     Before LimitText is called, the default limit to the amount of text a user can enter is</span>
<span class="cm">     32,767 characters.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_LimitText</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span><span class="n">txtSize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_EXLIMITTEXT</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_EXLIMITTEXT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">%txtSize%</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: Paste</span>
<span class="cm">		   Paste clipboard into the Edit control.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;CanPaste&gt;, &lt;PasteSpecial&gt;, &lt;Cut&gt;, &lt;Copy&gt;, &lt;Clear&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Paste</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">WM_PASTE</span><span class="o">:=</span><span class="mh">0x302</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">WM_PASTE</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	PasteSpecial</span>
<span class="cm">      Pastes a specific clipboard format in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Format	- One of the clipboard formats. See &lt;http://msdn.microsoft.com/en-us/library/bb774214(VS.85).aspx&gt;</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;CanPaste&gt;, &lt;Paste&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_PasteSpecial</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Format</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_PASTESPECIAL</span><span class="o">=</span><span class="mh">0x440</span>
		<span class="p">,</span><span class="n">CF_BITMAP</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">CF_DIB</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">CF_DIBV5</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">CF_DIF</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">CF_DSPBITMAP</span><span class="o">=</span><span class="mh">0x82</span><span class="p">,</span><span class="n">CF_DSPENHMETAFILE</span><span class="o">=</span><span class="mh">0x8E</span><span class="p">,</span><span class="n">CF_DSPMETAFILEPICT</span><span class="o">=</span><span class="mh">0x83</span>
        <span class="p">,</span><span class="n">CF_DSPTEXT</span><span class="o">=</span><span class="mh">0x81</span><span class="p">,</span><span class="n">CF_ENHMETAFILE</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">CF_GDIOBJFIRST</span><span class="o">=</span><span class="mh">0x300</span><span class="p">,</span><span class="n">CF_GDIOBJLAST</span><span class="o">=</span><span class="mh">0x3FF</span><span class="p">,</span><span class="n">CF_HDROP</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">CF_LOCALE</span><span class="o">=</span><span class="mi">16</span>
        <span class="p">,</span><span class="n">CF_METAFILEPICT</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">CF_OEMTEXT</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">CF_OWNERDISPLAY</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span><span class="n">CF_PALETTE</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">CF_PENDATA</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">CF_PRIVATEFIRST</span><span class="o">=</span><span class="mh">0x200</span>
        <span class="p">,</span><span class="n">CF_PRIVATELAST</span><span class="o">=</span><span class="mh">0x2FF</span><span class="p">,</span><span class="n">CF_RIFF</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">CF_SYLK</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">CF_TEXT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">CF_WAVE</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">CF_TIFF</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">CF_UNICODETEXT</span><span class="o">=</span><span class="mi">13</span>

<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_PASTESPECIAL</span><span class="p">,</span> <span class="n">CF_</span><span class="nv">%Format%</span><span class="p">,</span> <span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> Function: PosFromChar</span>
<span class="cm">           Gets the client area coordinates of a specified character in an Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">           CharIndex - The zero-based index of the character.</span>

<span class="cm">           X, Y - These parameters, which must contain valid variable names,</span>
<span class="cm">           are used to return the x/y-coordinates of a point in the control&#39;s client relative to the upper-left corner of the client area.</span>

<span class="cm"> Remarks:</span>
<span class="cm">           If CharIndex is greater than the index of the last character in the control, the returned coordinates are of the position just past</span>
<span class="cm">           the last character of the control.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_PosFromChar</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">CharIndex</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">X</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Y</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span> <span class="n">EM_POSFROMCHAR</span><span class="o">=</span><span class="mh">0xD6</span>
    <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">POINTL</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">SendMessage</span> <span class="n">EM_POSFROMCHAR</span><span class="p">,</span><span class="o">&amp;</span><span class="n">POINTL</span><span class="p">,</span><span class="n">CharIndex</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">    </span><span class="nl">X:</span><span class="o">=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">POINTL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="n">Y</span><span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">POINTL</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Redo</span>
<span class="cm">			Do redo operation.</span>

<span class="cm"> Returns:</span>
<span class="cm">			True if the Redo operation succeeds, false otherwise.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Redo</span><span class="p">(</span><span class="n">hEdit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_REDO</span> <span class="o">:=</span> <span class="mi">1108</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_REDO</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	ReplaceSel</span>
<span class="cm">			Replace selection with desired text in the Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Text - Text to replace selection with.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_ReplaceSel</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span>  <span class="n">EM_REPLACESEL</span><span class="o">=</span><span class="mi">194</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_REPLACESEL</span><span class="p">,,</span> <span class="o">&amp;</span><span class="n">text</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Save</span>
<span class="cm">			Save the content of the rich edit control using RT format.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			FileName	- File name to save RTF file to. If omitted, function will return content.</span>
<span class="cm">			</span>
<span class="cm">  Related:</span>
<span class="cm">      &lt;GetModify&gt;, &lt;SetModify&gt;</span>
<span class="cm">      </span>
<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  If !RichEdit_GetModify( hRichEdit )  {</span>
<span class="cm">    MsgBox, No changes detected</span>
<span class="cm">    return</span>
<span class="cm">  }</span>

<span class="cm">  RichEdit_Save( hRichEdit, file )</span>
<span class="cm">  RichEdit_SetModify( hRichEdit, false )</span>
<span class="cm">  MsgBox, File has been saved</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Save</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">FileName</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_STREAMOUT</span><span class="o">=</span><span class="mh">0x44A</span>

	<span class="n">wbProc</span> <span class="o">:=</span> <span class="nf">RegisterCallback</span><span class="p">(</span><span class="s">&quot;RichEdit_editStreamCallBack&quot;</span><span class="p">,</span> <span class="s">&quot;F&quot;</span><span class="p">)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">EDITSTREAM</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">RichEdit_GetTextLength</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;USECRLF&quot;</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">EDITSTREAM</span><span class="p">)</span><span class="c-Singleline">	;aproximate</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">wbProc</span><span class="p">,</span> <span class="n">EDITSTREAM</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_STREAMOUT</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">EDITSTREAM</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">RichEdit_editStreamCallBack</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	ScrollCaret</span>
<span class="cm">			Scroll content of Edit control until caret is visible.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_ScrollCaret</span><span class="p">(</span><span class="n">hEdit</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SCROLLCARET</span><span class="o">=</span><span class="mi">183</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SCROLLCARET</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	ScrollPos</span>
<span class="cm">			Obtain the current scroll position, or tell the rich edit control to scroll to a particular point.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			PosString - String specifying the x/y point in the virtual text space of the document, expressed</span>
<span class="cm">					    in pixels. (See example)</span>

<span class="cm"> Returns:</span>
<span class="cm">     If *posString* is omitted, the return value is the current scroll position.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;ShowScrollBar&gt;, &lt;GetSel&gt;, &lt;LineFromChar&gt;, &lt;SetSel&gt;</span>

<span class="cm"> Example:</span>
<span class="cm">	&gt; Msgbox, % &quot;scroll pos = &quot; RichRichEdit_ScrollPos( hRichEdit )</span>
<span class="cm">	&gt; RichRichEdit_ScrollPos( hRichEdit , &quot;7/22&quot; )</span>
<span class="cm"> */</span>
<span class="n">RichEdit_ScrollPos</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">PosString</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_GETSCROLLPOS</span><span class="o">=</span><span class="mi">1245</span><span class="p">,</span><span class="n">EM_SETSCROLLPOS</span><span class="o">=</span><span class="mi">1246</span>

  <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">POINT</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">PosString</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETSCROLLPOS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">POINT</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">POINT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s">&quot;/&quot;</span> <span class="o">.</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">POINT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span><span class="c-Singleline">  ; returns posString</span>
  <span class="p">}</span>

<span class="w">  </span><span class="nb">If </span><span class="nf">RegExMatch</span><span class="p">(</span> <span class="n">PosString</span><span class="p">,</span> <span class="s">&quot;^(?&lt;X&gt;\d*)/(?&lt;Y&gt;\d*)$&quot;</span><span class="p">,</span> <span class="n">m</span> <span class="p">)</span>  <span class="p">{</span>
    <span class="nf">NumPut</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">POINT</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">mY</span><span class="p">,</span> <span class="n">POINT</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETSCROLLPOS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">POINT</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
  <span class="p">}</span>
<span class="w">  </span><span class="nb">else</span> <span class="n">return</span> <span class="nv">false</span><span class="p">,</span> <span class="nv">errorlevel</span> <span class="o">:=</span> <span class="s">&quot;ERROR: &#39;&quot;</span> <span class="n">PosString</span> <span class="s">&quot;&#39; isn&#39;t a valid posString.&quot;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SelectionType</span>
<span class="cm">			Determines the selection type for a rich edit control.</span>

<span class="cm"> Returns:</span>
<span class="cm">			If the selection is not empty, the return value is a set of flags containing one or more of the following values:</span>
<span class="cm">			TEXT		-	Text.</span>
<span class="cm">			OBJECT		-	At least one Component Object Model (COM) object.</span>
<span class="cm">			MULTICHAR	-	More than one character of text.</span>
<span class="cm">			MULTIOBJECT	-	More than one COM object.</span>

<span class="cm"> Remarks:</span>
<span class="cm">	This message is useful during WM_SIZE processing for the parent of a bottomless rich edit control.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SelectionType</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SELECTIONTYPE</span><span class="o">=</span><span class="mi">1090</span><span class="p">,</span> <span class="mi">1</span><span class="o">=</span><span class="s">&quot;TEXT&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">=</span><span class="s">&quot;OBJECT&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="o">=</span><span class="s">&quot;MULTICHAR&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="o">=</span><span class="s">&quot;MULTIOBJECT&quot;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="s">&quot;1,2,4,8&quot;</span>

<span class="w">	</span><span class="nb">if </span><span class="n">hCtrl</span> <span class="o">&gt;</span> <span class="mi">0</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SELECTIONTYPE</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
		<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">o</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span><span class="p">)</span>
<span class="w">			</span><span class="nb">return</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">o</span> <span class="o">:=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">)</span>

<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="se">`,</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">&amp;</span> <span class="nv">A_LoopField</span><span class="p">)</span>
			<span class="n">res</span> <span class="o">.=</span> <span class="nv">%A_LoopField%</span> <span class="s">&quot; &quot;</span>

<span class="w">	</span><span class="nb">return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetBgColor</span>
<span class="cm">			Sets the background color for a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Color -	Color in RGB format (0xRRGGBB) if &gt; 0 or BGR format if &lt; 0.</span>

<span class="cm"> Returns:</span>
<span class="cm">			Returns the previous background color in RGB format.</span>

<span class="cm"> Related:</span>
<span class="cm">     &lt;SetCharFormat&gt;, &lt;GetCharFormat&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> &gt; Dlg_Color( color, hRichEdit )</span>
<span class="cm"> &gt; RichEdit_SetBgColor( hRichEdit, color )</span>
<span class="cm"> &gt;</span>
<span class="cm"> &gt; RichEdit_SetBgColor( hRichEdit, 0xa9f874 )</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetBgColor</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETBKGNDCOLOR</span><span class="o">=</span><span class="mi">1091</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Color</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETBKGNDCOLOR</span><span class="p">,,</span> <span class="nf">abs</span><span class="p">(</span><span class="n">Color</span><span class="p">),,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">Color</span>
	<span class="p">}</span>

	<span class="n">old</span> <span class="o">:=</span> <span class="nv">A_FormatInteger</span>
<span class="w">	</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">hex</span>
	<span class="nf">RegExMatch</span><span class="p">(</span> <span class="n">Color</span><span class="p">,</span> <span class="s">&quot;0x(?P&lt;R&gt;..)(?P&lt;G&gt;..)(?P&lt;B&gt;..)$&quot;</span><span class="p">,</span> <span class="n">_</span> <span class="p">)</span><span class="c-Singleline"> ; RGB2BGR</span>
	<span class="n">Color</span> <span class="o">:=</span> <span class="s">&quot;0x00&quot;</span> <span class="n">_B</span> <span class="n">_G</span> <span class="n">_R</span><span class="c-Singleline">        ; 0x00bbggrr</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETBKGNDCOLOR</span><span class="p">,,</span><span class="n">Color</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
	<span class="nf">RegExMatch</span><span class="p">(</span> <span class="nv">ERRORLEVEL</span> <span class="o">+</span> <span class="mh">0x1000000</span><span class="p">,</span> <span class="s">&quot;(?P&lt;B&gt;..)(?P&lt;G&gt;..)(?P&lt;R&gt;..)$&quot;</span><span class="p">,</span> <span class="n">_</span> <span class="p">)</span><span class="c-Singleline"> ; RGB2BGR</span>
	<span class="n">pColor</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="n">_R</span> <span class="n">_G</span> <span class="n">_B</span>
<span class="w">	</span><span class="nb">SetFormat</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="nv">%old%</span>

<span class="w">	</span><span class="nb">return</span> <span class="n">pColor</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetCharFormat</span>
<span class="cm">			Set character formatting in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Face	- Font name. Optional.</span>
<span class="cm">			Style	- Space separated list of styles. See below list. Optional.</span>
<span class="cm">			TextColor	- Text foreground color. Optional.</span>
<span class="cm">			BackColor	- Text backgrond color. Optional.</span>
<span class="cm">			Mode	- Character formatting that applies to the control.</span>
<span class="cm">					  If omitted, the function changes the default character formatting.</span>
<span class="cm">					  It can be one of the values given bellow. Optional.</span>

<span class="cm"> Styles:</span>
<span class="cm">			s&lt;Num&gt;		- Character size, usual AHK represntation (i.e. s12)</span>
<span class="cm">			o&lt;Num&gt;		- Character offset from the baseline, in twips,. If the value of this member is positive, the character is a superscript; if the value is negative, the character is a subscript.</span>
<span class="cm">			AUTOBACKCOLOR - The background color is the return value of GetSysColor(COLOR_WINDOW:=5). If this flag is set, BackColor member is ignored.</span>
<span class="cm">			AUTOCOLOR	- The text color is the return value of GetSysColor(COLOR_WINDOWTEXT:=8). If this flag is set, the TextColor member is ignored.</span>
<span class="cm">			BOLD		- Characters are bold.</span>
<span class="cm">			HIDDEN		- Characters are not displayed.</span>
<span class="cm">			ITALIC		- Characters are italic.</span>
<span class="cm">			LINK		- A rich edit control sends LINK notification messages when it receives mouse messages while the mouse pointer is over text with the LINK effect.</span>
<span class="cm">			PROTECTED	- Characters are protected; an attempt to modify them will cause an PROTECTED notification message.</span>
<span class="cm">			STRIKEOUT	- Characters are struck out.</span>
<span class="cm">			SUBSCRIPT	- Characters are subscript. The SUPERSCRIPT and SUBSCRIPT values are mutually exclusive.</span>
<span class="cm">						  For both values, the control automatically calculates an offset and a smaller font size.</span>
<span class="cm">			SUPERSCRIPT	- Characters are superscript.</span>
<span class="cm">			UNDERLINE	- Characters are underlined.</span>

<span class="cm"> Modes:</span>
<span class="cm">			DEFAULT		- Changes the formating for the default text in the control. This is also the style used if you don&#39;t specify valid style.</span>
<span class="cm">			ALL			- Applies the formatting to all text in the control.</span>
<span class="cm">			SELECTION	- Applies the formatting to the current selection. If the selection is empty, the character formatting is applied</span>
<span class="cm">						  to the insertion point, and the new character format is in effect only until the insertion point changes. </span>
<span class="cm">			WORD		- Applies the formatting to the selected word or words. If the selection is empty but the insertion point is inside a word</span>
<span class="cm">						  ,the formatting is applied to the word.</span>
<span class="cm">						  </span>
<span class="cm"> Returns:</span>
<span class="cm">			True or false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			This function will fire up SELCHANGE message even if selection isn&#39;t changed.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetCharFormat</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Face</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Style</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">TextColor</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">BackColor</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="o">=</span><span class="s">&quot;SELECTION&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETCHARFORMAT</span><span class="o">=</span><span class="mh">0x444</span>
		  <span class="p">,</span> <span class="n">CFM_CHARSET</span><span class="o">:=</span><span class="mh">0x8000000</span><span class="p">,</span><span class="n">CFM_COLOR</span><span class="o">:=</span><span class="mh">0x40000000</span><span class="p">,</span> <span class="n">CFM_FACE</span><span class="o">:=</span><span class="mh">0x20000000</span><span class="p">,</span> <span class="n">CFM_OFFSET</span><span class="o">:=</span><span class="mh">0x10000000</span><span class="p">,</span> <span class="n">CFM_SIZE</span><span class="o">:=</span><span class="mh">0x80000000</span><span class="p">,</span> <span class="n">CFM_WEIGHT</span><span class="o">=</span><span class="mh">0x400000</span><span class="p">,</span> <span class="n">CFM_UNDERLINETYPE</span><span class="o">=</span><span class="mh">0x800000</span>
		  <span class="p">,</span> <span class="n">CFM_HIDDEN</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">CFM_BOLD</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CFM_ITALIC</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">CFM_DISABLED</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">CFM_LINK</span><span class="o">=</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">CFM_PROTECTED</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">CFM_STRIKEOUT</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">CFM_UNDERLINE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">CFM_SUPERSCRIPT</span><span class="o">=</span><span class="mh">0x30000</span><span class="p">,</span> <span class="n">CFM_SUBSCRIPT</span><span class="o">=</span><span class="mh">0x30000</span><span class="p">,</span> <span class="n">CFM_BACKCOLOR</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span> <span class="n">CFE_AUTOBACKCOLOR</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span> <span class="n">CFE_AUTOCOLOR</span> <span class="o">=</span> <span class="mh">0x40000000</span>
		  <span class="p">,</span> <span class="n">CFE_HIDDEN</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">CFE_BOLD</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CFE_ITALIC</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">CFE_DISABLED</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">CFE_LINK</span><span class="o">=</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">CFE_PROTECTED</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">CFE_STRIKEOUT</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">CFE_UNDERLINE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">CFE_SUBSCRIPT</span><span class="o">=</span><span class="mh">0x10000</span><span class="p">,</span> <span class="n">CFE_SUPERSCRIPT</span><span class="o">=</span><span class="mh">0x20000</span><span class="p">,</span> <span class="n">CFM_COLOR</span><span class="o">=</span><span class="mh">0x40000000</span><span class="p">,</span> <span class="n">CFM_AUTOBACKCOLOR</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span> <span class="n">CFM_AUTOCOLOR</span><span class="o">=</span><span class="mh">0x40000000</span>
		  <span class="p">,</span> <span class="n">SCF_ALL</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">SCF_SELECTION</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">SCF_WORD</span><span class="o">=</span><span class="mi">3</span><span class="c-Singleline">	;, SCF_ASSOCIATEFONT=0x10</span>

<span class="c-Singleline">	;sz := S(_, &quot;CHARFORMAT2A: cbSize dwMask dwEffects yHeight=.04 yOffset=.04 crTextColor bCharSet=.1 bPitchAndFamily=.1 szFaceName wWeight=60.2 sSpacing=.02 crBackColor lcid dwReserved sStyle=.02 wKerning=.2 bUnderlineType=.1 bAnimation=.1 bRevAuthor=.1 bReserved1=.1&quot;)</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CF</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="n">CF</span><span class="p">)</span>
	<span class="n">hMask</span> <span class="o">:=</span> <span class="mi">0</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Face</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Face</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">32</span><span class="p">)</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_FACE</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;lstrcpy&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CF</span><span class="o">+</span><span class="mi">26</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span> <span class="n">Face</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">TextColor</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="n">TextColor</span> <span class="o">:=</span> <span class="p">((</span><span class="n">TextColor</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">TextColor</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">TextColor</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_COLOR</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">TextColor</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">BackColor</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="n">BackColor</span> <span class="o">:=</span> <span class="p">((</span><span class="n">BackColor</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">BackColor</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">BackColor</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_BACKCOLOR</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">BackColor</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Style</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">hEffects</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="nv">%A_Space%</span>
		<span class="p">{</span>
			<span class="n">lf</span> <span class="o">:=</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">			</span><span class="nb">if </span><span class="nf">InStr</span><span class="p">(</span><span class="s">&quot;so&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">j</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nv">%c%</span> <span class="o">:=</span> <span class="n">j</span><span class="p">))</span>
<span class="w">				 </span><span class="nb">continue</span>

<span class="w">			</span><span class="nb">if </span><span class="n">bOff</span> <span class="o">:=</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
				<span class="n">lf</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

			<span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_</span><span class="nv">%lf%</span><span class="p">,</span> <span class="n">hEffects</span> <span class="o">|=</span> <span class="n">bOff</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">CFE_</span><span class="nv">%lf%</span>
		<span class="p">}</span>
	    <span class="nf">NumPut</span><span class="p">(</span><span class="n">hEffects</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
			<span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_SIZE</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
			<span class="n">hMask</span> <span class="o">|=</span> <span class="n">CFM_OFFSET</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="nf">NumPut</span><span class="p">(</span><span class="n">hMask</span><span class="p">,</span> <span class="n">CF</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETCHARFORMAT</span><span class="p">,</span> <span class="n">SCF_</span><span class="nv">%Mode%</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CF</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">	Function:	SetEvents</span>
<span class="cm">				Set notification events.</span>

<span class="cm">	Parameters:</span>
<span class="cm">				Handler	- Function that handles events. If empty, any existing handler will be removed.</span>
<span class="cm">				Events	- White space separated list of events to monitor.</span>

<span class="cm">	Handler:</span>
<span class="cm"> &gt;     	Result := Handler(hCtrl, Event, p1, p2, p3 )</span>

<span class="cm">		hCtrl	- Handle of richedit control sending the event.</span>
<span class="cm">		Event	- Specifies event that occurred. Event must be registered to be able to monitor it.</span>
<span class="cm">		Col,Row - Cell coordinates.</span>
<span class="cm">		Data	- Numeric data of the cell. Pointer to string for textual cells and DWORD value for numeric.</span>
<span class="cm">		Result  - Return 1 to prevent action.</span>

<span class="cm">	Events:</span>
<span class="cm">		*CHANGE*: Sent when the user has taken an action that may have altered text in an edit control.</span>
<span class="cm">				  Sent after the system updates the screen. (***)</span>

<span class="cm">		*DRAGDROPDONE*: Notifies a rich edit control&#39;s parent window that the drag-and-drop operation has completed.</span>
<span class="cm">		 o P1 - Number of characters highlighted in drag-drop operation.</span>
<span class="cm">         o P2 - Beginning character position of range.</span>
<span class="cm">         o P3 - Ending character position of range.</span>

<span class="cm">		*DROPFILES*: Notifies that the user is attempting to drop files into the control.</span>
<span class="cm">		 o P1 - Number of files dropped onto rich edit control.</span>
<span class="cm">		 o P2 - Newline delimited (`n) list of files dropped onto control.</span>
<span class="cm">		 o P3 - Character position files were dropped onto within rich edit control.</span>

<span class="cm">		*KEYEVENTS*: Notification of a keyboard or mouse event in the control. To ignore the</span>
<span class="cm">					 event, the handler function should return a nonzero value.  (*** needs redone)</span>
<span class="cm">		 o P1 - Character position files were dropped onto within rich edit control.</span>

<span class="cm">		*MOUSEEVENTS,SCROLLEVENTS,LINK*: A rich edit control sends these messages when it receives various messages, when the</span>
<span class="cm">				user clicks the mouse or when the mouse pointer is over text that has the LINK effect.</span>
<span class="cm">				(*** expand usefulness)</span>

<span class="cm">		*PROTECTED*:	User is taking an action that would change a protected range of text.  To ignore</span>
<span class="cm">						the event, the handler function should return a nonzero value.</span>

<span class="cm">		*REQUESTRESIZE*: This message notifies a rich edit control&#39;s parent window that the control&#39;s</span>
<span class="cm">						 contents are either smaller or larger than the control&#39;s window size.</span>
<span class="cm">		 o P1 - Requested new size.</span>

<span class="cm">		*SELCHANGE*: The current selection has changed.</span>
<span class="cm">		 o P1 - Beginning character position of range.</span>
<span class="cm">		 o P2 - Ending character position of range.</span>
<span class="cm">		 o P3 - Selection type.</span>

<span class="cm">		*LINK*: The hyperlink has been clicked.</span>
<span class="cm">		 o P1 - LClick or RClick.</span>
<span class="cm">		 o P2 - CpMin.</span>
<span class="cm">		 o P3 - CpMax.</span>

<span class="cm"> Returns:</span>
<span class="cm">		The previous event mask (number).</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetEvents</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Handler</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Events</span><span class="o">=</span><span class="s">&quot;selchange&quot;</span><span class="p">){</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">ENM_CHANGE</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="n">ENM_DRAGDROPDONE</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span><span class="n">ENM_DROPFILES</span><span class="o">:=</span><span class="mh">0x100000</span><span class="p">,</span><span class="n">ENM_KEYEVENTS</span><span class="o">=</span><span class="mh">0x10000</span><span class="p">,</span><span class="n">ENM_LINK</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span><span class="n">ENM_MOUSEEVENTS</span><span class="o">=</span><span class="mh">0x20000</span><span class="p">,</span><span class="n">ENM_PROTECTED</span><span class="o">=</span><span class="mh">0x200000</span><span class="p">,</span><span class="n">ENM_REQUESTRESIZE</span><span class="o">=</span><span class="mh">0x40000</span><span class="p">,</span><span class="n">ENM_SCROLLEVENTS</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span><span class="n">ENM_SELCHANGE</span><span class="o">=</span><span class="mh">0x80000</span><span class="c-Singleline"> ;ENM_OBJECTPOSITIONS=0x2000000,ENM_SCROLL=0x4,ENM_UPDATE=0x2   ***</span>
       <span class="p">,</span> <span class="n">sEvents</span><span class="o">=</span><span class="s">&quot;CHANGE,DRAGDROPDONE,DROPFILES,KEYEVENTS,LINK,MOUSEEVENTS,PROTECTED,REQUESTRESIZE,SCROLLEVENTS,SELCHANGE,SCROLL&quot;</span>
	   <span class="p">,</span> <span class="n">WM_NOTIFY</span><span class="o">=</span><span class="mh">0x4E</span><span class="p">,</span><span class="n">WM_COMMAND</span><span class="o">=</span><span class="mh">0x111</span><span class="p">,</span><span class="n">EM_SETEVENTMASK</span><span class="o">=</span><span class="mi">1093</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="n">oldCOMMAND</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Handler</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">WM_NOTIFY</span><span class="p">,</span> <span class="n">old</span> <span class="o">!=</span> <span class="s">&quot;RichEdit_onNotify&quot;</span> <span class="o">?</span> <span class="n">old</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">),</span> <span class="n">old</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>

	<span class="n">if</span> <span class="o">!</span><span class="nf">IsFunc</span><span class="p">(</span><span class="n">Handler</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid handler: &quot;</span> <span class="n">Handler</span>

	<span class="n">hMask</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Events</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">IfEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nv">%sEvents%</span>
<span class="w">			</span><span class="nb">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid event: &quot;</span> <span class="nv">A_LoopField</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="n">ENM_</span><span class="nv">%A_LOOPFIELD%</span>
		<span class="n">If</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;DROPFILES&quot;</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;shell32.dll\DragAcceptFiles&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="nv">true</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">		 ; 		if A_LoopField in CHANGE,SCROLL   ; (*** WIP)</span>
<span class="c-Singleline">		 ;     	if !oldCOMMAND {</span>
<span class="c-Singleline">		 ;     		oldCOMMAND := OnMessage(WM_COMMAND, &quot;RichEdit_onNotify&quot;)</span>
<span class="c-Singleline">		 ;     		if oldCOMMAND != RichEdit_onNotify</span>
<span class="c-Singleline">		 ;     			RichEdit(&quot;oldCOMMAND&quot;, RegisterCallback(oldCOMMAND))</span>
<span class="c-Singleline">		 ;     	}</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">oldNotify</span> <span class="p">{</span>
		<span class="n">oldNotify</span> <span class="o">:=</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">WM_NOTIFY</span><span class="p">,</span> <span class="s">&quot;RichEdit_onNotify&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">if </span><span class="n">oldNotify</span> <span class="o">!=</span> <span class="n">RichEdit_onNotify</span>
			<span class="n">RichEdit</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">,</span> <span class="nf">RegisterCallback</span><span class="p">(</span><span class="n">oldNotify</span><span class="p">))</span>
	<span class="p">}</span>

	<span class="n">RichEdit</span><span class="p">(</span><span class="n">hCtrl</span> <span class="s">&quot;Handler&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETEVENTMASK</span><span class="p">,,</span><span class="n">hMask</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span><span class="c-Singleline">  ; This message returns the previous event mask</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetFontSize</span>
<span class="cm">			Sets the font size for the selected text in the rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Add - Change in point size of the selected text. The change is applied to</span>
<span class="cm">					each part of the selection. So, if some of the text is 10pt and some 20pt,</span>
<span class="cm">					after a call with wParam set to 1, the font sizes become 11pt and 22pt, respectively.</span>
<span class="cm">					</span>
<span class="cm"> Returns:</span>
<span class="cm">			True if no error occurred, false otherwise.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetFontSize</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Add</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETFONTSIZE</span><span class="o">=</span><span class="mh">0x4DF</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETFONTSIZE</span><span class="p">,</span><span class="n">Add</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLEvel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function: SetModify</span>
<span class="cm">      Sets or clears the modification flag for an edit control. The modification flag indicates</span>
<span class="cm">      whether the text within the edit control has been modified.</span>

<span class="cm">  Related:</span>
<span class="cm">      &lt;GetModify&gt;, &lt;Save&gt;</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetModify</span><span class="p">(</span><span class="n">hEdit</span><span class="p">,</span> <span class="n">State</span><span class="o">=</span><span class="nv">true</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">Static</span> <span class="n">EM_SETMODIFY</span> <span class="o">=</span> <span class="mi">185</span>
<span class="w">  </span><span class="nb">SendMessage</span> <span class="n">EM_SETMODIFY</span><span class="p">,</span><span class="nv">%State%</span><span class="p">,,,</span><span class="n">ahk_id</span> <span class="nv">%hEdit%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetOptions</span>
<span class="cm">			Sets the options for a rich edit control.</span>


<span class="cm"> Parameters:</span>
<span class="cm">			Operation	- Specifies the operation.</span>
<span class="cm">			Options		- White separted list of option values.</span>

<span class="cm"> Operation:</span>
<span class="cm">			SET - Sets the options to those specified by Options.</span>
<span class="cm">			OR  - Combines the specified options with the current options.</span>
<span class="cm">			AND - Retains only those current options that are also specified by Options.</span>
<span class="cm">			XOR - Logically exclusive OR the current options with those specified by Options.</span>

<span class="cm"> Options:</span>
<span class="cm">			AUTOWORDSELECTION - Automatic selection of word on double-click.</span>
<span class="cm">			AUTOVSCROLL - Same as AUTOVSCROLL style.</span>
<span class="cm">			AUTOHSCROLL - Same as AUTOHSCROLL style.</span>
<span class="cm">			NOHIDESEL - Same as NOHIDESEL style.</span>
<span class="cm">			READONLY - Same as READONLY style.</span>
<span class="cm">			WANTRETURN - Same as WANTRETURN style.</span>
<span class="cm">			SELECTIONBAR - Same as SELECTIONBAR style.</span>
<span class="cm"> Returns:</span>
<span class="cm">			Returns the current options of the edit control.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetOptions</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Operation</span><span class="p">,</span> <span class="n">Options</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETOPTIONS</span><span class="o">=</span><span class="mi">1101</span>
		<span class="p">,</span> <span class="n">ECOOP_SET</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="n">ECOOP_OR</span><span class="o">=</span><span class="mh">0x2</span><span class="p">,</span><span class="n">ECOOP_AND</span><span class="o">=</span><span class="mh">0x3</span><span class="p">,</span><span class="n">ECOOP_XOR</span><span class="o">=</span><span class="mh">0x4</span>
		<span class="p">,</span> <span class="n">ECO_AUTOWORDSELECTION</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="n">ECO_AUTOVSCROLL</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span><span class="n">ECO_AUTOHSCROLL</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span><span class="n">ECO_NOHIDESEL</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span><span class="n">ECO_READONLY</span><span class="o">=</span><span class="mh">0x800</span><span class="p">,</span><span class="n">ECO_WANTRETURN</span><span class="o">=</span><span class="mh">0x1000</span><span class="p">,</span><span class="n">ECO_SELECTIONBAR</span><span class="o">=</span><span class="mh">0x1000000</span>

	<span class="n">operation</span> <span class="o">:=</span> <span class="n">ECOOP_</span><span class="nv">%Operation%</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">operation</span><span class="p">,,</span><span class="n">return</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Invalid operation: &quot;</span> <span class="n">Operation</span>

	<span class="n">hOptions</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Options</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span><span class="p">,</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">hOptions</span> <span class="o">|=</span> <span class="n">ECO_</span><span class="nv">%A_LOOPFIELD%</span>

<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETOPTIONS</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">hOptions</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">RichEdit_GetOptions</span><span class="p">(</span> <span class="s">&quot;.&quot;</span> <span class="nv">ErrorLevel</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	PageRotate</span>
<span class="cm">			Rotate page.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm">		    R	- Can be one of the following: 0,90,180,270. </span>

<span class="cm"> Returns:</span>
<span class="cm">			If R is omitted, functin returns current rotation.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_PageRotate</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETPAGEROTATE</span><span class="o">=</span><span class="mi">1260</span><span class="p">,</span> <span class="n">EM_GETPAGEROTATE</span><span class="o">=</span><span class="mi">1259</span><span class="p">,</span> <span class="n">EPR_270</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">EPR_180</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">EPR_90</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="mi">2</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="mi">3</span><span class="o">=</span><span class="mi">90</span>
	
	<span class="n">if</span> <span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> 
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETPAGEROTATE</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">		</span><span class="nb">return</span> <span class="p">(</span><span class="nv">%ErrorLevel%</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETPAGEROTATE</span><span class="p">,</span><span class="n">EPR_</span><span class="nv">%R%</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetParaFormat</span>
<span class="cm">			Sets the paragraph formatting for the current selection in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			o1..o6	- Named arguments: Num, Align, Line, Ident, Space, Tabs. Each named arugment has its own set of</span>
<span class="cm">					  parameters (delimited by comma). The syntax is &quot;Name=a1,a2,a3,a4&quot;.</span>

<span class="cm"> *Num* :</span>

<span class="cm">			Type	- EMPTY, BULLET, DECIMAL, LOWER, UPPER, ROMAN_LOWER, ROMAN_UPPER, SEQUENCE (Uses a sequence of characters beginning with the character specified by the start argument).</span>
<span class="cm">			Start	- Starting number or starting value used for numbered paragraphs.</span>
<span class="cm">			Style	- One of the following :</span>
<span class="cm">					  o RP   - Follows the number with a right parenthesis.</span>
<span class="cm">					  o P	 - Encloses the number in parentheses.</span>
<span class="cm">					  o D	 - Follows the number with a dot.</span>
<span class="cm">					  o N	 - Displays only the number.</span>
<span class="cm">					  o CONT - Continues a numbered list without applying the next number or bullet.</span>
<span class="cm">					  o NEW  - Starts a new number with value of *Start* parameter.</span>
<span class="cm">			Offset	- Minimum space between a paragraph number and the paragraph text, in twips.</span>

<span class="cm"> *Align* :</span>

<span class="cm">			Type	- CENTER, LEFT, RIGHT, JUSTIFY.</span>

<span class="cm"> *Line* :</span>

<span class="cm">			Rule	- One of the following :</span>
<span class="cm">					  o SINGLE	 - Single spacing.</span>
<span class="cm">					  o 1ANDHALF - One-and-a-half spacing.</span>
<span class="cm">					  o DOUBLE	 - Double spacing.</span>
<span class="cm">					  o S1		 - The Spacing specifies the spacing from one line to the next, in twips. However, if Spacing specifies a value that is less than single spacing, the control displays single-spaced text.</span>
<span class="cm">					  o S2		 - The Spacing specifies the spacing from one line to the next, in twips. The control uses the exact spacing specified, even if Spacing specifies a value that is less than single spacing.</span>
<span class="cm">					  o S3		 - The value of Spacing/20 is the spacing, in lines, from one line to the next. Thus, setting Spacing to 20 produces single-spaced text, 40 is double spaced, 60 is triple spaced, and so on.</span>
<span class="cm">			Spacing - Spacing between lines. This value is valid only for S1-S3 Rules.</span>

<span class="cm"> *Ident* :</span>

<span class="cm"> 			First	- Indentation of the paragraph&#39;s first line, relative to the paragraph&#39;s current indentation, in twips.</span>
<span class="cm">					  The indentation of subsequent lines depends on the Offset member.  To see all this in effect you must enable word wrap mode.</span>
<span class="cm">					  If starts with &quot;.&quot;, it represents absolute indentation from the left margin.</span>
<span class="cm">			Offset	- Indentation of the second and subsequent lines, relative to the indentation of the first line, in twips.</span>
<span class="cm">					  The first line is indented if this member is negative or outdented if this member is positive.</span>
<span class="cm">			Right	- Indentation of the right side of the paragraph, relative to the right margin, in twips.</span>

<span class="cm"> *Space* :</span>

<span class="cm">			Before	- Size of the spacing above the paragraph, in twips.</span>
<span class="cm">			After	- Specifies the size of the spacing below the paragraph, in twips.</span>

<span class="cm"> *Tabs* :</span>

<span class="cm">			List	- Space separated list of absolute tab stop positions in twips.</span>

<span class="cm"> Returns:</span>
<span class="cm">			True if succeessiful, false otherwise.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			Control uses carriage return character (`r) for paragraph markers by default.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetParaFormat</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">	;S(_, &quot;PARAFORMAT2: cbSize dwMask wNumbering=.2 wEffects=.2 dxStartIndent=.04 dxRightIndent=.04 dxOffset=.04 wAlignment=.02 cTabCount dySpaceBefore=156.04 dySpaceAfter=.04 dyLineSpacing=.04 sStyle=.02 bLineSpacingRule=.1 bOutlineLevel=.1 wShadingWeight=.2 wShadingStyle=.2 wNumberingStart=.2 wNumberingStyle=.2 wNumberingTab=.2 wBorderSpace=.2 wBorderWidth=.2 wBorders=.2&quot;)</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETPARAFORMAT</span><span class="o">=</span><span class="mh">0x447</span>
		<span class="p">,</span><span class="n">PFM_ALIGNMENT</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">PFM_BORDER</span><span class="o">=</span><span class="mh">0x800</span><span class="p">,</span> <span class="n">PFM_BOX</span><span class="o">=</span><span class="mh">0x4000000</span><span class="p">,</span> <span class="n">PFM_COLLAPSED</span><span class="o">=</span><span class="mh">0x1000000</span><span class="p">,</span> <span class="n">PFM_DONOTHYPHEN</span><span class="o">=</span><span class="mh">0x400000</span><span class="p">,</span> <span class="n">PFM_KEEP</span><span class="o">=</span><span class="mh">0x20000</span><span class="p">,</span> <span class="n">PFM_KEEPNEXT</span><span class="o">=</span><span class="mh">0x40000</span><span class="p">,</span> <span class="n">PFM_LINESPACING</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">PFM_NOLINENUMBER</span><span class="o">=</span><span class="mh">0x100000</span><span class="p">,</span> <span class="n">PFM_NOWIDOWCONTROL</span><span class="o">=</span><span class="mh">0x200000</span><span class="p">,</span> <span class="n">PFM_NUMBERING</span><span class="o">=</span><span class="mh">0x20</span>
		<span class="p">,</span><span class="n">PFM_NUMBERINGSTART</span><span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span> <span class="n">PFM_NUMBERINGSTYLE</span><span class="o">=</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">PFM_NUMBERINGTAB</span><span class="o">=</span><span class="mh">0x4000</span><span class="p">,</span> <span class="n">PFM_OFFSET</span><span class="o">=</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">PFM_OFFSETINDENT</span><span class="o">=</span><span class="mh">0x80000000</span><span class="p">,</span> <span class="n">PFM_OUTLINELEVEL</span><span class="o">=</span><span class="mh">0x2000000</span><span class="p">,</span> <span class="n">PFM_PAGEBREAKBEFORE</span><span class="o">=</span><span class="mh">0x80000</span><span class="p">,</span> <span class="n">PFM_RIGHTINDENT</span><span class="o">=</span><span class="mh">0x2</span><span class="p">,</span> <span class="n">PFM_RTLPARA</span><span class="o">=</span><span class="mh">0x10000</span><span class="p">,</span> <span class="n">PFM_SHADING</span><span class="o">=</span><span class="mh">0x1000</span>
		<span class="p">,</span><span class="n">PFM_SIDEBYSIDE</span><span class="o">=</span><span class="mh">0x800000</span><span class="p">,</span> <span class="n">PFM_SPACEAFTER</span><span class="o">=</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">PFM_SPACEBEFORE</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">PFM_STARTINDENT</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span> <span class="n">PFM_STYLE</span><span class="o">=</span><span class="mh">0x400</span><span class="p">,</span><span class="n">PFM_TABLE</span><span class="o">=</span><span class="mh">0x40000000</span><span class="p">,</span> <span class="n">PFM_TABSTOPS</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">PFN_BULLET</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span> <span class="n">PFN_LCLETTER</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">PFN_LCROMAN</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">PFN_UCLETTER</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">PFN_UCROMAN</span><span class="o">=</span><span class="mi">6</span>

<span class="w">	</span><span class="nb">static</span> <span class="n">ALIGN_CENTER</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ALIGN_LEFT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ALIGN_RIGHT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ALIGN_JUSTIFY</span><span class="o">=</span><span class="mi">4</span>
		  <span class="p">,</span><span class="n">NUM_TYPE_BULLET</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_TYPE_DECIMAL</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NUM_TYPE_LOWER</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">NUM_TYPE_UPPER</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">NUM_TYPE_ROMAN_LOWER</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">NUM_TYPE_ROMAN_UPPER</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NUM_TYPE_SEQUENCE</span><span class="o">=</span><span class="mi">7</span>
		  <span class="p">,</span><span class="n">NUM_STYLE_P</span><span class="o">=</span><span class="mh">0X100</span><span class="p">,</span> <span class="n">NUM_STYLE_D</span><span class="o">=</span><span class="mh">0X200</span><span class="p">,</span> <span class="n">NUM_STYLE_N</span><span class="o">=</span><span class="mh">0X300</span><span class="p">,</span> <span class="n">NUM_STYLE_CONT</span><span class="o">=</span><span class="mh">0X400</span><span class="p">,</span> <span class="n">NUM_STYLE_NEW</span><span class="o">=</span><span class="mh">0X800</span>
		  <span class="p">,</span><span class="n">LINE_RULE_SINGLE</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">LINE_RULE_1ANDHALF</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LINE_RULE_DOUBLE</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">LINE_RULE_S1</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">LINE_RULE_S2</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">LINE_RULE_S3</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>

<span class="w">	</span><span class="nb">loop</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">o</span><span class="nv">%A_Index%</span><span class="p">,,</span><span class="n">break</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">j</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span> <span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="s">&quot;=&quot;</span> <span class="p">),</span> <span class="n">p</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span> <span class="p">),</span> <span class="n">v</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span> <span class="n">o</span><span class="nv">%A_index%</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="nv">%p%</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="se">`,</span>
	<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask wAlignment&quot;, sz, PFM_ALIGNMENT, PFA_RIGHT)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PF</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">188</span><span class="p">,</span> <span class="n">PF</span><span class="p">),</span>  <span class="n">hMask</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Align0</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_ALIGNMENT</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">ALIGN_</span><span class="nv">%Align1%</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask wNumbering wNumberingStart wNumberingStyle wNumberingTab&quot;, sz, pm := PFM_NUMBERING | PFM_NUMBERINGSTART | PFM_NUMBERINGSTYLE | PFM_NUMBERINGTAB, p1:=2, p2:=10, p3:=0x200, p4:=20*50)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Num0</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_NUMBERING</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">NUM_TYPE_</span><span class="nv">%Num1%</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">)</span>
		<span class="p">,</span> <span class="p">(</span><span class="n">Num2</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_NUMBERINGSTART</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Num2</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">))</span>
		<span class="p">,</span> <span class="p">(</span><span class="n">Num3</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_NUMBERINGSTYLE</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">NUM_STYLE_</span><span class="nv">%Num3%</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">))</span>
		<span class="p">,</span> <span class="p">(</span><span class="n">Num4</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_NUMBERINGTAB</span><span class="p">,</span>    <span class="nf">NumPut</span><span class="p">(</span><span class="n">Num4</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">))</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask bLineSpacingRule dyLineSpacing&quot;, sz, PFM_LINESPACING, x:=4, y:=20*50)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Line0</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_LINESPACING</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">LINE_RULE_</span><span class="nv">%Line1%</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="s">&quot;UChar&quot;</span><span class="p">),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Line2</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask dxOffset dxStartIndent dxRightIndent&quot;, sz, p:=PFM_OFFSET | PFM_OFFSETINDENT | PFM_RIGHTINDENT, x:=-20*50, y:=20*50, z=x:=20*50)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Ident0</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="mi">0</span><span class="c-Singleline">	;dummy, expression so that bellow works....</span>
		<span class="p">,(</span><span class="n">Ident1</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Ident1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">!=</span><span class="s">&quot;.&quot;</span> <span class="o">?</span> <span class="n">PFM_OFFSETINDENT</span> <span class="o">:</span> <span class="p">(</span><span class="n">PFM_STARTINDENT</span><span class="p">,</span> <span class="n">Ident1</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Ident1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Ident1</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">))</span>
		<span class="p">,(</span><span class="n">Ident2</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_OFFSET</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Ident2</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">))</span>
		<span class="p">,(</span><span class="n">Ident3</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_RIGHTINDENT</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Ident3</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">))</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask dySpaceAfter dySpaceBefore&quot;, sz, p:=PFM_SPACEAFTER | PFM_SPACEBEFORE, x:=20*50, y:=10*50)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Space0</span>
		<span class="n">hMask</span> <span class="o">|=</span> <span class="mi">0</span>
		<span class="p">,(</span><span class="n">Space1</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_SPACEBEFORE</span><span class="p">,</span>  <span class="nf">NumPut</span><span class="p">(</span><span class="n">Space1</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">))</span>
		<span class="p">,(</span><span class="n">Space2</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_SPACEAFTER</span><span class="p">,</span>   <span class="nf">NumPut</span><span class="p">(</span><span class="n">Space2</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">))</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask cTabCount rgxTabs&quot;, sz, PFM_TABSTOPS, x:=2)		;put 2 tabstops</span>
<span class="c-Singleline">	;NumPut(20*50, PF, 28+0, &quot;Int&quot;), NumPut(20*250, PF, 28+4, &quot;Int&quot;)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Tabs0</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Tabs1</span><span class="p">,</span> <span class="nv">%A_Space%%A_Tab%</span>
			<span class="nf">NumPut</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">24</span><span class="o">+</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="n">tabCount</span> <span class="o">:=</span> <span class="nv">A_Index</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">tabCount</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span>  <span class="n">hMask</span> <span class="o">|=</span> <span class="n">PFM_TABSTOPS</span>
	<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">	;S(PF, &quot;PARAFORMAT2! cbSize dwMask wBorders wBorderWidth&quot;, sz, PFM_BORDER, x:=64, y:=20*5 )	;!!! does not work</span>

    <span class="nf">NumPut</span><span class="p">(</span><span class="n">hMask</span><span class="p">,</span> <span class="n">PF</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c-Singleline">   ; HexView(&amp;PF, sz)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETPARAFORMAT</span><span class="p">,,</span><span class="o">&amp;</span><span class="n">PF</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetEditStyle</span>
<span class="cm">			Sets the current edit style flags.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Style - One of the styles bellow. Prepend &quot;-&quot; to turn the style off.</span>

<span class="cm"> Styles:</span>
<span class="cm">			EMULATESYSEDIT	- When this bit is on, rich edit attempts to emulate the system edit control.</span>
<span class="cm">			BEEPONMAXTEXT	- Rich Edit will call the system beeper if the user attempts to enter more than the maximum characters.</span>
<span class="cm">			EXTENDBACKCOLOR	- Extends the background color all the way to the edges of the client rectangle.</span>
<span class="cm">			USEAIMM			- Uses the AIMM input method component that ships with Microsoft Internet Explorer 4.0 or later.</span>
<span class="cm">			UPPERCASE		- Converts all input characters to uppercase.</span>
<span class="cm">			LOWERCASE		- Converts all input characters to lowercase.</span>
<span class="cm">			XLTCRCRLFTOCR	- Turns on translation of CRCRLFs to CRs. When this bit is on and a file is read in, all instances of CRCRLF will be converted to hard CRs internally. This will affect the text wrapping. Note that if such a file is saved as plain text, the CRs will be replaced by CRLFs. This is the .txt standard for plain text.</span>
<span class="cm">			SCROLLONKILLFOCUS - When KillFocus occurs, scroll to the beginning of the text.</span>

<span class="cm"> Returns:</span>
<span class="cm">			State of the edit style flags after rich edit has attempted to implement your edit style changes (number).</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetEditStyle</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Style</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETEDITSTYLE</span><span class="o">=</span><span class="mh">0x4CC</span>
		   <span class="p">,</span><span class="n">SES_UPPERCASE</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">SES_LOWERCASE</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">SES_XLTCRCRLFTOCR</span><span class="o">=</span><span class="mi">16384</span><span class="p">,</span> <span class="n">SES_EXTENDBACKCOLOR</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">SES_BEEPONMAXTEXT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">SES_EMULATESYSEDIT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">SES_USEAIMM</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">SES_SCROLLONKILLFOCUS</span><span class="o">=</span><span class="mi">8192</span>

<span class="w">	</span><span class="nb">if </span><span class="n">bOff</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">Style</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span><span class="p">)</span>
		<span class="n">Style</span> <span class="o">:=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Style</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETEDITSTYLE</span><span class="p">,</span> <span class="n">bOff</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">SES_</span><span class="nv">%Style%</span><span class="p">,</span> <span class="n">SES_</span><span class="nv">%Style%</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  SetSel</span>
<span class="cm">			Selects a range of characters or Component Object Model (COM) objects in a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			CpMin -	Beginning of range of characters to select.</span>
<span class="cm">			CpMax -	End of range of characters to select.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			If the *cpMin* and *cpMax* members are equal, or *cpMax* is omitted, the cursor will be moved to</span>
<span class="cm">			*cpMin*&#39;s position.  The range includes everything if *cpMin* is 0 and *cpMax* is Â–1.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The selection that is actually set.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;HideSelection&gt;, &lt;SetText&gt;, &lt;GetSel&gt;, &lt;GetText&gt;, &lt;GetTextLength&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  RichEdit_SetSel( hRichEdit, 4, 10 ) ; select range</span>
<span class="cm">  RichEdit_SetSel( hRichEdit, 2 )     ; move cursor to right of 2nd character</span>
<span class="cm">  RichEdit_SetSel( hRichEdit, 0, -1 ) ; select all</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetSel</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">CpMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CpMax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_EXSETSEL</span><span class="o">=</span><span class="mi">1079</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">cpMin</span><span class="p">,</span> <span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">cpMax</span> <span class="o">?</span> <span class="n">cpMax</span> <span class="o">:</span> <span class="n">cpMin</span><span class="p">,</span> <span class="n">CHARRANGE</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_EXSETSEL</span><span class="p">,</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">CHARRANGE</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	SetText</span>
<span class="cm">			Set text from string or file in rich edit control using either rich text or plain text.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Txt		- The text string to set within control. To set RTF mark-up the Txt must be prefixed with &quot;{rtf&quot;.</span>
<span class="cm">			Flag	- Space separated list of options.  See below list.</span>
<span class="cm">			Pos		- This optional parameter allows you to specify a character position you want text inserted to,</span>
<span class="cm">					  rather than replacing current selection. To append to the end, use -1.</span>
<span class="cm">					  When using SELECTION flag, the position is relative to the current selection text and current selection is expanded to</span>
<span class="cm">					  contain new text. If used without SELECTION flag existing selection remains unafected.</span>

<span class="cm"> Flags:</span>
<span class="cm">			DEFAULT		- Deletes the undo stack, discards rich-text formatting, &amp; replaces all text.</span>
<span class="cm">			KEEPUNDO	- Keeps the undo stack.</span>
<span class="cm">			SELECTION	- Replaces selection and keeps rich-text formatting. If you don&#39;t specify this style entire content of</span>
<span class="cm">						  the control will be replaced with the new text.</span>
<span class="cm">			FROMFILE	- Load a file into control.  If used, this option expects the *txt* parameter to be</span>
<span class="cm">						  a filename. If there is a problem loading the file, *ErrorLevel* will contain message.</span>

<span class="cm"> Returns:</span>
<span class="cm">		If the operation is setting all of the text and succeeds, the return value is 1.</span>
<span class="cm">		If the operation fails, the return value is zero.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;SetSel&gt;, &lt;GetText&gt;, &lt;GetSel&gt;, &lt;TextMode&gt;</span>

<span class="cm"> Example:</span>
<span class="cm"> (start code)</span>
<span class="cm">  FileSelectFile, file,,, Select file, RTF(*.rtf; *.txt)</span>
<span class="cm">  RichEdit_SetText(hRichEdit, file, &quot;FROMFILE KEEPUNDO&quot;)</span>

<span class="cm">  RichEdit_SetText(hRichEdit, &quot;insert..&quot;, &quot;SELECTION&quot;)</span>

<span class="cm">  RichEdit_SetText(hRichEdit, &quot;replace all..&quot;)</span>

<span class="cm">  RichEdit_SetText(hRichEdit, &quot;append to end of selection..&quot;, &quot;SELECTION&quot;, -1 )</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetText</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Txt</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Flag</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Pos</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETTEXTEX</span><span class="o">=</span><span class="mh">0x461</span><span class="p">,</span> <span class="n">ST_KEEPUNDO</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ST_SELECTION</span><span class="o">=</span><span class="mi">2</span>

	<span class="n">hFlag</span><span class="o">=</span><span class="mi">0</span>
<span class="w">	</span><span class="nb">If </span><span class="n">Flag</span>
<span class="w">  		</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Flag</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
			<span class="n">If</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;FROMFILE&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">			</span><span class="nb">FileRead</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="nv">%Txt%</span>
<span class="w">			</span><span class="nb">IfNotEqual</span><span class="p">,</span> <span class="nv">Errorlevel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="nv">false</span><span class="p">,</span> <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Couldn&#39;t open file: &#39;&quot;</span> <span class="n">Txt</span> <span class="s">&quot;&#39;&quot;</span>
		<span class="p">}</span> <span class="n">else</span> <span class="n">if</span> <span class="nv">A_LoopField</span> <span class="ow">in</span> <span class="n">KEEPUNDO</span><span class="p">,</span><span class="n">SELECTION</span>
			<span class="n">hFlag</span> <span class="o">|=</span> <span class="n">ST_</span><span class="nv">%A_LoopField%</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ; If specifying a pos, calculate new range for restoring original selection</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">hFlag</span> <span class="o">&gt;=</span> <span class="n">ST_SELECTION</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">RichEdit_GetSel</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">)</span>
<span class="w">			</span><span class="nb">ifLess</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="mi">0</span>
<span class="w">			</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&gt;</span> <span class="n">max</span><span class="o">-</span><span class="n">min</span><span class="p">)</span>
				<span class="n">Pos</span> <span class="o">:=</span> <span class="n">max</span><span class="o">-</span><span class="n">min</span>

<span class="w">			</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%max%</span>
<span class="w">			</span><span class="nb">else</span> <span class="n">Pos</span> <span class="o">+=</span> <span class="n">min</span>

			<span class="n">prevPos</span> <span class="o">:=</span> <span class="n">RichEdit_SetSel</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Pos</span><span class="p">)</span>
			<span class="n">max</span> <span class="o">+=</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Txt</span><span class="p">)</span>
		<span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
			<span class="n">hFlag</span> <span class="o">|=</span> <span class="n">ST_SELECTION</span><span class="p">,</span> <span class="n">len</span> <span class="o">:=</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Txt</span><span class="p">)</span>
			<span class="n">RichEdit_GetSel</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">)</span>
			<span class="n">prevPos</span> <span class="o">:=</span> <span class="n">RichEdit_SetSel</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Pos</span><span class="p">)</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&lt;</span> <span class="n">min</span><span class="p">)</span>
				<span class="n">min</span> <span class="o">+=</span> <span class="n">len</span><span class="p">,</span> <span class="n">max</span> <span class="o">+=</span> <span class="n">len</span>
<span class="w">			</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&gt;=</span> <span class="n">min</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Pos</span> <span class="o">&lt;</span> <span class="n">max</span><span class="p">)</span>
				<span class="n">max</span> <span class="o">+=</span> <span class="n">len</span>
		<span class="p">}</span>

	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">SETTEXTEX</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">hFlag</span><span class="p">,</span> <span class="n">SETTEXTEX</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SETTEXTEX</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c-Singleline">		  ;The code page is used to translate the text to Unicode. If codepage is 1200 (Unicode code page),</span>
<span class="c-Singleline">								  ; no translation is done. If codepage is CP_ACP (0), the system code page is used.</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETTEXTEX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SETTEXTEX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Txt</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span><span class="p">,</span> <span class="n">prevPos</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">RichEdit_SetSel</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">)</span> <span class="o">:</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  SetUndoLimit</span>
<span class="cm">			Set the maximum number of actions that can stored in the undo queue of the rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			nMax - The maximum number of actions that can be stored in the undo queue.</span>

<span class="cm"> Returns:</span>
<span class="cm">			The return value is the new maximum number of undo actions for the rich edit control.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			By default, the maximum number of actions in the undo queue is 100. If you increase</span>
<span class="cm">			this number, there must be enough available memory to accommodate the new number.</span>
<span class="cm">			For better performance, set the limit to the smallest possible value needed.</span>

<span class="cm"> Related:</span>
<span class="cm">			&lt;Undo&gt;, &lt;GetUndo&gt;, &lt;Redo&gt;, &lt;GetRedo&gt;</span>

<span class="cm"> Example:</span>
<span class="cm">		&gt; MsgBox, % RichEdit_SetUndoLimit( hRichEdit, 5 )</span>
<span class="cm"> */</span>
<span class="n">RichEdit_SetUndoLimit</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">nMax</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETUNDOLIMIT</span><span class="o">=</span><span class="mi">82</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span>
<span class="w">	</span><span class="nb">if </span><span class="n">nMax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">integer</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">false</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_SETUNDOLIMIT</span><span class="p">,</span> <span class="nv">%nMax%</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:  ShowScrollBar</span>
<span class="cm">			Shows or hides scroll bars for Edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Bar - Identifies which scroll bar to display: horizontal or vertical. This parameter must be</span>
<span class="cm">				  &quot;*V*&quot;, &quot;*H*&quot;, or a combination of the two.</span>

<span class="cm">			State - True or false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">     This method is only valid when the control is in-place active. Calls made while the control is inactive may fail.</span>

<span class="cm"> Related:</span>
<span class="cm">     &lt;ScrollPos&gt;</span>

<span class="cm"> Example:</span>
<span class="cm">	 &gt; RichEdit_ShowScrollBar( hRichEdit, &quot;VH&quot;, false )</span>
<span class="cm">	 &gt; Sleep, 3000</span>
<span class="cm">	 &gt;</span>
<span class="cm">	 &gt; RichEdit_ShowScrollBar( hRichEdit, &quot;V&quot;, true )</span>
<span class="cm"> */</span>
<span class="n">RichEdit_ShowScrollBar</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Bar</span><span class="p">,</span> <span class="n">State</span><span class="o">=</span><span class="nv">true</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_SHOWSCROLLBAR</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span><span class="p">,</span><span class="n">SB_HORZ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">SB_VERT</span><span class="o">=</span><span class="mi">1</span>

	<span class="n">If</span> <span class="p">(</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">		</span><span class="nb">If </span><span class="nf">InStr</span><span class="p">(</span> <span class="n">Bar</span><span class="p">,</span> <span class="s">&quot;H&quot;</span> <span class="p">)</span>
<span class="w">			</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_SHOWSCROLLBAR</span><span class="p">,</span> <span class="n">SB_HORZ</span><span class="p">,</span> <span class="n">State</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">		</span><span class="nb">If </span><span class="nf">InStr</span><span class="p">(</span> <span class="n">Bar</span><span class="p">,</span> <span class="s">&quot;V&quot;</span> <span class="p">)</span>
<span class="w">			</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_SHOWSCROLLBAR</span><span class="p">,</span> <span class="n">SB_VERT</span><span class="p">,</span> <span class="n">State</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	TextMode</span>
<span class="cm">			Get or set the current text mode of a rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			TextMode - Space separated list of options (see below). If omitted, current text mode is returned.</span>

<span class="cm"> Options:</span>
<span class="cm">		Specify one of the following values to set the text mode parameter.</span>
<span class="cm">		If you don&#39;t specify a text mode value, the text mode remains at its current setting.</span>

<span class="cm">		PLAINTEXT		 - Indicates plain-text mode, in which the control is similar to a standard edit control.</span>
<span class="cm">		RICHTEXT		 - Indicates rich-text mode (default text mode).</span>

<span class="cm">		Specify one of the following values to set the undo level parameter. If you don&#39;t specify an undo level value, the undo level remains at its current setting.</span>

<span class="cm">		SINGLELEVELUNDO  - The control allows the user to undo only the last action in the undo queue.</span>
<span class="cm">		MULTILEVELUNDO	 - The control supports multiple undo actions (default undo mode).</span>
<span class="cm">						   Use &lt;SetUndoLimit&gt; to set the maximum number of undo actions.</span>

<span class="cm">		Specify one of the following values to set the code page parameter. If you don&#39;t specify an code page value, the code page remains at its current setting.</span>

<span class="cm">		SINGLECODEPAGE	 - The control only allows the English keyboard and a keyboard corresponding</span>
<span class="cm">						   to the default character set. For example, you could have Greek and</span>
<span class="cm">						   English. Note that this prevents Unicode text from entering the control.</span>
<span class="cm">						   For example, use this value if a rich edit control must be restricted to ANSI text.</span>
<span class="cm">		MULTICODEPAGE	 - The control allows multiple code pages and Unicode text into the control (default code page mode).</span>

<span class="cm"> Returns:</span>
<span class="cm">		If *TextMode* is omitted, the return value is the current text mode settings.</span>
<span class="cm">		When *TextMode* is given, function will return true or false.</span>

<span class="cm"> Remarks:</span>
<span class="cm">		The control text will be deleted when calling this function.</span>

<span class="cm">		In rich text mode, a rich edit control has standard rich edit functionality.</span>
<span class="cm">		However, in plain text mode, the control is similar to a standard edit control :</span>

<span class="cm">		- The text in a plain text control can have only one format (such as Bold, 10pt Arial).</span>
<span class="cm">		- The user cannot paste rich text formats, such as Rich Text Format (RTF) or embedded objects into a plain text control.</span>
<span class="cm">		- Rich text mode controls always have a default end-of-document marker or carriage return, to format paragraphs.</span>
<span class="cm">		- Plain text controls, on the other hand, do not need the default, end-of-document marker, so it is omitted.</span>

<span class="cm"> Related:</span>
<span class="cm">		&lt;SetUndoLimit&gt;</span>

<span class="cm"> Example:</span>
<span class="cm">	(start code)</span>
<span class="cm">	  MsgBox, % &quot;mode= &quot; RichEdit_TextMode(hRichEdit)</span>

<span class="cm">	  If RichEdit_TextMode( hRichEdit, &quot;PLAINTEXT SINGLELEVELUNDO&quot; )</span>
<span class="cm">			MsgBox, % &quot;new mode= &quot; RichEdit_TextMode(hRichEdit)</span>
<span class="cm">	  Else	MsgBox, % errorlevel</span>
<span class="cm">	(end code)</span>
<span class="cm"> */</span>
<span class="n">RichEdit_TextMode</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">TextMode</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_SETTEXTMODE</span><span class="o">=</span><span class="mh">0x459</span><span class="p">,</span> <span class="n">EM_GETTEXTMODE</span><span class="o">=</span><span class="mh">0x45A</span>
		<span class="p">,</span><span class="n">TM_PLAINTEXT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TM_RICHTEXT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TM_SINGLELEVELUNDO</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">TM_MULTILEVELUNDO</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">TM_SINGLECODEPAGE</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">TM_MULTICODEPAGE</span><span class="o">=</span><span class="mi">32</span>
		<span class="p">,</span><span class="n">TEXTMODES</span><span class="o">=</span><span class="s">&quot;MULTICODEPAGE,SINGLECODEPAGE,MULTILEVELUNDO,SINGLELEVELUNDO,RICHTEXT,PLAINTEXT&quot;</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">TextMode</span><span class="p">)</span>  <span class="p">{</span><span class="c-Singleline">    ; Setting text mode</span>
		<span class="n">hTextMode</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">		</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">TextMode</span><span class="p">,</span> <span class="nv">%A_Tab%%A_Space%</span>
<span class="w">			</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,,</span><span class="n">continue</span>
<span class="w">			</span><span class="nb">else</span> <span class="n">hTextMode</span> <span class="o">|=</span> <span class="n">TM_</span><span class="nv">%A_LOOPFIELD%</span>
<span class="w">	    </span><span class="nb">IfEqual</span><span class="p">,</span> <span class="n">hTextMode</span><span class="p">,,</span> <span class="n">return</span> <span class="nv">false</span><span class="p">,</span> <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="nv">A_ThisFunc</span> <span class="s">&quot;&gt; Some of the options are invalid: &quot;</span> <span class="n">TextMode</span>

		<span class="n">RichEdit_SetText</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">)</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETTEXTMODE</span><span class="p">,</span> <span class="n">hTextMode</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">Errorlevel</span> <span class="o">?</span> <span class="nv">False</span> <span class="o">:</span> <span class="nv">True</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>  <span class="p">{</span><span class="c-Singleline">				; Getting current text mode</span>
<span class="w">		</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_GETTEXTMODE</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%HCtrl%</span>
		<span class="n">tm</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span>
<span class="w">		</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">TEXTMODES</span><span class="p">,</span><span class="se">`,</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">TM_</span><span class="nv">%A_LoopField%</span> <span class="o">&amp;</span> <span class="n">tm</span><span class="p">)</span>
				<span class="n">res</span> <span class="o">.=</span> <span class="nv">A_LoopField</span> <span class="s">&quot; &quot;</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:		WordWrap</span>
<span class="cm">				Set word wrap mode in rich edit control.</span>

<span class="cm"> Parameters:</span>
<span class="cm">				Flag	- True or false.</span>

<span class="cm"> Returns:</span>
<span class="cm">				The return value is zero if the operation fails, or nonzero if it succeeds.</span>

<span class="cm"> */</span>
<span class="n">RichEdit_WordWrap</span><span class="p">(</span><span class="n">HCtrl</span><span class="p">,</span> <span class="n">Flag</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">EM_SETTARGETDEVICE</span><span class="o">=</span><span class="mh">0x448</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_SETTARGETDEVICE</span><span class="p">,,</span><span class="o">!</span><span class="n">Flag</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">	</span><span class="nb">return</span> <span class="nv">ErrorLevel</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Zoom</span>
<span class="cm">			Sets the zoom ratio anywhere between 1/64 and 64.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			zoom - Integer amount to increase or decrease zoom with *+* or *-* infront of it (see examples).</span>

<span class="cm"> Returns:</span>
<span class="cm">			If the new zoom setting is accepted, the return value is true.</span>
<span class="cm">			If the new zoom setting is not accepted, the return value is false.</span>
<span class="cm">			If *zoom* param is omitted, current numerator/denominator ratio is returned.</span>

<span class="cm"> Examples:</span>
<span class="cm"> &gt; Msgbox, % &quot;zoom ratio: &quot; RichEdit_Zoom( hRichEdit )</span>
<span class="cm"> &gt;</span>
<span class="cm"> &gt; #MaxHotkeysPerInterval 200</span>
<span class="cm"> &gt; #IfWinActive ahk_group RichEditGrp</span>
<span class="cm"> &gt; ^WheelUp::   RichEdit_Zoom( hRichEdit, +1 )</span>
<span class="cm"> &gt; ^WheelDown:: RichEdit_Zoom( hRichEdit, -1 )</span>
<span class="cm"> &gt; #IfWinActive</span>
<span class="cm"> */</span>
<span class="n">Richedit_Zoom</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_SETZOOM</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span><span class="n">EM_GETZOOM</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span><span class="n">WM_USER</span><span class="o">=</span><span class="mh">0x400</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ; Get the current zoom ratio</span>
  <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="p">,</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">denom</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_GETZOOM</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">numer</span><span class="p">,</span><span class="o">&amp;</span><span class="n">denom</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
  <span class="n">numerator</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">)</span><span class="c-Singleline"> ;, denominator := NumGet(denom, 0, &quot;UShort&quot;)</span>

<span class="w">  </span><span class="nb">If </span><span class="n">zoom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">integer</span>
<span class="w">    </span><span class="nb">return</span> <span class="nv">false</span><span class="p">,</span> <span class="nv">errorlevel</span> <span class="o">:=</span> <span class="s">&quot;ERROR: &#39;&quot;</span> <span class="n">zoom</span> <span class="s">&quot;&#39; is not an integer, stupid&quot;</span>
  <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">zoom</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">numerator</span> <span class="s">&quot;/&quot;</span> <span class="n">denominator</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ; Calculate new numerator value (denominator not currently changed)</span>
  <span class="nf">InStr</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span><span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="o">?</span>  <span class="n">numerator</span><span class="o">-=</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="o">:</span>  <span class="n">numerator</span><span class="o">+=</span><span class="n">zoom</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ; Set the zoom ratio</span>
<span class="w">  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">WM_USER</span> <span class="o">|</span> <span class="n">EM_SETZOOM</span><span class="p">,</span> <span class="nv">%numerator%</span><span class="p">,</span> <span class="mi">1</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">  </span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Undo</span>
<span class="cm">			Send message to Edit control to undo the next action in the control&#39;s undo queue &amp;</span>
<span class="cm">		  optionally empty the undo buffer by resetting the undo flag.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Reset - Set to true to clear the undo buffer rather than send undo command.</span>

<span class="cm"> Returns:</span>
<span class="cm">			For a single-line edit control, the return value is always true.</span>
<span class="cm">			For a multiline edit control, the return value is true if the undo operation is</span>
<span class="cm">			successful, or false if the undo operation fails, or your resetting the undo queue.</span>
<span class="cm"> */</span>
<span class="n">RichEdit_Undo</span><span class="p">(</span><span class="n">hCtrl</span><span class="p">,</span> <span class="n">Reset</span><span class="o">=</span><span class="nv">false</span><span class="p">)</span>  <span class="p">{</span>
<span class="w">  </span><span class="nb">static</span> <span class="n">EM_UNDO</span><span class="o">=</span><span class="mh">0xC7</span><span class="p">,</span><span class="n">EM_EMPTYUNDOBUFFER</span><span class="o">=</span><span class="mh">0xCD</span>
  <span class="n">If</span> <span class="o">!</span><span class="n">reset</span>  <span class="p">{</span>
<span class="w">    </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">EM_UNDO</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="w">    </span><span class="nb">return</span> <span class="nv">ERRORLEVEL</span>
  <span class="p">}</span> <span class="n">else</span> <span class="n">SendMessage</span><span class="p">,</span> <span class="n">EM_EMPTYUNDOBUFFER</span><span class="p">,,,,</span> <span class="n">ahk_id</span> <span class="nv">%hCtrl%</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;========================================== PRIVATE ===================================================================</span>

<span class="n">RichEdit_add2Form</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">Opt</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">parse</span> <span class="o">=</span> <span class="s">&quot;Form_Parse&quot;</span>
	<span class="nv">%parse%</span><span class="p">(</span><span class="n">Opt</span><span class="p">,</span> <span class="s">&quot;x# y# w# h# style&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
	<span class="n">hCtrl</span> <span class="o">:=</span> <span class="n">RichEdit_Add</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">Txt</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hCtrl</span>
<span class="p">}</span>


<span class="n">RichEdit_onNotify</span><span class="p">(</span><span class="n">Wparam</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MODULEID</span> <span class="o">:=</span> <span class="mo">091009</span><span class="p">,</span> <span class="n">oldNotify</span><span class="o">=</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="n">oldCOMMAND</span><span class="o">=</span><span class="s">&quot;*&quot;</span>
		  <span class="p">,</span><span class="n">ENM_PROTECTED</span><span class="o">=</span><span class="mi">1796</span><span class="p">,</span> <span class="n">ENM_REQUESTRESIZE</span><span class="o">=</span><span class="mi">1793</span><span class="p">,</span> <span class="n">ENM_SELCHANGE</span><span class="o">=</span><span class="mi">1794</span><span class="p">,</span> <span class="n">ENM_DROPFILES</span><span class="o">=</span><span class="mi">1795</span><span class="p">,</span> <span class="n">ENM_DRAGDROPDONE</span><span class="o">=</span><span class="mi">1804</span><span class="p">,</span> <span class="n">ENM_LINK</span><span class="o">=</span><span class="mi">1803</span>

<span class="w">	</span><span class="nb">critical</span><span class="c-Singleline">		;its OK, always executed in its own thread.</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">_</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">4</span><span class="p">)))</span> <span class="o">!=</span> <span class="n">MODULEID</span>
<span class="w">	 </span><span class="nb">ifLess</span> <span class="n">_</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">return</span><span class="c-Singleline">	;if ahk control, return asap (AHK increments control ID starting from 1. Custom controls use IDs &gt; 10000 as its unlikely that u will use more then 10K ahk controls.</span>
<span class="w">	 </span><span class="nb">else</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">%</span> <span class="n">RichEdit</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">if </span><span class="n">oldNotify</span> <span class="o">!=</span>
<span class="w">			 </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="n">oldNotify</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Wparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">return</span><span class="c-Singleline"></span>
<span class="c-Singleline">		;ifEqual, oldCOMMAND, *, SetEnv, oldCOMMAND, % RichEdit(&quot;oldCOMMAND&quot;)</span>
<span class="c-Singleline">		;if oldCOMMAND !=</span>
<span class="c-Singleline">		;	return DllCall(oldCOMMAND, &quot;uint&quot;, Wparam, &quot;uint&quot;, Lparam, &quot;uint&quot;, Msg, &quot;uint&quot;, Hwnd)</span>
	 <span class="p">}</span>

	<span class="n">hw</span> <span class="o">:=</span>  <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">0</span><span class="p">),</span> <span class="n">code</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">),</span>  <span class="n">handler</span> <span class="o">:=</span> <span class="n">RichEdit</span><span class="p">(</span><span class="n">hw</span> <span class="s">&quot;Handler&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">handler</span><span class="p">,,</span><span class="n">return</span> <span class="n">code</span><span class="o">=</span><span class="n">ENM_PROTECTED</span> <span class="o">?</span> <span class="nv">TRUE</span> <span class="o">:</span> <span class="nv">FALSE</span><span class="c-Singleline">  ;ENM_PROTECTED msg returns nonzero value to prevent operation</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="mi">1792</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline">					;ENM_MOUSEEVENTS ENM_KEYEVENTS ENM_SCROLLEVENTS</span>
<span class="w">		</span><span class="nb">static</span> <span class="mi">258</span><span class="o">=</span><span class="s">&quot;KEYPRESS_DWN&quot;</span><span class="p">,</span><span class="mi">513</span><span class="o">=</span><span class="s">&quot;MOUSE_L_DWN&quot;</span><span class="p">,</span><span class="mi">514</span><span class="o">=</span><span class="s">&quot;MOUSE_L_UP&quot;</span><span class="p">,</span><span class="mi">516</span><span class="o">=</span><span class="s">&quot;MOUSE_R_DWN&quot;</span><span class="p">,</span><span class="mi">517</span><span class="o">=</span><span class="s">&quot;MOUSE_R_UP&quot;</span><span class="p">,</span><span class="mi">522</span><span class="o">=</span><span class="s">&quot;SCROLL_BEGIN&quot;</span><span class="p">,</span><span class="mi">277</span><span class="o">=</span><span class="s">&quot;SCROLL_END&quot;</span><span class="c-Singleline"> ;,512=&quot;MOUSE_HOVER&quot;,256=&quot;KEYPRESS_UP&quot;</span>

		<span class="n">umsg</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span><span class="c-Singleline">		;Keyboard or mouse message identifier.</span>
		<span class="n">key</span> <span class="o">:=</span> <span class="p">((</span><span class="n">n</span><span class="o">:=</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">40</span><span class="p">))</span><span class="o">&gt;=</span><span class="mi">32</span><span class="p">)</span> <span class="o">?</span> <span class="nf">Chr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
		<span class="n">If</span> <span class="p">(</span><span class="nv">%umsg%</span><span class="p">)</span><span class="c-Singleline">   ;***</span>
<span class="w">			</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="nv">%Umsg%</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_REQUESTRESIZE</span><span class="p">)</span>  <span class="p">{</span>
		<span class="n">rc</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">24</span><span class="p">)</span><span class="c-Singleline"> ;Requested new size.</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;REQUESTRESIZE&quot;</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_SELCHANGE</span><span class="p">)</span>  <span class="p">{</span>
		<span class="n">cpMin</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="n">cpMax</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="n">selType</span> <span class="o">:=</span> <span class="n">RichEdit_SelectionType</span><span class="p">(</span><span class="o">-</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">20</span><span class="p">))</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;SELCHANGE&quot;</span><span class="p">,</span> <span class="n">cpMin</span><span class="p">,</span> <span class="n">cpMax</span><span class="p">,</span> <span class="n">seltype</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_DROPFILES</span><span class="p">)</span>  <span class="p">{</span><span class="c-Singleline">          ;</span>
		<span class="n">hDrop</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">),</span> <span class="n">cp</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span> <span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">		; (thanks DerRaphael!)  http://www.autohotkey.com/forum/post-234905.html&amp;highlight=#234905</span>
<span class="w">		</span><span class="nb">Loop</span><span class="p">,</span><span class="o">%</span> <span class="n">file_count</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;shell32.dll\DragQueryFile&quot;</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="n">hDrop</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">lpSzFile</span><span class="p">,</span><span class="mi">4096</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
		   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;shell32.dll\DragQueryFile&quot;</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="n">hDrop</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="nv">A_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">lpSzFile</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mi">4096</span><span class="p">)</span>
		   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">lpSzFile</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		   <span class="n">files</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">A_Index</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="n">lpSzFile</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;DROPFILES&quot;</span><span class="p">,</span> <span class="n">file_count</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_DRAGDROPDONE</span><span class="p">)</span>  <span class="p">{</span>
		<span class="n">chars</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="n">cpMax</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">16</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;DRAGDROPDONE&quot;</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">cpMax</span><span class="o">-</span><span class="n">chars</span><span class="p">,</span> <span class="n">cpMax</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_PROTECTED</span><span class="p">)</span>  <span class="p">{</span>
		<span class="n">cpMin</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="n">cpMax</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">28</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;PROTECTED&quot;</span><span class="p">,</span> <span class="n">cpMin</span><span class="p">,</span> <span class="n">cpMax</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="c-Singleline"> ; This message returns a nonzero value to prevent the operation.</span>
	<span class="p">}</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">code</span> <span class="o">=</span> <span class="n">ENM_LINK</span> <span class="p">)</span>  <span class="p">{</span>
		<span class="n">umsg</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span>
<span class="w">		</span><span class="nb">If </span><span class="n">umsg</span> <span class="n">Not</span> <span class="n">In</span> <span class="mi">513</span><span class="p">,</span><span class="mi">516</span>
<span class="w">			 </span><span class="nb">return</span>
		<span class="n">cpMin</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="n">cpMax</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">lparam</span><span class="o">+</span><span class="mi">28</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="s">&quot;LINK&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Umsg</span> <span class="o">=</span> <span class="mi">513</span> <span class="o">?</span> <span class="s">&quot;LClick&quot;</span> <span class="o">:</span> <span class="s">&quot;RClick&quot;</span><span class="p">),</span> <span class="n">cpMin</span><span class="p">,</span> <span class="n">cpMax</span><span class="p">)</span><span class="c-Singleline"> ; This message returns a nonzero value to prevent the operation.</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="n">RichEdit_wndProc</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">){</span>

   <span class="n">if</span> <span class="p">(</span><span class="n">uMsg</span> <span class="o">=</span> <span class="mh">0x87</span><span class="p">)</span><span class="c-Singleline">  ;WM_GETDLGCODE</span>
<span class="w">		</span><span class="nb">return</span> <span class="mi">4</span><span class="c-Singleline">	 ;DLGC_WANTALLKEYS</span>

<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CallWindowProcA&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="nv">A_EventInfo</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">hwnd</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">uMsg</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">lParam</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">RichEdit_editStreamCallBack</span><span class="p">(</span><span class="n">dwCookie</span><span class="p">,</span> <span class="n">pbBuff</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">pcb</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">s</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">dwCookie</span><span class="o">=</span><span class="s">&quot;!&quot;</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">fn</span> <span class="o">:=</span> <span class="n">pbBuff</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">fn</span><span class="p">,,</span> <span class="n">return</span> <span class="n">l</span> <span class="o">:=</span> <span class="n">s</span><span class="p">,</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nb">FileDelete</span><span class="p">,</span> <span class="nv">%fn%</span>
<span class="w">		</span><span class="nb">FileAppend</span><span class="p">,</span> <span class="nv">%s%</span><span class="p">,</span> <span class="nv">%fn%</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">if </span><span class="n">s</span> <span class="o">=</span>
		 <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">dwCookie</span><span class="p">)</span>

	<span class="n">s</span> <span class="o">.=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MulDiv&quot;</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">pbBuff</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;Mini storage</span>
<span class="n">RichEdit</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">&quot;~`a&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>
	 <span class="n">_</span> <span class="o">:=</span> <span class="nv">%var%</span>
<span class="w">	</span><span class="nb">ifNotEqual</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">~</span><span class="se">`a</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="nv">%var%</span><span class="p">,</span> <span class="nv">%value%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">_</span>
<span class="p">}</span>

<span class="cm">/* Group: About</span>
<span class="cm">	o Version 1.0b2 by freakkk &amp; majkinetor.</span>
<span class="cm">	o MSDN Reference : &lt;http://msdn.microsoft.com/en-us/library/bb787605(VS.85).aspx&gt;.</span>
<span class="cm">	o RichEdit control shortcut keys: &lt;http://msdn.microsoft.com/en-us/library/bb787873(VS.85).aspx#rich_edit_shortcut_keys&gt;.</span>
<span class="cm">	o Licensed under BSD &lt;http://creativecommons.org/licenses/BSD/&gt;.</span>
<span class="cm"> */</span>
</pre></div>
