<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="cm">/* Title:	HLink</span>
<span class="cm">			HyperLink control.</span>
<span class="cm">*/</span>

<span class="o">/*</span>
<span class="w">  </span>Function<span class="o">:</span><span class="w">		</span>Add
<span class="w"> 				</span>Creates<span class="w"> </span>hyperlink<span class="w"> </span><span class="k">control</span><span class="p">.</span>
<span class="w"> </span>
<span class="w">  </span>Parameters<span class="o">:</span><span class="w"> 	</span>
<span class="w"> 				</span>hGui<span class="w">	</span><span class="o">-</span><span class="w"> </span>Handle<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>parent<span class="w"> </span>GUI<span class="p">.</span>
<span class="w"> 				</span>X<span class="p">..</span>H<span class="w">	</span><span class="o">-</span><span class="w"> </span>Size<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>position<span class="p">.</span>
<span class="w">				</span>Handler<span class="w">	</span><span class="o">-</span><span class="w"> </span>Notification<span class="w"> </span>handler<span class="p">.</span><span class="w"> </span><span class="kr">If</span><span class="w"> </span>you<span class="w"> </span>omit<span class="w"> </span>handler<span class="p">,</span><span class="w"> </span>link<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>opened<span class="w"> </span>in<span class="w"> </span>default<span class="w"> </span>browser<span class="w"> </span>when<span class="w"> </span>clicked<span class="p">.</span>
<span class="w"> 				</span>Text<span class="w">	</span><span class="o">-</span><span class="w"> </span>Link<span class="w"> </span>text<span class="p">.</span><span class="w"> </span>Link<span class="w"> </span>is<span class="w"> </span>text<span class="w"> </span>between<span class="w"> </span>the<span class="w"> </span><span class="err">&#39;</span><span class="w"> </span>char<span class="w"> </span>followd<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span><span class="o">:</span><span class="w"> </span>char<span class="w"> </span><span class="kr">and</span><span class="w"> </span>location<span class="w"> </span><span class="p">(</span>as<span class="w"> </span>Textille<span class="w"> </span>mark<span class="o">-</span>up<span class="p">).</span>
<span class="w"> 						  </span>Everything<span class="w"> </span><span class="k">else</span><span class="w">  </span>will<span class="w"> </span>be<span class="w"> </span>displayed<span class="w"> </span>as<span class="w"> </span>ordinary<span class="w"> </span>text<span class="p">.</span>
<span class="w"> </span>
<span class="w">  </span>Notifications<span class="o">:</span>
<span class="w"> </span><span class="o">&gt;</span><span class="w">				</span>Result<span class="w"> </span><span class="o">:=</span><span class="w"> </span>OnLink<span class="p">(</span>hWnd<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>Link<span class="p">)</span>
<span class="w"> </span>
<span class="w"> 				</span>hWnd<span class="w">	</span><span class="o">-</span><span class="w"> </span>Handle<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>HLink<span class="w"> </span>control<span class="w"> </span>that<span class="w"> </span>generated<span class="w"> </span>notification<span class="p">.</span>
<span class="w"> 				</span>Text<span class="w">	</span><span class="o">-</span><span class="w"> </span>Text<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>control<span class="p">.</span>
<span class="w"> 				</span>Link<span class="w">	</span><span class="o">-</span><span class="w"> </span>Link<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>control<span class="p">.</span>

<span class="w">  </span><span class="nl">Returns:</span>
<span class="w">				</span>Handle<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span><span class="k">control</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>on<span class="w"> </span>failure<span class="p">.</span>
<span class="w">  </span>Example<span class="o">:</span>
<span class="w"> </span><span class="o">&gt;</span><span class="w">				</span>hLink<span class="w"> </span><span class="o">:=</span><span class="w"> </span>HLink_Add<span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="s">&quot;OnLink&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Click &#39;here&#39;:www.Google.com to go to Google&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span>X<span class="p">,</span><span class="w"> </span>Y<span class="p">,</span><span class="w"> </span>W<span class="p">,</span><span class="w"> </span>H<span class="p">,</span><span class="w"> </span>Handler<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Text<span class="o">=</span><span class="s">&quot;&#39;HLink Control&#39;:&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>MODULEID
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>ICC_LINK_CLASS<span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span><span class="w"> </span>WS_CHILD<span class="o">=</span><span class="mh">0x40000000</span><span class="p">,</span><span class="w"> </span>WS_VISIBLE<span class="o">=</span><span class="mh">0x10000000</span><span class="p">,</span><span class="w"> </span>WS_TABSTOP<span class="o">=</span><span class="mh">0x10000</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>id<span class="o">=</span><span class="mi">1</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>MODULEID<span class="w"> </span><span class="o">=</span>
<span class="w">	</span><span class="p">{</span><span class="w"> </span>
<span class="w">		</span>old<span class="w"> </span><span class="o">:=</span><span class="w"> </span>OnMessage<span class="p">(</span><span class="mh">0x4E</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;HLink_onNotify&quot;</span><span class="p">),</span><span class="w"> </span>MODULEID<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">170608</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>old<span class="w"> </span><span class="o">!=</span><span class="w"> </span>HLink_onNotify
<span class="w">			</span><span class="nf">HLink</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">,</span><span class="w"> </span>RegisterCallback<span class="p">(</span>old<span class="p">))</span>

<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>ICC<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>ICC<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;comctl32.dll\InitCommonControlsEx&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>ICC<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span>
<span class="w">	</span>Text<span class="w"> </span><span class="o">:=</span><span class="w"> </span>RegExReplace<span class="p">(</span>Text<span class="p">,</span><span class="w"> </span><span class="s">&quot;&#39;(.+?)&#39;\:([^ ]*)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&lt;a href=&quot;&quot;$2&quot;&quot;&gt;$1&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="w">	</span>hCtrl<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span>
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w">  </span><span class="s">&quot;SysLink&quot;</span>
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w">  </span>Text
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span>WS_CHILD<span class="w"> </span><span class="o">|</span><span class="w"> </span>WS_VISIBLE<span class="w"> </span><span class="o">|</span><span class="w"> </span>WS_TABSTOP
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w">  </span>X<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Y<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>W<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>H
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span>hGui
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span>MODULEID
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                  </span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">)</span>
<span class="w">    </span>ifEqual<span class="p">,</span><span class="w"> </span>hCtrl<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="nf">IsFunc</span><span class="p">(</span>Handler<span class="p">)</span>
<span class="w">		</span><span class="nf">HLink</span><span class="p">(</span>hCtrl<span class="w"> </span><span class="s">&quot;handler&quot;</span><span class="p">,</span><span class="w"> </span>Handler<span class="p">)</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span>hCtrl
<span class="p">}</span>

<span class="c1">;========================= PRIVATE ==========================================</span>

<span class="nf">HLink_onNotify</span><span class="p">(</span>Wparam<span class="p">,</span><span class="w"> </span>Lparam<span class="p">,</span><span class="w"> </span>Msg<span class="p">,</span><span class="w"> </span>Hwnd<span class="p">){</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>MODULEID<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">170608</span><span class="p">,</span><span class="w"> </span>oldNotify<span class="o">=</span><span class="s">&quot;*&quot;</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>NM_CLICK<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span>NM_ENTER<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>_<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>NumGet<span class="p">(</span>Lparam<span class="o">+</span><span class="mi">4</span><span class="p">)))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span>MODULEID
<span class="w">	 </span><span class="k">ifLess</span><span class="w"> </span>_<span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="k">return</span><span class="w">	</span><span class="c1">;if ahk control, return asap (AHK increments control ID starting from 1. Custom controls use IDs &gt; 10000 as its unlikely that u will use more then 10K ahk controls.</span>
<span class="w">	 </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span>ifEqual<span class="p">,</span><span class="w"> </span>oldNotify<span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span>SetEnv<span class="p">,</span><span class="w"> </span>oldNotify<span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>HLink<span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">)</span><span class="w">		</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>oldNotify<span class="w"> </span><span class="o">!=</span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>oldNotify<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Wparam<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Lparam<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Msg<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Hwnd<span class="p">)</span>
<span class="w">	 </span><span class="p">}</span>

<span class="w">	</span>hw<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>Lparam<span class="o">+</span><span class="mi">0</span><span class="p">),</span><span class="w">  </span>code<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>Lparam<span class="o">+</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>code<span class="w"> </span>not<span class="w"> </span>in<span class="w"> </span><span class="nv">%NM_CLICK%</span><span class="p">,</span><span class="nv">%NM_ENTER%</span>
<span class="w">		</span><span class="k">return</span>
<span class="w">   </span>
<span class="w">	</span><span class="k">ControlGetText</span><span class="p">,</span><span class="w"> </span>txt<span class="p">,</span><span class="w"> </span><span class="p">,</span>ahk_id<span class="w"> </span><span class="nv">%hw%</span>
<span class="w">	</span><span class="nf">RegExmatch</span><span class="p">(</span>txt<span class="p">,</span><span class="w"> </span><span class="s">&quot;\Q&lt;a href=&quot;&quot;\E(.*?)&quot;&quot;&gt;(.+?)&lt;/a&gt;&quot;</span><span class="p">,</span><span class="w"> </span>out<span class="p">)</span>
<span class="w">	</span><span class="k">StringReplace</span><span class="p">,</span><span class="w"> </span>txt<span class="p">,</span><span class="w"> </span>txt<span class="p">,</span><span class="w"> </span><span class="nv">%out%</span><span class="p">,</span><span class="w"> </span><span class="nv">%out2%</span>

<span class="w">	</span>handler<span class="w"> </span><span class="o">:=</span><span class="w"> </span>HLink<span class="p">(</span>hw<span class="w"> </span><span class="s">&quot;Handler&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>handler<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">Run</span><span class="p">,</span><span class="w"> </span><span class="nv">%out1%</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">%handler%</span><span class="p">(</span>hw<span class="p">,</span><span class="w"> </span>txt<span class="p">,</span><span class="w"> </span>out1<span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">		</span><span class="k">Run</span><span class="p">,</span><span class="w"> </span><span class="nv">%out1%</span>
<span class="p">}</span>

<span class="c1">;Mini storage function</span>
<span class="nf">HLink</span><span class="p">(</span>var<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>value<span class="o">=</span><span class="s">&quot;~</span><span class="se">`a</span><span class="s">&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">	</span><span class="kt">static</span>
<span class="w">	</span>_<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%var%</span>
<span class="w">	</span><span class="k">ifNotEqual</span><span class="p">,</span><span class="w"> </span>value<span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="p">`</span>a<span class="p">,</span><span class="w"> </span>SetEnv<span class="p">,</span><span class="w"> </span><span class="nv">%var%</span><span class="p">,</span><span class="w"> </span><span class="nv">%value%</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>_
<span class="p">}</span>


<span class="c1">;Required function by Forms framework.</span>
<span class="nf">HLink_add2Form</span><span class="p">(</span>hParent<span class="p">,</span><span class="w"> </span>Txt<span class="p">,</span><span class="w"> </span>Opt<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>f<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Form_Parse&quot;</span>
<span class="w">	</span>
<span class="w">	</span><span class="nv">%f%</span><span class="p">(</span>Opt<span class="p">,</span><span class="w"> </span><span class="s">&quot;x# y# w# h# g*&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>handler<span class="p">)</span>
<span class="w">	</span>x<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> 	</span>y<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>y<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> 	</span>w<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>w<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> 	</span>h<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>h<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">HLink_Add</span><span class="p">(</span>hParent<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>handler<span class="p">,</span><span class="w"> </span>Txt<span class="p">)</span>
<span class="p">}</span>


<span class="o">/*</span><span class="w"> </span>Group<span class="o">:</span><span class="w"> </span>Examples
<span class="w">	</span><span class="p">(</span>start<span class="w"> </span>code<span class="p">)</span>
<span class="w">	</span><span class="k">#SingleInstance </span>force

<span class="w">	   </span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span><span class="o">+</span>LastFound
<span class="w">	   </span>hGui<span class="w"> </span><span class="o">:=</span><span class="w"> </span>WinExist<span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="mi">0</span>

<span class="w">	   </span><span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">  </span><span class="mi">10</span><span class="p">,</span><span class="w">  </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OnLink&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Click &#39;here&#39;:www.Google.com to go to Google&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">	   </span><span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">  </span><span class="mi">40</span><span class="p">,</span><span class="w">  </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OnLink&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Click &#39;this link&#39;:www.Yahoo.com to go to Yahoo&quot;</span><span class="p">)</span>
<span class="w">	   </span><span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">  </span><span class="mi">170</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OnLink&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&#39;About HLink&#39;:About&quot;</span><span class="p">)</span>
<span class="w">	   </span><span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="mi">110</span><span class="p">,</span><span class="w"> </span><span class="mi">170</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OnLink&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&#39;Forum&#39;:http://www.autohotkey.com/forum/topic19508.html&quot;</span><span class="p">)</span>
<span class="w">	   </span><span class="nf">HLink_Add</span><span class="p">(</span>hGui<span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">	</span><span class="mi">60</span><span class="p">,</span><span class="w">  </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&#39;Google&#39;:www.Google.com) ;without handler</span>
<span class="w">	   </span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Show<span class="p">,</span><span class="w"> </span>w300<span class="w"> </span>h200
<span class="w">	</span><span class="k">return</span>

<span class="w">	</span><span class="nf">OnLink</span><span class="p">(</span>hCtrl<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>Link<span class="p">){</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>Link<span class="w"> </span><span class="o">=</span><span class="w"> </span>About
<span class="w">			</span><span class="k">msgbox</span><span class="w"> </span>Hlink<span class="w"> </span><span class="k">control</span><span class="p">`</span>nby<span class="w"> </span>majkinetor
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span>

<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="p">(</span>end<span class="w"> </span>code<span class="p">)</span>
<span class="w"> </span><span class="o">*/</span>

<span class="o">/*</span><span class="w"> </span>Group<span class="o">:</span><span class="w"> </span>About
<span class="w">		</span>o<span class="w"> </span>Ver<span class="w"> </span><span class="mf">2.01</span><span class="w"> </span>by<span class="w"> </span>majkinetor<span class="p">.</span><span class="w"> </span>See<span class="w"> </span>http<span class="o">://</span>www<span class="p">.</span>autohotkey<span class="p">.</span>com<span class="o">/</span>forum<span class="o">/</span>topic19508<span class="p">.</span>html
<span class="w">		</span>o<span class="w"> </span>HLink<span class="w"> </span>Reference<span class="w"> </span>at<span class="w"> </span>MSDN<span class="o">:</span><span class="w"> </span><span class="o">&lt;</span>http<span class="o">://</span>msdn2<span class="p">.</span>microsoft<span class="p">.</span>com<span class="o">/</span>en<span class="o">-</span>us<span class="o">/</span>library<span class="o">/</span>bb760704<span class="p">.</span>aspx<span class="o">&gt;</span>
<span class="w">		</span>o<span class="w"> </span>Licensed<span class="w"> </span>under<span class="w"> </span>GNU<span class="w"> </span>GPL<span class="w"> </span><span class="o">&lt;</span>http<span class="o">://</span>creativecommons<span class="p">.</span>org<span class="o">/</span>licenses<span class="o">/</span>GPL<span class="o">/</span><span class="mf">2.0</span><span class="o">/&gt;</span><span class="w"> </span>
<span class="w"> </span><span class="o">*/</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="cm">/* Title:	HLink</span>
<span class="cm">			HyperLink control.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">  Function:		Add</span>
<span class="cm"> 				Creates hyperlink control.</span>
<span class="cm"> </span>
<span class="cm">  Parameters: 	</span>
<span class="cm"> 				hGui	- Handle of the parent GUI.</span>
<span class="cm"> 				X..H	- Size &amp; position.</span>
<span class="cm">				Handler	- Notification handler. If you omit handler, link will be opened in default browser when clicked.</span>
<span class="cm"> 				Text	- Link text. Link is text between the &#39; char followd by the : char and location (as Textille mark-up).</span>
<span class="cm"> 						  Everything else  will be displayed as ordinary text.</span>
<span class="cm"> </span>
<span class="cm">  Notifications:</span>
<span class="cm"> &gt;				Result := OnLink(hWnd, Text, Link)</span>
<span class="cm"> </span>
<span class="cm"> 				hWnd	- Handle of the HLink control that generated notification.</span>
<span class="cm"> 				Text	- Text of the control.</span>
<span class="cm"> 				Link	- Link of the control.</span>

<span class="cm">  Returns:</span>
<span class="cm">				Handle of the new control or 0 on failure.</span>
<span class="cm">  Example:</span>
<span class="cm"> &gt;				hLink := HLink_Add(hGui, &quot;OnLink&quot;, 10, 10, 200, 20, &quot;Click &#39;here&#39;:www.Google.com to go to Google&quot;)</span>
<span class="cm"> */</span>
<span class="n">HLink_Add</span><span class="p">(</span><span class="n">hGui</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Handler</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s">&quot;&#39;HLink Control&#39;:&quot;</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MODULEID</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">ICC_LINK_CLASS</span><span class="o">=</span><span class="mh">0x8000</span><span class="p">,</span> <span class="n">WS_CHILD</span><span class="o">=</span><span class="mh">0x40000000</span><span class="p">,</span> <span class="n">WS_VISIBLE</span><span class="o">=</span><span class="mh">0x10000000</span><span class="p">,</span> <span class="n">WS_TABSTOP</span><span class="o">=</span><span class="mh">0x10000</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span>

<span class="w">	</span><span class="nb">if </span><span class="n">MODULEID</span> <span class="o">=</span>
	<span class="p">{</span> 
		<span class="n">old</span> <span class="o">:=</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="mh">0x4E</span><span class="p">,</span> <span class="s">&quot;HLink_onNotify&quot;</span><span class="p">),</span> <span class="n">MODULEID</span> <span class="o">:=</span> <span class="mi">170608</span>
<span class="w">		</span><span class="nb">if </span><span class="n">old</span> <span class="o">!=</span> <span class="n">HLink_onNotify</span>
			<span class="n">HLink</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">,</span> <span class="nf">RegisterCallback</span><span class="p">(</span><span class="n">old</span><span class="p">))</span>

		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">ICC</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICC</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;comctl32.dll\InitCommonControlsEx&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ICC</span><span class="p">)</span>
	<span class="p">}</span>
	
	<span class="n">Text</span> <span class="o">:=</span> <span class="nf">RegExReplace</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="s">&quot;&#39;(.+?)&#39;\:([^ ]*)&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;a href=</span><span class="se">&quot;&quot;</span><span class="s">$2</span><span class="se">&quot;&quot;</span><span class="s">&gt;$1&lt;/a&gt;&quot;</span><span class="p">)</span>
	<span class="n">hCtrl</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span>
                  <span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span>  <span class="s">&quot;SysLink&quot;</span>
                  <span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span>  <span class="n">Text</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">WS_CHILD</span> <span class="o">|</span> <span class="n">WS_VISIBLE</span> <span class="o">|</span> <span class="n">WS_TABSTOP</span>
                  <span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span>  <span class="n">X</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">H</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hGui</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">MODULEID</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span>
                  <span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">hCtrl</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">return</span> <span class="mi">0</span>

<span class="w">	</span><span class="nb">if </span><span class="nf">IsFunc</span><span class="p">(</span><span class="n">Handler</span><span class="p">)</span>
		<span class="n">HLink</span><span class="p">(</span><span class="n">hCtrl</span> <span class="s">&quot;handler&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="p">)</span>

<span class="w">	</span><span class="nb">return</span> <span class="n">hCtrl</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;========================= PRIVATE ==========================================</span>

<span class="n">HLink_onNotify</span><span class="p">(</span><span class="n">Wparam</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">MODULEID</span> <span class="o">:=</span> <span class="mi">170608</span><span class="p">,</span> <span class="n">oldNotify</span><span class="o">=</span><span class="s">&quot;*&quot;</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">NM_CLICK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">NM_ENTER</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">_</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">4</span><span class="p">)))</span> <span class="o">!=</span> <span class="n">MODULEID</span>
<span class="w">	 </span><span class="nb">ifLess</span> <span class="n">_</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">return</span><span class="c-Singleline">	;if ahk control, return asap (AHK increments control ID starting from 1. Custom controls use IDs &gt; 10000 as its unlikely that u will use more then 10K ahk controls.</span>
<span class="w">	 </span><span class="nb">else</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">oldNotify</span><span class="p">,</span> <span class="o">%</span> <span class="n">HLink</span><span class="p">(</span><span class="s">&quot;oldNotify&quot;</span><span class="p">)</span>		
<span class="w">		</span><span class="nb">if </span><span class="n">oldNotify</span> <span class="o">!=</span>
<span class="w">			</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="n">oldNotify</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Wparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Lparam</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Msg</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">)</span>
	 <span class="p">}</span>

	<span class="n">hw</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">0</span><span class="p">),</span>  <span class="n">code</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">Lparam</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nv">%NM_CLICK%</span><span class="p">,</span><span class="nv">%NM_ENTER%</span>
<span class="w">		</span><span class="nb">return</span>
<span class="w">   </span>
<span class="w">	</span><span class="nb">ControlGetText</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hw%</span>
	<span class="nf">RegExmatch</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s">&quot;\Q&lt;a href=</span><span class="se">&quot;&quot;</span><span class="s">\E(.*?)</span><span class="se">&quot;&quot;</span><span class="s">&gt;(.+?)&lt;/a&gt;&quot;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="w">	</span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="nv">%out%</span><span class="p">,</span> <span class="nv">%out2%</span>

	<span class="n">handler</span> <span class="o">:=</span> <span class="n">HLink</span><span class="p">(</span><span class="n">hw</span> <span class="s">&quot;Handler&quot;</span><span class="p">)</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">handler</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">Run</span><span class="p">,</span> <span class="nv">%out1%</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span> <span class="nv">%handler%</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">out1</span><span class="p">)</span> <span class="p">)</span>
<span class="w">		</span><span class="nb">Run</span><span class="p">,</span> <span class="nv">%out1%</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;Mini storage function</span>
<span class="n">HLink</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">&quot;~`a&quot;</span><span class="p">)</span> <span class="p">{</span> 
<span class="w">	</span><span class="nb">static</span>
	<span class="n">_</span> <span class="o">:=</span> <span class="nv">%var%</span>
<span class="w">	</span><span class="nb">ifNotEqual</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">~</span><span class="se">`a</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="nv">%var%</span><span class="p">,</span> <span class="nv">%value%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">_</span>
<span class="p">}</span><span class="c-Singleline"></span>


<span class="c-Singleline">;Required function by Forms framework.</span>
<span class="n">HLink_add2Form</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">Opt</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">f</span> <span class="o">:=</span> <span class="s">&quot;Form_Parse&quot;</span>
	
	<span class="nv">%f%</span><span class="p">(</span><span class="n">Opt</span><span class="p">,</span> <span class="s">&quot;x# y# w# h# g*&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>
	<span class="n">x</span> <span class="o">.=</span> <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span> 	<span class="n">y</span> <span class="o">.=</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span> 	<span class="n">w</span> <span class="o">.=</span> <span class="n">w</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span> 	<span class="n">h</span> <span class="o">.=</span> <span class="n">h</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="mi">25</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">HLink_Add</span><span class="p">(</span><span class="n">hParent</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">Txt</span><span class="p">)</span>
<span class="p">}</span>


<span class="cm">/* Group: Examples</span>
<span class="cm">	(start code)</span>
<span class="cm">	#SingleInstance force</span>

<span class="cm">	   Gui, +LastFound</span>
<span class="cm">	   hGui := WinExist() +0</span>

<span class="cm">	   HLink_Add(hGui, 10,  10,  250, 20, &quot;OnLink&quot;, &quot;Click &#39;here&#39;:www.Google.com to go to Google&quot; )</span>
<span class="cm">	   HLink_Add(hGui, 10,  40,  250, 20, &quot;OnLink&quot;, &quot;Click &#39;this link&#39;:www.Yahoo.com to go to Yahoo&quot;)</span>
<span class="cm">	   HLink_Add(hGui, 10,  170, 100, 20, &quot;OnLink&quot;, &quot;&#39;About HLink&#39;:About&quot;)</span>
<span class="cm">	   HLink_Add(hGui, 110, 170, 100, 20, &quot;OnLink&quot;, &quot;&#39;Forum&#39;:http://www.autohotkey.com/forum/topic19508.html&quot;)</span>
<span class="cm">	   HLink_Add(hGui, 10,	60,  100, 20, &quot;&quot;, &quot;&#39;Google&#39;:www.Google.com) ;without handler</span>
<span class="cm">	   Gui, Show, w300 h200</span>
<span class="cm">	return</span>

<span class="cm">	OnLink(hCtrl, Text, Link){</span>
<span class="cm">		if Link = About</span>
<span class="cm">			msgbox Hlink control`nby majkinetor</span>
<span class="cm">		else return 1</span>

<span class="cm">	}</span>
<span class="cm">	(end code)</span>
<span class="cm"> */</span>

<span class="cm">/* Group: About</span>
<span class="cm">		o Ver 2.01 by majkinetor. See http://www.autohotkey.com/forum/topic19508.html</span>
<span class="cm">		o HLink Reference at MSDN: &lt;http://msdn2.microsoft.com/en-us/library/bb760704.aspx&gt;</span>
<span class="cm">		o Licensed under GNU GPL &lt;http://creativecommons.org/licenses/GPL/2.0/&gt; </span>
<span class="cm"> */</span>
</pre></div>
