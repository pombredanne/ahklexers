<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; ST - Stack Library by Banane</span>
<span class="c-Singleline">; http://www.autohotkey.com/forum/viewtopic.php?t=54153</span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Dim</span>
<span class="c-Singleline">;Parameters:  Stack = Specify a new variable</span>
<span class="c-Singleline">;Description: Declares the specified variable as a stack</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Dim</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">ST_Debug</span><span class="p">()</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="nb">MsgBox</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">ST</span> <span class="n">Error</span><span class="p">,</span> <span class="n">Specified</span> <span class="n">Stack</span> <span class="ow">is</span> <span class="n">already</span> <span class="n">declared</span><span class="o">.</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="n">Stack</span> <span class="o">:=</span><span class="s">&quot;[]&quot;</span>
<span class="p">}</span><span class="c-Singleline"></span>


<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Undim</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
<span class="c-Singleline">;Description: Deletes all contents from the stack variable</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Undim</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span>
  <span class="n">Stack</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Del</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
<span class="c-Singleline">;Description: Deletes all entrys from the stack</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Del</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span>
  <span class="n">Stack</span> <span class="o">:=</span> <span class="s">&quot;[]&quot;</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Push</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
              <span class="n">Value</span> <span class="o">=</span> <span class="n">Entry</span>&#39;<span class="n">s</span> <span class="n">value</span><span class="c-Singleline"></span>
<span class="c-Singleline">;Description: Adds an entry to the stack</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Push</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">,</span><span class="n">Value</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Check if it&#39;s a valid stack</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Add the value</span>
  <span class="n">Stack</span> <span class="o">:=</span> <span class="s">&quot;[&quot;</span> <span class="o">.</span> <span class="n">ST_Convert</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span> <span class="o">.</span> <span class="s">&quot;|&quot;</span> <span class="o">.</span> <span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">StrLen(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s">&quot;]&quot;</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Pop</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
<span class="c-Singleline">;Description: Removes and returns the newest entrys contents</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Pop</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Check if it&#39;s a valid stack</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span>
<span class="w">  </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="n">ST_Len</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">1</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Get first entry</span>
  <span class="n">Value</span> <span class="o">:=</span> <span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">InStr(</span><span class="n">Stack</span><span class="p">,</span><span class="s">&quot;|&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Remove from stack</span>
  <span class="n">Stack</span> <span class="o">:=</span> <span class="s">&quot;[&quot;</span> <span class="o">.</span> <span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="nf">InStr(</span><span class="n">Stack</span><span class="p">,</span><span class="s">&quot;|&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="nf">StrLen(</span><span class="n">Stack</span><span class="p">))</span>
<span class="w">  </span><span class="nb">Return</span> <span class="n">ST_Convert</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Peek</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
<span class="c-Singleline">;Description: Returns the newest entrys contents without removing</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Peek</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Check if it&#39;s a valid stack</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span>
<span class="w">  </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="n">ST_Len</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">1</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Return first entry</span>
<span class="w">  </span><span class="nb">Return</span> <span class="n">ST_Convert</span><span class="p">(</span><span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">InStr(</span><span class="n">Stack</span><span class="p">,</span><span class="s">&quot;|&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Len</span>
<span class="c-Singleline">;Parameters:  Stack = Declared Stack</span>
<span class="c-Singleline">;Description: Returns the count of entrys</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Len</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Check if it&#39;s a valid stack</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">0</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Check how many entrys are in it</span>
<span class="w">  </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">Stack</span>
    <span class="n">If</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
      <span class="n">Length</span> <span class="o">++</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;If Stack doesn&#39;t have any entrys</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_Debug</span><span class="p">()</span> <span class="o">=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Length</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">MsgBox</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">ST</span> <span class="n">Error</span><span class="p">,</span> <span class="n">Specified</span> <span class="n">Stack</span> <span class="n">doesn</span>&#39;<span class="n">t</span> <span class="n">have</span> <span class="n">any</span> <span class="n">entrys</span><span class="o">.</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Return the length</span>
<span class="w">  </span><span class="nb">Return</span> <span class="n">Length</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="c-Singleline">;Function:    ST_Debug</span>
<span class="c-Singleline">;Parameters:  OnOff = Boolean - 1 to activate, 0 to deactivate</span>
<span class="c-Singleline">;Description: Actiavtes error messages</span>
<span class="c-Singleline">;-----------------------------------------------------------------------------------------------------------------------------</span>
<span class="n">ST_Debug</span><span class="p">(</span><span class="n">OnOff</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w"> </span><span class="nb">static</span> <span class="n">Debug</span><span class="c-Singleline"></span>

<span class="c-Singleline">  ;Change Debug State</span>
  <span class="n">Debug</span> <span class="o">:=</span> <span class="p">(</span><span class="n">OnOff</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">Debug</span> <span class="o">:</span> <span class="n">OnOff</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Return Debug State</span>
<span class="w">  </span><span class="nb">Return</span> <span class="n">Debug</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;=============================================================================================================================</span>
<span class="c-Singleline">;Internal Functions</span>
<span class="c-Singleline">;=============================================================================================================================</span>
<span class="n">ST_Convert</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span><span class="n">Mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">  ;Mode 0 = Convert to Stack Format</span>
<span class="c-Singleline">  ;Mode 1 = Convert from Stack Format</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">Mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="o">|</span><span class="p">,</span> <span class="o">&lt;</span>&#39;<span class="n">D</span>&#39;<span class="o">&gt;</span><span class="p">,</span> <span class="mi">1</span><span class="c-Singleline"> ;Replace Delimiter</span>
<span class="w">  </span><span class="nb">Else</span>
<span class="w">    </span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="o">&lt;</span>&#39;<span class="n">D</span>&#39;<span class="o">&gt;</span><span class="p">,</span> <span class="o">|</span><span class="p">,</span> <span class="mi">1</span><span class="c-Singleline"> ;Change to Delimiter</span>
<span class="w">  </span><span class="nb">Return</span> <span class="n">Value</span>
<span class="p">}</span>

<span class="n">ST_IsValid</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">Stack</span><span class="p">,</span><span class="n">Dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">If</span> <span class="p">(</span><span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;[&quot;</span> <span class="ow">and</span> <span class="nf">SubStr(</span><span class="n">Stack</span><span class="p">,</span><span class="nf">StrLen(</span><span class="n">Stack</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;]&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="mi">1</span>
  <span class="n">If</span> <span class="p">(</span><span class="n">ST_Debug</span><span class="p">()</span> <span class="o">=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nb">MsgBox</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="n">ST</span> <span class="n">Error</span><span class="p">,</span> <span class="n">Specified</span> <span class="n">Stack</span> <span class="n">isn</span>&#39;<span class="n">t</span> <span class="n">valid</span><span class="o">.</span>
<span class="w">  </span><span class="nb">Return</span> <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
