<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">_______________________________________________________________________________</span>
<span class="cm">_______________________________________________________________________________</span>

<span class="cm">Title: argp - Argument Options Parser</span>
<span class="cm">    Parse an argument string with options and get keys and values.</span>
<span class="cm">_______________________________________________________________________________</span>
<span class="cm">_______________________________________________________________________________</span>

<span class="cm">License:</span>

<span class="cm">(C) Copyright 2009, 2010 Tuncay</span>
<span class="cm">    </span>
<span class="cm">This program is free software; you can redistribute it and/or modify</span>
<span class="cm">it under the terms of the GNU Lesser General Public License as published by</span>
<span class="cm">the Free Software Foundation; either version 3 of the License, or</span>
<span class="cm">(at your option) any later version.</span>

<span class="cm">This program is distributed in the hope that it will be useful,</span>
<span class="cm">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">GNU Lesser General Public License for more details.</span>

<span class="cm">You should have received a copy of the GNU Lesser General Public License</span>
<span class="cm">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="cm">(see lgplv3.png)</span>

<span class="cm">See the file COPYING.txt and COPYING.LESSER.txt for license and copying conditions.</span>

<span class="cm">About: Description</span>
<span class="cm">    About the idea</span>

<span class="cm">Introduction:</span>
<span class="cm">    Sometimes we need to work with many optional parameters. Some of the</span>
<span class="cm">    parameters may be just logical flags only (true/false). If the function have</span>
<span class="cm">    too many such parameters, the usability is endangered. To workaround</span>
<span class="cm">    that disgrace, we can make one option string to the function. From now </span>
<span class="cm">    on, this string contains all parameters. This is comparable to the </span>
<span class="cm">    commandline.</span>
<span class="cm">        </span>
<span class="cm">    It must be parsed to find all parts. Writing such parsers could become </span>
<span class="cm">    difficult and slow down the complete process. The parsing is tried to </span>
<span class="cm">    be made with one regex call only (with some other non dramatic lines).</span>
<span class="cm">    As long as the string is keeped simple, there should be no problem. But </span>
<span class="cm">    with growing complexity, with different values of subparameters, it is a </span>
<span class="cm">    pain to make the difference.</span>
<span class="cm">    </span>
<span class="cm">Who needs this?:    </span>
<span class="cm">    This is not a parser for command line arguments of programs or scripts.</span>
<span class="cm">    It is similiar to Windows or Unix/Linux command line arguments, but </span>
<span class="cm">    different in some ways and less powerful. This library is for those ahk </span>
<span class="cm">    developers, who needs to write user defined functions with many options. </span>
<span class="cm">    With the parsing of just one real function parameter, it can be avoided to </span>
<span class="cm">    have a bunch of function parameters. </span>
<span class="cm">    </span>
<span class="cm">What it can do for you:</span>
<span class="cm">    The source will be parsed and all found options are given over to specified</span>
<span class="cm">    variables. The other work parsing these generated variables is left to the </span>
<span class="cm">    user. </span>
<span class="cm">    </span>
<span class="cm">    * *Pro:* A standardized, simple and fast way of options handling.</span>
<span class="cm">    * *Contra:* It isn`t a well known official standard.</span>

<span class="cm">History:</span>
<span class="cm">    This library is rewritten from scratch and the old BUG or LIMITATION is</span>
<span class="cm">    not present anymore. Not only that. It does work in a completly another</span>
<span class="cm">    way. After searching the web, I found a regular expression made by </span>
<span class="cm">    Richard Hauer at regexlib.com. I have modified it and now it is the </span>
<span class="cm">    backbone of my functions. One deserved credit goes to him.</span>
<span class="cm">    </span>
<span class="cm">    The name of the library is changed again, from args to argp. The chosen </span>
<span class="cm">    name argp is a GNU C library for parsing arguments of programs. This </span>
<span class="cm">    AutoHotkey library is named like it, but there is no compatibility with</span>
<span class="cm">    the GNU C library. The name is an abbreviation for &quot;ARGument Parser&quot;.</span>
<span class="cm">    </span>
<span class="cm">Links:</span>
<span class="cm">    * Discussion: [http://www.autohotkey.com/forum/viewtopic.php?p=310409]</span>
<span class="cm">    * License: [http://www.gnu.org/licenses/lgpl-3.0.html]</span>
<span class="cm">    * Wikipedia - LGPL: [http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License]</span>

<span class="cm">Date:</span>
<span class="cm">    2010-01-30</span>

<span class="cm">Revision:</span>
<span class="cm">    3.0</span>
<span class="cm">    </span>
<span class="cm">Status:</span>
<span class="cm">    Release</span>

<span class="cm">Credits:</span>
<span class="cm">    * Tuncay, [tuncay.d@gmx.de] (Author)</span>
<span class="cm">    * Richard Hauer [http://regexlib.com/REDetails.aspx?regexp_id=1220] (Author of original Regular Expression)</span>
<span class="cm">    </span>
<span class="cm">License:</span>
<span class="cm">    GNU Lesser General Public License 3.0 or higher [http://www.gnu.org/licenses/lgpl-3.0.html]</span>
<span class="cm">    </span>
<span class="cm">Category:</span>
<span class="cm">    String Manipulation</span>

<span class="cm">Type:</span>
<span class="cm">    Library</span>

<span class="cm">Tested AutoHotkey Version:</span>
<span class="cm">    1.0.48.05</span>

<span class="cm">Tested Platform:</span>
<span class="cm">    2000/XP</span>

<span class="cm">Standalone (such as no need for extern file or library):</span>
<span class="cm">    Yes</span>

<span class="cm">StdLibConform (such as use of prefix and no globals use):</span>
<span class="cm">    Yes</span>

<span class="cm">Related:</span>
<span class="cm">    *Other Community Solutions*</span>
<span class="cm">    * Parameters and switches parser by Yook: [http://www.autohotkey.com/forum/viewtopic.php?t=50885]</span>
<span class="cm">    * [function] Parse by majkinetor: [http://www.autohotkey.com/forum/viewtopic.php?t=49261]</span>
<span class="cm">    * options.ahkl - an options object for AutoHotkey_L by ahklerner: [http://www.autohotkey.com/forum/viewtopic.php?t=49430]</span>

<span class="cm">About: Usage</span>
<span class="cm">    How to use the functions</span>

<span class="cm">Syntax:    </span>
<span class="cm">    &gt; count := argp_parse( source [, maxcount, keyname1, value1, ... keyname32, value32] )</span>
<span class="cm">    &gt;</span>
<span class="cm">    &gt; optlist := argp_getopt( source [, keylist, caseSense, value1, ... value32] )</span>
<span class="cm">    </span>
<span class="cm">    There are two independently working functions. They have the same regular expression</span>
<span class="cm">    at the core, but the functionality and interface differs. One creates variables for each</span>
<span class="cm">    key name and the other one returns a list with names, checking against another list of </span>
<span class="cm">    possible names (either with case sense on or off and, removing dublicates).</span>

<span class="cm">    After calling one of the functions, the variables or the list must be parsed. This is</span>
<span class="cm">    left to be done by the user. For the beginner, it is recommended to use argp_getopt() and then</span>
<span class="cm">    check with InStr() if a name exists in resulting list (with surrounding spaces).</span>

<span class="cm">    No globals are created, no special objects or frameworks are needed. </span>
<span class="cm"> </span>
<span class="cm">Installation:</span>
<span class="cm">    Just name the library to &quot;argp.ahk&quot; and put it into the standard or user library folder.</span>
<span class="cm">    A call of one of these functions in this library will lead to automatically include it </span>
<span class="cm">    into the script at call time. The folder should reside under one of these paths:</span>
<span class="cm">    </span>
<span class="cm">    &gt; %A_MyDocuments%\AutoHotkey\Lib\  ; User library.</span>
<span class="cm">    &gt; path-to-the-currently-running-AutoHotkey.exe\Lib\  ; Standard library.</span>
<span class="cm">    </span>
<span class="cm">    Alternatively you can include this library at any position of your script with the </span>
<span class="cm">    #include command:</span>
<span class="cm">    </span>
<span class="cm">    &gt; #Include argp.ahk</span>

<span class="cm">Example 1:</span>
<span class="cm">    This is part of parsing the options parameter from hypotetical function set_clipboard().</span>
<span class="cm">    The code demonstrates some aspects only, and it`s not optimized.</span>
<span class="cm">    </span>
<span class="cm">    (Code)        </span>
<span class="cm">        ; Set default values prior to parsing argument string.        </span>
<span class="cm">        opt_wait_use := false</span>
<span class="cm">        opt_errorlevel_set := false</span>
<span class="cm">                </span>
<span class="cm">        ; Analyze the variable argument for existence of options namely &quot;wait&quot; and &quot;errorlevel&quot;.</span>
<span class="cm">        ; Save the value of &quot;wait&quot; into variable wait_value.</span>
<span class="cm">        ; After that, a new list with option names is get and saved into variable optlist.        </span>
<span class="cm">        optlist := argp_getopt(argument, &quot;wait errorlevel&quot;, false, wait_value)</span>
<span class="cm">                </span>
<span class="cm">        ; Now, parse the list and set options for programs usage.        </span>
<span class="cm">        If InStr(optlist, &quot; wait &quot;)</span>
<span class="cm">        {</span>
<span class="cm">            opt_wait_use := true</span>
<span class="cm">            opt_wait_value := wait_value</span>
<span class="cm">        }</span>
<span class="cm">        </span>
<span class="cm">        If InStr(optlist, &quot; errorlevel &quot;)</span>
<span class="cm">        {</span>
<span class="cm">            opt_errorlevel_set := true</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    If the set_clipboard() function was called with following options</span>
<span class="cm">    </span>
<span class="cm">    &gt; &quot;-w:2&quot;</span>
<span class="cm">    </span>
<span class="cm">    Then the following variables are set</span>
<span class="cm">    </span>
<span class="cm">    &gt; opt_wait_use := true</span>
<span class="cm">    &gt; opt_wait_value := 2</span>
<span class="cm">    &gt; opt_errorlevel_set := false</span>
<span class="cm">    </span>
<span class="cm">Example 2:</span>
<span class="cm">    The next example shall show how to translate an usual function to argp_getopt()</span>
<span class="cm">    powered function. One function could look like this (very boring I know):</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        display(sentence = &quot;hello world&quot;, caseMod = 0, html = 0)</span>
<span class="cm">        {</span>
<span class="cm">            If (caseMod = 1)</span>
<span class="cm">                StringUpper, sentence, sentence, T</span>
<span class="cm">            Else If (caseMod = 2)</span>
<span class="cm">                StringUpper, sentence, sentence</span>
<span class="cm">            Else If (caseMod = 3)</span>
<span class="cm">                StringLower, sentence, sentence</span>
<span class="cm">            If ( html)</span>
<span class="cm">                Transform, sentence, HTML, %sentence%</span>
<span class="cm">            MsgBox %sentence%</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    A call could look like this</span>
<span class="cm">    </span>
<span class="cm">    &gt; display(&quot;hello world&quot;, 1, 1)</span>
<span class="cm">    </span>
<span class="cm">    Next code is one possible version with argp</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        display(options)</span>
<span class="cm">        {</span>
<span class="cm">            ; Default values of options.</span>
<span class="cm">            sentence = hello world</span>
<span class="cm">            </span>
<span class="cm">            ; Parsing options.</span>
<span class="cm">            optlist := argp_getopt(options, &quot;sentence caseMod html&quot;, false, sentence_value, caseMod_value)</span>
<span class="cm">            </span>
<span class="cm">            Loop, Parse, optlist, %A_Space%, %A_Space%</span>
<span class="cm">            {</span>
<span class="cm">                If (&quot;sentence&quot; = A_LoopField)</span>
<span class="cm">                    sentence := sentence_value</span>
<span class="cm">                Else If (&quot;caseMod&quot; = A_LoopField)</span>
<span class="cm">                {</span>
<span class="cm">                    If (caseMod_value = 1)</span>
<span class="cm">                        StringUpper, sentence, sentence, T</span>
<span class="cm">                    Else If (caseMod_value = 2)</span>
<span class="cm">                        StringUpper, sentence, sentence</span>
<span class="cm">                    Else If (caseMod_value = 3)</span>
<span class="cm">                        StringLower, sentence, sentence</span>
<span class="cm">                }</span>
<span class="cm">                Else If (&quot;html&quot; = A_LoopField)</span>
<span class="cm">                    Transform, sentence, HTML, %sentence%</span>
<span class="cm">            }</span>
<span class="cm">            </span>
<span class="cm">            MsgBox %sentence%</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    Lets see how a call could look now</span>
<span class="cm">    </span>
<span class="cm">    &gt; display(&quot;-caseMod 2 -html&quot;)</span>
<span class="cm">    </span>
<span class="cm">    What is done there? First we have changed from multiple function parameters to </span>
<span class="cm">    single parameter. All the necessary default parameters are set in the function </span>
<span class="cm">    body. Then the argp_getopt() is used to parse options variable. The third </span>
<span class="cm">    parameter (here set to false) is for doing the parse without case sensitivity. </span>
<span class="cm">    All the parameters after that, are variables for holding possible values of the </span>
<span class="cm">    options. That is, because every option can have its own value. </span>
<span class="cm">    </span>
<span class="cm">    After this process, the resulting optlist variable holds the found names of options </span>
<span class="cm">    (given are the three &quot;sentence caseMod html&quot;). As a next step, this optlist </span>
<span class="cm">    variable must be parsed manually for checking which options are found actually and </span>
<span class="cm">    doing the right actions. In this example, a Loop, Parse command is chosen. There </span>
<span class="cm">    are other possibilities like multiple InStr() checks.</span>
<span class="cm">    </span>
<span class="cm">About: Specification</span>
<span class="cm">    Argument string format</span>

<span class="cm">Basic structure:</span>
<span class="cm">    Any option must begin either with a hypghen &quot;-&quot; or slash &quot;/&quot;, to be </span>
<span class="cm">    recognized as an option. It doesn`t matter which of the two is used. </span>
<span class="cm">    The following character or word until next option or space is the key </span>
<span class="cm">    name of that option. In example:    </span>
<span class="cm">    </span>
<span class="cm">    &gt; -a -b</span>
<span class="cm">    and</span>
<span class="cm">    &gt; -a-b</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; b</span>
<span class="cm">    </span>
<span class="cm">    Although space is not required, you can write without it.</span>
<span class="cm">    </span>
<span class="cm">    Normally parts in string that are not recognized as options should be ignored. In </span>
<span class="cm">    such a case, the resulting variable and value is allways empty. </span>

<span class="cm">Values added to keys:</span>
<span class="cm">    Every option can have its own assigned value. The value can be delimited</span>
<span class="cm">    from its key name with a space &quot; &quot;, a double colon &quot;:&quot; or an equality sign &quot;=&quot;.</span>
<span class="cm">    If it is enclosed in quotes, then no delimiter is needed. The value is read until </span>
<span class="cm">    one space is found (or another option starts). In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a test1 -b</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; b</span>
<span class="cm">    </span>
<span class="cm">    Where &quot;a&quot; holds the value &quot;test1&quot;.</span>
<span class="cm">    </span>
<span class="cm">    Normally spaces around a value are lost. The value can be optionally enclosed</span>
<span class="cm">    between a pair of single or double quotes. That way spaces inside the quotes</span>
<span class="cm">    are saved. </span>
<span class="cm">    </span>
<span class="cm">    &gt; -a:&#39;foo -bar &#39; -B -c hello world</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; B</span>
<span class="cm">    &gt; c</span>
<span class="cm">    </span>
<span class="cm">    Where a holds the value &quot;foo -bar &quot; and c the value &quot;hello&quot;.</span>
<span class="cm">    </span>
<span class="cm">    If a value contains one of these characters -, /, :, =, &#39; or &quot;, then it is best </span>
<span class="cm">    to enclose the whole value between quotes (single or double).</span>

<span class="cm">Dublicate keys:</span>
<span class="cm">    argp_parse() and argp_getopt() treat duplicate definitions of option names in </span>
<span class="cm">    different ways. argp_parse() sees every key separately. And argp_getopt() sees</span>
<span class="cm">    the first definition only. This is important if they have values. In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a:foo -a:bar -A</span>
<span class="cm">    </span>
<span class="cm">    would argp_getopt() resolve to</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; A</span>
<span class="cm">    </span>
<span class="cm">    where a would holds the value &quot;foo&quot; and A would have an empty value.</span>
<span class="cm">    In contrast argp_parse() resolves to</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; A</span>
<span class="cm">    </span>
<span class="cm">    first a holds &quot;foo&quot; and second a holds &quot;bar&quot;. Again, the last A have an</span>
<span class="cm">    empty value.</span>
<span class="cm">    </span>
<span class="cm">Key naming:</span>
<span class="cm">    These characters in key name are allowed: a-z, A-Z, 0-9, _, ., ?, ! and @. Some</span>
<span class="cm">    examples:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a</span>
<span class="cm">    &gt; -test</span>
<span class="cm">    &gt; /test.example</span>
<span class="cm">    &gt; /?</span>
<span class="cm">    &gt; -64</span>
<span class="cm">    &gt; -@section</span>
<span class="cm">    </span>
<span class="cm">The one special value without key name:    </span>
<span class="cm">    There is one exception in argp_parse() function only. Any string before</span>
<span class="cm">    first option is treated as a special value without a key name. That value </span>
<span class="cm">    is parsed like any other value. In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; hello -a    </span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    </span>
<span class="cm">    The key &quot;a&quot; does have an empty value and the first special value &quot;hello&quot; </span>
<span class="cm">    is saved in ErrorLevel. This is supported by argp_parse() function exclusively.</span>
<span class="cm">*/</span>


<span class="cm">/*</span>
<span class="cm">Func: argp_parse</span>
<span class="cm">    Get optional keys and values as separate variables.</span>
<span class="cm">    </span>
<span class="cm">Syntax:</span>
<span class="cm">    &gt; count := argp_parse( args [, maxcount, n1, v1, ... n32, v32] )</span>

<span class="cm">Parameters:</span>
<span class="cm">    args            - *Variable* [string] input: Source String variable with options to parse. See above </span>
<span class="cm">                        at &quot;Specification&quot;, which is a description about the format.</span>
<span class="cm">    maxcount        - *Optional* [integer] input:  Specifies how many options to get. Anything </span>
<span class="cm">                        below &#39;1&#39; or above &#39;32&#39; defaults to &#39;32&#39;.</span>
<span class="cm">    n1-n32          - *Variable Optional* [string] output: Stores the key name of option into variable.</span>
<span class="cm">                        Variable n1 would hold first found name of option (i.e. &quot;A&quot;).</span>
<span class="cm">    v1-v32          - *Variable Optional* [string] output: Stores the value of an option into variable.</span>
<span class="cm">                        Variable v1 would hold value of first found option (i.e. &quot;33&quot;).</span>

<span class="cm">Returns:</span>
<span class="cm">    Number of retrieved options, or &#39;0&#39; otherwise.</span>

<span class="cm">Remarks:</span>
<span class="cm">    maxcount can be set to an integer value between 1 and 32. That restricts the number</span>
<span class="cm">    of options to extract from source string. In example, if specified to 8, then the </span>
<span class="cm">    first 8 options are seen and the rest is ignored. This is an optimization. Maximum</span>
<span class="cm">     possible of 6 options to parse is faster than to parse 26 options. Plus, there are </span>
<span class="cm">    special optimizations to 8, 16 and 32, so they are faster in execution against values</span>
<span class="cm">    near to them. These values (8, 16, 32) are highly recommended.</span>

<span class="cm">ErrorLevel:</span>
<span class="cm">    ErrorLevel is set to the first special value without key name. Otherwise it is empty.</span>
<span class="cm">    With following example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; get -i</span>
<span class="cm">    </span>
<span class="cm">    it would hold &quot;get&quot;. With next example</span>
<span class="cm">    </span>
<span class="cm">    &gt; -i get</span>
<span class="cm">    </span>
<span class="cm">    ErrorLevel would be empty.</span>
<span class="cm">    </span>
<span class="cm">Examples:</span>
<span class="cm">    (Code)</span>
<span class="cm">        options = -A=&#39;33&#39; -i /f:c:\test -time:5:10 -x /date:11:08:2009</span>
<span class="cm">        count := argp_parse(options, 8, n1, v1, n2, v2, n3, v3, n4, v4, n5, v5, n6, v6, n7, v7, n8, v8)</span>
<span class="cm">        Text =</span>
<span class="cm">        (</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        %count%</span>
<span class="cm">        </span>
<span class="cm">        Name of key 3 (n3):</span>
<span class="cm">        %n3%</span>
<span class="cm">        </span>
<span class="cm">        Value of key 3 (v3):</span>
<span class="cm">        %v3%</span>
<span class="cm">        )</span>
<span class="cm">        MsgBox %Text%</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    *Output:*</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        6</span>
<span class="cm">        </span>
<span class="cm">        Name of key 3 (n3):</span>
<span class="cm">        f</span>
<span class="cm">        </span>
<span class="cm">        Value of key 3 (v3):</span>
<span class="cm">        c:\test</span>
<span class="cm">    (End)</span>
<span class="cm">*/</span>
<span class="nf">argp_parse</span><span class="p">(</span>ByRef<span class="w"> </span>_args<span class="p">,</span><span class="w"> </span>_maxcount<span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n3<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v3<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n4<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v4<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n5<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v5<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n6<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v6<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n7<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v7<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n8<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v8<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n9<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v9<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n10<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v10<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n11<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v11<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n12<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v12<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n13<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v13<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n14<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v14<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n15<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v15<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n16<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v16<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n17<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v17<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n18<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v18<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n19<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v19<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n20<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v20<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n21<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v21<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n22<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v22<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n23<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v23<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n24<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v24<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n25<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v25<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n26<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v26<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n27<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v27<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n28<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v28<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n29<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v29<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n30<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v30<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n31<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v31<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_n32<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_v32<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_maxcount<span class="o">&lt;</span><span class="mi">1</span><span class="o">||</span>_maxcount<span class="o">&gt;</span><span class="mi">32</span><span class="p">)</span>
<span class="w">        </span>_maxcount<span class="o">:=</span><span class="mi">32</span>
<span class="w">    </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_maxcount<span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="c1">; Optimization to avoid Loop.</span>
<span class="w">        </span>_n1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n4<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n5<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n6<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n7<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n8<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n9<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n10<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n11<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n12<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n13<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n14<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n15<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n16<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n17<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n18<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n19<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n20<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n21<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n22<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n23<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n24<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n25<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n26<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n27<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n28<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n29<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n30<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n31<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n32<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>regex<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;JSs</span><span class="se">`a</span><span class="s">)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v&gt;.+?)&quot;&quot;)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v1&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v2&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v3&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v4&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v5&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v6&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v7&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v8&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v9&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v10&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v11&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v12&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v13&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v14&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v15&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v16&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n17&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v17&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v17&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v17&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n18&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v18&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v18&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v18&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n19&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v19&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v19&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v19&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n20&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v20&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v20&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v20&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n21&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v21&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v21&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v21&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n22&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v22&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v22&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v22&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n23&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v23&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v23&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v23&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v24&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v24&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v24&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v25&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v25&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v25&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v26&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v26&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v26&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v27&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v27&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v27&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v28&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v28&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v28&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v29&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v29&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v29&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v30&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v30&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v30&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v31&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v31&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v31&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v32&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v32&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v32&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_maxcount<span class="o">=</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="c1">; Optimization to avoid Loop.</span>
<span class="w">        </span>_n1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n4<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n5<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n6<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n7<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n8<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n9<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n10<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n11<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n12<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n13<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n14<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n15<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n16<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>regex<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;JSs</span><span class="se">`a</span><span class="s">)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v&gt;.+?)&quot;&quot;)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v1&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v2&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v3&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v4&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v5&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v6&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v7&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v8&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v9&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v10&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v11&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v12&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v13&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v14&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v15&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v16&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_maxcount<span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="c1">; Optimization to avoid Loop.</span>
<span class="w">        </span>_n1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n4<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n5<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n6<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n7<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_n8<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>regex<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;JSs</span><span class="se">`a</span><span class="s">)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v&gt;.+?)&quot;&quot;)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v1&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v2&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v3&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v4&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v5&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v6&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v7&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v8&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="k">Else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_maxcount<span class="o">&gt;</span><span class="mi">8</span><span class="p">)</span>
<span class="w">            </span><span class="nf">VarSetCapacity</span><span class="p">(</span>regex<span class="p">,</span><span class="mi">4624</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span>regex<span class="o">:=</span><span class="s">&quot;JSs</span><span class="se">`a</span><span class="s">)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v&gt;.+?)&quot;&quot;)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%_maxcount%</span>
<span class="w">            </span>_n<span class="nv">%A_Index%</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>regex<span class="p">.</span><span class="o">=</span><span class="s">&quot;(?:(?:.*?\s*)[-/](?P&lt;n&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Index</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Index</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Index</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Index</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">RegExMatch</span><span class="p">(</span>_args<span class="p">,</span>regex<span class="p">,</span>_<span class="p">),</span>ErrorLevel<span class="o">:=</span>_v
<span class="w">    </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_n<span class="nv">%_maxcount%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">; Possible shortcut to avoid checking for each variable.</span>
<span class="w">        </span><span class="k">Return</span><span class="w"> </span>_maxcount
<span class="w">    </span><span class="k">Else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>count<span class="o">:=</span><span class="mi">0</span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%_maxcount%</span>
<span class="w">            </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_n<span class="nv">%A_Index%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span>count<span class="o">:=</span><span class="nb">A_Index</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">Return</span><span class="w"> </span>count
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm">Func: argp_getopt</span>
<span class="cm">    Check for known keys and get list of them and all values as separate variables.</span>

<span class="cm">Syntax:</span>
<span class="cm">    &gt; optlist := argp_getopt( source [, keylist, caseSense, value1, ... value32] )</span>

<span class="cm">Parameters:</span>
<span class="cm">    args            - *Variable* [string] input: Source String variable with options to parse. See above </span>
<span class="cm">                        at &quot;Specification&quot;, which is a description about the format.</span>
<span class="cm">    keyList         - *Optional* [string] input: A space separated list of option names. Every key </span>
<span class="cm">                        in options source string args will be in returning optlist. All values are</span>
<span class="cm">                        written to output variables from number 1 to 32. The third item in this list</span>
<span class="cm">                        relates to third output variable.</span>
<span class="cm">                        If the keylist is empty &quot;&quot;, then all existing key names are get.</span>
<span class="cm">    case            - *Optional* [flag] input: Case sensitivity of names checking; sensitiv at </span>
<span class="cm">                        default (true or 1) leads to let &quot;a&quot; as a different option as &quot;A&quot;.</span>
<span class="cm">    1-32            - *Variable Optional* [string] output: Stores the value of option into variable.</span>
<span class="cm">                        Variable number 1 would hold value (i.e. &quot;33&quot;) of first defined option (i.e. &quot;A&quot;).</span>

<span class="cm">Returns:</span>
<span class="cm">    Get a space separated list of matching names. This means, all not found option names </span>
<span class="cm">    are filtered out from keyList. Duplicate names are not found and first one is used </span>
<span class="cm">    instead. (In example: &quot;A file A c i&quot;, these are the names of 4 options.) </span>
<span class="cm">    </span>
<span class="cm">    If keyList is empty, then all options found in source is returned. Order of corresponding</span>
<span class="cm">    values (specified variables 1-32) reflects the order in source. But if keyList is a non </span>
<span class="cm">    empty list, then all options specified in this list are returned.</span>

<span class="cm">Remarks:</span>
<span class="cm">    Other than argp_parse(), this function awaits a list of option names in keyList. That</span>
<span class="cm">    keylist is compared against all found option names from source. All matching keys are</span>
<span class="cm">    copied to resulting return list. </span>
<span class="cm">    </span>
<span class="cm">    The returning list have spaces around also (at begin of list and end of). That allows </span>
<span class="cm">    checking for existency of keys with </span>
<span class="cm">    </span>
<span class="cm">    &gt; InStr(keylist, &quot; A &quot;)</span>
<span class="cm">    </span>
<span class="cm">    Any existing value corresponding to the key name is copied to output variable ranging </span>
<span class="cm">    from 1 to 32. In example second options value belongs to second variable, even if there</span>
<span class="cm">    is no value. In that case, the value is an empty string (blank value).</span>

<span class="cm">ErrorLevel:</span>
<span class="cm">    ErrorLevel is set to the number of matching option names. Duplicates are not counted. </span>
<span class="cm">    If nothing is found, it is set to &#39;0&#39;. It is not the count of resulting keylist, but the</span>
<span class="cm">    count of keys in source string args.</span>

<span class="cm">Examples:</span>
<span class="cm">    (Code)</span>
<span class="cm">        options = -A=&#39;33&#39; -i /f:c:\test -time:5:10 -x /date:11:08:2009</span>
<span class="cm">        optlist := argp_getopt(options, &quot;s i test a&quot;, false, v1, v2, v3, v4)</span>
<span class="cm">        Text =</span>
<span class="cm">        (</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        %count%</span>
<span class="cm">        </span>
<span class="cm">        List of all matching key names (optlist):</span>
<span class="cm">        %optlist%</span>
<span class="cm">        </span>
<span class="cm">        Value of key 4 (v4):</span>
<span class="cm">        %v4%</span>
<span class="cm">        )</span>
<span class="cm">        MsgBox %Text%</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    *Output:*</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        6</span>
<span class="cm">        </span>
<span class="cm">        List of all matching key names (optlist):</span>
<span class="cm">         a i </span>
<span class="cm">        </span>
<span class="cm">        Value of key 4 (v4):</span>
<span class="cm">        33</span>
<span class="cm">    (End)</span>
<span class="cm">*/</span>
<span class="nf">argp_getopt</span><span class="p">(</span>ByRef<span class="w"> </span>_args<span class="p">,</span><span class="w"> </span>_keylist<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>_case<span class="o">=</span>true<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_3<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_4<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_5<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_6<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_7<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_8<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_9<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_10<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_11<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_12<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_13<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_14<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_15<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_16<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_17<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_18<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_19<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_20<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_21<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_22<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_23<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_24<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_25<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_26<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_27<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_28<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_29<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_30<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_31<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>_32<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>CaseSense<span class="o">:=</span><span class="nb">A_StringCaseSense</span>
<span class="w">    </span><span class="k">StringCaseSense</span><span class="p">,</span>Off
<span class="w">    </span>_1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_4<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_5<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_6<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_7<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_8<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_9<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_10<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_11<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_12<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_13<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_14<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_15<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_16<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_17<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_18<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_19<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_20<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_21<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_22<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_23<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_24<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_25<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_26<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_27<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_28<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_29<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_30<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_31<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>_32<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>RegExMatch<span class="p">(</span>_args<span class="p">,</span><span class="s">&quot;JSs</span><span class="se">`a</span><span class="s">)(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v1&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v2&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v3&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v4&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v5&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v6&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v7&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v8&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v9&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v10&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v11&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v12&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v13&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v14&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v15&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v16&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n17&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v17&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v17&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v17&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n18&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v18&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v18&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v18&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n19&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v19&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v19&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v19&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n20&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v20&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v20&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v20&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n21&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v21&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v21&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v21&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n22&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v22&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v22&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v22&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n23&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v23&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v23&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v23&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v24&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v24&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v24&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v25&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v25&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v25&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v26&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v26&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v26&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v27&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v27&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v27&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v28&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v28&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v28&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v29&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v29&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v29&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v30&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v30&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v30&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v31&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v31&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v31&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v32&gt;.+?)&#39;)(?=.*?)|&quot;&quot;(?:(?P&lt;v32&gt;.+?)&quot;&quot;)(?=.*?)|[\s&#39;&quot;&quot;]?\s*(?P&lt;v32&gt;[^-/\s]*)\s*))?&quot;</span><span class="p">,</span>_<span class="p">)</span><span class="w"> </span><span class="c1">; 32 elements.</span>
<span class="w">    </span><span class="c1">; At keys, one space is needed for checking.</span>
<span class="w">    </span>count<span class="o">:=</span><span class="mi">0</span><span class="p">,</span>keys<span class="o">:=</span><span class="s">&quot; &quot;</span><span class="p">,</span>i<span class="o">:=</span><span class="mi">0</span>
<span class="w">    </span><span class="k">Loop</span><span class="p">,</span><span class="mi">32</span><span class="w"> </span><span class="c1">; 32 corresponding to the maximum possible number of matching elements.</span>
<span class="w">        </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_n<span class="nv">%A_Index%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span>count<span class="o">:=</span><span class="nb">A_Index</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_keylist<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span>n<span class="o">:=</span>_n<span class="nv">%A_Index%</span>
<span class="w">            </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>InStr<span class="p">(</span>keys<span class="p">,</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>n<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span>_case<span class="p">))</span>
<span class="w">                </span>_<span class="nv">%A_Index%</span><span class="o">:=</span>_v<span class="nv">%A_Index%</span><span class="p">,</span>keys<span class="p">.</span><span class="o">=</span>_n<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Space</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>_case<span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span>i<span class="o">:=</span><span class="nb">A_Index</span><span class="p">,</span>n<span class="o">:=</span>_n<span class="nv">%A_Index%</span>
<span class="w">            </span><span class="k">Loop</span><span class="p">,</span>Parse<span class="p">,</span>_keylist<span class="p">,</span><span class="nv">%A_Space%</span><span class="p">,</span><span class="nv">%A_Space%</span>
<span class="w">                </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>n<span class="o">==</span><span class="nb">A_LoopField</span><span class="o">&amp;&amp;!</span>InStr<span class="p">(</span>keys<span class="p">,</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span>true<span class="p">))</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span>_<span class="nv">%A_Index%</span><span class="o">:=</span>_v<span class="nv">%i%</span><span class="p">,</span>keys<span class="p">.</span><span class="o">=</span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Space</span>
<span class="w">                    </span><span class="k">Break</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>InStr<span class="p">(</span>keys<span class="p">,</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span>false<span class="p">))</span>
<span class="w">                    </span>_<span class="nv">%A_Index%</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">Else</span><span class="w"> </span><span class="c1">; Uses = instead of == and false instead of true in InStr() and case</span>
<span class="w">         </span><span class="c1">; takes the correct case version from source.</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span>i<span class="o">:=</span><span class="nb">A_Index</span><span class="p">,</span>n<span class="o">:=</span>_n<span class="nv">%A_Index%</span>
<span class="w">            </span><span class="k">Loop</span><span class="p">,</span>Parse<span class="p">,</span>_keylist<span class="p">,</span><span class="nv">%A_Space%</span><span class="p">,</span><span class="nv">%A_Space%</span>
<span class="w">                </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>n<span class="o">=</span><span class="nb">A_LoopField</span><span class="o">&amp;&amp;!</span>InStr<span class="p">(</span>keys<span class="p">,</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span>false<span class="p">))</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span>_<span class="nv">%A_Index%</span><span class="o">:=</span>_v<span class="nv">%i%</span><span class="p">,</span>keys<span class="p">.</span><span class="o">=</span>n<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_Space</span><span class="w"> </span><span class="c1">; n is case from source.</span>
<span class="w">                    </span><span class="k">Break</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>InStr<span class="p">(</span>keys<span class="p">,</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span>false<span class="p">))</span>
<span class="w">                    </span>_<span class="nv">%A_Index%</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">StringCaseSense</span><span class="p">,</span><span class="nv">%CaseSense%</span>
<span class="w">    </span>ErrorLevel<span class="o">:=</span>count<span class="w"> </span><span class="c1">; Number of matching elements.</span>
<span class="w">    </span><span class="k">Return</span><span class="w"> </span>keys
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">_______________________________________________________________________________</span>
<span class="cm">_______________________________________________________________________________</span>

<span class="cm">Title: argp - Argument Options Parser</span>
<span class="cm">    Parse an argument string with options and get keys and values.</span>
<span class="cm">_______________________________________________________________________________</span>
<span class="cm">_______________________________________________________________________________</span>

<span class="cm">License:</span>

<span class="cm">(C) Copyright 2009, 2010 Tuncay</span>
<span class="cm">    </span>
<span class="cm">This program is free software; you can redistribute it and/or modify</span>
<span class="cm">it under the terms of the GNU Lesser General Public License as published by</span>
<span class="cm">the Free Software Foundation; either version 3 of the License, or</span>
<span class="cm">(at your option) any later version.</span>

<span class="cm">This program is distributed in the hope that it will be useful,</span>
<span class="cm">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">GNU Lesser General Public License for more details.</span>

<span class="cm">You should have received a copy of the GNU Lesser General Public License</span>
<span class="cm">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="cm">(see lgplv3.png)</span>

<span class="cm">See the file COPYING.txt and COPYING.LESSER.txt for license and copying conditions.</span>

<span class="cm">About: Description</span>
<span class="cm">    About the idea</span>

<span class="cm">Introduction:</span>
<span class="cm">    Sometimes we need to work with many optional parameters. Some of the</span>
<span class="cm">    parameters may be just logical flags only (true/false). If the function have</span>
<span class="cm">    too many such parameters, the usability is endangered. To workaround</span>
<span class="cm">    that disgrace, we can make one option string to the function. From now </span>
<span class="cm">    on, this string contains all parameters. This is comparable to the </span>
<span class="cm">    commandline.</span>
<span class="cm">        </span>
<span class="cm">    It must be parsed to find all parts. Writing such parsers could become </span>
<span class="cm">    difficult and slow down the complete process. The parsing is tried to </span>
<span class="cm">    be made with one regex call only (with some other non dramatic lines).</span>
<span class="cm">    As long as the string is keeped simple, there should be no problem. But </span>
<span class="cm">    with growing complexity, with different values of subparameters, it is a </span>
<span class="cm">    pain to make the difference.</span>
<span class="cm">    </span>
<span class="cm">Who needs this?:    </span>
<span class="cm">    This is not a parser for command line arguments of programs or scripts.</span>
<span class="cm">    It is similiar to Windows or Unix/Linux command line arguments, but </span>
<span class="cm">    different in some ways and less powerful. This library is for those ahk </span>
<span class="cm">    developers, who needs to write user defined functions with many options. </span>
<span class="cm">    With the parsing of just one real function parameter, it can be avoided to </span>
<span class="cm">    have a bunch of function parameters. </span>
<span class="cm">    </span>
<span class="cm">What it can do for you:</span>
<span class="cm">    The source will be parsed and all found options are given over to specified</span>
<span class="cm">    variables. The other work parsing these generated variables is left to the </span>
<span class="cm">    user. </span>
<span class="cm">    </span>
<span class="cm">    * *Pro:* A standardized, simple and fast way of options handling.</span>
<span class="cm">    * *Contra:* It isn`t a well known official standard.</span>

<span class="cm">History:</span>
<span class="cm">    This library is rewritten from scratch and the old BUG or LIMITATION is</span>
<span class="cm">    not present anymore. Not only that. It does work in a completly another</span>
<span class="cm">    way. After searching the web, I found a regular expression made by </span>
<span class="cm">    Richard Hauer at regexlib.com. I have modified it and now it is the </span>
<span class="cm">    backbone of my functions. One deserved credit goes to him.</span>
<span class="cm">    </span>
<span class="cm">    The name of the library is changed again, from args to argp. The chosen </span>
<span class="cm">    name argp is a GNU C library for parsing arguments of programs. This </span>
<span class="cm">    AutoHotkey library is named like it, but there is no compatibility with</span>
<span class="cm">    the GNU C library. The name is an abbreviation for &quot;ARGument Parser&quot;.</span>
<span class="cm">    </span>
<span class="cm">Links:</span>
<span class="cm">    * Discussion: [http://www.autohotkey.com/forum/viewtopic.php?p=310409]</span>
<span class="cm">    * License: [http://www.gnu.org/licenses/lgpl-3.0.html]</span>
<span class="cm">    * Wikipedia - LGPL: [http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License]</span>

<span class="cm">Date:</span>
<span class="cm">    2010-01-30</span>

<span class="cm">Revision:</span>
<span class="cm">    3.0</span>
<span class="cm">    </span>
<span class="cm">Status:</span>
<span class="cm">    Release</span>

<span class="cm">Credits:</span>
<span class="cm">    * Tuncay, [tuncay.d@gmx.de] (Author)</span>
<span class="cm">    * Richard Hauer [http://regexlib.com/REDetails.aspx?regexp_id=1220] (Author of original Regular Expression)</span>
<span class="cm">    </span>
<span class="cm">License:</span>
<span class="cm">    GNU Lesser General Public License 3.0 or higher [http://www.gnu.org/licenses/lgpl-3.0.html]</span>
<span class="cm">    </span>
<span class="cm">Category:</span>
<span class="cm">    String Manipulation</span>

<span class="cm">Type:</span>
<span class="cm">    Library</span>

<span class="cm">Tested AutoHotkey Version:</span>
<span class="cm">    1.0.48.05</span>

<span class="cm">Tested Platform:</span>
<span class="cm">    2000/XP</span>

<span class="cm">Standalone (such as no need for extern file or library):</span>
<span class="cm">    Yes</span>

<span class="cm">StdLibConform (such as use of prefix and no globals use):</span>
<span class="cm">    Yes</span>

<span class="cm">Related:</span>
<span class="cm">    *Other Community Solutions*</span>
<span class="cm">    * Parameters and switches parser by Yook: [http://www.autohotkey.com/forum/viewtopic.php?t=50885]</span>
<span class="cm">    * [function] Parse by majkinetor: [http://www.autohotkey.com/forum/viewtopic.php?t=49261]</span>
<span class="cm">    * options.ahkl - an options object for AutoHotkey_L by ahklerner: [http://www.autohotkey.com/forum/viewtopic.php?t=49430]</span>

<span class="cm">About: Usage</span>
<span class="cm">    How to use the functions</span>

<span class="cm">Syntax:    </span>
<span class="cm">    &gt; count := argp_parse( source [, maxcount, keyname1, value1, ... keyname32, value32] )</span>
<span class="cm">    &gt;</span>
<span class="cm">    &gt; optlist := argp_getopt( source [, keylist, caseSense, value1, ... value32] )</span>
<span class="cm">    </span>
<span class="cm">    There are two independently working functions. They have the same regular expression</span>
<span class="cm">    at the core, but the functionality and interface differs. One creates variables for each</span>
<span class="cm">    key name and the other one returns a list with names, checking against another list of </span>
<span class="cm">    possible names (either with case sense on or off and, removing dublicates).</span>

<span class="cm">    After calling one of the functions, the variables or the list must be parsed. This is</span>
<span class="cm">    left to be done by the user. For the beginner, it is recommended to use argp_getopt() and then</span>
<span class="cm">    check with InStr() if a name exists in resulting list (with surrounding spaces).</span>

<span class="cm">    No globals are created, no special objects or frameworks are needed. </span>
<span class="cm"> </span>
<span class="cm">Installation:</span>
<span class="cm">    Just name the library to &quot;argp.ahk&quot; and put it into the standard or user library folder.</span>
<span class="cm">    A call of one of these functions in this library will lead to automatically include it </span>
<span class="cm">    into the script at call time. The folder should reside under one of these paths:</span>
<span class="cm">    </span>
<span class="cm">    &gt; %A_MyDocuments%\AutoHotkey\Lib\  ; User library.</span>
<span class="cm">    &gt; path-to-the-currently-running-AutoHotkey.exe\Lib\  ; Standard library.</span>
<span class="cm">    </span>
<span class="cm">    Alternatively you can include this library at any position of your script with the </span>
<span class="cm">    #include command:</span>
<span class="cm">    </span>
<span class="cm">    &gt; #Include argp.ahk</span>

<span class="cm">Example 1:</span>
<span class="cm">    This is part of parsing the options parameter from hypotetical function set_clipboard().</span>
<span class="cm">    The code demonstrates some aspects only, and it`s not optimized.</span>
<span class="cm">    </span>
<span class="cm">    (Code)        </span>
<span class="cm">        ; Set default values prior to parsing argument string.        </span>
<span class="cm">        opt_wait_use := false</span>
<span class="cm">        opt_errorlevel_set := false</span>
<span class="cm">                </span>
<span class="cm">        ; Analyze the variable argument for existence of options namely &quot;wait&quot; and &quot;errorlevel&quot;.</span>
<span class="cm">        ; Save the value of &quot;wait&quot; into variable wait_value.</span>
<span class="cm">        ; After that, a new list with option names is get and saved into variable optlist.        </span>
<span class="cm">        optlist := argp_getopt(argument, &quot;wait errorlevel&quot;, false, wait_value)</span>
<span class="cm">                </span>
<span class="cm">        ; Now, parse the list and set options for programs usage.        </span>
<span class="cm">        If InStr(optlist, &quot; wait &quot;)</span>
<span class="cm">        {</span>
<span class="cm">            opt_wait_use := true</span>
<span class="cm">            opt_wait_value := wait_value</span>
<span class="cm">        }</span>
<span class="cm">        </span>
<span class="cm">        If InStr(optlist, &quot; errorlevel &quot;)</span>
<span class="cm">        {</span>
<span class="cm">            opt_errorlevel_set := true</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    If the set_clipboard() function was called with following options</span>
<span class="cm">    </span>
<span class="cm">    &gt; &quot;-w:2&quot;</span>
<span class="cm">    </span>
<span class="cm">    Then the following variables are set</span>
<span class="cm">    </span>
<span class="cm">    &gt; opt_wait_use := true</span>
<span class="cm">    &gt; opt_wait_value := 2</span>
<span class="cm">    &gt; opt_errorlevel_set := false</span>
<span class="cm">    </span>
<span class="cm">Example 2:</span>
<span class="cm">    The next example shall show how to translate an usual function to argp_getopt()</span>
<span class="cm">    powered function. One function could look like this (very boring I know):</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        display(sentence = &quot;hello world&quot;, caseMod = 0, html = 0)</span>
<span class="cm">        {</span>
<span class="cm">            If (caseMod = 1)</span>
<span class="cm">                StringUpper, sentence, sentence, T</span>
<span class="cm">            Else If (caseMod = 2)</span>
<span class="cm">                StringUpper, sentence, sentence</span>
<span class="cm">            Else If (caseMod = 3)</span>
<span class="cm">                StringLower, sentence, sentence</span>
<span class="cm">            If ( html)</span>
<span class="cm">                Transform, sentence, HTML, %sentence%</span>
<span class="cm">            MsgBox %sentence%</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    A call could look like this</span>
<span class="cm">    </span>
<span class="cm">    &gt; display(&quot;hello world&quot;, 1, 1)</span>
<span class="cm">    </span>
<span class="cm">    Next code is one possible version with argp</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        display(options)</span>
<span class="cm">        {</span>
<span class="cm">            ; Default values of options.</span>
<span class="cm">            sentence = hello world</span>
<span class="cm">            </span>
<span class="cm">            ; Parsing options.</span>
<span class="cm">            optlist := argp_getopt(options, &quot;sentence caseMod html&quot;, false, sentence_value, caseMod_value)</span>
<span class="cm">            </span>
<span class="cm">            Loop, Parse, optlist, %A_Space%, %A_Space%</span>
<span class="cm">            {</span>
<span class="cm">                If (&quot;sentence&quot; = A_LoopField)</span>
<span class="cm">                    sentence := sentence_value</span>
<span class="cm">                Else If (&quot;caseMod&quot; = A_LoopField)</span>
<span class="cm">                {</span>
<span class="cm">                    If (caseMod_value = 1)</span>
<span class="cm">                        StringUpper, sentence, sentence, T</span>
<span class="cm">                    Else If (caseMod_value = 2)</span>
<span class="cm">                        StringUpper, sentence, sentence</span>
<span class="cm">                    Else If (caseMod_value = 3)</span>
<span class="cm">                        StringLower, sentence, sentence</span>
<span class="cm">                }</span>
<span class="cm">                Else If (&quot;html&quot; = A_LoopField)</span>
<span class="cm">                    Transform, sentence, HTML, %sentence%</span>
<span class="cm">            }</span>
<span class="cm">            </span>
<span class="cm">            MsgBox %sentence%</span>
<span class="cm">        }</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    Lets see how a call could look now</span>
<span class="cm">    </span>
<span class="cm">    &gt; display(&quot;-caseMod 2 -html&quot;)</span>
<span class="cm">    </span>
<span class="cm">    What is done there? First we have changed from multiple function parameters to </span>
<span class="cm">    single parameter. All the necessary default parameters are set in the function </span>
<span class="cm">    body. Then the argp_getopt() is used to parse options variable. The third </span>
<span class="cm">    parameter (here set to false) is for doing the parse without case sensitivity. </span>
<span class="cm">    All the parameters after that, are variables for holding possible values of the </span>
<span class="cm">    options. That is, because every option can have its own value. </span>
<span class="cm">    </span>
<span class="cm">    After this process, the resulting optlist variable holds the found names of options </span>
<span class="cm">    (given are the three &quot;sentence caseMod html&quot;). As a next step, this optlist </span>
<span class="cm">    variable must be parsed manually for checking which options are found actually and </span>
<span class="cm">    doing the right actions. In this example, a Loop, Parse command is chosen. There </span>
<span class="cm">    are other possibilities like multiple InStr() checks.</span>
<span class="cm">    </span>
<span class="cm">About: Specification</span>
<span class="cm">    Argument string format</span>

<span class="cm">Basic structure:</span>
<span class="cm">    Any option must begin either with a hypghen &quot;-&quot; or slash &quot;/&quot;, to be </span>
<span class="cm">    recognized as an option. It doesn`t matter which of the two is used. </span>
<span class="cm">    The following character or word until next option or space is the key </span>
<span class="cm">    name of that option. In example:    </span>
<span class="cm">    </span>
<span class="cm">    &gt; -a -b</span>
<span class="cm">    and</span>
<span class="cm">    &gt; -a-b</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; b</span>
<span class="cm">    </span>
<span class="cm">    Although space is not required, you can write without it.</span>
<span class="cm">    </span>
<span class="cm">    Normally parts in string that are not recognized as options should be ignored. In </span>
<span class="cm">    such a case, the resulting variable and value is allways empty. </span>

<span class="cm">Values added to keys:</span>
<span class="cm">    Every option can have its own assigned value. The value can be delimited</span>
<span class="cm">    from its key name with a space &quot; &quot;, a double colon &quot;:&quot; or an equality sign &quot;=&quot;.</span>
<span class="cm">    If it is enclosed in quotes, then no delimiter is needed. The value is read until </span>
<span class="cm">    one space is found (or another option starts). In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a test1 -b</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; b</span>
<span class="cm">    </span>
<span class="cm">    Where &quot;a&quot; holds the value &quot;test1&quot;.</span>
<span class="cm">    </span>
<span class="cm">    Normally spaces around a value are lost. The value can be optionally enclosed</span>
<span class="cm">    between a pair of single or double quotes. That way spaces inside the quotes</span>
<span class="cm">    are saved. </span>
<span class="cm">    </span>
<span class="cm">    &gt; -a:&#39;foo -bar &#39; -B -c hello world</span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; B</span>
<span class="cm">    &gt; c</span>
<span class="cm">    </span>
<span class="cm">    Where a holds the value &quot;foo -bar &quot; and c the value &quot;hello&quot;.</span>
<span class="cm">    </span>
<span class="cm">    If a value contains one of these characters -, /, :, =, &#39; or &quot;, then it is best </span>
<span class="cm">    to enclose the whole value between quotes (single or double).</span>

<span class="cm">Dublicate keys:</span>
<span class="cm">    argp_parse() and argp_getopt() treat duplicate definitions of option names in </span>
<span class="cm">    different ways. argp_parse() sees every key separately. And argp_getopt() sees</span>
<span class="cm">    the first definition only. This is important if they have values. In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a:foo -a:bar -A</span>
<span class="cm">    </span>
<span class="cm">    would argp_getopt() resolve to</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; A</span>
<span class="cm">    </span>
<span class="cm">    where a would holds the value &quot;foo&quot; and A would have an empty value.</span>
<span class="cm">    In contrast argp_parse() resolves to</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; a</span>
<span class="cm">    &gt; A</span>
<span class="cm">    </span>
<span class="cm">    first a holds &quot;foo&quot; and second a holds &quot;bar&quot;. Again, the last A have an</span>
<span class="cm">    empty value.</span>
<span class="cm">    </span>
<span class="cm">Key naming:</span>
<span class="cm">    These characters in key name are allowed: a-z, A-Z, 0-9, _, ., ?, ! and @. Some</span>
<span class="cm">    examples:</span>
<span class="cm">    </span>
<span class="cm">    &gt; -a</span>
<span class="cm">    &gt; -test</span>
<span class="cm">    &gt; /test.example</span>
<span class="cm">    &gt; /?</span>
<span class="cm">    &gt; -64</span>
<span class="cm">    &gt; -@section</span>
<span class="cm">    </span>
<span class="cm">The one special value without key name:    </span>
<span class="cm">    There is one exception in argp_parse() function only. Any string before</span>
<span class="cm">    first option is treated as a special value without a key name. That value </span>
<span class="cm">    is parsed like any other value. In example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; hello -a    </span>
<span class="cm">    </span>
<span class="cm">    would be resolved to these keys</span>
<span class="cm">    </span>
<span class="cm">    &gt; a</span>
<span class="cm">    </span>
<span class="cm">    The key &quot;a&quot; does have an empty value and the first special value &quot;hello&quot; </span>
<span class="cm">    is saved in ErrorLevel. This is supported by argp_parse() function exclusively.</span>
<span class="cm">*/</span>


<span class="cm">/*</span>
<span class="cm">Func: argp_parse</span>
<span class="cm">    Get optional keys and values as separate variables.</span>
<span class="cm">    </span>
<span class="cm">Syntax:</span>
<span class="cm">    &gt; count := argp_parse( args [, maxcount, n1, v1, ... n32, v32] )</span>

<span class="cm">Parameters:</span>
<span class="cm">    args            - *Variable* [string] input: Source String variable with options to parse. See above </span>
<span class="cm">                        at &quot;Specification&quot;, which is a description about the format.</span>
<span class="cm">    maxcount        - *Optional* [integer] input:  Specifies how many options to get. Anything </span>
<span class="cm">                        below &#39;1&#39; or above &#39;32&#39; defaults to &#39;32&#39;.</span>
<span class="cm">    n1-n32          - *Variable Optional* [string] output: Stores the key name of option into variable.</span>
<span class="cm">                        Variable n1 would hold first found name of option (i.e. &quot;A&quot;).</span>
<span class="cm">    v1-v32          - *Variable Optional* [string] output: Stores the value of an option into variable.</span>
<span class="cm">                        Variable v1 would hold value of first found option (i.e. &quot;33&quot;).</span>

<span class="cm">Returns:</span>
<span class="cm">    Number of retrieved options, or &#39;0&#39; otherwise.</span>

<span class="cm">Remarks:</span>
<span class="cm">    maxcount can be set to an integer value between 1 and 32. That restricts the number</span>
<span class="cm">    of options to extract from source string. In example, if specified to 8, then the </span>
<span class="cm">    first 8 options are seen and the rest is ignored. This is an optimization. Maximum</span>
<span class="cm">     possible of 6 options to parse is faster than to parse 26 options. Plus, there are </span>
<span class="cm">    special optimizations to 8, 16 and 32, so they are faster in execution against values</span>
<span class="cm">    near to them. These values (8, 16, 32) are highly recommended.</span>

<span class="cm">ErrorLevel:</span>
<span class="cm">    ErrorLevel is set to the first special value without key name. Otherwise it is empty.</span>
<span class="cm">    With following example:</span>
<span class="cm">    </span>
<span class="cm">    &gt; get -i</span>
<span class="cm">    </span>
<span class="cm">    it would hold &quot;get&quot;. With next example</span>
<span class="cm">    </span>
<span class="cm">    &gt; -i get</span>
<span class="cm">    </span>
<span class="cm">    ErrorLevel would be empty.</span>
<span class="cm">    </span>
<span class="cm">Examples:</span>
<span class="cm">    (Code)</span>
<span class="cm">        options = -A=&#39;33&#39; -i /f:c:\test -time:5:10 -x /date:11:08:2009</span>
<span class="cm">        count := argp_parse(options, 8, n1, v1, n2, v2, n3, v3, n4, v4, n5, v5, n6, v6, n7, v7, n8, v8)</span>
<span class="cm">        Text =</span>
<span class="cm">        (</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        %count%</span>
<span class="cm">        </span>
<span class="cm">        Name of key 3 (n3):</span>
<span class="cm">        %n3%</span>
<span class="cm">        </span>
<span class="cm">        Value of key 3 (v3):</span>
<span class="cm">        %v3%</span>
<span class="cm">        )</span>
<span class="cm">        MsgBox %Text%</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    *Output:*</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        6</span>
<span class="cm">        </span>
<span class="cm">        Name of key 3 (n3):</span>
<span class="cm">        f</span>
<span class="cm">        </span>
<span class="cm">        Value of key 3 (v3):</span>
<span class="cm">        c:\test</span>
<span class="cm">    (End)</span>
<span class="cm">*/</span>
<span class="n">argp_parse</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_maxcount</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n10</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v10</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n11</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v11</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n12</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v12</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n13</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v13</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n14</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v14</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n15</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v15</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n16</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v16</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n17</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v17</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n18</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v18</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n19</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v19</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n20</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v20</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n21</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v21</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n22</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v22</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n23</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v23</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n24</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v24</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n25</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v25</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n26</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v26</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n27</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v27</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n28</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v28</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n29</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v29</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n30</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v30</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n31</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v31</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_n32</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_v32</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">_maxcount</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">||</span><span class="n">_maxcount</span><span class="o">&gt;</span><span class="mi">32</span><span class="p">)</span>
<span class="w">        </span><span class="nl">_maxcount:</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">_maxcount</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="c-Singleline"> ; Optimization to avoid Loop.</span>
<span class="w">        </span><span class="nl">_n1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n4</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n5</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n6</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n7</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n8</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n9</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n10</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n11</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n12</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n13</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n14</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n15</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n16</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n17</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n18</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n19</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n20</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n21</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n22</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n23</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n24</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n25</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n26</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n27</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n28</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n29</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n30</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n31</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n32</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">regex</span> <span class="o">:=</span> <span class="s">&quot;JSs`a)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v1&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v2&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v3&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v4&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v5&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v6&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v7&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v8&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v9&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v10&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v11&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v12&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v13&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v14&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v15&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v16&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n17&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v17&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v17&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v17&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n18&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v18&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v18&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v18&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n19&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v19&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v19&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v19&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n20&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v20&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v20&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v20&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n21&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v21&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v21&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v21&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n22&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v22&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v22&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v22&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n23&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v23&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v23&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v23&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v24&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v24&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v24&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v25&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v25&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v25&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v26&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v26&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v26&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v27&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v27&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v27&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v28&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v28&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v28&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v29&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v29&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v29&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v30&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v30&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v30&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v31&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v31&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v31&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v32&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v32&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v32&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="n">_maxcount</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span><span class="c-Singleline"> ; Optimization to avoid Loop.</span>
<span class="w">        </span><span class="nl">_n1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n4</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n5</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n6</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n7</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n8</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n9</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n10</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n11</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n12</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n13</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n14</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n15</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n16</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">regex</span> <span class="o">:=</span> <span class="s">&quot;JSs`a)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v1&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v2&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v3&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v4&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v5&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v6&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v7&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v8&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v9&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v10&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v11&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v12&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v13&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v14&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v15&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v16&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="n">_maxcount</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="c-Singleline"> ; Optimization to avoid Loop.</span>
<span class="w">        </span><span class="nl">_n1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n4</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n5</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n6</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n7</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_n8</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">regex</span> <span class="o">:=</span> <span class="s">&quot;JSs`a)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v1&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v2&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v3&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v4&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v5&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v6&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v7&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v8&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">    </span><span class="nb">Else</span>
    <span class="p">{</span>
        <span class="n">If</span> <span class="p">(</span><span class="n">_maxcount</span><span class="o">&gt;</span><span class="mi">8</span><span class="p">)</span>
            <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span><span class="mi">4624</span><span class="p">)</span> 
<span class="w">        </span><span class="nl">regex:</span><span class="o">=</span><span class="s">&quot;JSs`a)(?:(&#39;(?:(?P&lt;v&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|\s*(?P&lt;v&gt;[^-/\s]*)\s*))?&quot;</span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%_maxcount%</span>
<span class="w">            </span><span class="nl">_n%A_Index%:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">regex</span><span class="o">.=</span><span class="s">&quot;(?:(?:.*?\s*)[-/](?P&lt;n&quot;</span> <span class="o">.</span> <span class="nv">A_Index</span> <span class="o">.</span> <span class="s">&quot;&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v&quot;</span> <span class="o">.</span> <span class="nv">A_Index</span> <span class="o">.</span> <span class="s">&quot;&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v&quot;</span> <span class="o">.</span> <span class="nv">A_Index</span> <span class="o">.</span> <span class="s">&quot;&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v&quot;</span> <span class="o">.</span> <span class="nv">A_Index</span> <span class="o">.</span> <span class="s">&quot;&gt;[^-/\s]*)\s*))?&quot;</span>
    <span class="p">}</span>
    <span class="nf">RegExMatch</span><span class="p">(</span><span class="n">_args</span><span class="p">,</span><span class="n">regex</span><span class="p">,</span><span class="n">_</span><span class="p">),</span><span class="nv">ErrorLevel</span><span class="o">:=</span><span class="n">_v</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">_n</span><span class="nv">%_maxcount%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="c-Singleline"> ; Possible shortcut to avoid checking for each variable.</span>
<span class="w">        </span><span class="nb">Return</span> <span class="n">_maxcount</span>
<span class="w">    </span><span class="nb">Else</span>
    <span class="p">{</span>
<span class="w">        </span><span class="nl">count:</span><span class="o">=</span><span class="mi">0</span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%_maxcount%</span>
            <span class="n">If</span> <span class="p">(</span><span class="n">_n</span><span class="nv">%A_Index%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="nl">count:</span><span class="o">=</span><span class="nv">A_Index</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">Return</span> <span class="n">count</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm">Func: argp_getopt</span>
<span class="cm">    Check for known keys and get list of them and all values as separate variables.</span>

<span class="cm">Syntax:</span>
<span class="cm">    &gt; optlist := argp_getopt( source [, keylist, caseSense, value1, ... value32] )</span>

<span class="cm">Parameters:</span>
<span class="cm">    args            - *Variable* [string] input: Source String variable with options to parse. See above </span>
<span class="cm">                        at &quot;Specification&quot;, which is a description about the format.</span>
<span class="cm">    keyList         - *Optional* [string] input: A space separated list of option names. Every key </span>
<span class="cm">                        in options source string args will be in returning optlist. All values are</span>
<span class="cm">                        written to output variables from number 1 to 32. The third item in this list</span>
<span class="cm">                        relates to third output variable.</span>
<span class="cm">                        If the keylist is empty &quot;&quot;, then all existing key names are get.</span>
<span class="cm">    case            - *Optional* [flag] input: Case sensitivity of names checking; sensitiv at </span>
<span class="cm">                        default (true or 1) leads to let &quot;a&quot; as a different option as &quot;A&quot;.</span>
<span class="cm">    1-32            - *Variable Optional* [string] output: Stores the value of option into variable.</span>
<span class="cm">                        Variable number 1 would hold value (i.e. &quot;33&quot;) of first defined option (i.e. &quot;A&quot;).</span>

<span class="cm">Returns:</span>
<span class="cm">    Get a space separated list of matching names. This means, all not found option names </span>
<span class="cm">    are filtered out from keyList. Duplicate names are not found and first one is used </span>
<span class="cm">    instead. (In example: &quot;A file A c i&quot;, these are the names of 4 options.) </span>
<span class="cm">    </span>
<span class="cm">    If keyList is empty, then all options found in source is returned. Order of corresponding</span>
<span class="cm">    values (specified variables 1-32) reflects the order in source. But if keyList is a non </span>
<span class="cm">    empty list, then all options specified in this list are returned.</span>

<span class="cm">Remarks:</span>
<span class="cm">    Other than argp_parse(), this function awaits a list of option names in keyList. That</span>
<span class="cm">    keylist is compared against all found option names from source. All matching keys are</span>
<span class="cm">    copied to resulting return list. </span>
<span class="cm">    </span>
<span class="cm">    The returning list have spaces around also (at begin of list and end of). That allows </span>
<span class="cm">    checking for existency of keys with </span>
<span class="cm">    </span>
<span class="cm">    &gt; InStr(keylist, &quot; A &quot;)</span>
<span class="cm">    </span>
<span class="cm">    Any existing value corresponding to the key name is copied to output variable ranging </span>
<span class="cm">    from 1 to 32. In example second options value belongs to second variable, even if there</span>
<span class="cm">    is no value. In that case, the value is an empty string (blank value).</span>

<span class="cm">ErrorLevel:</span>
<span class="cm">    ErrorLevel is set to the number of matching option names. Duplicates are not counted. </span>
<span class="cm">    If nothing is found, it is set to &#39;0&#39;. It is not the count of resulting keylist, but the</span>
<span class="cm">    count of keys in source string args.</span>

<span class="cm">Examples:</span>
<span class="cm">    (Code)</span>
<span class="cm">        options = -A=&#39;33&#39; -i /f:c:\test -time:5:10 -x /date:11:08:2009</span>
<span class="cm">        optlist := argp_getopt(options, &quot;s i test a&quot;, false, v1, v2, v3, v4)</span>
<span class="cm">        Text =</span>
<span class="cm">        (</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        %count%</span>
<span class="cm">        </span>
<span class="cm">        List of all matching key names (optlist):</span>
<span class="cm">        %optlist%</span>
<span class="cm">        </span>
<span class="cm">        Value of key 4 (v4):</span>
<span class="cm">        %v4%</span>
<span class="cm">        )</span>
<span class="cm">        MsgBox %Text%</span>
<span class="cm">    (End)</span>
<span class="cm">    </span>
<span class="cm">    *Output:*</span>
<span class="cm">    </span>
<span class="cm">    (Code)</span>
<span class="cm">        Number of options in source (options):</span>
<span class="cm">        6</span>
<span class="cm">        </span>
<span class="cm">        List of all matching key names (optlist):</span>
<span class="cm">         a i </span>
<span class="cm">        </span>
<span class="cm">        Value of key 4 (v4):</span>
<span class="cm">        33</span>
<span class="cm">    (End)</span>
<span class="cm">*/</span>
<span class="n">argp_getopt</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_keylist</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">_case</span><span class="o">=</span><span class="nv">true</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_7</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_8</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_9</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_10</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_11</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_12</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_13</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_14</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_15</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_16</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_17</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_18</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_19</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_20</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_21</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_22</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_23</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_24</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_25</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_26</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_27</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_28</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_29</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_30</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_31</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">_32</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nl">CaseSense:</span><span class="o">=</span><span class="nv">A_StringCaseSense</span>
<span class="w">    </span><span class="nb">StringCaseSense</span><span class="p">,</span><span class="n">Off</span>
<span class="w">    </span><span class="nl">_1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_4</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_5</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_6</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_7</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_8</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_9</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_10</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_11</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_12</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_13</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_14</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_15</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_16</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_17</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_18</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_19</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_20</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_21</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_22</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_23</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_24</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_25</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_26</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_27</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_28</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_29</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_30</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_31</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">_32</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">_args</span><span class="p">,</span><span class="s">&quot;JSs`a)(?:(?:.*?\s*)[-/](?P&lt;n1&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v1&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v1&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v1&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n2&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v2&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v2&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v2&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n3&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v3&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v3&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v3&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n4&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v4&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v4&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v4&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n5&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v5&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v5&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v5&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n6&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v6&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v6&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v6&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n7&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v7&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v7&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v7&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n8&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v8&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v8&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v8&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n9&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v9&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v9&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v9&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n10&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v10&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v10&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v10&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n11&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v11&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v11&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v11&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n12&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v12&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v12&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v12&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n13&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v13&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v13&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v13&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n14&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v14&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v14&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v14&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n15&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v15&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v15&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v15&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n16&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v16&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v16&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v16&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n17&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v17&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v17&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v17&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n18&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v18&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v18&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v18&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n19&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v19&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v19&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v19&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n20&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v20&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v20&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v20&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n21&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v21&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v21&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v21&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n22&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v22&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v22&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v22&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n23&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v23&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v23&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v23&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v24&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v24&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v24&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v25&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v25&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v25&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v26&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v26&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v26&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v27&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v27&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v27&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v28&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v28&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v28&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v29&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v29&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v29&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v30&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v30&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v30&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v31&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v31&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v31&gt;[^-/\s]*)\s*))?(?:(?:.*?\s*)[-/](?P&lt;n24&gt;[a-zA-Z0-9_?!@.]+)(?:[:=]\s*)?(\s*&#39;(?:(?P&lt;v32&gt;.+?)&#39;)(?=.*?)|</span><span class="se">&quot;&quot;</span><span class="s">(?:(?P&lt;v32&gt;.+?)</span><span class="se">&quot;&quot;</span><span class="s">)(?=.*?)|[\s&#39;</span><span class="se">&quot;&quot;</span><span class="s">]?\s*(?P&lt;v32&gt;[^-/\s]*)\s*))?&quot;</span><span class="p">,</span><span class="n">_</span><span class="p">)</span><span class="c-Singleline"> ; 32 elements.</span>
<span class="c-Singleline">    ; At keys, one space is needed for checking.</span>
<span class="w">    </span><span class="nl">count:</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">keys</span><span class="o">:=</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="n">i</span><span class="o">:=</span><span class="mi">0</span>
<span class="w">    </span><span class="nb">Loop</span><span class="p">,</span><span class="mi">32</span><span class="c-Singleline"> ; 32 corresponding to the maximum possible number of matching elements.</span>
        <span class="n">If</span> <span class="p">(</span><span class="n">_n</span><span class="nv">%A_Index%</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nl">count:</span><span class="o">=</span><span class="nv">A_Index</span>
    
    <span class="n">If</span> <span class="p">(</span><span class="n">_keylist</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="p">{</span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%count%</span>
        <span class="p">{</span>
<span class="w">            </span><span class="nl">n:</span><span class="o">=</span><span class="n">_n</span><span class="nv">%A_Index%</span>
            <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="n">n</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">,</span><span class="n">_case</span><span class="p">))</span>
<span class="w">                </span><span class="nl">_%A_Index%:</span><span class="o">=</span><span class="n">_v</span><span class="nv">%A_Index%</span><span class="p">,</span><span class="n">keys</span><span class="o">.=</span><span class="n">_n</span> <span class="o">.</span> <span class="nv">A_Space</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="n">_case</span><span class="p">)</span>
    <span class="p">{</span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%count%</span>
        <span class="p">{</span>
<span class="w">            </span><span class="nl">i:</span><span class="o">=</span><span class="nv">A_Index</span><span class="p">,</span><span class="n">n</span><span class="o">:=</span><span class="n">_n</span><span class="nv">%A_Index%</span>
<span class="w">            </span><span class="nb">Loop</span><span class="p">,</span><span class="n">Parse</span><span class="p">,</span><span class="n">_keylist</span><span class="p">,</span><span class="nv">%A_Space%</span><span class="p">,</span><span class="nv">%A_Space%</span>
                <span class="n">If</span> <span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="nv">A_LoopField</span><span class="o">&amp;&amp;!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="nv">A_LoopField</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">,</span><span class="nv">true</span><span class="p">))</span>
                <span class="p">{</span>
<span class="w">                    </span><span class="nl">_%A_Index%:</span><span class="o">=</span><span class="n">_v</span><span class="nv">%i%</span><span class="p">,</span><span class="n">keys</span><span class="o">.=</span><span class="nv">A_LoopField</span> <span class="o">.</span> <span class="nv">A_Space</span>
<span class="w">                    </span><span class="nb">Break</span>
                <span class="p">}</span>
<span class="w">                </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="nv">A_LoopField</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">,</span><span class="nv">false</span><span class="p">))</span>
<span class="w">                    </span><span class="nl">_%A_Index%:</span><span class="o">=</span><span class="s">&quot;&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">Else</span><span class="c-Singleline"> ; Uses = instead of == and false instead of true in InStr() and case</span>
<span class="c-Singleline">         ; takes the correct case version from source.</span>
    <span class="p">{</span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%count%</span>
        <span class="p">{</span>
<span class="w">            </span><span class="nl">i:</span><span class="o">=</span><span class="nv">A_Index</span><span class="p">,</span><span class="n">n</span><span class="o">:=</span><span class="n">_n</span><span class="nv">%A_Index%</span>
<span class="w">            </span><span class="nb">Loop</span><span class="p">,</span><span class="n">Parse</span><span class="p">,</span><span class="n">_keylist</span><span class="p">,</span><span class="nv">%A_Space%</span><span class="p">,</span><span class="nv">%A_Space%</span>
                <span class="n">If</span> <span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nv">A_LoopField</span><span class="o">&amp;&amp;!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="nv">A_LoopField</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">,</span><span class="nv">false</span><span class="p">))</span>
                <span class="p">{</span>
<span class="w">                    </span><span class="nl">_%A_Index%:</span><span class="o">=</span><span class="n">_v</span><span class="nv">%i%</span><span class="p">,</span><span class="n">keys</span><span class="o">.=</span><span class="n">n</span> <span class="o">.</span> <span class="nv">A_Space</span><span class="c-Singleline"> ; n is case from source.</span>
<span class="w">                    </span><span class="nb">Break</span>
                <span class="p">}</span>
<span class="w">                </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="s">&quot; &quot;</span> <span class="o">.</span> <span class="nv">A_LoopField</span> <span class="o">.</span> <span class="s">&quot; &quot;</span><span class="p">,</span><span class="nv">false</span><span class="p">))</span>
<span class="w">                    </span><span class="nl">_%A_Index%:</span><span class="o">=</span><span class="s">&quot;&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">StringCaseSense</span><span class="p">,</span><span class="nv">%CaseSense%</span>
<span class="w">    </span><span class="nl">ErrorLevel:</span><span class="o">=</span><span class="n">count</span><span class="c-Singleline"> ; Number of matching elements.</span>
<span class="w">    </span><span class="nb">Return</span> <span class="n">keys</span>
<span class="p">}</span>
</pre></div>
