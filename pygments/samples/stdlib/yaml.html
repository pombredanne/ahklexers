<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; Simple Yaml Parser by HotKeyIt</span>
<span class="c1">; 2010, http://www.autohotkey.com/forum/viewtopic.php?t=60670</span>
<span class="nf">Yaml_Add</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>recursive<span class="o">:=</span>InStr<span class="p">(</span>key1<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="k">StringTrimLeft</span><span class="p">,</span>key1<span class="p">,</span>key1<span class="p">,</span><span class="mi">1</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nf">InStr</span><span class="p">(</span>key1<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">)</span>
<span class="w">      </span>parent<span class="o">:=</span>SubStr<span class="p">(</span>key1<span class="p">,</span><span class="mi">1</span><span class="p">,</span>InStr<span class="p">(</span>key1<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="k">StringTrimLeft</span><span class="p">,</span>key<span class="p">,</span>key1<span class="p">,</span><span class="o">%</span><span class="w"> </span>InStr<span class="p">(</span>key1<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>parent<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">))</span>
<span class="w">      </span><span class="nf">Yaml_Add</span><span class="p">(</span>pYaml<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="w"> </span>parent<span class="p">,</span>key<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">){</span>
<span class="w">      </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>parent<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>parent<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span>count<span class="o">++</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>parent<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>parent<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>count<span class="p">)</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>parent<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>parent<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>count<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>count<span class="p">,</span>key<span class="p">)</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>recursive<span class="p">){</span>
<span class="w">      </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>count<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">         </span>count<span class="o">=</span><span class="mi">2</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="w"> </span><span class="s">&quot;.1&quot;</span><span class="p">,</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">))</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">         </span>count<span class="o">++</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>count<span class="p">)</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>count<span class="p">,</span>key2<span class="p">)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span>key2<span class="o">:=</span><span class="p">(</span>RegExMatch<span class="p">(</span>Key2<span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>key2<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>key2<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">,</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>key2<span class="w"> </span><span class="o">:</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">)</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span>key2<span class="p">)</span>
<span class="p">}</span>
<span class="nf">Yaml_Exist</span><span class="p">(</span>pYaml<span class="p">,</span>Key<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>var<span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">      </span>wStr<span class="o">:=</span>Key
<span class="w">   </span><span class="k">else</span>
<span class="w">      </span><span class="nf">VarSetCapacity</span><span class="p">(</span>wStr<span class="p">,</span><span class="w"> </span>StrLen<span class="p">(</span>Key<span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>Key<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wStr<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>StrLen<span class="p">(</span>Key<span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>DllCall<span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wStr<span class="p">),</span>var<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var<span class="p">,</span><span class="w"> </span><span class="s">&quot;IntP&quot;</span><span class="p">,</span>bExist<span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="k">Return</span><span class="w"> </span>bExist
<span class="p">}</span>

<span class="nf">Yaml_Dump</span><span class="p">(</span>pYaml<span class="p">,</span>ByRef<span class="w"> </span>Output<span class="p">,</span>key<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>key<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span>mainkey<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">         </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="w"> </span><span class="c1">;&quot;---`r`n&quot;</span>
<span class="w">         </span>value<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="p">)</span>
<span class="w">         </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>mainkey<span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>mainkey<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>mainkey<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">))</span><span class="w"> </span><span class="s">&quot;:&quot;</span>
<span class="w">         </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>sub<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">1</span><span class="p">)){</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>sub<span class="p">){</span>
<span class="w">               </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">){</span>
<span class="w">                  </span>value<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>mainkey<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">                  </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;  - &quot;</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>value<span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>value<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>value<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">Continue</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span>value<span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span><span class="nf">Yaml_Dump</span><span class="p">(</span>pYaml<span class="p">,</span>Output<span class="p">,</span><span class="s">&quot;.&quot;</span><span class="w"> </span>mainkey<span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span>Output
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span>start<span class="o">:=</span>RegExMatch<span class="p">(</span>key<span class="p">,</span><span class="s">&quot;[^\.]&quot;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)){</span>
<span class="w">         </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>start<span class="o">*</span><span class="mi">2</span>
<span class="w">            </span>recurse<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="nb">A_Space</span>
<span class="w">         </span><span class="k">StringTrimLeft</span><span class="p">,</span>_key<span class="p">,</span>key<span class="p">,</span><span class="nv">%start%</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>_key<span class="o">:=</span>key
<span class="w">      </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span>
<span class="w">         </span>key1<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">         </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span>value<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="p">)</span>
<span class="w">         </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>recurse<span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>key1<span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>key1<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">))</span><span class="w"> </span><span class="s">&quot;:&quot;</span>
<span class="w">         </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>sub<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.1&quot;</span><span class="p">)){</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>sub<span class="p">){</span>
<span class="w">               </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">){</span>
<span class="w">                  </span>value<span class="o">:=</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>_key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">                  </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>recurse<span class="w"> </span><span class="s">&quot;  - &quot;</span><span class="w"> </span>value<span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">Continue</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Output<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span>value<span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span><span class="nf">Yaml_Dump</span><span class="p">(</span>pYaml<span class="p">,</span>Output<span class="p">,</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key1<span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">Return</span><span class="w"> </span>output
<span class="p">}</span>

<span class="nf">Yaml_Save</span><span class="p">(</span>pYaml<span class="p">,</span>ToFile<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nf">Yaml_Dump</span><span class="p">(</span>pYaml<span class="p">,</span>file<span class="p">)</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ToFile<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>FileExist<span class="p">(</span>ToFile<span class="p">)){</span>
<span class="w">      </span><span class="k">StringReplace</span><span class="p">,</span>savefile<span class="p">,</span>file<span class="p">,`</span>n<span class="p">,`</span>r<span class="p">`</span>n<span class="p">,</span>A
<span class="w">      </span><span class="k">FileMove</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">.</span>bkp<span class="p">.</span>yaml
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nf">FileExist</span><span class="p">(</span>ToFile<span class="p">){</span>
<span class="w">         </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Saving<span class="w"> </span>File
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">FileAppend</span><span class="p">,</span><span class="nv">%savefile%</span><span class="p">,</span><span class="nv">%ToFile%</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ErrorLevel<span class="p">){</span>
<span class="w">         </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Saving<span class="w"> </span>File
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">FileDelete</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">.</span>bkp<span class="p">.</span>yaml
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ErrorLevel<span class="p">){</span>
<span class="w">         </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Saving<span class="w"> </span>File
<span class="w">         </span><span class="k">FileDelete</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">.</span>bkp
<span class="w">         </span><span class="k">FileMove</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">.</span>bkp<span class="p">.</span>yaml<span class="p">,</span><span class="nv">%ToFile%</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>ToFile<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="k">StringReplace</span><span class="p">,</span>savefile<span class="p">,</span>file<span class="p">,`</span>n<span class="p">,`</span>r<span class="p">`</span>n<span class="p">,</span>A
<span class="w">      </span><span class="k">FileAppend</span><span class="p">,</span><span class="nv">%savefile%</span><span class="p">,</span><span class="nv">%ToFile%</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ErrorLevel<span class="p">){</span>
<span class="w">            </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Saving<span class="w"> </span>File
<span class="w">         </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">Return</span><span class="w"> </span>file
<span class="p">}</span>

<span class="nf">Yaml_Clone</span><span class="p">(</span>pYaml<span class="p">){</span>
<span class="w">   </span><span class="kt">static</span><span class="w"> </span>CLSIDString<span class="o">:=</span><span class="s">&quot;{EE09B103-97E0-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span><span class="w"> </span>IIDString<span class="o">:=</span><span class="s">&quot;{42C642C1-97E1-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span><span class="w"> </span>StrGet<span class="o">:=</span><span class="s">&quot;StrGet&quot;</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>Init<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>Init<span class="o">:=</span><span class="mi">1</span><span class="p">){</span><span class="w"> </span><span class="c1">;Initialize COM and create database</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoInitialize&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var1<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var2<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var1<span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var2<span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>CLSID<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wKey<span class="p">,</span><span class="w"> </span><span class="mi">79</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>IID<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">         </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>CLSIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>IIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UIntP&quot;</span><span class="p">,</span>_pYaml<span class="p">)</span><span class="w"> </span><span class="c1">; CLSCTX=5</span>
<span class="w">   </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>_pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>_pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>var1<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var2<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var1<span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var2<span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">80</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UIntP&quot;</span><span class="p">,</span>penum<span class="p">)</span><span class="w"> </span><span class="c1">; create key-list in penum</span>
<span class="w">   </span><span class="k">Loop</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>penum<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>penum<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var1<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>penum<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>penum<span class="p">)</span><span class="w">   </span><span class="c1">; END: destroy key-list</span>
<span class="w">         </span>penum<span class="o">=</span><span class="w">                                                  </span><span class="c1">; signal end of list</span>
<span class="w">         </span>ErrorLevel<span class="o">=</span><span class="w">                                                  </span><span class="c1">; empty</span>
<span class="w">         </span><span class="k">Return</span><span class="w"> </span>_pYaml<span class="w">                                                      </span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">         </span>wStr<span class="o">:=</span><span class="nv">%StrGet%</span><span class="p">(</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span>nLen<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wKey<span class="p">,</span><span class="w"> </span>nLen<span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>nLen<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>wKey<span class="p">,</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>wKey<span class="p">))</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">Yaml_Get</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="kt">static</span><span class="w"> </span>StrGet<span class="o">:=</span><span class="s">&quot;StrGet&quot;</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>var1<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var2<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var1<span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var2<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">      </span>wStr<span class="o">:=</span>key1
<span class="w">   </span><span class="k">else</span>
<span class="w">      </span><span class="nf">VarSetCapacity</span><span class="p">(</span>wStr<span class="p">,</span><span class="w"> </span>StrLen<span class="p">(</span>Key1<span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>Key1<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wStr<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>StrLen<span class="p">(</span>Key1<span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>DllCall<span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wStr<span class="p">),</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var1<span class="p">,</span><span class="w"> </span><span class="s">&quot;IntP&quot;</span><span class="p">,</span>bExist<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span>bExist<span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var1<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var2<span class="p">)</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>NumGet<span class="p">(</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="mh">0xcdcdcdcd</span><span class="p">)</span><span class="w"> </span><span class="c1">;uninitialized = empty string</span>
<span class="w">         </span><span class="k">Return</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">         </span>Key2<span class="o">:=</span><span class="nv">%StrGet%</span><span class="p">(</span>NumGet<span class="p">(</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span>nLen<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">VarSetCapacity</span><span class="p">(</span>Key2<span class="p">,</span><span class="w"> </span>nLen<span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>Key2<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>nLen<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var2<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="k">Return</span><span class="w"> </span>Key2
<span class="p">}</span>
<span class="nf">Yaml_Set</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">){</span>
<span class="w">      </span><span class="nf">Yaml_Add</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">,</span>key2<span class="p">)</span>
<span class="w">      </span><span class="k">return</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">,</span>key2<span class="p">)</span>
<span class="w">   </span><span class="k">Return</span>
<span class="p">}</span>
<span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>key1<span class="p">,</span>key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">){</span>
<span class="w">      </span><span class="nf">VarSetCapacity</span><span class="p">(</span>var<span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span>var<span class="nv">%A_Index%</span><span class="p">)</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">         </span>wStr<span class="o">:=</span>Key<span class="nv">%A_Index%</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span><span class="nf">VarSetCapacity</span><span class="p">(</span>wStr<span class="p">,</span><span class="w"> </span>StrLen<span class="p">(</span>Key<span class="nv">%A_Index%</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>Key<span class="nv">%A_Index%</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wStr<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>StrLen<span class="p">(</span>Key<span class="nv">%A_Index%</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="nf">NumPut</span><span class="p">(</span>DllCall<span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wStr<span class="p">),</span>var<span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var1<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var2<span class="p">)</span><span class="w">  </span><span class="c1">; 8 (Set0 -&gt; 7)</span>
<span class="w">   </span><span class="k">Loop</span><span class="w"> </span><span class="mi">2</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var<span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var<span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">Yaml_Insert</span><span class="p">(</span>_pYaml<span class="p">,</span>Yaml_File<span class="p">,</span>MainItem0<span class="p">){</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nf">FileExist</span><span class="p">(</span>Yaml_File<span class="p">){</span>
<span class="w">      </span><span class="k">FileRead</span><span class="p">,</span>Yaml_File_<span class="p">,</span><span class="nv">%Yaml_File%</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ErrorLevel<span class="p">){</span>
<span class="w">         </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Reading<span class="w"> </span>File
<span class="w">         </span><span class="k">Return</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Yaml_File_<span class="o">:=</span>Yaml_File
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span>Parse<span class="p">,</span>MainItem0<span class="p">,.</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span>space<span class="p">.</span><span class="o">=</span><span class="nb">A_Space</span><span class="w"> </span><span class="nb">A_Space</span>
<span class="w">      </span>_depth<span class="o">:=</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span>
<span class="w">      </span>MainItem<span class="nv">%_depth%</span><span class="o">:=</span><span class="nb">A_LoopField</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span>Parse<span class="p">,</span>Yaml_File_<span class="p">,`</span>n<span class="p">,`</span>r
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="o">=</span>
<span class="w">         </span><span class="k">Continue</span>
<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>create
<span class="w">         </span>Key1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Key2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Key3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Item<span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>create<span class="p">){</span>
<span class="w">         </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key1<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">)</span>
<span class="w">            </span>count<span class="o">++</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>count<span class="p">,</span>Key1<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">,</span><span class="w"> </span>count<span class="p">)</span>
<span class="w">            </span>item<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="p">,</span>item<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Key1<span class="w"> </span><span class="o">:</span><span class="w"> </span>item<span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span>key1<span class="p">)</span>
<span class="w">            </span><span class="k">Continue</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="k">Loop</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span>Key<span class="nv">%A_Index%</span><span class="o">=</span>
<span class="w">         </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s*)(\w+)\s?:\s?(.*)\s?$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="k">Loop</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span>Key<span class="nv">%A_Index%</span><span class="o">=</span>
<span class="w">            </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s*)&#39;(.+)&#39;:\s?(.*)\s?$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span>LastLine<span class="p">.</span><span class="o">=</span>Space<span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">Continue</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>SubStr<span class="p">(</span>LastLine<span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">StringTrimRight</span><span class="p">,</span>LastLine<span class="p">,</span>LastLine<span class="p">,</span><span class="mi">1</span>
<span class="w">         </span>depth<span class="o">:=</span>Round<span class="p">(</span>Strlen<span class="p">(</span>Key1<span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span>_depth<span class="o">+</span><span class="mi">1</span>
<span class="w">         </span>MainItem<span class="nv">%depth%</span><span class="o">:=</span>Key2
<span class="w">         </span>Item<span class="o">:=</span>MainItem0
<span class="w">         </span><span class="k">While</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">((</span>i<span class="o">:=</span><span class="nb">A_Index</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>depth<span class="o">&gt;</span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">            </span>Item<span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>MainItem<span class="nv">%i%</span>
<span class="w">         </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key2<span class="p">){</span>
<span class="w">            </span>MainItem<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">)</span>
<span class="w">            </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">)</span>
<span class="w">            </span>count<span class="o">++</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">,</span>count<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>count<span class="p">,</span>key2<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>MainItem<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>MainItem<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>Key2<span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>key2<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>key2<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">))</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span>Item<span class="p">.</span><span class="o">=</span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>key2
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>key3<span class="p">)</span>
<span class="w">         </span>LastItem<span class="o">:=</span>Item
<span class="w">         </span><span class="kr">If</span><span class="w"> </span>LastLine<span class="o">!=</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">,</span>LastLine<span class="p">),</span>LastLine<span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">)</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nf">RegExMatch</span><span class="p">(</span>Key3<span class="p">,</span><span class="s">&quot;^\s*&quot;&quot;&quot;</span><span class="p">)</span>
<span class="w">         </span>create<span class="o">:=</span><span class="mi">1</span>
<span class="w">      </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>create<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>RegExMatch<span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;&quot;&quot;\s*$&quot;</span><span class="p">))</span>
<span class="w">         </span>create<span class="o">:=</span><span class="mi">0</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
<span class="nf">Yaml_DeleteAll</span><span class="p">(</span>pYaml<span class="p">){</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">68</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">)</span><span class="w"> </span><span class="c1">;delete all keys</span>
<span class="p">}</span>
<span class="nf">Yaml_Delete</span><span class="p">(</span>pYaml<span class="p">,</span>key<span class="p">){</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>var1<span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span>var1<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">      </span>wStr<span class="o">:=</span>key
<span class="w">   </span><span class="k">else</span>
<span class="w">      </span><span class="nf">VarSetCapacity</span><span class="p">(</span>wStr<span class="p">,</span><span class="w"> </span>StrLen<span class="p">(</span>Key<span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>Key<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wStr<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span>StrLen<span class="p">(</span>Key<span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>DllCall<span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wStr<span class="p">),</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>var1<span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>NumGet<span class="p">(</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>var1<span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">Yaml_Init</span><span class="p">(</span>Yaml_File<span class="o">=</span><span class="s">&quot;?&quot;</span><span class="p">,</span>pointerYaml<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="kt">static</span><span class="w"> </span>pYaml<span class="p">,</span><span class="w"> </span>CLSID<span class="p">,</span>IID<span class="p">,</span>Init<span class="p">,</span>FileIndex
<span class="w">   </span><span class="kt">static</span><span class="w"> </span>CLSIDString<span class="o">:=</span><span class="s">&quot;{EE09B103-97E0-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span><span class="w"> </span>IIDString<span class="o">:=</span><span class="s">&quot;{42C642C1-97E1-11CF-978F-00A02463E06F}&quot;</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>Init<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>Init<span class="o">:=</span><span class="mi">1</span><span class="p">){</span><span class="w"> </span><span class="c1">;Initialize COM and create database</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoInitialize&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var1<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>var2<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var1<span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>var2<span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>CLSID<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wKey<span class="p">,</span><span class="w"> </span><span class="mi">79</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span>IID<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">         </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">)</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">         </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>CLSIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>IIDString<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
<span class="w">         </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>wKey<span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">)</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UIntP&quot;</span><span class="p">,</span>pYaml<span class="p">)</span><span class="w"> </span><span class="c1">; CLSCTX=5</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">; Set compare mode binary (casesensitive)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Yaml_File<span class="o">=</span><span class="s">&quot;?&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="nf">Yaml_Save</span><span class="p">(</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span><span class="nb">A_Index</span><span class="p">)),</span>Yaml_Get<span class="p">(</span>pYaml<span class="p">,</span><span class="nb">A_Index</span><span class="p">))</span>
<span class="w">      </span><span class="k">Return</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span><span class="nv">%Yaml_File%</span>
<span class="w">      </span>Yaml_File<span class="o">:=</span><span class="nb">A_LoopFileLongPath</span>
<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>Yaml_Exist<span class="p">(</span>_pYaml<span class="p">,</span>Yaml_File<span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>pointerYaml<span class="p">))</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>CLSID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Str&quot;</span><span class="p">,</span>IID<span class="p">,</span><span class="w"> </span><span class="s">&quot;UIntP&quot;</span><span class="p">,</span>_pYaml<span class="p">)</span><span class="w"> </span><span class="c1">; CLSCTX=5</span>
<span class="w">      </span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>_pYaml<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;UInt&quot;</span><span class="p">,</span>_pYaml<span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; Set compare mode text (caseinsensitive)</span>
<span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>pointerYaml<span class="p">)</span>
<span class="w">      </span>_pYaml<span class="o">:=</span>pointerYaml
<span class="w">   </span><span class="k">else</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nf">Yaml_Get</span><span class="p">(</span>pYaml<span class="p">,</span>Yaml_File<span class="p">)</span>
<span class="w">   </span><span class="kr">If</span><span class="w"> </span><span class="nf">FileExist</span><span class="p">(</span>Yaml_File<span class="p">){</span>
<span class="w">      </span><span class="k">FileRead</span><span class="p">,</span>Yaml_File_<span class="p">,</span><span class="nv">%Yaml_File%</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>ErrorLevel<span class="p">){</span>
<span class="w">         </span><span class="k">MsgBox</span><span class="w"> </span>Error<span class="w"> </span>Reading<span class="w"> </span>File
<span class="w">         </span><span class="k">Return</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span>FileIndex<span class="o">++</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span><span class="mi">0</span><span class="p">,</span>FileIndex<span class="p">)</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>FileIndex<span class="p">,</span>Yaml_File<span class="p">)</span>
<span class="w">      </span><span class="nf">Yaml_Assign</span><span class="p">(</span>pYaml<span class="p">,</span>Yaml_File<span class="p">,</span>_pYaml<span class="p">)</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span>Yaml_File_<span class="o">:=</span>Yaml_File
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span>Parse<span class="p">,</span>Yaml_File_<span class="p">,`</span>n<span class="p">,`</span>r
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="o">=</span>
<span class="w">         </span><span class="k">Continue</span>
<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>create
<span class="w">         </span>Key1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Key2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Key3<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>Item<span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>MainItem0<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>create<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span>RegExMatch<span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s&quot;</span><span class="p">))){</span>
<span class="w">         </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>RegExMatch<span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\w+)\s?:\s?(.*)\s*$&quot;</span><span class="p">,</span>MainItem<span class="p">)</span>
<span class="w">            </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>RegExMatch<span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^&#39;(.+)&#39;\s?:\s?(.*)\s*$&quot;</span><span class="p">,</span>MainItem<span class="p">){</span>
<span class="w">               </span>Key1<span class="o">=</span>
<span class="w">               </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">               </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key1<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">                  </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">)</span>
<span class="w">                  </span>count<span class="o">++</span>
<span class="w">                  </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>count<span class="p">,</span>Key1<span class="p">)</span>
<span class="w">                  </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">,</span><span class="w"> </span>count<span class="p">)</span>
<span class="w">                  </span>item<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="p">)</span>
<span class="w">                  </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="p">,</span>item<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Key1<span class="w"> </span><span class="o">:</span><span class="w"> </span>item<span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span>key1<span class="p">)</span>
<span class="w">                  </span><span class="k">Continue</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span>LastLine<span class="p">.</span><span class="o">=</span><span class="nb">A_LoopField</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="k">Continue</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">         </span>MainItem0<span class="o">:=</span>MainItem1
<span class="w">         </span>ItemCount<span class="o">++</span>
<span class="w">         </span>MainItem<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>MainItem0<span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>MainItem0<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>MainItem0<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span>MainItem<span class="p">)</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span><span class="mi">0</span><span class="p">,</span>ItemCount<span class="p">)</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>ItemCount<span class="p">,</span>MainItem0<span class="p">)</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="p">,</span>MainItem2<span class="p">)</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>SubStr<span class="p">(</span>LastLine<span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">StringTrimRight</span><span class="p">,</span>LastLine<span class="p">,</span>LastLine<span class="p">,</span><span class="mi">1</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>MainItem0<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">,</span>LastLine<span class="p">)</span>
<span class="w">         </span>MainItem<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>MainItem1<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>MainItem2<span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span>LastLine<span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">         </span>LastItem<span class="o">:=</span>MainItem0
<span class="w">         </span><span class="k">Continue</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>create<span class="p">){</span>
<span class="w">         </span>Key1<span class="o">=</span>
<span class="w">         </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key1<span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">)</span>
<span class="w">            </span>count<span class="o">++</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>count<span class="p">,</span>Key1<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">,</span><span class="w"> </span>count<span class="p">)</span>
<span class="w">            </span>item<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>LastItem<span class="p">,</span>item<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Key1<span class="w"> </span><span class="o">:</span><span class="w"> </span>item<span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span>key1<span class="p">)</span>
<span class="w">            </span><span class="k">Continue</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="k">Loop</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span>Key<span class="nv">%A_Index%</span><span class="o">=</span>
<span class="w">         </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s+)(\w+)\s?:\s?(.*)\s?$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="k">Loop</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span>Key<span class="nv">%A_Index%</span><span class="o">=</span>
<span class="w">            </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s+)&#39;(.+)&#39;:\s?(.*)\s?$&quot;</span><span class="p">,</span>Key<span class="p">)</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Key2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span>LastLine<span class="p">.</span><span class="o">=</span><span class="nb">A_LoopField</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="k">Continue</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>SubStr<span class="p">(</span>LastLine<span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">StringTrimRight</span><span class="p">,</span>LastLine<span class="p">,</span>LastLine<span class="p">,</span><span class="mi">1</span>
<span class="w">         </span>depth<span class="o">:=</span>Round<span class="p">(</span>Strlen<span class="p">(</span>Key1<span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span>MainItem<span class="nv">%depth%</span><span class="o">:=</span>Key2
<span class="w">         </span>Item<span class="o">:=</span>MainItem0
<span class="w">         </span><span class="k">While</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">((</span>i<span class="o">:=</span><span class="nb">A_Index</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>depth<span class="o">&gt;</span><span class="nb">A_Index</span><span class="p">)</span>
<span class="w">            </span>Item<span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>MainItem<span class="nv">%i%</span>
<span class="w">         </span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>Yaml_Exist<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>key2<span class="p">){</span>
<span class="w">            </span>MainItem<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">)</span>
<span class="w">            </span>count<span class="o">:=</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">)</span>
<span class="w">            </span>count<span class="o">++</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.0&quot;</span><span class="p">,</span>count<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>count<span class="p">,</span>key2<span class="p">)</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>MainItem<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>MainItem<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>Key2<span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>key2<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span>key2<span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">))</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span>Item<span class="p">.</span><span class="o">=</span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>key2
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>key3<span class="p">)</span>
<span class="w">         </span>LastItem<span class="o">:=</span>Item
<span class="w">         </span><span class="kr">If</span><span class="w"> </span>LastLine<span class="o">!=</span>
<span class="w">            </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">,</span>LastLine<span class="p">),</span>LastLine<span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">         </span><span class="nf">Yaml_Assign</span><span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">,</span>Yaml_Get<span class="p">(</span>_pYaml<span class="p">,</span>Item<span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">)</span>
<span class="w">      </span><span class="kr">If</span><span class="w"> </span><span class="nf">RegExMatch</span><span class="p">(</span>Key3<span class="p">,</span><span class="s">&quot;^\s*&quot;&quot;&quot;</span><span class="p">)</span>
<span class="w">         </span>create<span class="o">:=</span><span class="mi">1</span>
<span class="w">      </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>create<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>RegExMatch<span class="p">(</span><span class="nb">A_LoopField</span><span class="p">,</span><span class="s">&quot;&quot;&quot;\s*$&quot;</span><span class="p">))</span>
<span class="w">         </span>create<span class="o">:=</span><span class="mi">0</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">Return</span><span class="w"> </span>_pYaml
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; Simple Yaml Parser by HotKeyIt</span>
<span class="c-Singleline">; 2010, http://www.autohotkey.com/forum/viewtopic.php?t=60670</span>
<span class="n">Yaml_Add</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">recursive</span><span class="o">:=</span><span class="nf">InStr</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="nb">StringTrimLeft</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="mi">1</span>
<span class="w">   </span><span class="nb">If </span><span class="nf">InStr</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nl">parent:</span><span class="o">=</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">InStr</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="nb">StringTrimLeft</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="o">%</span> <span class="nf">InStr</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">parent</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">))</span>
      <span class="n">Yaml_Add</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="s">&quot;.&quot;</span> <span class="n">parent</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
   <span class="n">If</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">){</span>
<span class="w">      </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">parent</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="p">(</span><span class="n">parent</span> <span class="s">&quot;.&quot;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">count</span><span class="o">++</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">parent</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="p">(</span><span class="n">parent</span> <span class="s">&quot;.&quot;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">parent</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="p">(</span><span class="n">parent</span> <span class="s">&quot;.&quot;</span> <span class="n">count</span><span class="p">)</span> <span class="o">:</span> <span class="n">count</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">if</span> <span class="p">(</span><span class="o">!</span><span class="n">recursive</span><span class="p">){</span>
<span class="w">      </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span> <span class="s">&quot;.&quot;</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
         <span class="n">count</span><span class="o">=</span><span class="mi">2</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span> <span class="s">&quot;.1&quot;</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">))</span>
      <span class="p">}</span> <span class="n">else</span>
         <span class="n">count</span><span class="o">++</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span> <span class="s">&quot;.&quot;</span> <span class="mi">0</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span> <span class="s">&quot;.&quot;</span> <span class="n">count</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nl">key2:</span><span class="o">=</span><span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Key2</span><span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">key2</span> <span class="o">:</span> <span class="s">&quot;&#39;&quot;</span> <span class="n">key2</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
   <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">key2</span> <span class="o">:</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">)</span> <span class="s">&quot;,&quot;</span> <span class="n">key2</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Key</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">      </span><span class="nl">wStr:</span><span class="o">=</span><span class="n">Key</span>
<span class="w">   </span><span class="nb">else</span>
      <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wStr</span><span class="p">,</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Key</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wStr</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wStr</span><span class="p">),</span><span class="n">var</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var</span><span class="p">,</span> <span class="s">&quot;IntP&quot;</span><span class="p">,</span><span class="n">bExist</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="n">bExist</span>
<span class="p">}</span>

<span class="n">Yaml_Dump</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">ByRef</span> <span class="n">Output</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="p">{</span>
<span class="w">         </span><span class="nl">mainkey:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="nv">A_Index</span><span class="p">)</span>
         <span class="n">Output</span> <span class="o">.=</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="c-Singleline"> ;&quot;---`r`n&quot;</span>
<span class="w">         </span><span class="nl">value:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span><span class="p">)</span>
         <span class="n">Output</span> <span class="o">.=</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">mainkey</span><span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">mainkey</span> <span class="o">:</span> <span class="p">(</span><span class="s">&quot;&#39;&quot;</span> <span class="n">mainkey</span> <span class="s">&quot;&#39;&quot;</span><span class="p">))</span> <span class="s">&quot;:&quot;</span>
         <span class="n">if</span> <span class="p">(</span><span class="n">sub</span><span class="o">:=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.&quot;</span> <span class="mi">1</span><span class="p">)){</span>
            <span class="n">if</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.&quot;</span> <span class="n">sub</span><span class="p">){</span>
               <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.0&quot;</span><span class="p">){</span>
<span class="w">                  </span><span class="nl">value:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">mainkey</span> <span class="s">&quot;.&quot;</span> <span class="nv">A_Index</span><span class="p">)</span>
                  <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot;  - &quot;</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">value</span> <span class="o">:</span> <span class="s">&quot;&#39;&quot;</span> <span class="n">value</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="p">}</span>
<span class="w">               </span><span class="nb">Continue</span>
            <span class="p">}</span> <span class="n">else</span> <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="p">}</span> <span class="n">else</span> <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot; &quot;</span> <span class="n">value</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">Yaml_Dump</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Output</span><span class="p">,</span><span class="s">&quot;.&quot;</span> <span class="n">mainkey</span><span class="p">)</span>
      <span class="p">}</span>
<span class="w">      </span><span class="nb">return</span> <span class="n">Output</span>
   <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
      <span class="n">If</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">start</span><span class="o">:=</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s">&quot;[^\.]&quot;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)){</span>
<span class="w">         </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">start</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">recurse</span> <span class="o">.=</span> <span class="nv">A_Space</span>
<span class="w">         </span><span class="nb">StringTrimLeft</span><span class="p">,</span><span class="n">_key</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="nv">%start%</span>
      <span class="p">}</span> <span class="n">else</span> <span class="n">_key</span><span class="o">:=</span><span class="n">key</span>
<span class="w">      </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="mi">0</span><span class="p">){</span>
<span class="w">         </span><span class="nl">key1:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="nv">A_Index</span><span class="p">)</span>
         <span class="n">Output</span> <span class="o">.=</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">         </span><span class="nl">value:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span><span class="p">)</span>
         <span class="n">Output</span> <span class="o">.=</span> <span class="n">recurse</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span><span class="s">&quot;^\w+$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">key1</span> <span class="o">:</span> <span class="p">(</span><span class="s">&quot;&#39;&quot;</span> <span class="n">key1</span> <span class="s">&quot;&#39;&quot;</span><span class="p">))</span> <span class="s">&quot;:&quot;</span>
         <span class="n">if</span> <span class="p">(</span><span class="n">sub</span><span class="o">:=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.1&quot;</span><span class="p">)){</span>
            <span class="n">if</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.&quot;</span> <span class="n">sub</span><span class="p">){</span>
               <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.0&quot;</span><span class="p">){</span>
<span class="w">                  </span><span class="nl">value:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">_key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span> <span class="s">&quot;.&quot;</span> <span class="nv">A_Index</span><span class="p">)</span>
                  <span class="n">Output</span> <span class="o">.=</span> <span class="n">recurse</span> <span class="s">&quot;  - &quot;</span> <span class="n">value</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
               <span class="p">}</span>
<span class="w">               </span><span class="nb">Continue</span>
            <span class="p">}</span> <span class="n">else</span> <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="p">}</span> <span class="n">else</span> <span class="n">Output</span> <span class="o">.=</span> <span class="s">&quot; &quot;</span> <span class="n">value</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
         <span class="n">Yaml_Dump</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Output</span><span class="p">,</span> <span class="s">&quot;.&quot;</span> <span class="n">key</span> <span class="s">&quot;.&quot;</span> <span class="n">key1</span><span class="p">)</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">Return</span> <span class="n">output</span>
<span class="p">}</span>

<span class="n">Yaml_Save</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">ToFile</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
   <span class="n">Yaml_Dump</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">ToFile</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="nf">FileExist</span><span class="p">(</span><span class="n">ToFile</span><span class="p">)){</span>
<span class="w">      </span><span class="nb">StringReplace</span><span class="p">,</span><span class="n">savefile</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="se">`n</span><span class="p">,</span><span class="se">`r`n</span><span class="p">,</span><span class="n">A</span>
<span class="w">      </span><span class="nb">FileMove</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="o">.</span><span class="n">bkp</span><span class="o">.</span><span class="n">yaml</span>
<span class="w">      </span><span class="nb">If </span><span class="nf">FileExist</span><span class="p">(</span><span class="n">ToFile</span><span class="p">){</span>
<span class="w">         </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Saving</span> <span class="n">File</span>
      <span class="p">}</span>
<span class="w">      </span><span class="nb">FileAppend</span><span class="p">,</span><span class="nv">%savefile%</span><span class="p">,</span><span class="nv">%ToFile%</span>
      <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span><span class="p">){</span>
<span class="w">         </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Saving</span> <span class="n">File</span>
      <span class="p">}</span>
<span class="w">      </span><span class="nb">FileDelete</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="o">.</span><span class="n">bkp</span><span class="o">.</span><span class="n">yaml</span>
      <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span><span class="p">){</span>
<span class="w">         </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Saving</span> <span class="n">File</span>
<span class="w">         </span><span class="nb">FileDelete</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="o">.</span><span class="n">bkp</span>
<span class="w">         </span><span class="nb">FileMove</span><span class="p">,</span><span class="nv">%ToFile%</span><span class="o">.</span><span class="n">bkp</span><span class="o">.</span><span class="n">yaml</span><span class="p">,</span><span class="nv">%ToFile%</span>
      <span class="p">}</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">ToFile</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="nb">StringReplace</span><span class="p">,</span><span class="n">savefile</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="se">`n</span><span class="p">,</span><span class="se">`r`n</span><span class="p">,</span><span class="n">A</span>
<span class="w">      </span><span class="nb">FileAppend</span><span class="p">,</span><span class="nv">%savefile%</span><span class="p">,</span><span class="nv">%ToFile%</span>
         <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span><span class="p">){</span>
<span class="w">            </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Saving</span> <span class="n">File</span>
         <span class="p">}</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">Return</span> <span class="n">file</span>
<span class="p">}</span>

<span class="n">Yaml_Clone</span><span class="p">(</span><span class="n">pYaml</span><span class="p">){</span>
<span class="w">   </span><span class="nb">static</span> <span class="n">CLSIDString</span><span class="o">:=</span><span class="s">&quot;{EE09B103-97E0-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span> <span class="n">IIDString</span><span class="o">:=</span><span class="s">&quot;{42C642C1-97E1-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span> <span class="nf">StrGet</span><span class="o">:=</span><span class="s">&quot;StrGet&quot;</span>
   <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">Init</span> <span class="o">&amp;&amp;</span> <span class="n">Init</span><span class="o">:=</span><span class="mi">1</span><span class="p">){</span><span class="c-Singleline"> ;Initialize COM and create database</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoInitialize&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
      <span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var1</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var2</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CLSID</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wKey</span><span class="p">,</span> <span class="mi">79</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">IID</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
         <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSIDString</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IIDString</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">)</span>
<span class="w">      </span><span class="nb">else</span>
         <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">CLSIDString</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">IIDString</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">)</span>
   <span class="p">}</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">,</span> <span class="s">&quot;UIntP&quot;</span><span class="p">,</span><span class="n">_pYaml</span><span class="p">)</span><span class="c-Singleline"> ; CLSCTX=5</span>
   <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">_pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">_pYaml</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var1</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">80</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UIntP&quot;</span><span class="p">,</span><span class="n">penum</span><span class="p">)</span><span class="c-Singleline"> ; create key-list in penum</span>
<span class="w">   </span><span class="nb">Loop</span> <span class="p">{</span>
      <span class="n">If</span> <span class="p">(</span><span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">penum</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">penum</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
         <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">penum</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">penum</span><span class="p">)</span><span class="c-Singleline">   ; END: destroy key-list</span>
         <span class="n">penum</span><span class="o">=</span><span class="c-Singleline">                                                  ; signal end of list</span>
         <span class="nv">ErrorLevel</span><span class="o">=</span><span class="c-Singleline">                                                  ; empty</span>
<span class="w">         </span><span class="nb">Return</span> <span class="n">_pYaml</span>                                                      
      <span class="p">}</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">         </span><span class="nl">wStr:</span><span class="o">=</span><span class="nv">%StrGet%</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="w">      </span><span class="nb">else</span>
         <span class="n">nLen</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wKey</span><span class="p">,</span> <span class="n">nLen</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">nLen</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">wKey</span><span class="p">))</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nb">static</span> <span class="nf">StrGet</span><span class="o">:=</span><span class="s">&quot;StrGet&quot;</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var1</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var2</span><span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">      </span><span class="nl">wStr:</span><span class="o">=</span><span class="n">key1</span>
<span class="w">   </span><span class="nb">else</span>
      <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wStr</span><span class="p">,</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Key1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Key1</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wStr</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Key1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wStr</span><span class="p">),</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var1</span><span class="p">,</span> <span class="s">&quot;IntP&quot;</span><span class="p">,</span><span class="n">bExist</span><span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="n">bExist</span> <span class="p">{</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var2</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="mh">0xcdcdcdcd</span><span class="p">)</span><span class="c-Singleline"> ;uninitialized = empty string</span>
<span class="w">         </span><span class="nb">Return</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">         </span><span class="nl">Key2:</span><span class="o">=</span><span class="nv">%StrGet%</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="w">      </span><span class="nb">else</span>
         <span class="n">nLen</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">Key2</span><span class="p">,</span> <span class="n">nLen</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">Key2</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">nLen</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
   <span class="p">}</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="n">Key2</span>
<span class="p">}</span>
<span class="n">Yaml_Set</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
   <span class="n">If</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">){</span>
      <span class="n">Yaml_Add</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
<span class="w">      </span><span class="nb">return</span>
   <span class="p">}</span>
   <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span>
<span class="p">}</span>
<span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key1</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nb">Loop</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="p">){</span>
      <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var</span><span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">var</span><span class="nv">%A_Index%</span><span class="p">)</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">         </span><span class="nl">wStr:</span><span class="o">=</span><span class="n">Key</span><span class="nv">%A_Index%</span>
<span class="w">      </span><span class="nb">else</span>
         <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wStr</span><span class="p">,</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="nv">%A_Index%</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Key</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wStr</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="nv">%A_Index%</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
      <span class="nf">NumPut</span><span class="p">(</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wStr</span><span class="p">),</span><span class="n">var</span><span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
   <span class="p">}</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var2</span><span class="p">)</span><span class="c-Singleline">  ; 8 (Set0 -&gt; 7)</span>
<span class="w">   </span><span class="nb">Loop</span> <span class="mi">2</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var</span><span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var</span><span class="nv">%A_Index%</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">Yaml_Insert</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Yaml_File</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">){</span>
<span class="w">   </span><span class="nb">If </span><span class="nf">FileExist</span><span class="p">(</span><span class="n">Yaml_File</span><span class="p">){</span>
<span class="w">      </span><span class="nb">FileRead</span><span class="p">,</span><span class="n">Yaml_File_</span><span class="p">,</span><span class="nv">%Yaml_File%</span>
      <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span><span class="p">){</span>
<span class="w">         </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Reading</span> <span class="n">File</span>
<span class="w">         </span><span class="nb">Return</span>
      <span class="p">}</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">Yaml_File_</span><span class="o">:=</span><span class="n">Yaml_File</span>
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span><span class="n">Parse</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">,</span><span class="o">.</span>
   <span class="p">{</span>
      <span class="n">space</span><span class="o">.=</span><span class="nv">A_Space</span> <span class="nv">A_Space</span>
<span class="w">      </span><span class="nl">_depth:</span><span class="o">=</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span>
<span class="w">      </span><span class="nl">MainItem%_depth%:</span><span class="o">=</span><span class="nv">A_LoopField</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span><span class="n">Parse</span><span class="p">,</span><span class="n">Yaml_File_</span><span class="p">,</span><span class="se">`n</span><span class="p">,</span><span class="se">`r</span>
   <span class="p">{</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_LoopField</span><span class="o">=</span>
<span class="w">         </span><span class="nb">Continue</span>
      <span class="n">if</span> <span class="o">!</span><span class="n">create</span>
<span class="w">         </span><span class="nl">Key1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Key2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Key3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Item</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
      <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">create</span><span class="p">){</span>
         <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key1</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.0&quot;</span><span class="p">)</span>
            <span class="n">count</span><span class="o">++</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.&quot;</span> <span class="n">count</span><span class="p">,</span><span class="n">Key1</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.0&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="w">            </span><span class="nl">item:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span><span class="p">,</span><span class="n">item</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">Key1</span> <span class="o">:</span> <span class="n">item</span> <span class="s">&quot;,&quot;</span> <span class="n">key1</span><span class="p">)</span>
<span class="w">            </span><span class="nb">Continue</span>
         <span class="p">}</span>
<span class="w">         </span><span class="nb">Loop</span> <span class="mi">3</span>
            <span class="n">Key</span><span class="nv">%A_Index%</span><span class="o">=</span>
         <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s*)(\w+)\s?:\s?(.*)\s?$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="nb">Loop</span> <span class="mi">3</span>
                <span class="n">Key</span><span class="nv">%A_Index%</span><span class="o">=</span>
            <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s*)&#39;(.+)&#39;:\s?(.*)\s?$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="p">}</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
            <span class="n">LastLine</span><span class="o">.=</span><span class="n">Space</span> <span class="nv">A_LoopField</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="nb">Continue</span>
         <span class="p">}</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nb">StringTrimRight</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">1</span>
<span class="w">         </span><span class="nl">depth:</span><span class="o">=</span><span class="nf">Round</span><span class="p">(</span><span class="nf">Strlen</span><span class="p">(</span><span class="n">Key1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">_depth</span><span class="o">+</span><span class="mi">1</span>
<span class="w">         </span><span class="nl">MainItem%depth%:</span><span class="o">=</span><span class="n">Key2</span>
<span class="w">         </span><span class="nl">Item:</span><span class="o">=</span><span class="n">MainItem0</span>
<span class="w">         </span><span class="nb">While</span> <span class="o">%</span> <span class="p">((</span><span class="n">i</span><span class="o">:=</span><span class="nv">A_Index</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">depth</span><span class="o">&gt;</span><span class="nv">A_Index</span><span class="p">)</span>
            <span class="n">Item</span><span class="o">.=</span> <span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">MainItem</span><span class="nv">%i%</span>
         <span class="n">If</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="s">&quot;.&quot;</span> <span class="n">key2</span><span class="p">){</span>
<span class="w">            </span><span class="nl">MainItem:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">)</span>
<span class="w">            </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.0&quot;</span><span class="p">)</span>
            <span class="n">count</span><span class="o">++</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.0&quot;</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">count</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">MainItem</span> <span class="o">.</span> <span class="p">(</span><span class="n">MainItem</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="s">&quot;,&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Key2</span><span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">key2</span> <span class="o">:</span> <span class="s">&quot;&#39;&quot;</span> <span class="n">key2</span> <span class="s">&quot;&#39;&quot;</span><span class="p">))</span>
         <span class="p">}</span>
         <span class="n">Item</span><span class="o">.=</span><span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">key2</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">key3</span><span class="p">)</span>
<span class="w">         </span><span class="nl">LastItem:</span><span class="o">=</span><span class="n">Item</span>
<span class="w">         </span><span class="nb">If </span><span class="n">LastLine</span><span class="o">!=</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.&quot;</span><span class="p">,</span><span class="n">LastLine</span><span class="p">),</span><span class="n">LastLine</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
      <span class="p">}</span> <span class="n">else</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">)</span> <span class="o">.</span> <span class="nv">A_LoopField</span><span class="p">)</span>
<span class="w">      </span><span class="nb">If </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Key3</span><span class="p">,</span><span class="s">&quot;^\s*</span><span class="se">&quot;&quot;</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="nl">create:</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">if</span> <span class="p">(</span><span class="n">create</span> <span class="o">&amp;&amp;</span> <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">\s*$&quot;</span><span class="p">))</span>
<span class="w">         </span><span class="nl">create:</span><span class="o">=</span><span class="mi">0</span>
   <span class="p">}</span>
<span class="p">}</span>
<span class="n">Yaml_DeleteAll</span><span class="p">(</span><span class="n">pYaml</span><span class="p">){</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">68</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">)</span><span class="c-Singleline"> ;delete all keys</span>
<span class="p">}</span>
<span class="n">Yaml_Delete</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">key</span><span class="p">){</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">var1</span><span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
<span class="w">      </span><span class="nl">wStr:</span><span class="o">=</span><span class="n">key</span>
<span class="w">   </span><span class="nb">else</span>
      <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wStr</span><span class="p">,</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">Key</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wStr</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysAllocString&quot;</span><span class="p">,</span><span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wStr</span><span class="p">),</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">var1</span><span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;oleaut32\SysFreeString&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">var1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">Yaml_Init</span><span class="p">(</span><span class="n">Yaml_File</span><span class="o">=</span><span class="s">&quot;?&quot;</span><span class="p">,</span><span class="n">pointerYaml</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">   </span><span class="nb">static</span> <span class="n">pYaml</span><span class="p">,</span> <span class="n">CLSID</span><span class="p">,</span><span class="n">IID</span><span class="p">,</span><span class="n">Init</span><span class="p">,</span><span class="n">FileIndex</span>
<span class="w">   </span><span class="nb">static</span> <span class="n">CLSIDString</span><span class="o">:=</span><span class="s">&quot;{EE09B103-97E0-11CF-978F-00A02463E06F}&quot;</span><span class="p">,</span> <span class="n">IIDString</span><span class="o">:=</span><span class="s">&quot;{42C642C1-97E1-11CF-978F-00A02463E06F}&quot;</span>
   <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">Init</span> <span class="o">&amp;&amp;</span> <span class="n">Init</span><span class="o">:=</span><span class="mi">1</span><span class="p">){</span><span class="c-Singleline"> ;Initialize COM and create database</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoInitialize&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
      <span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var1</span><span class="p">),</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">var2</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">CLSID</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wKey</span><span class="p">,</span> <span class="mi">79</span><span class="p">),</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">IID</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_IsUnicode</span>
         <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSIDString</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IIDString</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">)</span>
<span class="w">      </span><span class="nb">else</span>
         <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">CLSIDString</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">IIDString</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">39</span><span class="p">)</span>
         <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CLSIDFromString&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">wKey</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">)</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">,</span> <span class="s">&quot;UIntP&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">)</span><span class="c-Singleline"> ; CLSCTX=5</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">pYaml</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="c-Singleline"> ; Set compare mode binary (casesensitive)</span>
   <span class="p">}</span>
   <span class="n">If</span> <span class="p">(</span><span class="n">Yaml_File</span><span class="o">=</span><span class="s">&quot;?&quot;</span><span class="p">){</span>
<span class="w">      </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="n">Yaml_Save</span><span class="p">(</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="nv">A_Index</span><span class="p">)),</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="nv">A_Index</span><span class="p">))</span>
<span class="w">      </span><span class="nb">Return</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span><span class="nv">%Yaml_File%</span>
<span class="w">      </span><span class="nl">Yaml_File:</span><span class="o">=</span><span class="nv">A_LoopFileLongPath</span>
   <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Yaml_File</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">pointerYaml</span><span class="p">))</span>
      <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CoCreateInstance&quot;</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">CLSID</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="s">&quot;Str&quot;</span><span class="p">,</span><span class="n">IID</span><span class="p">,</span> <span class="s">&quot;UIntP&quot;</span><span class="p">,</span><span class="n">_pYaml</span><span class="p">)</span><span class="c-Singleline"> ; CLSCTX=5</span>
      <span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">_pYaml</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">_pYaml</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c-Singleline"> ; Set compare mode text (caseinsensitive)</span>
<span class="w">   </span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">pointerYaml</span><span class="p">)</span>
<span class="w">      </span><span class="nl">_pYaml:</span><span class="o">=</span><span class="n">pointerYaml</span>
<span class="w">   </span><span class="nb">else</span>
<span class="w">      </span><span class="nb">return</span> <span class="n">Yaml_Get</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Yaml_File</span><span class="p">)</span>
<span class="w">   </span><span class="nb">If </span><span class="nf">FileExist</span><span class="p">(</span><span class="n">Yaml_File</span><span class="p">){</span>
<span class="w">      </span><span class="nb">FileRead</span><span class="p">,</span><span class="n">Yaml_File_</span><span class="p">,</span><span class="nv">%Yaml_File%</span>
      <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span><span class="p">){</span>
<span class="w">         </span><span class="nb">MsgBox</span> <span class="n">Error</span> <span class="n">Reading</span> <span class="n">File</span>
<span class="w">         </span><span class="nb">Return</span>
      <span class="p">}</span>
      <span class="n">FileIndex</span><span class="o">++</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">FileIndex</span><span class="p">)</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">FileIndex</span><span class="p">,</span><span class="n">Yaml_File</span><span class="p">)</span>
      <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">pYaml</span><span class="p">,</span><span class="n">Yaml_File</span><span class="p">,</span><span class="n">_pYaml</span><span class="p">)</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">Yaml_File_</span><span class="o">:=</span><span class="n">Yaml_File</span>
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span><span class="n">Parse</span><span class="p">,</span><span class="n">Yaml_File_</span><span class="p">,</span><span class="se">`n</span><span class="p">,</span><span class="se">`r</span>
   <span class="p">{</span>
<span class="w">      </span><span class="nb">If </span><span class="nv">A_LoopField</span><span class="o">=</span>
<span class="w">         </span><span class="nb">Continue</span>
      <span class="n">if</span> <span class="o">!</span><span class="n">create</span>
<span class="w">         </span><span class="nl">Key1:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Key2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Key3</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Item</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">MainItem0</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">create</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s&quot;</span><span class="p">))){</span>
         <span class="n">If</span> <span class="o">!</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\w+)\s?:\s?(.*)\s*$&quot;</span><span class="p">,</span><span class="n">MainItem</span><span class="p">)</span>
            <span class="n">If</span> <span class="o">!</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^&#39;(.+)&#39;\s?:\s?(.*)\s*$&quot;</span><span class="p">,</span><span class="n">MainItem</span><span class="p">){</span>
               <span class="n">Key1</span><span class="o">=</span>
               <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
               <span class="n">If</span> <span class="p">(</span><span class="n">Key1</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">                  </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span> <span class="s">&quot;.0&quot;</span><span class="p">)</span>
                  <span class="n">count</span><span class="o">++</span>
                  <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span> <span class="s">&quot;.&quot;</span> <span class="n">count</span><span class="p">,</span><span class="n">Key1</span><span class="p">)</span>
                  <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span> <span class="s">&quot;.0&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="w">                  </span><span class="nl">item:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">)</span>
                  <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">,</span><span class="n">item</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">Key1</span> <span class="o">:</span> <span class="n">item</span> <span class="s">&quot;,&quot;</span> <span class="n">key1</span><span class="p">)</span>
<span class="w">                  </span><span class="nb">Continue</span>
               <span class="p">}</span>
               <span class="n">LastLine</span><span class="o">.=</span><span class="nv">A_LoopField</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">               </span><span class="nb">Continue</span>
            <span class="p">}</span>
<span class="w">         </span><span class="nl">MainItem0:</span><span class="o">=</span><span class="n">MainItem1</span>
         <span class="n">ItemCount</span><span class="o">++</span>
<span class="w">         </span><span class="nl">MainItem:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="p">(</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">!=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;,&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">MainItem0</span><span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">MainItem0</span> <span class="o">:</span> <span class="s">&quot;&#39;&quot;</span> <span class="n">MainItem0</span> <span class="s">&quot;&#39;&quot;</span><span class="p">)</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">MainItem</span><span class="p">)</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ItemCount</span><span class="p">)</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">ItemCount</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">)</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span><span class="p">,</span><span class="n">MainItem2</span><span class="p">)</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nb">StringTrimRight</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">1</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">MainItem0</span> <span class="s">&quot;.&quot;</span><span class="p">,</span><span class="n">LastLine</span><span class="p">)</span>
<span class="w">         </span><span class="nl">MainItem:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">MainItem1</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">MainItem2</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">LastLine</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
<span class="w">         </span><span class="nl">LastItem:</span><span class="o">=</span><span class="n">MainItem0</span>
<span class="w">         </span><span class="nb">Continue</span>
      <span class="p">}</span>
      <span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">create</span><span class="p">){</span>
         <span class="n">Key1</span><span class="o">=</span>
         <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^\s+-\s(.*)$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key1</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.0&quot;</span><span class="p">)</span>
            <span class="n">count</span><span class="o">++</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.&quot;</span> <span class="n">count</span><span class="p">,</span><span class="n">Key1</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span> <span class="s">&quot;.0&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="w">            </span><span class="nl">item:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">LastItem</span><span class="p">,</span><span class="n">item</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="n">Key1</span> <span class="o">:</span> <span class="n">item</span> <span class="s">&quot;,&quot;</span> <span class="n">key1</span><span class="p">)</span>
<span class="w">            </span><span class="nb">Continue</span>
         <span class="p">}</span>
<span class="w">         </span><span class="nb">Loop</span> <span class="mi">3</span>
            <span class="n">Key</span><span class="nv">%A_Index%</span><span class="o">=</span>
         <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s+)(\w+)\s?:\s?(.*)\s?$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="nb">Loop</span> <span class="mi">3</span>
                <span class="n">Key</span><span class="nv">%A_Index%</span><span class="o">=</span>
            <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;^(\s+)&#39;(.+)&#39;:\s?(.*)\s?$&quot;</span><span class="p">,</span><span class="n">Key</span><span class="p">)</span>
         <span class="p">}</span>
         <span class="n">If</span> <span class="p">(</span><span class="n">Key2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">){</span>
            <span class="n">LastLine</span><span class="o">.=</span><span class="nv">A_LoopField</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="nb">Continue</span>
         <span class="p">}</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nb">StringTrimRight</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="n">LastLine</span><span class="p">,</span><span class="mi">1</span>
<span class="w">         </span><span class="nl">depth:</span><span class="o">=</span><span class="nf">Round</span><span class="p">(</span><span class="nf">Strlen</span><span class="p">(</span><span class="n">Key1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">         </span><span class="nl">MainItem%depth%:</span><span class="o">=</span><span class="n">Key2</span>
<span class="w">         </span><span class="nl">Item:</span><span class="o">=</span><span class="n">MainItem0</span>
<span class="w">         </span><span class="nb">While</span> <span class="o">%</span> <span class="p">((</span><span class="n">i</span><span class="o">:=</span><span class="nv">A_Index</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">depth</span><span class="o">&gt;</span><span class="nv">A_Index</span><span class="p">)</span>
            <span class="n">Item</span><span class="o">.=</span> <span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">MainItem</span><span class="nv">%i%</span>
         <span class="n">If</span> <span class="o">!</span><span class="n">Yaml_Exist</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="s">&quot;.&quot;</span> <span class="n">key2</span><span class="p">){</span>
<span class="w">            </span><span class="nl">MainItem:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">)</span>
<span class="w">            </span><span class="nl">count:</span><span class="o">=</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.0&quot;</span><span class="p">)</span>
            <span class="n">count</span><span class="o">++</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.0&quot;</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">count</span><span class="p">,</span><span class="n">key2</span><span class="p">)</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">MainItem</span> <span class="o">.</span> <span class="p">(</span><span class="n">MainItem</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="s">&quot;,&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Key2</span><span class="p">,</span><span class="s">&quot;^\s?\w+\s?$&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">key2</span> <span class="o">:</span> <span class="s">&quot;&#39;&quot;</span> <span class="n">key2</span> <span class="s">&quot;&#39;&quot;</span><span class="p">))</span>
         <span class="p">}</span>
         <span class="n">Item</span><span class="o">.=</span><span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">key2</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">key3</span><span class="p">)</span>
<span class="w">         </span><span class="nl">LastItem:</span><span class="o">=</span><span class="n">Item</span>
<span class="w">         </span><span class="nb">If </span><span class="n">LastLine</span><span class="o">!=</span>
            <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span> <span class="o">.</span> <span class="s">&quot;.&quot;</span><span class="p">,</span><span class="n">LastLine</span><span class="p">),</span><span class="n">LastLine</span><span class="o">:=</span><span class="s">&quot;&quot;</span>
      <span class="p">}</span> <span class="n">else</span>
         <span class="n">Yaml_Assign</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">,</span><span class="n">Yaml_Get</span><span class="p">(</span><span class="n">_pYaml</span><span class="p">,</span><span class="n">Item</span><span class="p">)</span> <span class="o">.</span> <span class="nv">A_LoopField</span><span class="p">)</span>
<span class="w">      </span><span class="nb">If </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Key3</span><span class="p">,</span><span class="s">&quot;^\s*</span><span class="se">&quot;&quot;</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">         </span><span class="nl">create:</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">if</span> <span class="p">(</span><span class="n">create</span> <span class="o">&amp;&amp;</span> <span class="nf">RegExMatch</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="s">&quot;</span><span class="se">&quot;&quot;</span><span class="s">\s*$&quot;</span><span class="p">))</span>
<span class="w">         </span><span class="nl">create:</span><span class="o">=</span><span class="mi">0</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">Return</span> <span class="n">_pYaml</span>
<span class="p">}</span>
</pre></div>
