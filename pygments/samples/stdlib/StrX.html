<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; Auto-Parser for XML / HTML by SKAN</span>
<span class="nf">StrX</span><span class="p">(</span><span class="w"> </span>H<span class="p">,</span><span class="w">  </span>BS<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>BO<span class="o">=</span><span class="mi">0</span><span class="p">,</span>BT<span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w">   </span>ES<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>EO<span class="o">=</span><span class="mi">0</span><span class="p">,</span>ET<span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span>ByRef<span class="w"> </span>N<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">;    | by Skan | 19-Nov-2009</span>
<span class="k">Return</span><span class="w"> </span><span class="nf">SubStr</span><span class="p">(</span>H<span class="p">,</span>P<span class="o">:=</span><span class="p">(((</span>Z<span class="o">:=</span>StrLen<span class="p">(</span>ES<span class="p">))</span><span class="o">+</span><span class="p">(</span>X<span class="o">:=</span>StrLen<span class="p">(</span>H<span class="p">))</span><span class="o">+</span>StrLen<span class="p">(</span>BS<span class="p">)</span><span class="o">-</span>Z<span class="o">-</span>X<span class="p">)</span><span class="o">?</span><span class="p">((</span>T<span class="o">:=</span>InStr<span class="p">(</span>H<span class="p">,</span>BS<span class="p">,</span><span class="mi">0</span><span class="p">,((</span>BO
<span class="w"> </span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span>BO<span class="p">))))</span><span class="o">?</span><span class="p">(</span>T<span class="o">+</span>BT<span class="p">)</span><span class="o">:</span><span class="p">(</span>X<span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="mi">1</span><span class="p">)),(</span>N<span class="o">:=</span>P<span class="o">+</span><span class="p">((</span>Z<span class="p">)</span><span class="o">?</span><span class="p">((</span>T<span class="o">:=</span>InStr<span class="p">(</span>H<span class="p">,</span>ES<span class="p">,</span><span class="mi">0</span><span class="p">,((</span>EO<span class="p">)</span><span class="o">?</span><span class="p">(</span>P<span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="mi">0</span><span class="p">))))</span><span class="o">?</span><span class="p">(</span>T<span class="o">-</span>P<span class="o">+</span>Z
<span class="w"> </span><span class="o">+</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span>ET<span class="p">))</span><span class="o">:</span><span class="p">(</span>X<span class="o">+</span>P<span class="p">))</span><span class="o">:</span><span class="p">(</span>X<span class="p">)))</span><span class="o">-</span>P<span class="p">)</span><span class="w"> </span><span class="c1">; v1.0-196c 21-Nov-2009 www.autohotkey.com/forum/topic51354.html</span>
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; Auto-Parser for XML / HTML by SKAN</span>
<span class="n">StrX</span><span class="p">(</span> <span class="n">H</span><span class="p">,</span>  <span class="n">BS</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">BO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">BT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="n">ES</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">EO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ET</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">ByRef</span> <span class="n">N</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ;    | by Skan | 19-Nov-2009</span>
<span class="nb">Return</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">P</span><span class="o">:=</span><span class="p">(((</span><span class="n">Z</span><span class="o">:=</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">ES</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">X</span><span class="o">:=</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">+</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">BS</span><span class="p">)</span><span class="o">-</span><span class="n">Z</span><span class="o">-</span><span class="n">X</span><span class="p">)</span><span class="o">?</span><span class="p">((</span><span class="n">T</span><span class="o">:=</span><span class="nf">InStr</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">BS</span><span class="p">,</span><span class="mi">0</span><span class="p">,((</span><span class="n">BO</span>
 <span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="n">BO</span><span class="p">))))</span><span class="o">?</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">BT</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="mi">1</span><span class="p">)),(</span><span class="n">N</span><span class="o">:=</span><span class="n">P</span><span class="o">+</span><span class="p">((</span><span class="n">Z</span><span class="p">)</span><span class="o">?</span><span class="p">((</span><span class="n">T</span><span class="o">:=</span><span class="nf">InStr</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">ES</span><span class="p">,</span><span class="mi">0</span><span class="p">,((</span><span class="n">EO</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="mi">0</span><span class="p">))))</span><span class="o">?</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">P</span><span class="o">+</span><span class="n">Z</span>
 <span class="o">+</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">ET</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">P</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span><span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="c-Singleline"> ; v1.0-196c 21-Nov-2009 www.autohotkey.com/forum/topic51354.html</span>
<span class="p">}</span>
</pre></div>
