<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; ShellFileOperation by SKAN</span>
<span class="c1">; 2007, http://www.autohotkey.com/forum/viewtopic.php?p=133249#133249</span>
<span class="nf">ShellFileOperation</span><span class="p">(</span><span class="w"> </span>fileO<span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="w"> </span>fSource<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>fTarget<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>flags<span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="w"> </span>ghwnd<span class="o">=</span><span class="mh">0x0</span><span class="w"> </span><span class="p">)</span><span class="w">     </span><span class="p">{</span>

<span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>SubStr<span class="p">(</span>fSource<span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span>fSource<span class="w"> </span><span class="o">:=</span><span class="w"> </span>fSource<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;|&quot;</span>

<span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>SubStr<span class="p">(</span>fTarget<span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span>fTarget<span class="w"> </span><span class="o">:=</span><span class="w"> </span>fTarget<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;|&quot;</span>

<span class="w"> </span>fsPtr<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span>fSource
<span class="w"> </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>StrLen<span class="p">(</span>fSource<span class="p">)</span>
<span class="w">  </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">(</span>fsPtr<span class="o">+</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">124</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span><span class="w"> </span>fsPtr<span class="o">+</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span>Int<span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>UChar<span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>

<span class="w"> </span>ftPtr<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span>fTarget
<span class="w"> </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>StrLen<span class="p">(</span>fTarget<span class="p">)</span>
<span class="w">  </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="p">(</span>ftPtr<span class="o">+</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">124</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span><span class="w"> </span>ftPtr<span class="o">+</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span>Int<span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>UChar<span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>

<span class="w"> </span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="w"> </span>SHFILEOPSTRUCT<span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w">                 </span><span class="c1">; Encoding SHFILEOPSTRUCT</span>
<span class="w"> </span>NextOffset<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumPut<span class="p">(</span><span class="w"> </span>ghwnd<span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>SHFILEOPSTRUCT<span class="w"> </span><span class="p">)</span><span class="w">          </span><span class="c1">; hWnd of calling GUI</span>
<span class="w"> </span>NextOffset<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumPut<span class="p">(</span><span class="w"> </span>fileO<span class="p">,</span><span class="w"> </span>NextOffset<span class="o">+</span><span class="mi">0</span><span class="w">    </span><span class="p">)</span><span class="w">          </span><span class="c1">; File operation</span>
<span class="w"> </span>NextOffset<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumPut<span class="p">(</span><span class="w"> </span>fsPtr<span class="p">,</span><span class="w"> </span>NextOffset<span class="o">+</span><span class="mi">0</span><span class="w">    </span><span class="p">)</span><span class="w">          </span><span class="c1">; Source file / pattern</span>
<span class="w"> </span>NextOffset<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumPut<span class="p">(</span><span class="w"> </span>ftPtr<span class="p">,</span><span class="w"> </span>NextOffset<span class="o">+</span><span class="mi">0</span><span class="w">    </span><span class="p">)</span><span class="w">          </span><span class="c1">; Target file / folder</span>
<span class="w"> </span>NextOffset<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumPut<span class="p">(</span><span class="w"> </span>flags<span class="p">,</span><span class="w"> </span>NextOffset<span class="o">+</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Short&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="c1">; options</span>

<span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Shell32\SHFileOperationA&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span><span class="o">&amp;</span>SHFILEOPSTRUCT<span class="w"> </span><span class="p">)</span>
<span class="w"> </span>
<span class="k">Return</span><span class="w"> </span><span class="nf">NumGet</span><span class="p">(</span><span class="w"> </span>NextOffset<span class="o">+</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; ShellFileOperation by SKAN</span>
<span class="c-Singleline">; 2007, http://www.autohotkey.com/forum/viewtopic.php?p=133249#133249</span>
<span class="n">ShellFileOperation</span><span class="p">(</span> <span class="n">fileO</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">fSource</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">fTarget</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">ghwnd</span><span class="o">=</span><span class="mh">0x0</span> <span class="p">)</span>     <span class="p">{</span>

 <span class="n">If</span> <span class="p">(</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">fSource</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&quot;|&quot;</span> <span class="p">)</span>
      <span class="n">fSource</span> <span class="o">:=</span> <span class="n">fSource</span> <span class="o">.</span> <span class="s">&quot;|&quot;</span>

 <span class="n">If</span> <span class="p">(</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">fTarget</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&quot;|&quot;</span> <span class="p">)</span>
      <span class="n">fTarget</span> <span class="o">:=</span> <span class="n">fTarget</span> <span class="o">.</span> <span class="s">&quot;|&quot;</span>

 <span class="n">fsPtr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">fSource</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="o">%</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">fSource</span><span class="p">)</span>
  <span class="n">If</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">fsPtr</span><span class="o">+</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">124</span> <span class="p">)</span>
      <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">fsPtr</span><span class="o">+</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>

 <span class="n">ftPtr</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">fTarget</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="o">%</span> <span class="nf">StrLen</span><span class="p">(</span><span class="n">fTarget</span><span class="p">)</span>
  <span class="n">If</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">ftPtr</span><span class="o">+</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">124</span> <span class="p">)</span>
      <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;RtlFillMemory&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">ftPtr</span><span class="o">+</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UChar</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>

 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">SHFILEOPSTRUCT</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span><span class="c-Singleline">                 ; Encoding SHFILEOPSTRUCT</span>
 <span class="n">NextOffset</span> <span class="o">:=</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="n">ghwnd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SHFILEOPSTRUCT</span> <span class="p">)</span><span class="c-Singleline">          ; hWnd of calling GUI</span>
 <span class="n">NextOffset</span> <span class="o">:=</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="n">fileO</span><span class="p">,</span> <span class="n">NextOffset</span><span class="o">+</span><span class="mi">0</span>    <span class="p">)</span><span class="c-Singleline">          ; File operation</span>
 <span class="n">NextOffset</span> <span class="o">:=</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="n">fsPtr</span><span class="p">,</span> <span class="n">NextOffset</span><span class="o">+</span><span class="mi">0</span>    <span class="p">)</span><span class="c-Singleline">          ; Source file / pattern</span>
 <span class="n">NextOffset</span> <span class="o">:=</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="n">ftPtr</span><span class="p">,</span> <span class="n">NextOffset</span><span class="o">+</span><span class="mi">0</span>    <span class="p">)</span><span class="c-Singleline">          ; Target file / folder</span>
 <span class="n">NextOffset</span> <span class="o">:=</span> <span class="nf">NumPut</span><span class="p">(</span> <span class="n">flags</span><span class="p">,</span> <span class="n">NextOffset</span><span class="o">+</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span> <span class="p">)</span><span class="c-Singleline"> ; options</span>

 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;Shell32\SHFileOperationA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">SHFILEOPSTRUCT</span> <span class="p">)</span>
<span class="w"> </span>
<span class="nb">Return</span> <span class="nf">NumGet</span><span class="p">(</span> <span class="n">NextOffset</span><span class="o">+</span><span class="mi">0</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>
