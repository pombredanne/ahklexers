<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; String version info for execs by SKAN, wOxxOm</span>
<span class="c-Singleline">; http://www.autohotkey.com/forum/viewtopic.php?p=233188#233188</span>
<span class="c-Singleline">; http://www.autohotkey.com/forum/viewtopic.php?p=52148#52148</span>
<span class="n">FileGetVersionInfo</span><span class="p">(</span> <span class="n">peFile</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">StringFileInfo</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span>
 <span class="n">FSz</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;Version\GetFileVersionInfoSizeA&quot;</span><span class="p">,</span><span class="n">Str</span><span class="p">,</span><span class="n">peFile</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">IfLess</span><span class="p">,</span> <span class="n">FSz</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">Return</span> <span class="o">-</span><span class="mi">1</span>
 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">FVI</span><span class="p">,</span> <span class="n">FSz</span><span class="p">,</span> <span class="mi">0</span> <span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Trans</span><span class="p">,</span><span class="mi">8</span> <span class="p">)</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;Version\GetFileVersionInfoA&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">peFile</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">FSz</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">FVI</span> <span class="p">)</span>
 <span class="n">If</span> <span class="o">!</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;Version\VerQueryValueA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">FVI</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;\VarFileInfo\Translation&quot;</span>
                                       <span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">Translation</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="o">-</span><span class="mi">2</span>
 <span class="n">If</span> <span class="o">!</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;msvcrt.dll\sprintf&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Trans</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;%08X&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">Translation</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="o">-</span><span class="mi">4</span>
 <span class="n">subBlock</span> <span class="o">:=</span> <span class="s">&quot;\StringFileInfo\&quot;</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Trans</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Trans</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="s">&quot;\&quot;</span> <span class="n">StringFileInfo</span>
 <span class="n">If</span> <span class="o">!</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;Version\VerQueryValueA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">FVI</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">SubBlock</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">InfoPtr</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span>
 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Info</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;lstrlen&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">InfoPtr</span> <span class="p">)</span> <span class="p">)</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;lstrcpy&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Info</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">InfoPtr</span> <span class="p">)</span>
<span class="nb">Return</span> <span class="n">Info</span>
<span class="p">}</span>
</pre></div>
