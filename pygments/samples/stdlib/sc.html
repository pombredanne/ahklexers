<LINK href="styles.css" rel="stylesheet" type="text/css">

New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; 2010 Added by Tuncay a prefix &quot;sc_&quot; to all functions and renamed file from &quot;ScreenCapture.ahk&quot; to &quot;sc.ahk&quot;.</span>
<span class="cm">/*</span>
<span class="cm">sc_CaptureScreen(aRect, bCursor, sFileTo, nQuality)</span>
<span class="cm">1) If the optional parameter bCursor is True, captures the cursor too.</span>
<span class="cm">2) If the optional parameter sFileTo is 0, set the image to Clipboard.</span>
<span class="cm">   If it is omitted or &quot;&quot;, saves to screen.bmp in the script folder,</span>
<span class="cm">   otherwise to sFileTo which can be BMP/JPG/PNG/GIF/TIF.</span>
<span class="cm">3) The optional parameter nQuality is applicable only when sFileTo is JPG. Set it to the desired quality level of the resulting JPG, an integer between 0 - 100.</span>
<span class="cm">4) If aRect is 0/1/2/3, captures the entire desktop/active window/active client area/active monitor.</span>
<span class="cm">5) aRect can be comma delimited sequence of coordinates, e.g., &quot;Left, Top, Right, Bottom&quot; or &quot;Left, Top, Right, Bottom, Width_Zoomed, Height_Zoomed&quot;.</span>
<span class="cm">   In this case, only that portion of the rectangle will be captured. Additionally, in the latter case, zoomed to the new width/height, Width_Zoomed/Height_Zoomed.</span>

<span class="cm">Example:</span>
<span class="cm">sc_CaptureScreen(0)</span>
<span class="cm">sc_CaptureScreen(1)</span>
<span class="cm">sc_CaptureScreen(2)</span>
<span class="cm">sc_CaptureScreen(3)</span>
<span class="cm">sc_CaptureScreen(&quot;100, 100, 200, 200&quot;)</span>
<span class="cm">sc_CaptureScreen(&quot;100, 100, 200, 200, 400, 400&quot;)   ; Zoomed</span>
<span class="cm">*/</span><span class="w"></span>

<span class="cm">/* </span>
<span class="cm">sc_Convert(sFileFr, sFileTo, nQuality)</span>
<span class="cm">sc_Convert(&quot;C:\image.bmp&quot;, &quot;C:\image.jpg&quot;)</span>
<span class="cm">sc_Convert(&quot;C:\image.bmp&quot;, &quot;C:\image.jpg&quot;, 95)</span>
<span class="cm">sc_Convert(0, &quot;C:\clip.png&quot;)   ; Save the bitmap in the clipboard to sFileTo if sFileFr is &quot;&quot; or 0.</span>
<span class="cm">*/</span><span class="w"></span>

<span class="n">sc_CaptureScreen</span><span class="p">(</span><span class="n">aRect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bCursor</span> <span class="o">=</span> <span class="nv">False</span><span class="p">,</span> <span class="n">sFile</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">nQuality</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="o">!</span><span class="n">aRect</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">SysGet</span><span class="p">,</span><span class="s"> nL</span><span class="p">,</span><span class="s"> 76</span><span class="w"></span>
<span class="w">		</span>	<span class="n">SysGet</span><span class="p">,</span> <span class="n">nT</span><span class="p">,</span> <span class="mi">77</span>
<span class="w">		</span><span class="nb">SysGet</span><span class="p">,</span><span class="s"> nW</span><span class="p">,</span><span class="s"> 78</span><span class="w"></span>
<span class="w">		</span>	<span class="n">SysGet</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="mi">79</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">Else</span><span class="w"> </span><span class="s">If	aRect = 1</span><span class="w"></span>
<span class="w">		</span>	<span class="n">WinGetPos</span><span class="p">,</span> <span class="n">nL</span><span class="p">,</span> <span class="n">nT</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">A</span>
<span class="w">	</span><span class="nb">Else</span><span class="w"> </span><span class="s">If	aRect = 2</span><span class="w"></span>
<span class="w">	</span>	<span class="p">{</span>
<span class="w">		</span><span class="nb">WinGet</span><span class="p">,</span><span class="s"> hWnd</span><span class="p">,</span><span class="s"> ID</span><span class="p">,</span><span class="s"> A</span><span class="w"></span>
<span class="w">		</span><span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;GetClientRect&quot;</span> <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hWnd</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">rt</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;ClientToScreen&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hWnd</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">rt</span><span class="p">)</span>
<span class="w">		</span><span class="n">nL</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="n">nT</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="n">nW</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">		</span><span class="n">nH</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">Else</span><span class="w"> </span><span class="s">If	aRect = 3</span><span class="w"></span>
<span class="w">	</span>	<span class="p">{</span><span class="nf"></span>
<span class="nf">		VarSetCapacity</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;GetCursorPos&quot;</span><span class="p">,</span> <span class="s">&quot;int64P&quot;</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;GetMonitorInfo&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;MonitorFromPoint&quot;</span><span class="p">,</span> <span class="s">&quot;int64&quot;</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> NumPut</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="w">		</span><span class="n">nL</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="n">nT</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="n">nW</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">nL</span>
<span class="w">		</span><span class="n">nH</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">nT</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">Else</span><span class="w"></span>
<span class="w">	</span>	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span><span class="s"> rt</span><span class="p">,</span><span class="s"> aRect</span><span class="p">,</span><span class="s"> `</span><span class="p">,,</span><span class="s"> %A_Space%%A_Tab%</span><span class="w"></span>
<span class="w">		</span>	<span class="n">nL</span> <span class="o">:=</span> <span class="n">rt1</span>
<span class="w">		</span><span class="n">nT</span><span class="p"> </span><span class="o">:=</span> <span class="n">rt2</span>
<span class="w">		</span><span class="n">nW</span><span class="p"> </span><span class="o">:=</span> <span class="n">rt3</span> <span class="o">-</span> <span class="n">rt1</span>
<span class="w">		</span><span class="n">nH</span><span class="p"> </span><span class="o">:=</span> <span class="n">rt4</span> <span class="o">-</span> <span class="n">rt2</span>
<span class="w">		</span><span class="n">znW</span><span class="p"> </span><span class="o">:=</span> <span class="n">rt5</span>
<span class="w">		</span><span class="n">znH</span><span class="p"> </span><span class="o">:=</span> <span class="n">rt6</span>
	<span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">mDC</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;CreateCompatibleDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="n">hBM</span><span class="p"> </span><span class="o">:=</span> <span class="n">sc_CreateDIBSection</span><span class="p">(</span><span class="n">mDC</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">nH</span><span class="p">)</span>
<span class="w">	</span><span class="n">oBM</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBM</span><span class="p">)</span>
<span class="w">	</span><span class="n">hDC</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;GetDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;BitBlt&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nL</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nT</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mh">0x40000000</span> <span class="o">|</span> <span class="mh">0x00CC0020</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">)</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">bCursor</span><span class="w"></span>
<span class="w">		</span>	<span class="n">sc_CaptureCursor</span><span class="p">(</span><span class="n">mDC</span><span class="p">,</span> <span class="n">nL</span><span class="p">,</span> <span class="n">nT</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">oBM</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC</span><span class="p">)</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">znW &amp;&amp; znH</span><span class="w"></span>
<span class="w">		</span>	<span class="n">hBM</span> <span class="o">:=</span> <span class="n">sc_Zoomer</span><span class="p">(</span><span class="n">hBM</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">znW</span><span class="p">,</span> <span class="n">znH</span><span class="p">)</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">sFile = 0</span><span class="w"></span>
<span class="w">		</span>	<span class="n">sc_SetClipboardData</span><span class="p">(</span><span class="n">hBM</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Else</span><span class="w">	</span><span class="s">sc_Convert(hBM</span><span class="p">,</span><span class="s"> sFile</span><span class="p">,</span><span class="s"> nQuality)</span><span class="p">,</span><span class="s"> DllCall(&quot;DeleteObject&quot;</span><span class="p">,</span><span class="s"> &quot;Uint&quot;</span><span class="p">,</span><span class="s"> hBM)</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="n">sc_CaptureCursor</span><span class="p">(</span><span class="n">hDC</span><span class="p">,</span> <span class="n">nL</span><span class="p">,</span> <span class="n">nT</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="n">mi</span><span class="p"> </span><span class="o">:=</span><span class="nf"> Chr</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GetCursorInfo&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mi</span><span class="p">)</span>
<span class="w">	</span><span class="n">bShow</span><span class="p"> </span><span class="w">  </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="n">hCursor</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">	</span><span class="n">xCursor</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="w">	</span><span class="n">yCursor</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="nf"></span>

<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GetIconInfo&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hCursor</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ni</span><span class="p">)</span>
<span class="w">	</span><span class="n">xHotspot</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="n">yHotspot</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">	</span><span class="n">hBMMask</span><span class="p"> </span><span class="w"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="w">	</span><span class="n">hBMColor</span><span class="p"> </span><span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">bShow</span><span class="w"></span>
<span class="w">		</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DrawIcon&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">xCursor</span> <span class="o">-</span> <span class="n">xHotspot</span> <span class="o">-</span> <span class="n">nL</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">yCursor</span> <span class="o">-</span> <span class="n">yHotspot</span> <span class="o">-</span> <span class="n">nT</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hCursor</span><span class="p">)</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">hBMMask</span><span class="w"></span>
<span class="w">		</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBMMask</span><span class="p">)</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">hBMColor</span><span class="w"></span>
<span class="w">		</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBMColor</span><span class="p">)</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_Zoomer</span><span class="p">(</span><span class="n">hBM</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">znW</span><span class="p">,</span> <span class="n">znH</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">mDC1</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;CreateCompatibleDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="n">mDC2</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;CreateCompatibleDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="n">zhBM</span><span class="p"> </span><span class="o">:=</span> <span class="n">sc_CreateDIBSection</span><span class="p">(</span><span class="n">mDC2</span><span class="p">,</span> <span class="n">znW</span><span class="p">,</span> <span class="n">znH</span><span class="p">)</span>
<span class="w">	</span><span class="n">oBM1</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span>  <span class="n">hBM</span><span class="p">)</span>
<span class="w">	</span><span class="n">oBM2</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">zhBM</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;SetStretchBltMode&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC2</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;StretchBlt&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC2</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">znW</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">znH</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC1</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mh">0x00CC0020</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">oBM1</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">oBM2</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC1</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteDC&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">mDC2</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBM</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	Return</span>	<span class="n">zhBM</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_Convert</span><span class="p">(</span><span class="n">sFileFr</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sFileTo</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">nQuality</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">sFileTo  =</span><span class="w"></span>
<span class="w">		</span>	<span class="n">sFileTo</span> <span class="o">:=</span> <span class="nv">A_ScriptDir</span> <span class="o">.</span> <span class="s">&quot;\screen.bmp&quot;</span>
<span class="w">	</span><span class="nb">SplitPath</span><span class="p">,</span><span class="s"> sFileTo</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> sDirTo</span><span class="p">,</span><span class="s"> sExtTo</span><span class="p">,</span><span class="s"> sNameTo</span><span class="w"></span>

<span class="w">	</span><span class="nf">	If </span><span class="n">Not</span>	<span class="n">hGdiPlus</span> <span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;gdiplus.dll&quot;</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		Return</span>	<span class="n">sFileFr</span><span class="o">+</span><span class="mi">0</span> <span class="o">?</span> <span class="n">sc_SaveHBITMAPToFile</span><span class="p">(</span><span class="n">sFileFr</span><span class="p">,</span> <span class="n">sDirTo</span> <span class="o">.</span> <span class="s">&quot;\&quot;</span> <span class="o">.</span> <span class="n">sNameTo</span> <span class="o">.</span> <span class="s">&quot;.bmp&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">si</span> <span class="o">:=</span><span class="nf"> Chr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusStartup&quot;</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">pToken</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="o">!</span><span class="n">sFileFr</span>
	<span class="p">{</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="n">If</span><span class="p">	</span><span class="w"> </span><span class="s">DllCall(&quot;IsClipboardFormatAvailable&quot;</span><span class="p">,</span><span class="s"> &quot;Uint&quot;</span><span class="p">,</span><span class="s"> 2) &amp;&amp; (hBM:=DllCall(&quot;GetClipboardData&quot;</span><span class="p">,</span><span class="s"> &quot;Uint&quot;</span><span class="p">,</span><span class="s"> 2))</span><span class="w"></span>
<span class="w">		</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHBITMAP&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBM</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		DllCall</span><span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">Else</span><span class="w"> </span><span class="s">If	sFileFr Is Integer</span><span class="w"></span>
<span class="w">		</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHBITMAP&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">sFileFr</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Else</span><span class="w">	</span><span class="s">DllCall(&quot;gdiplus\GdipLoadImageFromFile&quot;</span><span class="p">,</span><span class="s"> &quot;Uint&quot;</span><span class="p">,</span><span class="s"> sc_Unicode4Ansi(wFileFr</span><span class="p">,</span><span class="s">sFileFr)</span><span class="p">,</span><span class="s"> &quot;UintP&quot;</span><span class="p">,</span><span class="s"> pImage)</span><span class="w"></span>

<span class="w">	</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncodersSize&quot;</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nCount</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span><span class="n">nSize</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncoders&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nCount</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ci</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span><span class="s"> %	nCount</span><span class="w"></span>
<span class="w">		</span>	<span class="n">If</span><span class="nf">	InStr</span><span class="p">(</span><span class="n">sc_Ansi4Unicode</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span><span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">)),</span> <span class="s">&quot;.&quot;</span> <span class="o">.</span> <span class="n">sExtTo</span><span class="p">)</span>
		<span class="p">{</span>
<span class="w">			</span><span class="n">pCodec</span><span class="p"> </span><span class="o">:=</span> <span class="o">&amp;</span><span class="n">ci</span><span class="o">+</span><span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">			</span><span class="nb">Break</span><span class="w"></span>
<span class="w">		</span>	<span class="p">}</span>
<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">InStr(&quot;.JPG.JPEG.JPE.JFIF&quot;</span><span class="p">,</span><span class="s"> &quot;.&quot; . sExtTo) &amp;&amp; nQuality&lt;&gt;&quot;&quot; &amp;&amp; pImage &amp;&amp; pCodec</span><span class="w"></span>
<span class="w">	</span>	<span class="p">{</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterListSize&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="n">nSize</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterList&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pi</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span><span class="s"> %	NumGet(pi)</span><span class="w"></span>
<span class="w">		</span>	<span class="n">If</span><span class="nf">	NumGet</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">)</span><span class="o">=</span><span class="mi">6</span>
		<span class="p">{</span>
<span class="w">			</span><span class="n">pParam</span><span class="p"> </span><span class="o">:=</span> <span class="o">&amp;</span><span class="n">pi</span><span class="o">+</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="nf"></span>
<span class="nf">			NumPut</span><span class="p">(</span><span class="n">nQuality</span><span class="p">,</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pParam</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">)))</span>
<span class="w">			</span><span class="nb">Break</span><span class="w"></span>
<span class="w">		</span>	<span class="p">}</span>
	<span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="n">If</span><span class="p">	</span><span class="s">pImage</span><span class="w"></span>
<span class="w">		</span>	<span class="n">pCodec</span>	<span class="o">?</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSaveImageToFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">sc_Unicode4Ansi</span><span class="p">(</span><span class="n">wFileTo</span><span class="p">,</span><span class="n">sFileTo</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pParam</span><span class="p">)</span> <span class="o">:</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHBITMAPFromBitmap&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">sc_SetClipboardData</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">),</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDisposeImage&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pImage</span><span class="p">)</span><span class="nf"></span>

<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusShutdown&quot;</span> <span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pToken</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;FreeLibrary&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hGdiPlus</span><span class="p">)</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_CreateDIBSection</span><span class="p">(</span><span class="n">hDC</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">bpp</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">pBits</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf">	NumPut</span><span class="p">(</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">bi</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">bi</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	NumPut</span><span class="p">(</span><span class="n">nW</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	NumPut</span><span class="p">(</span><span class="n">nH</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	NumPut</span><span class="p">(</span><span class="n">bpp</span><span class="p">,</span><span class="nf"> NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;UShort&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Ushort&quot;</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="n">bi</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	Return	DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\CreateDIBSection&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDC</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bi</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="n">pBits</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_SaveHBITMAPToFile</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">,</span> <span class="n">sFile</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span><span class="nf"> VarSetCapacity</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="p">)</span>
<span class="w">	</span><span class="nl">hFile:</span><span class="o">=</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;CreateFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sFile</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mh">0x40000000</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;WriteFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hFile</span><span class="p">,</span> <span class="s">&quot;int64P&quot;</span><span class="p">,</span> <span class="mh">0x4D42</span><span class="o">|</span><span class="mi">14</span><span class="o">+</span><span class="mi">40</span><span class="o">+</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">44</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;WriteFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hFile</span><span class="p">,</span> <span class="s">&quot;int64P&quot;</span><span class="p">,</span> <span class="mi">54</span><span class="o">&lt;&lt;</span><span class="mi">32</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;WriteFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hFile</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;WriteFile&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hFile</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">44</span><span class="p">),</span> <span class="s">&quot;UintP&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;CloseHandle&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hFile</span><span class="p">)</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_SetClipboardData</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span><span class="nf"> VarSetCapacity</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="p">)</span>
<span class="w">	</span><span class="n">hDIB</span><span class="p"> </span><span class="o">:=</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GlobalAlloc&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="o">+</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">44</span><span class="p">))</span>
<span class="w">	</span><span class="n">pDIB</span><span class="p"> </span><span class="o">:=</span><span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GlobalLock&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDIB</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pDIB</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pDIB</span><span class="o">+</span><span class="mi">40</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span><span class="mi">44</span><span class="p">))</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;GlobalUnlock&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDIB</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;EmptyClipboard&quot;</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;SetClipboardData&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">hDIB</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_Unicode4Ansi</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">wString</span><span class="p">,</span> <span class="n">sString</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">nSize</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">wString</span><span class="p">,</span> <span class="n">nSize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	Return</span>	<span class="o">&amp;</span><span class="n">wString</span>
<span class="p">}</span><span class="w"></span>

<span class="n">sc_Ansi4Unicode</span><span class="p">(</span><span class="n">pString</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="n">nSize</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	VarSetCapacity</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	Return</span>	<span class="n">sString</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
