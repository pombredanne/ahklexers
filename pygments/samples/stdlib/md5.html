<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; MD5 hashing functions by Laszlo</span>

<span class="nf">MD5_File</span><span class="p">(</span><span class="w"> </span>sFile<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>cSz<span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">; www.autohotkey.com/forum/viewtopic.php?p=275910#275910</span>
<span class="w"> </span>cSz<span class="w">  </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>cSz<span class="o">&lt;</span><span class="mi">0</span><span class="o">||</span>cSz<span class="o">&gt;</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="mi">22</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span>cSz<span class="p">),</span><span class="w"> </span>VarSetCapacity<span class="p">(</span><span class="w"> </span>Buffer<span class="p">,</span>cSz<span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span>hFil<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="w"> </span><span class="s">&quot;CreateFile&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>sFile<span class="p">,</span>UInt<span class="p">,</span><span class="mh">0x80000000</span><span class="p">,</span><span class="w"> </span>Int<span class="p">,</span><span class="mi">1</span><span class="p">,</span>Int<span class="p">,</span><span class="mi">0</span><span class="p">,</span>Int<span class="p">,</span><span class="mi">3</span><span class="p">,</span>Int<span class="p">,</span><span class="mi">0</span><span class="p">,</span>Int<span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="k">IfLess</span><span class="p">,</span>hFil<span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">Return</span><span class="p">,</span>hFil
<span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;GetFileSizeEx&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>hFil<span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>Buffer<span class="w"> </span><span class="p">),</span><span class="w">   </span>fSz<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span><span class="w"> </span>Buffer<span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Int64&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="w"> </span>MD5_CTX<span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">),</span><span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Init&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>fSz<span class="o">//</span>cSz<span class="o">+!!</span>Mod<span class="p">(</span>fSz<span class="p">,</span>cSz<span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;ReadFile&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>hFil<span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>Buffer<span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>cSz<span class="p">,</span><span class="w"> </span>UIntP<span class="p">,</span>bytesRead<span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Update&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>Buffer<span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>bytesRead<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Final&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;CloseHandle&quot;</span><span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>hFil<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>StrLen<span class="p">(</span><span class="w"> </span>Hex<span class="o">:=</span><span class="s">&quot;123456789ABCDEF0&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span>N<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span><span class="w"> </span>MD5_CTX<span class="p">,</span><span class="mi">87</span><span class="o">+</span><span class="nb">A_Index</span><span class="p">,</span><span class="s">&quot;Char&quot;</span><span class="p">),</span><span class="w"> </span>MD5<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>SubStr<span class="p">(</span>Hex<span class="p">,</span>N<span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>SubStr<span class="p">(</span>Hex<span class="p">,</span>N<span class="o">&amp;</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">Return</span><span class="w"> </span>MD5
<span class="p">}</span>

<span class="nf">MD5</span><span class="p">(</span><span class="w"> </span>ByRef<span class="w"> </span>V<span class="p">,</span><span class="w"> </span>L<span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">; www.autohotkey.com/forum/viewtopic.php?p=275910#275910</span>
<span class="w"> </span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="w"> </span>MD5_CTX<span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Init&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Update&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>V<span class="p">,</span><span class="w"> </span>UInt<span class="p">,</span>L<span class="w"> </span><span class="o">?</span><span class="w"> </span>L<span class="w"> </span><span class="o">:</span><span class="w"> </span>VarSetCapacity<span class="p">(</span>V<span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;advapi32\MD5Final&quot;</span><span class="p">,</span><span class="w"> </span>Str<span class="p">,</span>MD5_CTX<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>StrLen<span class="p">(</span><span class="w"> </span>Hex<span class="o">:=</span><span class="s">&quot;123456789ABCDEF0&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span>N<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span><span class="w"> </span>MD5_CTX<span class="p">,</span><span class="mi">87</span><span class="o">+</span><span class="nb">A_Index</span><span class="p">,</span><span class="s">&quot;Char&quot;</span><span class="p">),</span><span class="w"> </span>MD5<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>SubStr<span class="p">(</span>Hex<span class="p">,</span>N<span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="w"> </span>SubStr<span class="p">(</span>Hex<span class="p">,</span>N<span class="o">&amp;</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">Return</span><span class="w"> </span>MD5
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; MD5 hashing functions by Laszlo</span>

<span class="n">MD5_File</span><span class="p">(</span> <span class="n">sFile</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">cSz</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ; www.autohotkey.com/forum/viewtopic.php?p=275910#275910</span>
 <span class="n">cSz</span>  <span class="o">:=</span> <span class="p">(</span><span class="n">cSz</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">||</span><span class="n">cSz</span><span class="o">&gt;</span><span class="mi">8</span><span class="p">)</span> <span class="o">?</span> <span class="mi">2</span><span class="o">**</span><span class="mi">22</span> <span class="o">:</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">18</span><span class="o">+</span><span class="n">cSz</span><span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">Buffer</span><span class="p">,</span><span class="n">cSz</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
 <span class="n">hFil</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;CreateFile&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">sFile</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="mh">0x80000000</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Int</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">IfLess</span><span class="p">,</span><span class="n">hFil</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">Return</span><span class="p">,</span><span class="n">hFil</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;GetFileSizeEx&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hFil</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Buffer</span> <span class="p">),</span>   <span class="n">fSz</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span> <span class="n">Buffer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Int64&quot;</span> <span class="p">)</span>
 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">MD5_CTX</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span>    <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Init&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Loop</span> <span class="o">%</span> <span class="p">(</span> <span class="n">fSz</span><span class="o">//</span><span class="n">cSz</span><span class="o">+!!</span><span class="nf">Mod</span><span class="p">(</span><span class="n">fSz</span><span class="p">,</span><span class="n">cSz</span><span class="p">)</span> <span class="p">)</span>
   <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;ReadFile&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hFil</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Buffer</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cSz</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">bytesRead</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
 <span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Update&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Buffer</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">bytesRead</span> <span class="p">)</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Final&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span> <span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;CloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hFil</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Loop</span> <span class="o">%</span> <span class="nf">StrLen</span><span class="p">(</span> <span class="n">Hex</span><span class="o">:=</span><span class="s">&quot;123456789ABCDEF0&quot;</span> <span class="p">)</span>
  <span class="n">N</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span> <span class="n">MD5_CTX</span><span class="p">,</span><span class="mi">87</span><span class="o">+</span><span class="nv">A_Index</span><span class="p">,</span><span class="s">&quot;Char&quot;</span><span class="p">),</span> <span class="n">MD5</span> <span class="o">.=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Hex</span><span class="p">,</span><span class="n">N</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Hex</span><span class="p">,</span><span class="n">N</span><span class="o">&amp;</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">Return</span> <span class="n">MD5</span>
<span class="p">}</span>

<span class="n">MD5</span><span class="p">(</span> <span class="n">ByRef</span> <span class="n">V</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ; www.autohotkey.com/forum/viewtopic.php?p=275910#275910</span>
 <span class="nf">VarSetCapacity</span><span class="p">(</span> <span class="n">MD5_CTX</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Init&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span> <span class="p">)</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Update&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">V</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">L</span> <span class="o">?</span> <span class="n">L</span> <span class="o">:</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="p">)</span>
 <span class="nf">DllCall</span><span class="p">(</span> <span class="s">&quot;advapi32\MD5Final&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">MD5_CTX</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Loop</span> <span class="o">%</span> <span class="nf">StrLen</span><span class="p">(</span> <span class="n">Hex</span><span class="o">:=</span><span class="s">&quot;123456789ABCDEF0&quot;</span> <span class="p">)</span>
  <span class="n">N</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span> <span class="n">MD5_CTX</span><span class="p">,</span><span class="mi">87</span><span class="o">+</span><span class="nv">A_Index</span><span class="p">,</span><span class="s">&quot;Char&quot;</span><span class="p">),</span> <span class="n">MD5</span> <span class="o">.=</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Hex</span><span class="p">,</span><span class="n">N</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Hex</span><span class="p">,</span><span class="n">N</span><span class="o">&amp;</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">Return</span> <span class="n">MD5</span>
<span class="p">}</span>
</pre></div>
