<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">;</span>
<span class="c1">; MASTER CONTROLS</span>
<span class="c1">;</span>

<span class="nf">VA_GetMasterVolume</span><span class="p">(</span>channel<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>aev<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetAudioEndpointVolume<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="nf">VA_IAudioEndpointVolume_GetMasterVolumeLevelScalar</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>vol<span class="p">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nf">VA_IAudioEndpointVolume_GetChannelVolumeLevelScalar</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>channel<span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>vol<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>aev<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>vol<span class="o">*</span><span class="mi">100</span>
<span class="p">}</span>

<span class="nf">VA_SetMasterVolume</span><span class="p">(</span>vol<span class="p">,</span><span class="w"> </span>channel<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>vol<span class="o">&gt;</span><span class="mi">100</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>vol<span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>vol
<span class="w">    </span>aev<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetAudioEndpointVolume<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="nf">VA_IAudioEndpointVolume_SetMasterVolumeLevelScalar</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>vol<span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nf">VA_IAudioEndpointVolume_SetChannelVolumeLevelScalar</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>channel<span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>vol<span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>aev<span class="p">)</span>
<span class="p">}</span>

<span class="nf">VA_GetMasterChannelCount</span><span class="p">(</span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>aev<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetAudioEndpointVolume<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IAudioEndpointVolume_GetChannelCount</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>count<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>aev<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>count
<span class="p">}</span>

<span class="nf">VA_SetMasterMute</span><span class="p">(</span>mute<span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>aev<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetAudioEndpointVolume<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IAudioEndpointVolume_SetMute</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>mute<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>aev<span class="p">)</span>
<span class="p">}</span>

<span class="nf">VA_GetMasterMute</span><span class="p">(</span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>aev<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetAudioEndpointVolume<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IAudioEndpointVolume_GetMute</span><span class="p">(</span>aev<span class="p">,</span><span class="w"> </span>mute<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>aev<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>mute
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; SUBUNIT CONTROLS</span>
<span class="c1">;</span>

<span class="nf">VA_GetVolume</span><span class="p">(</span>subunit_desc<span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span>channel<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>avl<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDeviceSubunit<span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>avl
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="nf">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel_count<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>vol<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%channel_count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nf">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">,</span><span class="w"> </span>step_dB<span class="p">)</span>
<span class="w">            </span><span class="nf">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>this_vol<span class="p">)</span>
<span class="w">            </span>this_vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_dB2Scalar<span class="p">(</span>this_vol<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">)</span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">; &quot;Speakers Properties&quot; reports the highest channel as the volume.</span>
<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>this_vol<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>vol<span class="p">)</span>
<span class="w">                </span>vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>this_vol
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span>between<span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span>channel_count
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>channel<span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nf">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">,</span><span class="w"> </span>step_dB<span class="p">)</span>
<span class="w">        </span><span class="nf">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel<span class="p">,</span><span class="w"> </span>vol<span class="p">)</span>
<span class="w">        </span>vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_dB2Scalar<span class="p">(</span>vol<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>avl<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>vol
<span class="p">}</span>

<span class="nf">VA_SetVolume</span><span class="p">(</span>vol<span class="p">,</span><span class="w"> </span>subunit_desc<span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span>channel<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>avl<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDeviceSubunit<span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>avl
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span>
<span class="w">    </span>vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>vol<span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>vol<span class="o">&gt;</span><span class="mi">100</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>vol
<span class="w">    </span>
<span class="w">    </span><span class="nf">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel_count<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">; Simple method -- resets balance to &quot;center&quot;:</span>
<span class="w">        </span><span class="c1">;VA_IPerChannelDbLevel_SetLevelUniform(avl, vol)</span>
<span class="w">        </span>
<span class="w">        </span>vol_max<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%channel_count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nf">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">,</span><span class="w"> </span>step_dB<span class="p">)</span>
<span class="w">            </span><span class="nf">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>this_vol<span class="p">)</span>
<span class="w">            </span>this_vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_dB2Scalar<span class="p">(</span>this_vol<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">)</span>
<span class="w">            </span>
<span class="w">            </span>channel<span class="nv">%A_Index%</span>vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>this_vol
<span class="w">            </span>channel<span class="nv">%A_Index%</span>min<span class="w"> </span><span class="o">:=</span><span class="w"> </span>min_dB
<span class="w">            </span>channel<span class="nv">%A_Index%</span>max<span class="w"> </span><span class="o">:=</span><span class="w"> </span>max_dB
<span class="w">            </span>
<span class="w">            </span><span class="c1">; Scale all channels relative to the loudest channel.</span>
<span class="w">            </span><span class="c1">; (This is how Vista&#39;s &quot;Speakers Properties&quot; dialog seems to work.)</span>
<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>this_vol<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>vol_max<span class="p">)</span>
<span class="w">                </span>vol_max<span class="w"> </span><span class="o">:=</span><span class="w"> </span>this_vol
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%channel_count%</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span>this_vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>vol_max<span class="w"> </span><span class="o">?</span><span class="w"> </span>channel<span class="nv">%A_Index%</span>vol<span class="w"> </span><span class="o">/</span><span class="w"> </span>vol_max<span class="w"> </span><span class="o">*</span><span class="w"> </span>vol<span class="w"> </span><span class="o">:</span><span class="w"> </span>vol
<span class="w">            </span>this_vol<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_Scalar2dB<span class="p">(</span>this_vol<span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span>channel<span class="nv">%A_Index%</span>min<span class="p">,</span><span class="w"> </span>channel<span class="nv">%A_Index%</span>max<span class="p">)</span><span class="w">            </span>
<span class="w">            </span><span class="nf">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>this_vol<span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>channel<span class="w"> </span>between<span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="nv">%channel_count%</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>channel<span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nf">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">,</span><span class="w"> </span>step_dB<span class="p">)</span>
<span class="w">        </span><span class="nf">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel<span class="p">,</span><span class="w"> </span>VA_Scalar2dB<span class="p">(</span>vol<span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>avl<span class="p">)</span>
<span class="p">}</span>

<span class="nf">VA_GetChannelCount</span><span class="p">(</span>subunit_desc<span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>avl<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDeviceSubunit<span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>avl
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="nf">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span>avl<span class="p">,</span><span class="w"> </span>channel_count<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>avl<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>channel_count
<span class="p">}</span>

<span class="nf">VA_SetMute</span><span class="p">(</span>mute<span class="p">,</span><span class="w"> </span>subunit_desc<span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>amute<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDeviceSubunit<span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>amute
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="nf">VA_IAudioMute_SetMute</span><span class="p">(</span>amute<span class="p">,</span><span class="w"> </span>mute<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>amute<span class="p">)</span>
<span class="p">}</span>

<span class="nf">VA_GetMute</span><span class="p">(</span>subunit_desc<span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>amute<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDeviceSubunit<span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>amute
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="nf">VA_IAudioMute_GetMute</span><span class="p">(</span>amute<span class="p">,</span><span class="w"> </span>muted<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>amute<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>muted
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; AUDIO METERING</span>
<span class="c1">;</span>

<span class="nf">VA_GetAudioMeter</span><span class="p">(</span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="w"> </span>device<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDevice<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nf">VA_IMMDevice_Activate</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="s">&quot;{C02216F6-8C67-4B5B-9D00-D008E73E0064}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>audioMeter<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>device<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>audioMeter
<span class="p">}</span>

<span class="nf">VA_GetDevicePeriod</span><span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>default_period<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>minimum_period<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>defaultPeriod<span class="w"> </span><span class="o">:=</span><span class="w"> </span>minimumPeriod<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="w"> </span>device<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDevice<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">    </span><span class="nf">VA_IMMDevice_Activate</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="s">&quot;{1CB9AD4C-DBFA-4c32-B178-C2F568A703B2}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>audioClient<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>device<span class="p">)</span>
<span class="w">    </span><span class="c1">; IAudioClient::GetDevicePeriod</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>audioClient<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>audioClient<span class="p">,</span><span class="w"> </span><span class="s">&quot;int64*&quot;</span><span class="p">,</span>default_period<span class="p">,</span><span class="w"> </span><span class="s">&quot;int64*&quot;</span><span class="p">,</span>minimum_period<span class="p">)</span>
<span class="w">    </span><span class="c1">; Convert 100-nanosecond units to milliseconds.</span>
<span class="w">    </span>default_period<span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">10000</span>
<span class="w">    </span>minimum_period<span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">10000</span><span class="w">    </span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>audioClient<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>true
<span class="p">}</span>


<span class="cm">/* IID</span>
<span class="cm">    COM_GUID4String(IID_IAudioEndpointVolume,&quot;{5CDF2C82-841E-4546-9722-0CF74078229A}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioVolumeLevel,&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioMute,&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioAutoGainControl,&quot;{85401FD4-6DE4-4b9d-9869-2D6753A82F3C}&quot;)</span>
<span class="cm">*/</span>

<span class="nf">VA_GetAudioEndpointVolume</span><span class="p">(</span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="w"> </span>device<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDevice<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nf">VA_IMMDevice_Activate</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="s">&quot;{5CDF2C82-841E-4546-9722-0CF74078229A}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>endpointVolume<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>device<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>endpointVolume
<span class="p">}</span>

<span class="nf">VA_GetDeviceSubunit</span><span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span>subunit_iid<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>device<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_GetDevice<span class="p">(</span>device_desc<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>device
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span>subunit<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_FindSubunit<span class="p">(</span>device<span class="p">,</span><span class="w"> </span>subunit_desc<span class="p">,</span><span class="w"> </span>subunit_iid<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>device<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>subunit
<span class="p">}</span>

<span class="nf">VA_FindSubunit</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span>target_desc<span class="p">,</span><span class="w"> </span>target_iid<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>target_desc<span class="w"> </span>is<span class="w"> </span>integer
<span class="w">        </span>target_index<span class="w"> </span><span class="o">:=</span><span class="w"> </span>target_desc
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nf">RegExMatch</span><span class="p">(</span>target_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;(?&lt;_name&gt;.*?)(?::(?&lt;_index&gt;\d+))?$&quot;</span><span class="p">,</span><span class="w"> </span>target<span class="p">)</span>
<span class="w">    </span><span class="c1">; v2.01: Since target_name is now a regular expression, default to case-insensitive mode if no options are specified.</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>RegExMatch<span class="p">(</span>target_name<span class="p">,</span><span class="s">&quot;[imsxADJUXPS</span><span class="se">`n`r`a</span><span class="s"> ]+\)&quot;</span><span class="p">)</span>
<span class="w">        </span>target_name<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;i)&quot;</span><span class="w"> </span>target_name
<span class="w">    </span><span class="c1">; cbinfo:</span>
<span class="w">    </span><span class="c1">;   @0  target_index</span>
<span class="w">    </span><span class="c1">;   @4  current_index</span>
<span class="w">    </span><span class="nf">VarSetCapacity</span><span class="p">(</span>cbinfo<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nf">NumPut</span><span class="p">(</span>target_index<span class="w"> </span><span class="o">?</span><span class="w"> </span>target_index<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>cbinfo<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_EnumSubunits<span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="s">&quot;VA_FindSubunitCallback&quot;</span><span class="p">,</span><span class="w"> </span>target_name<span class="p">,</span><span class="w"> </span>target_iid<span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>cbinfo<span class="p">)</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalFree&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>callback<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>r
<span class="p">}</span>

<span class="nf">VA_FindSubunitCallback</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>interface<span class="p">,</span><span class="w"> </span>prm<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">NumPut</span><span class="p">(</span>index<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>NumGet<span class="p">(</span>prm<span class="o">+</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span>prm<span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nf">NumGet</span><span class="p">(</span>prm<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>index
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nf">COM_AddRef</span><span class="p">(</span>interface<span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>interface
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">VA_EnumSubunits</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span>callback<span class="p">,</span><span class="w"> </span>target_name<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>target_iid<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>callback_param<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">VA_IMMDevice_Activate</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="s">&quot;{2A07407E-6497-4A18-9787-32F79BD0D98F}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>deviceTopology<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IDeviceTopology_GetConnector</span><span class="p">(</span>deviceTopology<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>conn<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>deviceTopology<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IConnector_GetConnectedTo</span><span class="p">(</span>conn<span class="p">,</span><span class="w"> </span>conn_to<span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IConnector_GetDataFlow</span><span class="p">(</span>conn<span class="p">,</span><span class="w"> </span>data_flow<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>conn<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>conn_to
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="c1">; blank to indicate error</span>
<span class="w">    </span>part<span class="w"> </span><span class="o">:=</span><span class="w"> </span>COM_QueryInterface<span class="p">(</span>conn_to<span class="p">,</span><span class="w"> </span><span class="s">&quot;{AE2DE0E4-5BCA-4F2D-AA46-5D13F8FDB3A9}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>conn_to<span class="p">)</span>
<span class="w">    </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_EnumSubunitsEx<span class="p">(</span>part<span class="p">,</span><span class="w"> </span>data_flow<span class="p">,</span><span class="w"> </span>callback<span class="p">,</span><span class="w"> </span>target_name<span class="p">,</span><span class="w"> </span>target_iid<span class="p">,</span><span class="w"> </span>callback_param<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>part<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>r<span class="w"> </span><span class="c1">; value returned by callback, or zero.</span>
<span class="p">}</span>

<span class="nf">VA_EnumSubunitsEx</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>data_flow<span class="p">,</span><span class="w"> </span>callback<span class="p">,</span><span class="w"> </span>target_name<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>target_iid<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>callback_param<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">VA_IPart_GetPartType</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>type<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>type<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">; Subunit</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nf">VA_IPart_GetName</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>name<span class="p">)</span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">; v2.01: target_name is now a regular expression.</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nf">RegExMatch</span><span class="p">(</span>name<span class="p">,</span><span class="w"> </span>target_name<span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span>target_iid<span class="w"> </span><span class="o">=</span>
<span class="w">                </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%callback%</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>callback_param<span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="kr">if</span><span class="w"> </span><span class="nf">VA_IPart_Activate</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span>target_iid<span class="p">,</span><span class="w"> </span>interface<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%callback%</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>interface<span class="p">,</span><span class="w"> </span>callback_param<span class="p">)</span>
<span class="w">                    </span><span class="c1">; The callback is responsible for calling COM_AddRef()</span>
<span class="w">                    </span><span class="c1">; if it intends to keep the interface pointer.</span>
<span class="w">                    </span><span class="nf">COM_Release</span><span class="p">(</span>interface<span class="p">)</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">            </span><span class="kr">if</span><span class="w"> </span>r
<span class="w">                </span><span class="k">return</span><span class="w"> </span>r<span class="w"> </span><span class="c1">; early termination</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>data_flow<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="nf">VA_IPart_EnumPartsIncoming</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>parts<span class="p">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nf">VA_IPart_EnumPartsOutgoing</span><span class="p">(</span>part<span class="p">,</span><span class="w"> </span>parts<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">VA_IPartsList_GetCount</span><span class="p">(</span>parts<span class="p">,</span><span class="w"> </span>count<span class="p">)</span>
<span class="w">    </span><span class="k">Loop</span><span class="w"> </span><span class="nv">%count%</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nf">VA_IPartsList_GetPart</span><span class="p">(</span>parts<span class="p">,</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>subpart<span class="p">)</span><span class="w">        </span>
<span class="w">        </span>r<span class="w"> </span><span class="o">:=</span><span class="w"> </span>VA_EnumSubunitsEx<span class="p">(</span>subpart<span class="p">,</span><span class="w"> </span>data_flow<span class="p">,</span><span class="w"> </span>callback<span class="p">,</span><span class="w"> </span>target_name<span class="p">,</span><span class="w"> </span>target_iid<span class="p">,</span><span class="w"> </span>callback_param<span class="p">)</span>
<span class="w">        </span><span class="nf">COM_Release</span><span class="p">(</span>subpart<span class="p">)</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span>r
<span class="w">            </span><span class="k">break</span><span class="w"> </span><span class="c1">; early termination</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>parts<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>r<span class="w"> </span><span class="c1">; continue/finished enumeration</span>
<span class="p">}</span>

<span class="c1">; device_desc = device_id</span>
<span class="c1">;               | ( friendly_name | &#39;playback&#39; | &#39;capture&#39; ) [ &#39;:&#39; index ]</span>
<span class="nf">VA_GetDevice</span><span class="p">(</span>device_desc<span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="w"> </span>deviceEnumerator<span class="w"> </span><span class="o">:=</span><span class="w"> </span>COM_CreateObject<span class="p">(</span><span class="s">&quot;{BCDE0395-E52F-467C-8E3D-C4579291692E}&quot;</span><span class="p">,</span><span class="s">&quot;{A95664D2-9614-4F35-A746-DE8DB63617E6}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span>device<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">; deviceEnumerator-&gt;GetDevice(device_id, [out] device)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>deviceEnumerator<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>deviceEnumerator<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>COM_SysString<span class="p">(</span>wstr<span class="p">,</span><span class="w"> </span>device_desc<span class="p">),</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>device<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span>VA_GetDevice_Return
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>device_desc<span class="w"> </span>is<span class="w"> </span>integer
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>m2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>device_desc
<span class="w">        </span><span class="kr">if</span><span class="w"> </span>m2<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="c1">; Probably a device pointer, passed here indirectly via VA_GetAudioMeter or such.</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span>m2<span class="p">,</span><span class="w"> </span><span class="nf">COM_AddRef</span><span class="p">(</span>m2<span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nf">RegExMatch</span><span class="p">(</span>device_desc<span class="p">,</span><span class="w"> </span><span class="s">&quot;(.*?)\s*(?::(\d+))?$&quot;</span><span class="p">,</span><span class="w"> </span>m<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>m1<span class="w"> </span>in<span class="w"> </span>playback<span class="p">,</span>p
<span class="w">        </span>m1<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>flow<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c1">; eRender</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>m1<span class="w"> </span>in<span class="w"> </span>capture<span class="p">,</span>c
<span class="w">        </span>m1<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>flow<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">; eCapture</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>m1<span class="w"> </span><span class="p">.</span><span class="w"> </span>m2<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">  </span><span class="c1">; no name or number specified</span>
<span class="w">        </span>m1<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>flow<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c1">; eRender (default)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span>flow<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c1">; eAll</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>m1<span class="w"> </span><span class="p">.</span><span class="w"> </span>m2<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">   </span><span class="c1">; no name or number (maybe &quot;playback&quot; or &quot;capture&quot;)</span>
<span class="w">    </span><span class="p">{</span><span class="w">   </span><span class="c1">; deviceEnumerator-&gt;GetDefaultAudioEndpoint(dataFlow, role, [out] device)</span>
<span class="w">        </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>deviceEnumerator<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>deviceEnumerator<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>flow<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>device<span class="p">)</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span>VA_GetDevice_Return
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">; deviceEnumerator-&gt;EnumAudioEndpoints(dataFlow, stateMask, [out] devices)</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>deviceEnumerator<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>deviceEnumerator<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>flow<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>devices<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">; devices-&gt;GetCount([out] count)</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>devices<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>devices<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>count<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>m1<span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">{</span><span class="w">   </span><span class="c1">; devices-&gt;Item(m2-1, [out] device)</span>
<span class="w">        </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>devices<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>devices<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>m2<span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>device<span class="p">)</span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span>VA_GetDevice_Return
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span>index<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>count
<span class="w">        </span><span class="c1">; devices-&gt;Item(A_Index-1, [out] device)</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>devices<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>devices<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span>device<span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nf">InStr</span><span class="p">(</span>VA_GetDeviceName<span class="p">(</span>device<span class="p">),</span><span class="w"> </span>m1<span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>m2<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">++</span>index<span class="w"> </span><span class="o">=</span><span class="w"> </span>m2<span class="p">)</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span>VA_GetDevice_Return
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="nf">COM_Release</span><span class="p">(</span>device<span class="p">),</span><span class="w"> </span>device<span class="o">:=</span><span class="mi">0</span>

<span class="nl">VA_GetDevice_Return:</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>deviceEnumerator<span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span>devices
<span class="w">        </span><span class="nf">COM_Release</span><span class="p">(</span>devices<span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>device<span class="w"> </span><span class="c1">; may be 0</span>
<span class="p">}</span>

<span class="nf">VA_GetDeviceName</span><span class="p">(</span>device<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">static</span><span class="w"> </span>PKEY_Device_FriendlyName
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>VarSetCapacity<span class="p">(</span>PKEY_Device_FriendlyName<span class="p">)</span>
<span class="w">        </span><span class="nf">VarSetCapacity</span><span class="p">(</span>PKEY_Device_FriendlyName<span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="nf">COM_GUID4String</span><span class="p">(</span>PKEY_Device_FriendlyName<span class="p">,</span><span class="w"> </span><span class="s">&quot;{A45C254E-DF1C-4EFD-8020-67D146A850E0}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span>PKEY_Device_FriendlyName<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">    </span><span class="nf">VarSetCapacity</span><span class="p">(</span>prop<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">    </span><span class="nf">VA_IMMDevice_OpenPropertyStore</span><span class="p">(</span>device<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>store<span class="p">)</span>
<span class="w">    </span><span class="c1">; store-&gt;GetValue(.., [out] prop)</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>store<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span>store<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="o">&amp;</span>PKEY_Device_FriendlyName<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="o">&amp;</span>prop<span class="p">)</span>
<span class="w">    </span><span class="nf">COM_Release</span><span class="p">(</span>store<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">VA_StrGet</span><span class="p">(</span>NumGet<span class="p">(</span>prop<span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="w"> </span><span class="nf">COM_CoTaskMemFree</span><span class="p">(</span>NumGet<span class="p">(</span>prop<span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="p">}</span>

<span class="nf">VA_StrGet</span><span class="p">(</span>pString<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">; VA_StrGet: not included in AHK_L Unicode version.</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nb">A_IsUnicode</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nf">VarSetCapacity</span><span class="p">(</span>sString<span class="p">,</span><span class="w"> </span>nLen<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;msvcrt\wcslen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pString<span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pString<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>nLen<span class="p">)</span>
<span class="w">        </span><span class="k">Return</span><span class="w">	</span>sString
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span>nLen<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;kernel32\WideCharToMultiByte&quot;</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span>pString<span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nf">VarSetCapacity</span><span class="p">(</span>sString<span class="p">,</span>nLen<span class="p">)</span>
<span class="w">        </span><span class="kr">If</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;kernel32\WideCharToMultiByte&quot;</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span>pString<span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span>sString<span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span>nLen<span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">Return</span><span class="w">	</span>sString
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>


<span class="nf">VA_dB2Scalar</span><span class="p">(</span>dB<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>min_s<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>min_dB<span class="o">/</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span>max_s<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>max_dB<span class="o">/</span><span class="mi">20</span><span class="p">)</span>
<span class="w">    </span><span class="nf">return</span><span class="w"> </span><span class="p">((</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>dB<span class="o">/</span><span class="mi">20</span><span class="p">))</span><span class="o">-</span>min_s<span class="p">)</span><span class="o">/</span><span class="p">(</span>max_s<span class="o">-</span>min_s<span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="p">}</span>

<span class="nf">VA_Scalar2dB</span><span class="p">(</span>s<span class="p">,</span><span class="w"> </span>min_dB<span class="p">,</span><span class="w"> </span>max_dB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>min_s<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>min_dB<span class="o">/</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span>max_s<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>max_dB<span class="o">/</span><span class="mi">20</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">log</span><span class="p">((</span>max_s<span class="o">-</span>min_s<span class="p">)</span><span class="o">*</span>s<span class="o">+</span>min_s<span class="p">)</span><span class="o">*</span><span class="mi">20</span>
<span class="p">}</span>


<span class="c1">;</span>
<span class="c1">; INTERFACE WRAPPERS</span>
<span class="c1">;   Reference: Core Audio APIs in Windows Vista -- Programming Reference</span>
<span class="c1">;       http://msdn2.microsoft.com/en-us/library/ms679156(VS.85).aspx</span>
<span class="c1">;</span>

<span class="c1">;</span>
<span class="c1">; IMMDevice</span>
<span class="c1">;</span>
<span class="nf">VA_IMMDevice_Activate</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>iid<span class="p">,</span><span class="w"> </span>ClsCtx<span class="p">,</span><span class="w"> </span>ActivationParams<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Interface<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>iid<span class="p">,</span>iid<span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ClsCtx<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ActivationParams<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Interface<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IMMDevice_OpenPropertyStore</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Access<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Properties<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Access<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Properties<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IMMDevice_GetId</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Id<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Id<span class="p">)</span>
<span class="w">    </span>Id<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>Id<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>Id<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IMMDevice_GetState</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>State<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>State<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IDeviceTopology</span>
<span class="c1">;</span>
<span class="nf">VA_IDeviceTopology_GetConnectorCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Count<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Count<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetConnector</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Connector<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Connector<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetSubunitCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Count<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Count<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetSubunit</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Subunit<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Subunit<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetPartById</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Id<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Part<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Id<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Part<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetDeviceId</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>DeviceId<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>DeviceId<span class="p">)</span>
<span class="w">    </span>DeviceId<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>DeviceId<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>DeviceId<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IDeviceTopology_GetSignalPath</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>PartFrom<span class="p">,</span><span class="w"> </span>PartTo<span class="p">,</span><span class="w"> </span>RejectMixedPaths<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Parts<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>PartFrom<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>PartTo<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>RejectMixedPaths<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Parts<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IConnector</span>
<span class="c1">;</span>
<span class="nf">VA_IConnector_GetType</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Type<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Type<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_GetDataFlow</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Flow<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Flow<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_ConnectTo</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ConnectTo<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ConnectTo<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_Disconnect</span><span class="p">(</span>this<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_IsConnected</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Connected<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Connected<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_GetConnectedTo</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>ConTo<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ConTo<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IConnector_GetConnectorIdConnectedTo</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>ConnectorId<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ConnectorId<span class="p">)</span>
<span class="w">    </span>ConnectorId<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>ConnectorId<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>ConnectorId<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IConnector_GetDeviceIdConnectedTo</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>DeviceId<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>DeviceId<span class="p">)</span>
<span class="w">    </span>DeviceId<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>DeviceId<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>DeviceId<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IPart</span>
<span class="c1">;</span>
<span class="nf">VA_IPart_GetName</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Name<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Name<span class="p">)</span>
<span class="w">    </span>Name<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>Name<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>Name<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IPart_GetLocalId</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Id<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Id<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_GetGlobalId</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>GlobalId<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>GlobalId<span class="p">)</span>
<span class="w">    </span>GlobalId<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>VA_StrGet<span class="p">(</span>GlobalId<span class="p">),</span>COM_CoTaskMemFree<span class="p">(</span>GlobalId<span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IPart_GetPartType</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>PartType<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>PartType<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_GetSubType</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>SubType<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">VarSetCapacity</span><span class="p">(</span>SubType<span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span>hr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>SubType<span class="p">)</span>
<span class="w">    </span>SubType<span class="w"> </span><span class="o">:=</span><span class="w"> </span>COM_String4GUID<span class="p">(</span><span class="o">&amp;</span>SubType<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>hr
<span class="p">}</span>
<span class="nf">VA_IPart_GetControlInterfaceCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Count<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Count<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_GetControlInterface</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>InterfaceDesc<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Index<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>InterfaceDesc<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_EnumPartsIncoming</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Parts<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Parts<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_EnumPartsOutgoing</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Parts<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Parts<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_GetTopologyObject</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Topology<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Topology<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_Activate</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ClsContext<span class="p">,</span><span class="w"> </span>iid<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Object<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">52</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ClsContext<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>iid<span class="p">,</span>iid<span class="p">),</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Object<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_RegisterControlChangeCallback</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>iid<span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">56</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>iid<span class="p">,</span>iid<span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPart_UnregisterControlChangeCallback</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IPartsList</span>
<span class="c1">;</span>
<span class="nf">VA_IPartsList_GetCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Count<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Count<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPartsList_GetPart</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>INdex<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Part<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>INdex<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Part<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IAudioEndpointVolume</span>
<span class="c1">;</span>
<span class="nf">VA_IAudioEndpointVolume_RegisterControlChangeNotify</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_UnregisterControlChangeNotify</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Notify<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetChannelCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>ChannelCount<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_SetMasterVolumeLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_SetMasterVolumeLevelScalar</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Level<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>Level<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetMasterVolumeLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>LevelDB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetMasterVolumeLevelScalar</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Level<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>Level<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_SetChannelVolumeLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_SetChannelVolumeLevelScalar</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>Level<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>Level<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetChannelVolumeLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>LevelDB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetChannelVolumeLevelScalar</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Level<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">52</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>Level<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_SetMute</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Mute<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">56</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Mute<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetMute</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Mute<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Mute<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetVolumeStepInfo</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Step<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>StepCount<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Step<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>StepCount<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_VolumeStepUp</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">68</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_VolumeStepDown</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_QueryHardwareSupport</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>HardwareSupportMask<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">76</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>HardwareSupportMask<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioEndpointVolume_GetVolumeRange</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>MinDB<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>MaxDB<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>IncrementDB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">80</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>MinDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>MaxDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>IncrementDB<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IPerChannelDbLevel</span>
<span class="c1">;   Applies to IAudioVolumeLevel, IAudioBass, IAudioMidrange and IAudioTreble.</span>
<span class="c1">;</span>
<span class="nf">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Channels<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Channels<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>MinLevelDB<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>MaxLevelDB<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Stepping<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>MinLevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>MaxLevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>Stepping<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>LevelDB<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Channel<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPerChannelDbLevel_SetLevelUniform</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>LevelDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IPerChannelDbLevel_SetLevelAllChannels</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>LevelsDB<span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>LevelsDB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IAudioMute</span>
<span class="c1">;</span>
<span class="nf">VA_IAudioMute_SetMute</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Muted<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Muted<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioMute_GetMute</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Muted<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Muted<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IAudioAutoGainControl</span>
<span class="c1">;</span>
<span class="nf">VA_IAudioAutoGainControl_GetEnabled</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Enabled<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int*&quot;</span><span class="p">,</span><span class="w"> </span>Enabled<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioAutoGainControl_SetEnabled</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>Enable<span class="p">,</span><span class="w"> </span>GuidEventContext<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Enable<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>GuidEventContext<span class="w"> </span><span class="o">?</span><span class="w"> </span>COM_GUID4String<span class="p">(</span>GuidEventContext<span class="p">,</span>GuidEventContext<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">;</span>
<span class="c1">; IAudioMeterInformation</span>
<span class="c1">;</span>
<span class="nf">VA_IAudioMeterInformation_GetPeakValue</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Peak<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>Peak<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioMeterInformation_GetMeteringChannelCount</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>ChannelCount<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioMeterInformation_GetChannelsPeakValues</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">,</span><span class="w"> </span>PeakValues<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ChannelCount<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>PeakValues<span class="p">)</span>
<span class="p">}</span>
<span class="nf">VA_IAudioMeterInformation_QueryHardwareSupport</span><span class="p">(</span>this<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>HardwareSupportMask<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span>this<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>this<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>HardwareSupportMask<span class="p">)</span>
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">;</span>
<span class="c-Singleline">; MASTER CONTROLS</span>
<span class="c-Singleline">;</span>

<span class="n">VA_GetMasterVolume</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">aev</span> <span class="o">:=</span> <span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
<span class="w">    </span><span class="nb">if </span><span class="n">channel</span> <span class="o">=</span>
        <span class="n">VA_IAudioEndpointVolume_GetMasterVolumeLevelScalar</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">vol</span><span class="p">)</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="n">VA_IAudioEndpointVolume_GetChannelVolumeLevelScalar</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">channel</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vol</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">aev</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">vol</span><span class="o">*</span><span class="mi">100</span>
<span class="p">}</span>

<span class="n">VA_SetMasterVolume</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">vol</span> <span class="o">:=</span> <span class="n">vol</span><span class="o">&gt;</span><span class="mi">100</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="n">vol</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">vol</span>
    <span class="n">aev</span> <span class="o">:=</span> <span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
<span class="w">    </span><span class="nb">if </span><span class="n">channel</span> <span class="o">=</span>
        <span class="n">VA_IAudioEndpointVolume_SetMasterVolumeLevelScalar</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">vol</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="n">VA_IAudioEndpointVolume_SetChannelVolumeLevelScalar</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">channel</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vol</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">aev</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">VA_GetMasterChannelCount</span><span class="p">(</span><span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">aev</span> <span class="o">:=</span> <span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
    <span class="n">VA_IAudioEndpointVolume_GetChannelCount</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">aev</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">count</span>
<span class="p">}</span>

<span class="n">VA_SetMasterMute</span><span class="p">(</span><span class="n">mute</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">aev</span> <span class="o">:=</span> <span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
    <span class="n">VA_IAudioEndpointVolume_SetMute</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">mute</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">aev</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">VA_GetMasterMute</span><span class="p">(</span><span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">aev</span> <span class="o">:=</span> <span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
    <span class="n">VA_IAudioEndpointVolume_GetMute</span><span class="p">(</span><span class="n">aev</span><span class="p">,</span> <span class="n">mute</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">aev</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">mute</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; SUBUNIT CONTROLS</span>
<span class="c-Singleline">;</span>

<span class="n">VA_GetVolume</span><span class="p">(</span><span class="n">subunit_desc</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">avl</span> <span class="o">:=</span> <span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">avl</span>
<span class="w">        </span><span class="nb">return</span>
    <span class="n">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel_count</span><span class="p">)</span>
<span class="w">    </span><span class="nb">if </span><span class="n">channel</span> <span class="o">=</span>
    <span class="p">{</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">        </span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%channel_count%</span>
        <span class="p">{</span>
            <span class="n">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">,</span> <span class="n">step_dB</span><span class="p">)</span>
            <span class="n">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">this_vol</span><span class="p">)</span>
            <span class="n">this_vol</span> <span class="o">:=</span> <span class="n">VA_dB2Scalar</span><span class="p">(</span><span class="n">this_vol</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">            </span>
<span class="c-Singleline">            ; &quot;Speakers Properties&quot; reports the highest channel as the volume.</span>
            <span class="n">if</span> <span class="p">(</span><span class="n">this_vol</span> <span class="o">&gt;</span> <span class="n">vol</span><span class="p">)</span>
                <span class="n">vol</span> <span class="o">:=</span> <span class="n">this_vol</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">else</span> <span class="n">if</span> <span class="n">channel</span> <span class="n">between</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">channel_count</span>
    <span class="p">{</span>
        <span class="n">channel</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">,</span> <span class="n">step_dB</span><span class="p">)</span>
        <span class="n">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">vol</span><span class="p">)</span>
        <span class="n">vol</span> <span class="o">:=</span> <span class="n">VA_dB2Scalar</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">avl</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">vol</span>
<span class="p">}</span>

<span class="n">VA_SetVolume</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">avl</span> <span class="o">:=</span> <span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">avl</span>
<span class="w">        </span><span class="nb">return</span>
    
    <span class="n">vol</span> <span class="o">:=</span> <span class="n">vol</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">vol</span><span class="o">&gt;</span><span class="mi">100</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="n">vol</span>
    
    <span class="n">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel_count</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">channel</span> <span class="o">=</span>
    <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">        ; Simple method -- resets balance to &quot;center&quot;:</span>
<span class="c-Singleline">        ;VA_IPerChannelDbLevel_SetLevelUniform(avl, vol)</span>
        
        <span class="n">vol_max</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">        </span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%channel_count%</span>
        <span class="p">{</span>
            <span class="n">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">,</span> <span class="n">step_dB</span><span class="p">)</span>
            <span class="n">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">this_vol</span><span class="p">)</span>
            <span class="n">this_vol</span> <span class="o">:=</span> <span class="n">VA_dB2Scalar</span><span class="p">(</span><span class="n">this_vol</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">)</span>
            
            <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">vol</span> <span class="o">:=</span> <span class="n">this_vol</span>
            <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">min</span> <span class="o">:=</span> <span class="n">min_dB</span>
            <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">max</span> <span class="o">:=</span> <span class="n">max_dB</span><span class="c-Singleline"></span>
<span class="c-Singleline">            </span>
<span class="c-Singleline">            ; Scale all channels relative to the loudest channel.</span>
<span class="c-Singleline">            ; (This is how Vista&#39;s &quot;Speakers Properties&quot; dialog seems to work.)</span>
            <span class="n">if</span> <span class="p">(</span><span class="n">this_vol</span> <span class="o">&gt;</span> <span class="n">vol_max</span><span class="p">)</span>
                <span class="n">vol_max</span> <span class="o">:=</span> <span class="n">this_vol</span>
        <span class="p">}</span>
<span class="w">        </span>
<span class="w">        </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%channel_count%</span>
        <span class="p">{</span>
            <span class="n">this_vol</span> <span class="o">:=</span> <span class="n">vol_max</span> <span class="o">?</span> <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">vol</span> <span class="o">/</span> <span class="n">vol_max</span> <span class="o">*</span> <span class="n">vol</span> <span class="o">:</span> <span class="n">vol</span>
            <span class="n">this_vol</span> <span class="o">:=</span> <span class="n">VA_Scalar2dB</span><span class="p">(</span><span class="n">this_vol</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">min</span><span class="p">,</span> <span class="n">channel</span><span class="nv">%A_Index%</span><span class="n">max</span><span class="p">)</span>            
            <span class="n">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">this_vol</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">else</span> <span class="n">if</span> <span class="n">channel</span> <span class="n">between</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nv">%channel_count%</span>
    <span class="p">{</span>
        <span class="n">channel</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">,</span> <span class="n">step_dB</span><span class="p">)</span>
        <span class="n">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">VA_Scalar2dB</span><span class="p">(</span><span class="n">vol</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">avl</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">VA_GetChannelCount</span><span class="p">(</span><span class="n">subunit_desc</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">avl</span> <span class="o">:=</span> <span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="s">&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">avl</span>
<span class="w">        </span><span class="nb">return</span>
    <span class="n">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span><span class="n">avl</span><span class="p">,</span> <span class="n">channel_count</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">avl</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">channel_count</span>
<span class="p">}</span>

<span class="n">VA_SetMute</span><span class="p">(</span><span class="n">mute</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">amute</span> <span class="o">:=</span> <span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="s">&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">amute</span>
<span class="w">        </span><span class="nb">return</span>
    <span class="n">VA_IAudioMute_SetMute</span><span class="p">(</span><span class="n">amute</span><span class="p">,</span> <span class="n">mute</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">amute</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">VA_GetMute</span><span class="p">(</span><span class="n">subunit_desc</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">amute</span> <span class="o">:=</span> <span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="s">&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">amute</span>
<span class="w">        </span><span class="nb">return</span>
    <span class="n">VA_IAudioMute_GetMute</span><span class="p">(</span><span class="n">amute</span><span class="p">,</span> <span class="n">muted</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">amute</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">muted</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; AUDIO METERING</span>
<span class="c-Singleline">;</span>

<span class="n">VA_GetAudioMeter</span><span class="p">(</span><span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">if</span> <span class="o">!</span> <span class="n">device</span> <span class="o">:=</span> <span class="n">VA_GetDevice</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="mi">0</span>
    <span class="n">VA_IMMDevice_Activate</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">&quot;{C02216F6-8C67-4B5B-9D00-D008E73E0064}&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">audioMeter</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">audioMeter</span>
<span class="p">}</span>

<span class="n">VA_GetDevicePeriod</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">default_period</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">minimum_period</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">defaultPeriod</span> <span class="o">:=</span> <span class="n">minimumPeriod</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="n">if</span> <span class="o">!</span> <span class="n">device</span> <span class="o">:=</span> <span class="n">VA_GetDevice</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="nv">false</span>
    <span class="n">VA_IMMDevice_Activate</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">&quot;{1CB9AD4C-DBFA-4c32-B178-C2F568A703B2}&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">audioClient</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; IAudioClient::GetDevicePeriod</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">audioClient</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">audioClient</span><span class="p">,</span> <span class="s">&quot;int64*&quot;</span><span class="p">,</span><span class="n">default_period</span><span class="p">,</span> <span class="s">&quot;int64*&quot;</span><span class="p">,</span><span class="n">minimum_period</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; Convert 100-nanosecond units to milliseconds.</span>
    <span class="n">default_period</span> <span class="o">/=</span> <span class="mi">10000</span>
    <span class="n">minimum_period</span> <span class="o">/=</span> <span class="mi">10000</span>    
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">audioClient</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="nv">true</span>
<span class="p">}</span>


<span class="cm">/* IID</span>
<span class="cm">    COM_GUID4String(IID_IAudioEndpointVolume,&quot;{5CDF2C82-841E-4546-9722-0CF74078229A}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioVolumeLevel,&quot;{7FB7B48F-531D-44A2-BCB3-5AD5A134B3DC}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioMute,&quot;{DF45AEEA-B74A-4B6B-AFAD-2366B6AA012E}&quot;)</span>
<span class="cm">    COM_GUID4String(IID_IAudioAutoGainControl,&quot;{85401FD4-6DE4-4b9d-9869-2D6753A82F3C}&quot;)</span>
<span class="cm">*/</span>

<span class="n">VA_GetAudioEndpointVolume</span><span class="p">(</span><span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">if</span> <span class="o">!</span> <span class="n">device</span> <span class="o">:=</span> <span class="n">VA_GetDevice</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="mi">0</span>
    <span class="n">VA_IMMDevice_Activate</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">&quot;{5CDF2C82-841E-4546-9722-0CF74078229A}&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">endpointVolume</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">endpointVolume</span>
<span class="p">}</span>

<span class="n">VA_GetDeviceSubunit</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="n">subunit_iid</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">device</span> <span class="o">:=</span> <span class="n">VA_GetDevice</span><span class="p">(</span><span class="n">device_desc</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">device</span>
<span class="w">        </span><span class="nb">return</span> <span class="mi">0</span>
    <span class="n">subunit</span> <span class="o">:=</span> <span class="n">VA_FindSubunit</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">subunit_desc</span><span class="p">,</span> <span class="n">subunit_iid</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">subunit</span>
<span class="p">}</span>

<span class="n">VA_FindSubunit</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">target_desc</span><span class="p">,</span> <span class="n">target_iid</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nb">if </span><span class="n">target_desc</span> <span class="ow">is</span> <span class="n">integer</span>
        <span class="n">target_index</span> <span class="o">:=</span> <span class="n">target_desc</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="nf">RegExMatch</span><span class="p">(</span><span class="n">target_desc</span><span class="p">,</span> <span class="s">&quot;(?&lt;_name&gt;.*?)(?::(?&lt;_index&gt;\d+))?$&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; v2.01: Since target_name is now a regular expression, default to case-insensitive mode if no options are specified.</span>
    <span class="n">if</span> <span class="o">!</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span><span class="s">&quot;[imsxADJUXPS`n`r`a ]+\)&quot;</span><span class="p">)</span>
        <span class="n">target_name</span> <span class="o">:=</span> <span class="s">&quot;i)&quot;</span> <span class="n">target_name</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; cbinfo:</span>
<span class="c-Singleline">    ;   @0  target_index</span>
<span class="c-Singleline">    ;   @4  current_index</span>
    <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">cbinfo</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nf">NumPut</span><span class="p">(</span><span class="n">target_index</span> <span class="o">?</span> <span class="n">target_index</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cbinfo</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">:=</span> <span class="n">VA_EnumSubunits</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">&quot;VA_FindSubunitCallback&quot;</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_iid</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cbinfo</span><span class="p">)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalFree&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">r</span>
<span class="p">}</span>

<span class="n">VA_FindSubunitCallback</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">prm</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">NumPut</span><span class="p">(</span><span class="n">index</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">prm</span><span class="o">+</span><span class="mi">4</span><span class="p">),</span> <span class="n">prm</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="nb">if </span><span class="nf">NumGet</span><span class="p">(</span><span class="n">prm</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">index</span>
    <span class="p">{</span>
        <span class="n">COM_AddRef</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="n">interface</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">VA_EnumSubunits</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">target_iid</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">callback_param</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">VA_IMMDevice_Activate</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">&quot;{2A07407E-6497-4A18-9787-32F79BD0D98F}&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">deviceTopology</span><span class="p">)</span>
    <span class="n">VA_IDeviceTopology_GetConnector</span><span class="p">(</span><span class="n">deviceTopology</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">deviceTopology</span><span class="p">)</span>
    <span class="n">VA_IConnector_GetConnectedTo</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">conn_to</span><span class="p">)</span>
    <span class="n">VA_IConnector_GetDataFlow</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">data_flow</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
    <span class="n">if</span> <span class="o">!</span><span class="n">conn_to</span>
<span class="w">        </span><span class="nb">return</span><span class="c-Singleline"> ; blank to indicate error</span>
    <span class="n">part</span> <span class="o">:=</span> <span class="n">COM_QueryInterface</span><span class="p">(</span><span class="n">conn_to</span><span class="p">,</span> <span class="s">&quot;{AE2DE0E4-5BCA-4F2D-AA46-5D13F8FDB3A9}&quot;</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">conn_to</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">:=</span> <span class="n">VA_EnumSubunitsEx</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data_flow</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_iid</span><span class="p">,</span> <span class="n">callback_param</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">r</span><span class="c-Singleline"> ; value returned by callback, or zero.</span>
<span class="p">}</span>

<span class="n">VA_EnumSubunitsEx</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">data_flow</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">target_iid</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">callback_param</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">r</span> <span class="o">:=</span> <span class="mi">0</span>
    
    <span class="n">VA_IPart_GetPartType</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">type</span> <span class="o">=</span> <span class="mi">1</span><span class="c-Singleline"> ; Subunit</span>
    <span class="p">{</span>
        <span class="n">VA_IPart_GetName</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">        </span>
<span class="c-Singleline">        ; v2.01: target_name is now a regular expression.</span>
<span class="w">        </span><span class="nb">if </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">target_name</span><span class="p">)</span>
        <span class="p">{</span>
<span class="w">            </span><span class="nb">if </span><span class="n">target_iid</span> <span class="o">=</span>
                <span class="n">r</span> <span class="o">:=</span> <span class="nv">%callback%</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">callback_param</span><span class="p">)</span>
<span class="w">            </span><span class="nb">else</span>
<span class="w">                </span><span class="nb">if </span><span class="n">VA_IPart_Activate</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">target_iid</span><span class="p">,</span> <span class="n">interface</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="p">{</span>
                    <span class="n">r</span> <span class="o">:=</span> <span class="nv">%callback%</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">callback_param</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">                    ; The callback is responsible for calling COM_AddRef()</span>
<span class="c-Singleline">                    ; if it intends to keep the interface pointer.</span>
                    <span class="n">COM_Release</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
                <span class="p">}</span>

<span class="w">            </span><span class="nb">if </span><span class="n">r</span>
<span class="w">                </span><span class="nb">return</span> <span class="n">r</span><span class="c-Singleline"> ; early termination</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">data_flow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">VA_IPart_EnumPartsIncoming</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">parts</span><span class="p">)</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="n">VA_IPart_EnumPartsOutgoing</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">parts</span><span class="p">)</span>
    
    <span class="n">VA_IPartsList_GetCount</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Loop</span> <span class="nv">%count%</span>
    <span class="p">{</span>
        <span class="n">VA_IPartsList_GetPart</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span> <span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">subpart</span><span class="p">)</span>        
        <span class="n">r</span> <span class="o">:=</span> <span class="n">VA_EnumSubunitsEx</span><span class="p">(</span><span class="n">subpart</span><span class="p">,</span> <span class="n">data_flow</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">target_iid</span><span class="p">,</span> <span class="n">callback_param</span><span class="p">)</span>
        <span class="n">COM_Release</span><span class="p">(</span><span class="n">subpart</span><span class="p">)</span>
<span class="w">        </span><span class="nb">if </span><span class="n">r</span>
<span class="w">            </span><span class="nb">break</span><span class="c-Singleline"> ; early termination</span>
    <span class="p">}</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">r</span><span class="c-Singleline"> ; continue/finished enumeration</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; device_desc = device_id</span>
<span class="c-Singleline">;               | ( friendly_name | &#39;playback&#39; | &#39;capture&#39; ) [ &#39;:&#39; index ]</span>
<span class="n">VA_GetDevice</span><span class="p">(</span><span class="n">device_desc</span><span class="o">=</span><span class="s">&quot;playback&quot;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">if</span> <span class="o">!</span> <span class="n">deviceEnumerator</span> <span class="o">:=</span> <span class="n">COM_CreateObject</span><span class="p">(</span><span class="s">&quot;{BCDE0395-E52F-467C-8E3D-C4579291692E}&quot;</span><span class="p">,</span><span class="s">&quot;{A95664D2-9614-4F35-A746-DE8DB63617E6}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="mi">0</span>

    <span class="n">device</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline"></span>
<span class="c-Singleline">    </span>
<span class="c-Singleline">    ; deviceEnumerator-&gt;GetDevice(device_id, [out] device)</span>
<span class="w">    </span><span class="nb">if </span><span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">deviceEnumerator</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">deviceEnumerator</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">COM_SysString</span><span class="p">(</span><span class="n">wstr</span><span class="p">,</span> <span class="n">device_desc</span><span class="p">),</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">device</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">        </span><span class="nb">goto</span> <span class="n">VA_GetDevice_Return</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">device_desc</span> <span class="ow">is</span> <span class="n">integer</span>
    <span class="p">{</span>
        <span class="n">m2</span> <span class="o">:=</span> <span class="n">device_desc</span>
<span class="w">        </span><span class="nb">if </span><span class="n">m2</span> <span class="o">&gt;=</span> <span class="mi">4096</span><span class="c-Singleline"> ; Probably a device pointer, passed here indirectly via VA_GetAudioMeter or such.</span>
<span class="w">            </span><span class="nb">return</span> <span class="n">m2</span><span class="p">,</span> <span class="n">COM_AddRef</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="nf">RegExMatch</span><span class="p">(</span><span class="n">device_desc</span><span class="p">,</span> <span class="s">&quot;(.*?)\s*(?::(\d+))?$&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">m1</span> <span class="ow">in</span> <span class="n">playback</span><span class="p">,</span><span class="n">p</span>
        <span class="n">m1</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">flow</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline"> ; eRender</span>
<span class="w">    </span><span class="nb">else</span> <span class="n">if</span> <span class="n">m1</span> <span class="ow">in</span> <span class="n">capture</span><span class="p">,</span><span class="n">c</span>
        <span class="n">m1</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">flow</span> <span class="o">:=</span> <span class="mi">1</span><span class="c-Singleline"> ; eCapture</span>
<span class="w">    </span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">m1</span> <span class="o">.</span> <span class="n">m2</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="c-Singleline">  ; no name or number specified</span>
        <span class="n">m1</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">flow</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline"> ; eRender (default)</span>
<span class="w">    </span><span class="nb">else</span>
        <span class="n">flow</span> <span class="o">:=</span> <span class="mi">2</span><span class="c-Singleline"> ; eAll</span>
    
    <span class="n">if</span> <span class="p">(</span><span class="n">m1</span> <span class="o">.</span> <span class="n">m2</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="c-Singleline">   ; no name or number (maybe &quot;playback&quot; or &quot;capture&quot;)</span>
    <span class="p">{</span><span class="c-Singleline">   ; deviceEnumerator-&gt;GetDefaultAudioEndpoint(dataFlow, role, [out] device)</span>
        <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">deviceEnumerator</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">deviceEnumerator</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">flow</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">device</span><span class="p">)</span>
<span class="w">        </span><span class="nb">goto</span> <span class="n">VA_GetDevice_Return</span>
    <span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">    ; deviceEnumerator-&gt;EnumAudioEndpoints(dataFlow, stateMask, [out] devices)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">deviceEnumerator</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">deviceEnumerator</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">flow</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">devices</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    </span>
<span class="c-Singleline">    ; devices-&gt;GetCount([out] count)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">devices</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">devices</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">if </span><span class="n">m1</span> <span class="o">=</span>
    <span class="p">{</span><span class="c-Singleline">   ; devices-&gt;Item(m2-1, [out] device)</span>
        <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">devices</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">devices</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">m2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">device</span><span class="p">)</span>
<span class="w">        </span><span class="nb">goto</span> <span class="n">VA_GetDevice_Return</span>
    <span class="p">}</span>
    
    <span class="n">index</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">    </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">count</span><span class="c-Singleline"></span>
<span class="c-Singleline">        ; devices-&gt;Item(A_Index-1, [out] device)</span>
<span class="w">        </span><span class="nb">if </span><span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">devices</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">devices</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="n">device</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">            </span><span class="nb">if </span><span class="nf">InStr</span><span class="p">(</span><span class="n">VA_GetDeviceName</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">m1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">m2</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">||</span> <span class="o">++</span><span class="n">index</span> <span class="o">=</span> <span class="n">m2</span><span class="p">)</span>
<span class="w">                </span><span class="nb">goto</span> <span class="n">VA_GetDevice_Return</span>
<span class="w">            </span><span class="nb">else</span>
                <span class="n">COM_Release</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">device</span><span class="o">:=</span><span class="mi">0</span>

<span class="nl">VA_GetDevice_Return:</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">deviceEnumerator</span><span class="p">)</span>
<span class="w">    </span><span class="nb">if </span><span class="n">devices</span>
        <span class="n">COM_Release</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nb">return</span> <span class="n">device</span><span class="c-Singleline"> ; may be 0</span>
<span class="p">}</span>

<span class="n">VA_GetDeviceName</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nb">static</span> <span class="n">PKEY_Device_FriendlyName</span>
    <span class="n">if</span> <span class="o">!</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PKEY_Device_FriendlyName</span><span class="p">)</span>
        <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PKEY_Device_FriendlyName</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="p">,</span><span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">PKEY_Device_FriendlyName</span><span class="p">,</span> <span class="s">&quot;{A45C254E-DF1C-4EFD-8020-67D146A850E0}&quot;</span><span class="p">)</span>
        <span class="p">,</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">PKEY_Device_FriendlyName</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">VA_IMMDevice_OpenPropertyStore</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">store</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; store-&gt;GetValue(.., [out] prop)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">store</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">store</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">PKEY_Device_FriendlyName</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">prop</span><span class="p">)</span>
    <span class="n">COM_Release</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">VA_StrGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span> <span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">VA_StrGet</span><span class="p">(</span><span class="n">pString</span><span class="p">)</span>
<span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; VA_StrGet: not included in AHK_L Unicode version.</span>
<span class="w">    </span><span class="nb">if </span><span class="nv">A_IsUnicode</span>
    <span class="p">{</span>
        <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span> <span class="n">nLen</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;msvcrt\wcslen&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pString</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">sString</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pString</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">nLen</span><span class="p">)</span>
<span class="w">        </span><span class="nb">Return</span>	<span class="n">sString</span>
    <span class="p">}</span>
<span class="w">    </span><span class="nb">else</span>
    <span class="p">{</span>
        <span class="n">nLen</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;kernel32\WideCharToMultiByte&quot;</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="n">pString</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">)</span>
        <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span><span class="n">nLen</span><span class="p">)</span>
<span class="w">        </span><span class="nb">If </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;kernel32\WideCharToMultiByte&quot;</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="n">pString</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="n">sString</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="n">nLen</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="nb">Return</span>	<span class="n">sString</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="n">VA_dB2Scalar</span><span class="p">(</span><span class="n">dB</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">min_s</span> <span class="o">:=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">min_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">),</span> <span class="n">max_s</span> <span class="o">:=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">max_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="p">((</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">dB</span><span class="o">/</span><span class="mi">20</span><span class="p">))</span><span class="o">-</span><span class="n">min_s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_s</span><span class="o">-</span><span class="n">min_s</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="p">}</span>

<span class="n">VA_Scalar2dB</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">min_dB</span><span class="p">,</span> <span class="n">max_dB</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">min_s</span> <span class="o">:=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">min_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">),</span> <span class="n">max_s</span> <span class="o">:=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">max_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">log</span><span class="p">((</span><span class="n">max_s</span><span class="o">-</span><span class="n">min_s</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="n">min_s</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span>
<span class="p">}</span><span class="c-Singleline"></span>


<span class="c-Singleline">;</span>
<span class="c-Singleline">; INTERFACE WRAPPERS</span>
<span class="c-Singleline">;   Reference: Core Audio APIs in Windows Vista -- Programming Reference</span>
<span class="c-Singleline">;       http://msdn2.microsoft.com/en-us/library/ms679156(VS.85).aspx</span>
<span class="c-Singleline">;</span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IMMDevice</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IMMDevice_Activate</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iid</span><span class="p">,</span> <span class="n">ClsCtx</span><span class="p">,</span> <span class="n">ActivationParams</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Interface</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">iid</span><span class="p">,</span><span class="n">iid</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ClsCtx</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ActivationParams</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Interface</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IMMDevice_OpenPropertyStore</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Access</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Properties</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Access</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Properties</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IMMDevice_GetId</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Id</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Id</span><span class="p">)</span>
    <span class="n">Id</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">Id</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">Id</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IMMDevice_GetState</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">State</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">State</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IDeviceTopology</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IDeviceTopology_GetConnectorCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Count</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Count</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetConnector</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Connector</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Connector</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetSubunitCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Count</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Count</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetSubunit</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Subunit</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Subunit</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetPartById</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Id</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Part</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Id</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Part</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetDeviceId</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">DeviceId</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">DeviceId</span><span class="p">)</span>
    <span class="n">DeviceId</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">DeviceId</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">DeviceId</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IDeviceTopology_GetSignalPath</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">PartFrom</span><span class="p">,</span> <span class="n">PartTo</span><span class="p">,</span> <span class="n">RejectMixedPaths</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Parts</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">PartFrom</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">PartTo</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">RejectMixedPaths</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Parts</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IConnector</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IConnector_GetType</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Type</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_GetDataFlow</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Flow</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Flow</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_ConnectTo</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ConnectTo</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ConnectTo</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_Disconnect</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_IsConnected</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Connected</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Connected</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_GetConnectedTo</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">ConTo</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ConTo</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IConnector_GetConnectorIdConnectedTo</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">ConnectorId</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ConnectorId</span><span class="p">)</span>
    <span class="n">ConnectorId</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">ConnectorId</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">ConnectorId</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IConnector_GetDeviceIdConnectedTo</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">DeviceId</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">DeviceId</span><span class="p">)</span>
    <span class="n">DeviceId</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">DeviceId</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">DeviceId</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IPart</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IPart_GetName</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Name</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">)</span>
    <span class="n">Name</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">Name</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">Name</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetLocalId</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Id</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Id</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetGlobalId</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">GlobalId</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">GlobalId</span><span class="p">)</span>
    <span class="n">GlobalId</span> <span class="o">:=</span> <span class="p">(</span><span class="n">VA_StrGet</span><span class="p">(</span><span class="n">GlobalId</span><span class="p">),</span><span class="n">COM_CoTaskMemFree</span><span class="p">(</span><span class="n">GlobalId</span><span class="p">))</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetPartType</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">PartType</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">PartType</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetSubType</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">SubType</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">SubType</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">hr</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SubType</span><span class="p">)</span>
    <span class="n">SubType</span> <span class="o">:=</span> <span class="n">COM_String4GUID</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SubType</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">hr</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetControlInterfaceCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Count</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Count</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetControlInterface</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">InterfaceDesc</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">InterfaceDesc</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_EnumPartsIncoming</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Parts</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Parts</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_EnumPartsOutgoing</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Parts</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Parts</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_GetTopologyObject</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Topology</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Topology</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_Activate</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ClsContext</span><span class="p">,</span> <span class="n">iid</span><span class="p">,</span> <span class="n">ByRef</span> <span class="nf">Object</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">52</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ClsContext</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">iid</span><span class="p">,</span><span class="n">iid</span><span class="p">),</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="nf">Object</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_RegisterControlChangeCallback</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iid</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">56</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">iid</span><span class="p">,</span><span class="n">iid</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPart_UnregisterControlChangeCallback</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IPartsList</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IPartsList_GetCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Count</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Count</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPartsList_GetPart</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">INdex</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Part</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">INdex</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Part</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IAudioEndpointVolume</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IAudioEndpointVolume_RegisterControlChangeNotify</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_UnregisterControlChangeNotify</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Notify</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetChannelCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">ChannelCount</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_SetMasterVolumeLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_SetMasterVolumeLevelScalar</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Level</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">Level</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetMasterVolumeLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">LevelDB</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetMasterVolumeLevelScalar</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Level</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">36</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">Level</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_SetChannelVolumeLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">40</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_SetChannelVolumeLevelScalar</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">Level</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">Level</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetChannelVolumeLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">LevelDB</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">48</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetChannelVolumeLevelScalar</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Level</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">52</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">Level</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_SetMute</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Mute</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">56</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Mute</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetMute</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Mute</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">60</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Mute</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetVolumeStepInfo</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Step</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">StepCount</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">64</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Step</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">StepCount</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_VolumeStepUp</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">68</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_VolumeStepDown</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">72</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_QueryHardwareSupport</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">HardwareSupportMask</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">76</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">HardwareSupportMask</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioEndpointVolume_GetVolumeRange</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">MinDB</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">MaxDB</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">IncrementDB</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">80</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">MinDB</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">MaxDB</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">IncrementDB</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IPerChannelDbLevel</span>
<span class="c-Singleline">;   Applies to IAudioVolumeLevel, IAudioBass, IAudioMidrange and IAudioTreble.</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IPerChannelDbLevel_GetChannelCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Channels</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Channels</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPerChannelDbLevel_GetLevelRange</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">MinLevelDB</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">MaxLevelDB</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Stepping</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">MinLevelDB</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">MaxLevelDB</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">Stepping</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPerChannelDbLevel_GetLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">LevelDB</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPerChannelDbLevel_SetLevel</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Channel</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPerChannelDbLevel_SetLevelUniform</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">28</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">LevelDB</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IPerChannelDbLevel_SetLevelAllChannels</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">LevelsDB</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">32</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">LevelsDB</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IAudioMute</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IAudioMute_SetMute</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Muted</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Muted</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioMute_GetMute</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Muted</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Muted</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IAudioAutoGainControl</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IAudioAutoGainControl_GetEnabled</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Enabled</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int*&quot;</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioAutoGainControl_SetEnabled</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">GuidEventContext</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">GuidEventContext</span> <span class="o">?</span> <span class="n">COM_GUID4String</span><span class="p">(</span><span class="n">GuidEventContext</span><span class="p">,</span><span class="n">GuidEventContext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;</span>
<span class="c-Singleline">; IAudioMeterInformation</span>
<span class="c-Singleline">;</span>
<span class="n">VA_IAudioMeterInformation_GetPeakValue</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Peak</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">Peak</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioMeterInformation_GetMeteringChannelCount</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">ChannelCount</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioMeterInformation_GetChannelsPeakValues</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">,</span> <span class="n">PeakValues</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ChannelCount</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">PeakValues</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">VA_IAudioMeterInformation_QueryHardwareSupport</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">HardwareSupportMask</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">this</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">24</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">HardwareSupportMask</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
