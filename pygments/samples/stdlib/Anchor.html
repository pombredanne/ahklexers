<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">	Function: Anchor</span>
<span class="cm">		Defines how controls should be automatically positioned relative to the new dimensions of a window when resized.</span>

<span class="cm">	Parameters:</span>
<span class="cm">		cl - a control HWND, associated variable name or ClassNN to operate on</span>
<span class="cm">		a - (optional) one or more of the anchors: &#39;x&#39;, &#39;y&#39;, &#39;w&#39; (width) and &#39;h&#39; (height),</span>
<span class="cm">			optionally followed by a relative factor, e.g. &quot;x h0.5&quot;</span>
<span class="cm">		r - (optional) true to redraw controls, recommended for GroupBox and Button types</span>

<span class="cm">	Examples:</span>
<span class="cm">&gt; &quot;xy&quot; ; bounds a control to the bottom-left edge of the window</span>
<span class="cm">&gt; &quot;w0.5&quot; ; any change in the width of the window will resize the width of the control on a 2:1 ratio</span>
<span class="cm">&gt; &quot;h&quot; ; similar to above but directrly proportional to height</span>

<span class="cm">	Remarks:</span>
<span class="cm">		To assume the current window size for the new bounds of a control (i.e. resetting) simply omit the second and third parameters.</span>
<span class="cm">		However if the control had been created with DllCall() and has its own parent window,</span>
<span class="cm">			the container AutoHotkey created GUI must be made default with the +LastFound option prior to the call.</span>
<span class="cm">		For a complete example see anchor-example.ahk.</span>

<span class="cm">	License:</span>
<span class="cm">		- Version 4.60a &lt;http://www.autohotkey.net/~Titan/#anchor&gt;</span>
<span class="cm">		- New BSD License &lt;http://www.autohotkey.net/~Titan/license.txt&gt;</span>
<span class="cm">*/</span>
<span class="n">Anchor</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nv">false</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">c</span><span class="p">,</span> <span class="n">cs</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">cx</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">gs</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">gpi</span><span class="p">,</span> <span class="n">gw</span><span class="p">,</span> <span class="n">gh</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mh">0xffff</span>
<span class="w">	</span><span class="nb">If </span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="nf">VarSetCapacity(</span><span class="n">g</span><span class="p">,</span> <span class="n">gs</span> <span class="o">*</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">VarSetCapacity(</span><span class="n">c</span><span class="p">,</span> <span class="n">cs</span> <span class="o">*</span> <span class="n">cx</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">z</span> <span class="o">:=</span> <span class="nv">true</span>
	<span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="nf">WinExist(</span><span class="s">&quot;ahk_id&quot;</span> <span class="o">.</span> <span class="n">i</span><span class="p">))</span> <span class="p">{</span>
<span class="w">		</span><span class="nb">GuiControlGet</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="nv">%i%</span>
<span class="w">		</span><span class="nb">If </span><span class="nv">ErrorLevel</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">i</span> <span class="o">:=</span> <span class="n">t</span>
<span class="w">		</span><span class="nb">Else</span> <span class="n">ControlGet</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="p">,</span> <span class="nv">%i%</span>
	<span class="p">}</span>
	<span class="nf">VarSetCapacity(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">DllCall(</span><span class="s">&quot;GetWindowInfo&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">gp</span> <span class="o">:=</span> <span class="nf">DllCall(</span><span class="s">&quot;GetParent&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">gi</span><span class="p">)</span>
		<span class="p">,</span> <span class="n">giw</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">),</span> <span class="n">gih</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span>
	<span class="n">If</span> <span class="p">(</span><span class="n">gp</span> <span class="o">!=</span> <span class="n">gpi</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">gpi</span> <span class="o">:=</span> <span class="n">gp</span>
<span class="w">		</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%gl%</span>
			<span class="n">If</span> <span class="p">(</span><span class="nf">NumGet(</span><span class="n">g</span><span class="p">,</span> <span class="n">cb</span> <span class="o">:=</span> <span class="n">gs</span> <span class="o">*</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">gp</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">gw</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">g</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="n">gh</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">g</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="n">gf</span> <span class="o">:=</span> <span class="mi">1</span>
<span class="w">				</span><span class="nb">Break</span>
			<span class="p">}</span>
		<span class="n">If</span> <span class="p">(</span><span class="o">!</span><span class="n">gf</span><span class="p">)</span>
			<span class="nf">NumPut(</span><span class="n">gp</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">gl</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">gw</span> <span class="o">:=</span> <span class="n">giw</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">gl</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">gh</span> <span class="o">:=</span> <span class="n">gih</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">gl</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="n">gl</span> <span class="o">+=</span> <span class="n">gs</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">ControlGetPos</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%i%</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%cl%</span>
		<span class="n">If</span> <span class="p">(</span><span class="nf">NumGet(</span><span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">:=</span> <span class="n">cs</span> <span class="o">*</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
<span class="w">			</span><span class="nb">If </span><span class="n">a</span> <span class="o">=</span>
			<span class="p">{</span>
				<span class="n">cf</span> <span class="o">=</span> <span class="mi">1</span>
<span class="w">				</span><span class="nb">Break</span>
			<span class="p">}</span>
			<span class="n">giw</span> <span class="o">-=</span> <span class="n">gw</span><span class="p">,</span> <span class="n">gih</span> <span class="o">-=</span> <span class="n">gh</span><span class="p">,</span> <span class="n">as</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dx</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="n">dy</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">)</span>
				<span class="p">,</span> <span class="n">cw</span> <span class="o">:=</span> <span class="n">dw</span><span class="p">,</span> <span class="n">dw</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="n">ch</span> <span class="o">:=</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dh</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">)</span>
<span class="w">			</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xywh</span>
<span class="w">				</span><span class="nb">If </span><span class="nv">A_Index</span> <span class="o">&gt;</span> <span class="mi">1</span>
					<span class="n">av</span> <span class="o">:=</span> <span class="nf">SubStr(</span><span class="n">a</span><span class="p">,</span> <span class="n">as</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">as</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nf">StrLen(</span><span class="nv">A_LoopField</span><span class="p">)</span>
						<span class="p">,</span> <span class="n">d</span><span class="nv">%av%</span> <span class="o">+=</span> <span class="p">(</span><span class="nf">InStr(</span><span class="s">&quot;yh&quot;</span><span class="p">,</span> <span class="n">av</span><span class="p">)</span> <span class="o">?</span> <span class="n">gih</span> <span class="o">:</span> <span class="n">giw</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">?</span> <span class="nv">A_LoopField</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span>
			<span class="nf">DllCall(</span><span class="s">&quot;SetWindowPos&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">dy</span>
				<span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="nf">InStr(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">dw</span> <span class="o">:</span> <span class="n">cw</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="nf">InStr(</span><span class="n">a</span><span class="p">,</span> <span class="s">&quot;h&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">dh</span> <span class="o">:</span> <span class="n">ch</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="w">			</span><span class="nb">If </span><span class="n">r</span> <span class="o">!=</span> <span class="mi">0</span>
				<span class="nf">DllCall(</span><span class="s">&quot;RedrawWindow&quot;</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="mh">0x0101</span><span class="p">)</span><span class="c-Singleline"> ; RDW_UPDATENOW | RDW_INVALIDATE</span>
<span class="w">			</span><span class="nb">Return</span>
		<span class="p">}</span>
<span class="w">	</span><span class="nb">If </span><span class="n">cf</span> <span class="o">!=</span> <span class="mi">1</span>
		<span class="n">cb</span> <span class="o">:=</span> <span class="n">cl</span><span class="p">,</span> <span class="n">cl</span> <span class="o">+=</span> <span class="n">cs</span>
	<span class="n">bx</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">by</span> <span class="o">:=</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">gih</span> <span class="o">-</span> <span class="nf">NumGet(</span><span class="n">gi</span><span class="p">,</span> <span class="mi">52</span><span class="p">)</span>
<span class="w">	</span><span class="nb">If </span><span class="n">cf</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="n">dw</span> <span class="o">-=</span> <span class="n">giw</span> <span class="o">-</span> <span class="n">gw</span><span class="p">,</span> <span class="n">dh</span> <span class="o">-=</span> <span class="n">gih</span> <span class="o">-</span> <span class="n">gh</span>
	<span class="nf">NumPut(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">dx</span> <span class="o">-</span> <span class="n">bx</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">dy</span> <span class="o">-</span> <span class="n">by</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">)</span>
		<span class="p">,</span> <span class="nf">NumPut(</span><span class="n">dw</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">dh</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;Short&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">Return</span><span class="p">,</span> <span class="nv">true</span>
<span class="p">}</span>
</pre></div>
