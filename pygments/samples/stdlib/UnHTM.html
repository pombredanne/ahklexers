<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="nf">UnHTM</span><span class="p">(</span><span class="w"> </span>HTM<span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">; Remove HTML formatting / Convert to ordinary text   by SKAN 19-Nov-2009</span>
<span class="w"> </span><span class="kt">Static</span><span class="w"> </span>HT<span class="p">,</span>C<span class="o">=</span><span class="s">&quot;;&quot;</span><span class="w"> </span><span class="c1">; Forum Topic: www.autohotkey.com/forum/topic51342.html  Mod: 16-Sep-2010</span>
<span class="w"> </span>IfEqual<span class="p">,</span>HT<span class="p">,,</span><span class="w">   </span><span class="k">SetEnv</span><span class="p">,</span>HT<span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;&amp;aacuteá&amp;acircâ&amp;acute´&amp;aeligæ&amp;agraveà&amp;amp&amp;aringå&amp;atildeã&amp;au&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;mlä&amp;bdquo&amp;brvbar¦&amp;bull&amp;ccedilç&amp;cedil¸&amp;cent¢&amp;circ&amp;copy©&amp;curren¤&amp;dagger&amp;dagger&amp;deg&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;°&amp;divide÷&amp;eacuteé&amp;ecircê&amp;egraveè&amp;ethð&amp;eumlë&amp;euro&amp;fnof&amp;frac12½&amp;frac14¼&amp;frac34¾&amp;gt&gt;&amp;h&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;ellip&amp;iacuteí&amp;icircî&amp;iexcl¡&amp;igraveì&amp;iquest¿&amp;iumlï&amp;laquo«&amp;ldquo&amp;lsaquo&amp;lsquo&amp;lt&lt;&amp;m&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;acr¯&amp;mdash&amp;microµ&amp;middot·&amp;nbsp &amp;ndash&amp;not¬&amp;ntildeñ&amp;oacuteó&amp;ocircô&amp;oelig&amp;ograveò&amp;or&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;dfª&amp;ordmº&amp;oslashø&amp;otildeõ&amp;oumlö&amp;para¶&amp;permil&amp;plusmn±&amp;pound£&amp;quot&quot;&quot;&amp;raquo»&amp;rdquo&amp;reg&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;®&amp;rsaquo&amp;rsquo&amp;sbquo&amp;scaron&amp;sect§&amp;shy &amp;sup1¹&amp;sup2²&amp;sup3³&amp;szligß&amp;thornþ&amp;tilde&amp;tim&quot;</span>
<span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;es×&amp;trade&amp;uacuteú&amp;ucircû&amp;ugraveù&amp;uml¨&amp;uumlü&amp;yacuteý&amp;yen¥&amp;yumlÿ&quot;</span>
<span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>RegExReplace<span class="p">(</span><span class="w"> </span>HTM<span class="p">,</span><span class="s">&quot;&lt;[^&gt;]+&gt;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w">               </span><span class="c1">; Remove all tags between  &quot;&lt;&quot; and &quot;&gt;&quot;</span>
<span class="w"> </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">`;</span><span class="w">                              </span><span class="c1">; Create a list of special characters</span>
<span class="w">   </span>L<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&amp;&quot;</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span>C<span class="p">,</span><span class="w"> </span>R<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>InStr<span class="p">(</span>R<span class="p">,</span>L<span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>L<span class="o">:</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w"> </span><span class="k">StringTrimRight</span><span class="p">,</span><span class="w"> </span>R<span class="p">,</span><span class="w"> </span>R<span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="w"> </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span>R<span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nv">%C%</span><span class="w">                               </span><span class="c1">; Parse Special Characters</span>
<span class="w">  </span><span class="kr">If</span><span class="w"> </span>F<span class="w"> </span><span class="o">:=</span><span class="w"> </span>InStr<span class="p">(</span><span class="w"> </span>HT<span class="p">,</span><span class="w"> </span>L<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="p">)</span><span class="w">             </span><span class="c1">; Lookup HT Data</span>
<span class="w">    </span><span class="k">StringReplace</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">,</span><span class="err">$</span><span class="p">,</span><span class="w"> </span><span class="nv">%L%%C%</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>SubStr<span class="p">(</span><span class="w"> </span>HT<span class="p">,</span>F<span class="o">+</span>StrLen<span class="p">(</span>L<span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span>All
<span class="w">  </span><span class="k">Else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>SubStr<span class="p">(</span><span class="w"> </span>L<span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">StringReplace</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="p">,</span><span class="w"> </span><span class="nv">%L%%C%</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Chr<span class="p">(((</span>SubStr<span class="p">(</span>L<span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>SubStr<span class="p">(</span>L<span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="w"> </span>All
<span class="k">Return</span><span class="w"> </span><span class="nf">RegExReplace</span><span class="p">(</span><span class="w"> </span><span class="err">$</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;(^\s*|\s*$)&quot;</span><span class="p">)</span><span class="w">            </span><span class="c1">; Remove leading/trailing white spaces</span>
<span class="p">}</span>

<span class="o">/*</span>
<span class="c1">; Array of Special Character Entities was created with following code</span>
<span class="k">Loop</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">256</span><span class="o">-</span><span class="mi">33</span><span class="w"> </span><span class="p">{</span>
<span class="k">Transform</span><span class="p">,</span><span class="w"> </span>F<span class="p">,</span><span class="w"> </span>HTML<span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Chr<span class="p">(</span><span class="w"> </span>A<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">+</span><span class="mi">33</span><span class="w"> </span><span class="p">)</span>
<span class="kr">If</span><span class="w"> </span><span class="nf">Strlen</span><span class="p">(</span>F<span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span>Instr<span class="p">(</span><span class="w"> </span>F<span class="p">,</span><span class="w"> </span><span class="s">&quot;#&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span>list<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&amp;&quot;</span><span class="w"> </span>SubStr<span class="p">(</span>F<span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span>StrLen<span class="p">(</span>F<span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>Chr<span class="p">(</span>A<span class="w"> </span><span class="p">)</span>
<span class="p">}</span>
<span class="k">StringLower</span><span class="p">,</span><span class="w"> </span>List<span class="p">,</span><span class="w"> </span>List
<span class="k">Sort</span><span class="p">,</span><span class="w"> </span>List<span class="p">,</span><span class="w"> </span>D<span class="o">&amp;</span><span class="w"> </span>U
Clipboard<span class="w"> </span><span class="o">:=</span><span class="w"> </span>List
<span class="k">MsgBox</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>StrLen<span class="p">(</span><span class="w"> </span>List<span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>Clipboard
<span class="o">*</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="n">UnHTM</span><span class="p">(</span> <span class="n">HTM</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">   ; Remove HTML formatting / Convert to ordinary text   by SKAN 19-Nov-2009</span>
<span class="w"> </span><span class="nb">Static</span> <span class="n">HT</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="s">&quot;;&quot;</span><span class="c-Singleline"> ; Forum Topic: www.autohotkey.com/forum/topic51342.html  Mod: 16-Sep-2010</span>
<span class="w"> </span><span class="nb">IfEqual</span><span class="p">,</span><span class="n">HT</span><span class="p">,,</span>   <span class="n">SetEnv</span><span class="p">,</span><span class="n">HT</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;&amp;aacuteá&amp;acircâ&amp;acute´&amp;aeligæ&amp;agraveà&amp;amp&amp;aringå&amp;atildeã&amp;au&quot;</span>
 <span class="o">.</span> <span class="s">&quot;mlä&amp;bdquo&amp;brvbar¦&amp;bull&amp;ccedilç&amp;cedil¸&amp;cent¢&amp;circ&amp;copy©&amp;curren¤&amp;dagger&amp;dagger&amp;deg&quot;</span>
 <span class="o">.</span> <span class="s">&quot;°&amp;divide÷&amp;eacuteé&amp;ecircê&amp;egraveè&amp;ethð&amp;eumlë&amp;euro&amp;fnof&amp;frac12½&amp;frac14¼&amp;frac34¾&amp;gt&gt;&amp;h&quot;</span>
 <span class="o">.</span> <span class="s">&quot;ellip&amp;iacuteí&amp;icircî&amp;iexcl¡&amp;igraveì&amp;iquest¿&amp;iumlï&amp;laquo«&amp;ldquo&amp;lsaquo&amp;lsquo&amp;lt&lt;&amp;m&quot;</span>
 <span class="o">.</span> <span class="s">&quot;acr¯&amp;mdash&amp;microµ&amp;middot·&amp;nbsp &amp;ndash&amp;not¬&amp;ntildeñ&amp;oacuteó&amp;ocircô&amp;oelig&amp;ograveò&amp;or&quot;</span>
 <span class="o">.</span> <span class="s">&quot;dfª&amp;ordmº&amp;oslashø&amp;otildeõ&amp;oumlö&amp;para¶&amp;permil&amp;plusmn±&amp;pound£&amp;quot</span><span class="se">&quot;&quot;</span><span class="s">&amp;raquo»&amp;rdquo&amp;reg&quot;</span>
 <span class="o">.</span> <span class="s">&quot;®&amp;rsaquo&amp;rsquo&amp;sbquo&amp;scaron&amp;sect§&amp;shy &amp;sup1¹&amp;sup2²&amp;sup3³&amp;szligß&amp;thornþ&amp;tilde&amp;tim&quot;</span>
 <span class="o">.</span> <span class="s">&quot;es×&amp;trade&amp;uacuteú&amp;ucircû&amp;ugraveù&amp;uml¨&amp;uumlü&amp;yacuteý&amp;yen¥&amp;yumlÿ&quot;</span>
 <span class="n">$</span> <span class="o">:=</span> <span class="nf">RegExReplace</span><span class="p">(</span> <span class="n">HTM</span><span class="p">,</span><span class="s">&quot;&lt;[^&gt;]+&gt;&quot;</span> <span class="p">)</span><span class="c-Singleline">               ; Remove all tags between  &quot;&lt;&quot; and &quot;&gt;&quot;</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">$</span><span class="p">,</span> <span class="o">&amp;</span><span class="se">`;</span><span class="c-Singleline">                              ; Create a list of special characters</span>
   <span class="n">L</span> <span class="o">:=</span> <span class="s">&quot;&amp;&quot;</span> <span class="nv">A_LoopField</span> <span class="n">C</span><span class="p">,</span> <span class="n">R</span> <span class="o">.=</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span> <span class="o">?</span> <span class="p">(</span> <span class="p">(</span><span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">?</span> <span class="n">L</span><span class="o">:</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
<span class="w"> </span><span class="nb">StringTrimRight</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">R</span> <span class="p">,</span> <span class="nv">%C%</span><span class="c-Singleline">                               ; Parse Special Characters</span>
<span class="w">  </span><span class="nb">If </span><span class="n">F</span> <span class="o">:=</span> <span class="nf">InStr</span><span class="p">(</span> <span class="n">HT</span><span class="p">,</span> <span class="n">L</span> <span class="o">:=</span> <span class="nv">A_LoopField</span> <span class="p">)</span><span class="c-Singleline">             ; Lookup HT Data</span>
<span class="w">    </span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">$</span><span class="p">,</span><span class="n">$</span><span class="p">,</span> <span class="nv">%L%%C%</span><span class="p">,</span> <span class="o">%</span> <span class="nf">SubStr</span><span class="p">(</span> <span class="n">HT</span><span class="p">,</span><span class="n">F</span><span class="o">+</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="mi">1</span> <span class="p">),</span> <span class="n">All</span>
<span class="w">  </span><span class="nb">Else</span> <span class="n">If</span> <span class="p">(</span> <span class="nf">SubStr</span><span class="p">(</span> <span class="n">L</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="p">)</span>
<span class="w">    </span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">$</span><span class="p">,</span> <span class="n">$</span><span class="p">,</span> <span class="nv">%L%%C%</span><span class="p">,</span> <span class="o">%</span> <span class="nf">Chr</span><span class="p">(((</span><span class="nf">SubStr</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;0&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="n">All</span>
<span class="nb">Return</span> <span class="nf">RegExReplace</span><span class="p">(</span> <span class="n">$</span><span class="p">,</span> <span class="s">&quot;(^\s*|\s*$)&quot;</span><span class="p">)</span><span class="c-Singleline">            ; Remove leading/trailing white spaces</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm">; Array of Special Character Entities was created with following code</span>
<span class="cm">Loop % 256-33 {</span>
<span class="cm">Transform, F, HTML, % Chr( A := A_Index+33 )</span>
<span class="cm">If Strlen(F) &gt; 1 &amp;&amp; !Instr( F, &quot;#&quot; )</span>
<span class="cm">  list .= &quot;&amp;&quot; SubStr(F,2, StrLen(F)-2) Chr(A )</span>
<span class="cm">}</span>
<span class="cm">StringLower, List, List</span>
<span class="cm">Sort, List, D&amp; U</span>
<span class="cm">Clipboard := List</span>
<span class="cm">MsgBox, 0, % StrLen( List ), % Clipboard</span>
<span class="cm">*</span>
</pre></div>
