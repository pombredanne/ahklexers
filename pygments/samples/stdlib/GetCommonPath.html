<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; GetCommonPath - Get path to standard system folder by majkinetor</span>
<span class="c-Singleline">; http://www.autohotkey.com/forum/topic10325.html</span>
<span class="n">GetCommonPath</span><span class="p">(</span> <span class="n">csidl</span> <span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="nb">static</span> <span class="n">init</span>

        <span class="n">if</span> <span class="o">!</span><span class="n">init</span>
        <span class="p">{</span>
                <span class="n">CSIDL_APPDATA</span>                 <span class="o">=</span><span class="mh">0x001A</span><span class="c-Singleline">     ; Application Data, new for NT4</span>
                <span class="n">CSIDL_COMMON_APPDATA</span>          <span class="o">=</span><span class="mh">0x0023</span><span class="c-Singleline">     ; All Users\Application Data</span>
                <span class="n">CSIDL_COMMON_DOCUMENTS</span>        <span class="o">=</span><span class="mh">0x002e</span><span class="c-Singleline">     ; All Users\Documents</span>
                <span class="n">CSIDL_DESKTOP</span>                 <span class="o">=</span><span class="mh">0x0010</span><span class="c-Singleline">     ; C:\Documents and Settings\username\Desktop</span>
                <span class="n">CSIDL_FONTS</span>                   <span class="o">=</span><span class="mh">0x0014</span><span class="c-Singleline">     ; C:\Windows\Fonts</span>
                <span class="n">CSIDL_LOCAL_APPDATA</span>           <span class="o">=</span><span class="mh">0x001C</span><span class="c-Singleline">     ; non roaming, user\Local Settings\Application Data</span>
                <span class="n">CSIDL_MYMUSIC</span>                 <span class="o">=</span><span class="mh">0x000d</span><span class="c-Singleline">     ; &quot;My Music&quot; folder</span>
                <span class="n">CSIDL_MYPICTURES</span>              <span class="o">=</span><span class="mh">0x0027</span><span class="c-Singleline">     ; My Pictures, new for Win2K</span>
                <span class="n">CSIDL_PERSONAL</span>                <span class="o">=</span><span class="mh">0x0005</span><span class="c-Singleline">     ; My Documents</span>
                <span class="n">CSIDL_PROGRAM_FILES_COMMON</span>    <span class="o">=</span><span class="mh">0x002b</span><span class="c-Singleline">     ; C:\Program Files\Common</span>
                <span class="n">CSIDL_PROGRAM_FILES</span>           <span class="o">=</span><span class="mh">0x0026</span><span class="c-Singleline">     ; C:\Program Files</span>
                <span class="n">CSIDL_PROGRAMS</span>                <span class="o">=</span><span class="mh">0x0002</span><span class="c-Singleline">     ; C:\Documents and Settings\username\Start Menu\Programs</span>
                <span class="n">CSIDL_RESOURCES</span>               <span class="o">=</span><span class="mh">0x0038</span><span class="c-Singleline">     ; %windir%\Resources\, For theme and other windows resources.</span>
                <span class="n">CSIDL_STARTMENU</span>               <span class="o">=</span><span class="mh">0x000b</span><span class="c-Singleline">     ; C:\Documents and Settings\username\Start Menu</span>
                <span class="n">CSIDL_STARTUP</span>                 <span class="o">=</span><span class="mh">0x0007</span><span class="c-Singleline">     ; C:\Documents and Settings\username\Start Menu\Programs\Startup.</span>
                <span class="n">CSIDL_SYSTEM</span>                  <span class="o">=</span><span class="mh">0x0025</span><span class="c-Singleline">     ; GetSystemDirectory()</span>
                <span class="n">CSIDL_WINDOWS</span>                 <span class="o">=</span><span class="mh">0x0024</span><span class="c-Singleline">     ; GetWindowsDirectory()</span>
        <span class="p">}</span>

       
        <span class="n">val</span> <span class="o">=</span> <span class="o">%</span> <span class="n">CSIDL_</span><span class="nv">%csidl%</span>
        <span class="nf">VarSetCapacity(</span><span class="n">fpath</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="nf">DllCall(</span> <span class="s">&quot;shell32\SHGetFolderPathA&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">fpath</span><span class="p">)</span>
<span class="w">        </span><span class="nb">return</span> <span class="nv">%fpath%</span>
<span class="p">}</span>
</pre></div>
