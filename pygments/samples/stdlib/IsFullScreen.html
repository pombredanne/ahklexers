<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; http://www.autohotkey.com/forum/viewtopic.php?t=55041</span>
<span class="cm">/*! TheGood</span>
<span class="cm">    Checks if a window is in fullscreen mode.</span>
<span class="cm">    ______________________________________________________________________________________________________________</span>
<span class="cm">    sWinTitle       - WinTitle of the window to check. Same syntax as the WinTitle parameter of, e.g., WinExist().</span>
<span class="cm">    bRefreshRes     - Forces a refresh of monitor data (necessary if resolution has changed)</span>
<span class="cm">    Return value    o If window is fullscreen, returns the index of the monitor on which the window is fullscreen.</span>
<span class="cm">                    o If window is not fullscreen, returns False.</span>
<span class="cm">    ErrorLevel      - Sets ErrorLevel to True if no window could match sWinTitle</span>
<span class="cm">   </span>
<span class="cm">        Based on the information found at http://support.microsoft.com/kb/179363/ which discusses under what</span>
<span class="cm">    circumstances does a program cover the taskbar. Even if the window passed to IsFullscreen is not the</span>
<span class="cm">    foreground application, IsFullscreen will check if, were it the foreground, it would cover the taskbar.</span>
<span class="cm">*/</span>
<span class="n">IsFullscreen</span><span class="p">(</span><span class="n">sWinTitle</span> <span class="o">=</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="n">bRefreshRes</span> <span class="o">=</span> <span class="nv">False</span><span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">Static</span>
<span class="w">    </span><span class="nb">Local</span> <span class="n">iWinX</span><span class="p">,</span> <span class="n">iWinY</span><span class="p">,</span> <span class="n">iWinW</span><span class="p">,</span> <span class="n">iWinH</span><span class="p">,</span> <span class="n">iCltX</span><span class="p">,</span> <span class="n">iCltY</span><span class="p">,</span> <span class="n">iCltW</span><span class="p">,</span> <span class="n">iCltH</span><span class="p">,</span> <span class="n">iMidX</span><span class="p">,</span> <span class="n">iMidY</span><span class="p">,</span> <span class="n">iMonitor</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">iBestD</span>
   
    <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="nv">False</span>
<span class="w">   </span>
<span class="w">    </span><span class="nb">If </span><span class="n">bRefreshRes</span> <span class="n">Or</span> <span class="n">Not</span> <span class="n">Mon0</span> <span class="p">{</span>
<span class="w">        </span><span class="nb">SysGet</span><span class="p">,</span> <span class="n">Mon0</span><span class="p">,</span> <span class="n">MonitorCount</span>
<span class="w">        </span><span class="nb">SysGet</span><span class="p">,</span> <span class="n">iPrimaryMon</span><span class="p">,</span> <span class="n">MonitorPrimary</span>
<span class="w">        </span><span class="nb">Loop</span> <span class="nv">%Mon0%</span> <span class="p">{</span><span class="c-Singleline"> ;Loop through each monitor</span>
<span class="w">            </span><span class="nb">SysGet</span><span class="p">,</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="n">Monitor</span><span class="p">,</span> <span class="nv">%A_Index%</span>
            <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">MidX</span> <span class="o">:=</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Left</span> <span class="o">+</span> <span class="nf">Ceil</span><span class="p">((</span><span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Right</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Left</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">MidY</span> <span class="o">:=</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Top</span> <span class="o">+</span> <span class="nf">Ceil</span><span class="p">((</span><span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Top</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">Bottom</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Get the active window&#39;s dimension</span>
    <span class="n">hWin</span> <span class="o">:=</span> <span class="nf">WinExist</span><span class="p">(</span><span class="n">sWinTitle</span><span class="p">)</span>
<span class="w">    </span><span class="nb">If </span><span class="n">Not</span> <span class="n">hWin</span> <span class="p">{</span>
        <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="nv">True</span>
<span class="w">        </span><span class="nb">Return</span> <span class="nv">False</span>
    <span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Make sure it&#39;s not desktop</span>
<span class="w">    </span><span class="nb">WinGetClass</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hWin%</span>
    <span class="n">If</span> <span class="p">(</span><span class="n">hWin</span> <span class="o">=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetDesktopWindow&quot;</span><span class="p">)</span> <span class="n">Or</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="s">&quot;Progman&quot;</span><span class="p">)</span> <span class="n">Or</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="s">&quot;WorkerW&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="nb">Return</span> <span class="nv">False</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Get the window and client area, and style</span>
    <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">iCltRect</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetWindowRect&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">hWin</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iWinRect</span><span class="p">)</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetClientRect&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">hWin</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iCltRect</span><span class="p">)</span>
<span class="w">    </span><span class="nb">WinGet</span><span class="p">,</span> <span class="n">iStyle</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hWin%</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Extract coords and sizes</span>
    <span class="n">iWinX</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">iWinY</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">iWinW</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="c-Singleline"> ;Bottom-right coordinates are exclusive</span>
    <span class="n">iWinH</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iWinRect</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c-Singleline"> ;Bottom-right coordinates are exclusive</span>
    <span class="n">iCltX</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">iCltY</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline"> ;Client upper-left always (0,0)</span>
    <span class="n">iCltW</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iCltRect</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">iCltH</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">iCltRect</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Check in which monitor it lies</span>
    <span class="n">iMidX</span> <span class="o">:=</span> <span class="n">iWinX</span> <span class="o">+</span> <span class="nf">Ceil</span><span class="p">(</span><span class="n">iWinW</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">iMidY</span> <span class="o">:=</span> <span class="n">iWinY</span> <span class="o">+</span> <span class="nf">Ceil</span><span class="p">(</span><span class="n">iWinH</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">   ;Loop through every monitor and calculate the distance to each monitor</span>
   <span class="n">iBestD</span> <span class="o">:=</span> <span class="mh">0xFFFFFFFF</span>
<span class="w">    </span><span class="nb">Loop</span> <span class="o">%</span> <span class="n">Mon0</span> <span class="p">{</span>
      <span class="n">D</span> <span class="o">:=</span> <span class="nf">Sqrt</span><span class="p">((</span><span class="n">iMidX</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">MidX</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">iMidY</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%A_Index%</span><span class="n">MidY</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">If</span> <span class="p">(</span><span class="n">D</span> <span class="o">&lt;</span> <span class="n">iBestD</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">iBestD</span> <span class="o">:=</span> <span class="n">D</span>
         <span class="n">iMonitor</span> <span class="o">:=</span> <span class="nv">A_Index</span>
      <span class="p">}</span>
   <span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Check if the client area covers the whole screen</span>
    <span class="n">bCovers</span> <span class="o">:=</span> <span class="p">(</span><span class="n">iCltX</span> <span class="o">&lt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Left</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iCltY</span> <span class="o">&lt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Top</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iCltW</span> <span class="o">&gt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Right</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Left</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iCltH</span> <span class="o">&gt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Bottom</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Top</span><span class="p">)</span>
<span class="w">    </span><span class="nb">If </span><span class="n">bCovers</span>
<span class="w">        </span><span class="nb">Return</span> <span class="nv">True</span><span class="c-Singleline"></span>
<span class="c-Singleline">   </span>
<span class="c-Singleline">    ;Check if the window area covers the whole screen and styles</span>
    <span class="n">bCovers</span> <span class="o">:=</span> <span class="p">(</span><span class="n">iWinX</span> <span class="o">&lt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Left</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iWinY</span> <span class="o">&lt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Top</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iWinW</span> <span class="o">&gt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Right</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Left</span><span class="p">)</span> <span class="n">And</span> <span class="p">(</span><span class="n">iWinH</span> <span class="o">&gt;=</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Bottom</span> <span class="o">-</span> <span class="n">Mon</span><span class="nv">%iMonitor%</span><span class="n">Top</span><span class="p">)</span>
<span class="w">    </span><span class="nb">If </span><span class="n">bCovers</span> <span class="p">{</span><span class="c-Singleline"> ;WS_THICKFRAME or WS_CAPTION</span>
        <span class="n">bCovers</span> <span class="o">:=</span> <span class="n">bCovers</span> <span class="n">And</span> <span class="p">(</span><span class="n">Not</span> <span class="p">(</span><span class="n">iStyle</span> <span class="o">&amp;</span> <span class="mh">0x00040000</span><span class="p">)</span> <span class="n">Or</span> <span class="n">Not</span> <span class="p">(</span><span class="n">iStyle</span> <span class="o">&amp;</span> <span class="mh">0x00C00000</span><span class="p">))</span>
<span class="w">        </span><span class="nb">Return</span> <span class="n">bCovers</span> <span class="o">?</span> <span class="n">iMonitor</span> <span class="o">:</span> <span class="nv">False</span>
    <span class="p">}</span> <span class="n">Else</span> <span class="n">Return</span> <span class="nv">False</span>
<span class="p">}</span>
</pre></div>
