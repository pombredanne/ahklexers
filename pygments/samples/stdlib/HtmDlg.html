<LINK href="styles.css" rel="stylesheet" type="text/css">

New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">;                                                      _     _            _____   _</span>
<span class="c-Singleline">;  HtmDlg() - HTML DialogBox v0.51                    | |   | |_         (____ \ | | v0.51</span>
<span class="c-Singleline">;                                                     | |__ | | |_  ____  _   \ \| | ____</span>
<span class="c-Singleline">;  Suresh Kumar A N (arian.suresh@gmail.com)          |  __)| |  _)|    \| |   | | |/ _  |</span>
<span class="c-Singleline">;                                                     | |   | | |__| | | | |__/ /| ( ( | |</span>
<span class="c-Singleline">;  Created  : 09-Jul-2010                             |_|   |_|\___)_|_|_|_____/ |_|\_|| |</span>
<span class="c-Singleline">;  Last Mod : 13-Jul-2010                                                          (_____|</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;  Usage : HtmDlg( URL, hwndOwner, Options, OptionsDelimiter )</span>
<span class="c-Singleline">;        :  For Options, please refer the bottom of this script</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><span class="w"></span>

<span class="n">HtmDlg</span><span class="p">(</span> <span class="n">_URL</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">_Owner</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">_Options</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">_ODL</span><span class="o">=</span><span class="s">&quot;,&quot;</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>

<span class="c-Singleline">; HTML DialogBox v0.50 - scripted by SKAN : www.autohotkey.com/forum/viewtopic.php?t=60215</span><span class="nf"></span>

<span class="nf"> static</span> <span class="n">_Ins</span><span class="p">,</span> <span class="n">_hDLG</span><span class="p">,</span> <span class="n">_DlgT</span><span class="p">,</span> <span class="n">_DlgP</span><span class="p">,</span> <span class="n">_STRU</span><span class="p">,</span> <span class="n">_pIWEB</span><span class="p">,</span> <span class="n">_pV</span><span class="p">,</span>                      <span class="n">BDef</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">BEsc</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> (</span> <span class="nv">A_EventInfo</span> <span class="o">=</span> <span class="mh">0xCBF</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">                                    ; nested CallBackFunction</span>
<span class="w"> </span><span class="n">hWnd</span><span class="p"> </span><span class="o">:=</span> <span class="n">_URL</span><span class="p">,</span>  <span class="n">uMsg</span> <span class="o">:=</span> <span class="n">_Owner</span><span class="p">,</span>  <span class="n">wP</span> <span class="o">:=</span> <span class="n">_Options</span><span class="p">,</span>  <span class="n">lP</span> <span class="o">:=</span> <span class="n">_ODL</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> (</span> <span class="n">uMsg</span><span class="o">=</span><span class="mh">0x112</span> <span class="o">&amp;&amp;</span> <span class="n">wP</span><span class="o">=</span><span class="mh">0xF060</span> <span class="p">)</span><span class="c-Singleline">  ; WM_SYSCOMMAND &amp;&amp; SC_ClOSE</span><span class="nf"></span>
<span class="nf">  Return DllCall</span><span class="p">(</span> <span class="s">&quot;EndDialog&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BDEf</span> <span class="o">:=</span> <span class="n">BEsc</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> (</span> <span class="n">uMsg</span><span class="o">=</span><span class="mh">0x111</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">wP</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span><span class="c-Singleline"> ; WM_COMMAND &amp;&amp; BN_CLICKED</span><span class="nf"></span>
<span class="nf">  Return DllCall</span><span class="p">(</span> <span class="s">&quot;EndDialog&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BDef</span> <span class="o">:=</span> <span class="p">(</span><span class="n">wP</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">?</span> <span class="n">BEsc</span> <span class="o">:</span> <span class="n">wP</span><span class="o">-</span><span class="mi">100</span>  <span class="p">)</span><span class="nf"></span>

<span class="nf"> Return</span> <span class="nv">False</span>
 <span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> </span><span class="o">!</span> <span class="p">(</span> <span class="n">_Ins</span> <span class="p">)</span> <span class="p">{</span><span class="w"></span>

<span class="w"> </span><span class="n">_Ins</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="nv">A_AhkPath</span> <span class="p">)</span>
 <span class="n">_DT</span><span class="o">=</span>
<span class="w"> </span><span class="g">( Ltrim Join</span>
<span class="g">   61160CD3AFCDD0118A3EGC04FC9E26EZPCHC88OAZO8G4DG53G2H53G68G65G6CG6CG2H44G6CG67Q58ZHDG741</span>
<span class="g">   G74G6CG41G78G57G69G6EK7BG38G38G35G36G46G39G36G31G2DG33G34G3H41G2DG31G31G44G3H2DG41G39G3</span>
<span class="g">   6G42G2DG3H3H43G3H34G46G44G37G3H35G41G32G7DT14NFBFFQ65GFFFF8Y14NFBFFQ66GFFFF8Y14NFBFFQ67</span>
<span class="g">   GFFFF8Y14NFBFFQ68GFFFF8Y14NFBFFQ69GFFFF8Y14NFBFFQ6AGFFFF8Y14NFBFFQ6BGFFFF8Y14NFBFFQ6CGF</span>
<span class="g">   FFF8Y14NFBFFQ6DGFFFF8T</span>
<span class="g"> )</span><span class="w"></span>

<span class="w"> </span><span class="nb">Loop</span><span class="w"> </span><span class="s">20  </span><span class="c-Singleline">;  Decompressing Nulls : www.autohotkey.com/forum/viewtopic.php?p=198560#198560</span><span class="w"></span>
<span class="w">  </span> <span class="n">StringReplace</span><span class="p">,</span><span class="n">_DT</span><span class="p">,</span><span class="n">_DT</span><span class="p">,</span><span class="o">%</span><span class="nf"> Chr</span><span class="p">(</span><span class="mi">70</span><span class="o">+</span><span class="mi">21</span><span class="o">-</span><span class="nv">A_Index</span><span class="p">),</span><span class="o">%</span><span class="nf"> SubStr</span><span class="p">(</span><span class="s">&quot;000000000000000000000&quot;</span><span class="p">,</span><span class="nv">A_Index</span><span class="p">),</span><span class="n">All</span><span class="nf"></span>

<span class="nf"> VarSetCapacity</span><span class="p">(</span> <span class="n">_STRU</span><span class="p">,</span> <span class="p">(</span> <span class="n">_DTLEN</span> <span class="o">:=</span><span class="nf"> StrLen</span><span class="p">(</span><span class="n">_DT</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Loop</span><span class="w"> </span><span class="nv">%_DTLEN%</span><span class="c-Singleline">                                       ;  Creating Binary Structure from Hex</span><span class="w"></span>
<span class="w">  </span><span class="nf"> NumPut</span><span class="p">(</span> <span class="s">&quot;0x&quot;</span> <span class="o">.</span><span class="nf"> SubStr</span><span class="p">(</span><span class="n">_DT</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">_STRU</span><span class="p">,</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Char&quot;</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="n">_pIWEB</span><span class="p"> </span><span class="o">:=</span> <span class="o">&amp;</span><span class="n">_STRU</span><span class="p">,</span> <span class="n">_pV</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">_STRU</span><span class="o">+</span><span class="mi">16</span><span class="p">,</span> <span class="n">_DlgT</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">_STRU</span><span class="o">+</span><span class="mi">32</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> </span><span class="o">!</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;atl.dll&quot;</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span> <span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;atl.dll&quot;</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">      DllCall</span><span class="p">(</span> <span class="s">&quot;atl\AtlAxWinInit&quot;</span> <span class="p">)</span>
<span class="w"> </span><span class="n">_DlgP</span><span class="p"> </span><span class="o">:=</span><span class="nf"> RegisterCallback</span><span class="p">(</span> <span class="nv">A_ThisFunc</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0xCBF</span> <span class="p">)</span><span class="w"></span>

 <span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">_hDLG</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;CreateDialogIndirectParam&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_Ins</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_DlgT</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="p">(</span> <span class="n">_Owner</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span>
         <span class="o">?</span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;FindWindowA&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;AutoHotkey&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="nv">A_ScriptFullPath</span> <span class="s">&quot; - AutoHotkey v&quot;</span>
         <span class="o">.</span> <span class="nv">A_AhkVersion</span> <span class="p">)</span> <span class="o">:</span> <span class="n">_Owner</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_DlgP</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span><span class="nf"></span>

<span class="nf"> VarSetCapacity</span><span class="p">(</span> <span class="n">_WU</span><span class="p">,</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">_URL</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span> <span class="p">),</span> <span class="n">sLen</span> <span class="o">:=</span><span class="nf"> StrLen</span><span class="p">(</span><span class="n">_URL</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">_URL</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">_WU</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">sLen</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="n">_hHTM</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetDlgItem&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span> <span class="n">UInt</span> <span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline"> ; www.autohotkey.com/forum/viewtopic.php?p=103987#103987  WebBrowser Control Demo by Sean</span>
<span class="c-Singleline"> ; ---------------------------------------------------------------------------------------</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;atl\AtlAxGetControl&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hHTM</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">_ppunk</span> <span class="p">)</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span> <span class="n">_ppunk</span><span class="o">+</span><span class="mi">0</span> <span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">0</span> <span class="p">),</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_ppunk</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_pIWEB</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">_ppwb</span> <span class="p">)</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span> <span class="n">_ppunk</span><span class="o">+</span><span class="mi">0</span> <span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span> <span class="p">),</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_ppunk</span> <span class="p">),</span> <span class="n">_pwb</span> <span class="o">:=</span><span class="nf"> NumGet</span><span class="p">(</span> <span class="n">_ppwb</span><span class="o">+</span><span class="mi">0</span> <span class="p">)</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">_pwb</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">11</span><span class="p">),</span><span class="n">UInt</span><span class="p">,</span><span class="n">_ppwb</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="o">&amp;</span><span class="n">_WU</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_pV</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">_pV</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">_pV</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">_pV</span> <span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline"> ; ---------------------------------------------------------------------------------------</span><span class="w"></span>

<span class="w"> </span><span class="nl">Slee:</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">HtmD</span><span class="o">:=</span><span class="mi">1</span>
<span class="w"> </span><span class="nl">Butt:</span><span class="o">=</span><span class="s">&quot;OK&quot;</span><span class="p">,</span> <span class="n">BWid</span><span class="o">:=</span><span class="mi">75</span><span class="p">,</span> <span class="n">BHei</span><span class="o">:=</span><span class="mi">23</span><span class="p">,</span> <span class="n">BSpH</span><span class="o">:=</span><span class="mi">5</span><span class="p">,</span> <span class="n">BSpV</span><span class="o">:=</span><span class="mi">8</span><span class="p">,</span> <span class="n">BAli</span><span class="o">:=</span><span class="mi">1</span>
<span class="w"> </span><span class="nl">DlgX:</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">DlgY</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">HtmW</span><span class="o">:=</span><span class="mi">280</span><span class="p">,</span> <span class="n">HtmH</span><span class="o">:=</span><span class="mi">140</span><span class="p">,</span> <span class="n">Left</span><span class="o">:=</span><span class="mi">5</span><span class="p">,</span> <span class="n">TopM</span><span class="o">:=</span><span class="mi">5</span><span class="w"></span>

<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> Parse</span><span class="p">,</span><span class="s"> _Options</span><span class="p">,</span><span class="s"> =%_ODL%</span><span class="p">,</span><span class="s"> %A_Space%</span><span class="w"></span>
<span class="w">   </span> <span class="nv">A_Index</span> <span class="o">&amp;</span> <span class="mi">1</span>  <span class="o">?</span> <span class="p">(</span> <span class="n">__</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s">&quot;_&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;_&quot;</span> <span class="o">:</span><span class="nf"> SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
                <span class="o">:</span> <span class="p">(</span> <span class="nv">%__%</span> <span class="o">:=</span> <span class="nv">A_LoopField</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> (</span> <span class="n">HtmD</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">   DllCall</span><span class="p">(</span> <span class="s">&quot;MoveWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hHTM</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">HtmW</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">HtmH</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"> </span><span class="s">{</span><span class="w"></span>
<span class="w">   </span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;MoveWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hHTM</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">Left</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">TopM</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">HtmW</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">HtmH</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Control</span><span class="p">,</span><span class="s"> Enable</span><span class="p">,,,</span><span class="s"> ahk_id %_hHTM%</span><span class="w"></span>
<span class="w"> </span> <span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">Cap</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetSystemMetrics&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">4</span>  <span class="p">)</span><span class="c-Singleline"> ; SM_CYCAPTION    = Window Caption</span>
<span class="w"> </span><span class="n">Frm</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetSystemMetrics&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">7</span>  <span class="p">)</span><span class="c-Singleline"> ; SM_CXFIXEDFRAME = Window Frame</span>
<span class="w"> </span><span class="n">SBW</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetSystemMetrics&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">2</span>  <span class="p">)</span><span class="c-Singleline"> ; SM_CXVSCROLL    = VScrollbar Width</span><span class="w"></span>

<span class="w"> </span><span class="n">DlgW</span><span class="p"> </span><span class="o">:=</span> <span class="n">Frm</span> <span class="o">+</span> <span class="n">HtmW</span> <span class="o">+</span> <span class="n">Frm</span> <span class="o">+</span> <span class="p">(</span> <span class="n">HtmD</span> <span class="o">?</span> <span class="mi">0</span><span class="o">-</span><span class="n">SBW</span> <span class="o">:</span> <span class="n">Left</span><span class="o">+</span><span class="n">Left</span> <span class="p">)</span>
<span class="w"> </span><span class="n">DlgH</span><span class="p"> </span><span class="o">:=</span> <span class="n">Cap</span> <span class="o">+</span> <span class="n">Frm</span> <span class="o">+</span> <span class="n">HtmH</span> <span class="o">+</span> <span class="n">BSpV</span> <span class="o">+</span> <span class="n">BHei</span> <span class="o">+</span> <span class="n">BSpV</span> <span class="o">+</span> <span class="n">Frm</span> <span class="o">+</span> <span class="p">(</span> <span class="n">HtmD</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">TopM</span> <span class="p">)</span>
<span class="w"> </span><span class="n">DlgX</span><span class="p"> </span><span class="o">:=</span> <span class="p">(</span> <span class="n">DlgX</span> <span class="o">&lt;&gt;</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">?</span> <span class="n">DlgX</span> <span class="o">:</span> <span class="p">(</span> <span class="nv">A_ScreenWidth</span> <span class="o">-</span> <span class="n">DlgW</span> <span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="w"> </span><span class="n">DlgY</span><span class="p"> </span><span class="o">:=</span> <span class="p">(</span> <span class="n">DlgY</span> <span class="o">&lt;&gt;</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">?</span> <span class="n">DlgY</span> <span class="o">:</span> <span class="p">(</span> <span class="nv">A_ScreenHeight</span> <span class="o">-</span> <span class="n">DlgH</span> <span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="w"> </span><span class="n">ClAW</span><span class="p"> </span><span class="o">:=</span> <span class="n">DlgW</span> <span class="o">-</span> <span class="n">Frm</span> <span class="o">-</span> <span class="n">Frm</span><span class="c-Singleline">                                               ; ClientArea Width</span><span class="nf"></span>

<span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;MoveWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">DlgX</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">DlgY</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">DlgW</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">DlgH</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> Butt</span><span class="p">,</span><span class="s">Butt</span><span class="p">,</span><span class="s"> /</span><span class="p">,</span><span class="s">/</span><span class="p">,</span><span class="s"> UseErrorLevel</span><span class="w"></span>
<span class="w">  </span><span class="n">bCount</span><span class="p"> </span><span class="o">:=</span> <span class="nv">ErrorLevel</span><span class="o">+</span><span class="mi">1</span><span class="nf"></span>

<span class="nf"> If </span><span class="n">BAli</span> <span class="o">=</span> <span class="mi">0</span><span class="w">                                                       </span>
<span class="w"> </span><span class="n">BX</span><span class="p"> </span><span class="o">:=</span> <span class="p">(</span> <span class="n">BSpH</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">HtmD</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">Left</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"> </span><span class="s">If BAli = 1                                                   </span><span class="w"></span>
<span class="w">  </span><span class="n">BX</span><span class="p"> </span><span class="o">:=</span> <span class="p">(</span> <span class="n">ClAW</span> <span class="o">-</span> <span class="p">(</span><span class="n">BSpH</span><span class="o">*</span><span class="p">(</span><span class="n">bCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">BWid</span><span class="o">*</span><span class="n">bCount</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span><span class="n">BX</span><span class="p"> </span><span class="o">:=</span> <span class="n">ClAW</span> <span class="o">-</span> <span class="p">(</span><span class="n">BSpH</span><span class="o">*</span><span class="p">(</span><span class="n">bCount</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">BWid</span><span class="o">*</span><span class="n">bCount</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="n">HtmD</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">Left</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="n">BY</span><span class="p"> </span><span class="o">:=</span> <span class="n">HtmH</span> <span class="o">+</span> <span class="n">BSpV</span> <span class="o">+</span> <span class="p">(</span> <span class="n">HtmD</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">TopM</span> <span class="p">)</span><span class="w"></span>

<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> Parse</span><span class="p">,</span><span class="s"> Butt</span><span class="p">,</span><span class="s"> /</span><span class="w"></span>
<span class="w">  </span> <span class="p">{</span>
<span class="w">    </span><span class="n">BHwnd</span><span class="p"> </span><span class="o">:=</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;GetDlgItem&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="nv">A_Index</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">    DllCall</span><span class="p">(</span> <span class="s">&quot;MoveWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BHwnd</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BX</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BY</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BWid</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BHei</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">    DllCall</span><span class="p">(</span> <span class="s">&quot;SetWindowTextA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BHwnd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="nv">A_LoopField</span> <span class="p">),</span> <span class="n">BX</span> <span class="o">:=</span> <span class="n">BX</span><span class="o">+</span><span class="n">BSpH</span><span class="o">+</span><span class="n">BWid</span><span class="nf"></span>
<span class="nf">    DllCall</span><span class="p">(</span> <span class="s">&quot;ShowWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">BHwnd</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="nv">True</span> <span class="p">)</span>
  <span class="p">}</span>
<span class="w"> </span><span class="n">BDef</span><span class="p"> </span><span class="o">:=</span> <span class="p">(</span> <span class="n">BDef</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">||</span> <span class="n">BDef</span><span class="o">&gt;</span><span class="n">bCount</span> <span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">BDef</span><span class="nf"></span>
<span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;SendMessageA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mh">0x401</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="n">BDef</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span><span class="c-Singleline">    ; DM_SETDEFID</span>
<span class="w"> </span><span class="nb">ControlFocus</span><span class="p">,, % </span><span class="s">&quot;ahk_id &quot; DllCall( &quot;GetDlgItem&quot;</span><span class="p">,</span><span class="s"> UInt</span><span class="p">,</span><span class="s">_hDLG</span><span class="p">,</span><span class="s"> UInt</span><span class="p">,</span><span class="s">100+BDef )</span><span class="w"></span>

<span class="w"> </span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;SetWindowTextA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Titl</span> <span class="o">?</span> <span class="n">Titl</span> <span class="o">:</span> <span class="nv">A_ScriptName</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Sleep</span><span class="p">,</span><span class="s"> %Slee%</span><span class="w"></span>

<span class="w">  </span><span class="nb">WinShow</span><span class="p">,</span><span class="s"> ahk_id %_hDLG%</span><span class="w"></span>
<span class="w">  </span><span class="nb">WinWaitClose</span><span class="p">,</span><span class="s"> ahk_id %_hDLG%</span><span class="p">,,</span><span class="s"> %Time%</span><span class="w"></span>

<span class="w">  </span><span class="n">If</span><span class="p"> (</span> <span class="n">TimedOut</span> <span class="o">:=</span> <span class="nv">Errorlevel</span> <span class="p">)</span> <span class="p">{</span><span class="nf"></span>
<span class="nf">  DllCall</span><span class="p">(</span> <span class="s">&quot;EndDialog&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_hDLG</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
 <span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="n">If</span><span class="p"> (</span> <span class="n">AltR</span><span class="o">=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">BDef</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">   </span><span class="nb">StringSplit</span><span class="p">,</span><span class="s"> B</span><span class="p">,</span><span class="s"> Butt</span><span class="p">,</span><span class="s"> /</span><span class="w"></span>
<span class="w">   </span> <span class="n">BDef</span> <span class="o">:=</span> <span class="n">B</span><span class="nv">%BDef%</span>
 <span class="p">}</span><span class="nf"></span>

<span class="nf"> DllCall</span><span class="p">(</span><span class="nf"> NumGet</span><span class="p">(</span><span class="n">_pwb</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="n">UInt</span><span class="p">,</span><span class="n">_ppwb</span> <span class="p">),</span><span class="nf"> DllCall</span><span class="p">(</span> <span class="s">&quot;SetLastError&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">TimedOut</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">)</span><span class="nf"></span>
<span class="nf">Return</span> <span class="n">BDEf</span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/*</span>

<span class="cm">/- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="cm">&gt;-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - O P T I O N S -</span>
<span class="cm">\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>

<span class="cm">Usage: HtmDlg( URL, hwndOwner, Options, OptionsDelimiter )</span>

<span class="cm">Parameters :</span>

<span class="cm">URL              - A valid URL supported by Internet Explorer including Res:// and File://</span>

<span class="cm">hWndOwner        - Handle to the parent window. If invalid handle or 0 ( zero ) is passed,</span>
<span class="cm">                   the dialog will have a taskbar button. Passing &quot;&quot; as a parameter will</span>
<span class="cm">                   definitely supress the Taskbar Button.</span>

<span class="cm">Options          - A series of &#39;variable overrides&#39; delimited with character specified in</span>
<span class="cm">                   Options delimiter. Please refer &#39;VARIABLE OVERRIDES&#39; below.</span>

<span class="cm">OptionsDelimiter - The delimiter used in seperating &#39;variable overrides&#39;</span>


<span class="cm">;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="cm">;  * * *   V A R I A B L E   O V E R R I D E S   * * *</span>
<span class="cm">;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>

<span class="cm">Important Note: leading 4 characters of a variable will be sufficient.</span>
<span class="cm">                for eg., Instead of &#39;AltReturn=1&#39; you may use &#39;AltR=1&#39;</span>

<span class="cm">Title         = Captionbar Text</span>
<span class="cm">                Default is A_ScriptName</span>

<span class="cm">DlgXpos       = X coordinate in pixels, relative to screen</span>
<span class="cm">                Dialog is horizontally centered by default</span>

<span class="cm">DlgYpos       = Y coordinate in pixels, relative to screen</span>
<span class="cm">                Dialog is vertically centered by default</span>

<span class="cm">AltReturn     = 1 will return Button-text</span>
<span class="cm">                0 is default and Button Instance will be returned</span>

<span class="cm">TimeOut       = Seconds</span>
<span class="cm">                No Default value</span>
<span class="cm">                Note: A_LastError will be true when a TimeOut occurs</span>

<span class="cm">Sleep         = MilliSeconds ( Will be used just before Dialog is shown )</span>
<span class="cm">                No Sleep by Default</span>

<span class="cm">LeftMargin    = Spacing in Pixels ( on the left/right sides of Htm Control )</span>
<span class="cm">                Default value is 5. Ignored if Htm control is disabled. See: HtmDisable</span>

<span class="cm">TopMargin     = Spacing in Pixels ( above the Htm Control )</span>
<span class="cm">                Default value is 5. Ignored if Htm control is disabled. See: HtmDisable</span>

<span class="cm">HtmDisable    = 0 to enable</span>
<span class="cm">                Htm Control is disabled by default.</span>

<span class="cm">HtmWidth      = Width of WebControl in Pixels</span>
<span class="cm">                Default value is 240</span>

<span class="cm">HtmHeight     = Height of WebControl in pixels</span>
<span class="cm">                Default value is 140</span>

<span class="cm">Buttons       = Button labels seperated with &quot;/&quot;  ( eg: Buttons=Yes/No/Cancel )</span>
<span class="cm">                Default is &quot;OK&quot;</span>

<span class="cm">BDefault      = Instance of Default Button ( eg: To make 3rd Button default, use BDef=3 )</span>
<span class="cm">                Default forced value is 1</span>

<span class="cm">BEscape       = Instance of Cancel Button ( Used when dialog is closed or Esc is pressed )</span>
<span class="cm">                Default is 0</span>

<span class="cm">BWidth        = Button Width in Pixels</span>
<span class="cm">                Default Value is 75</span>

<span class="cm">BHeight       = Button height Pixels</span>
<span class="cm">                Default value is 23</span>

<span class="cm">BSpHorizontal = Pixels ( affects the spacing on the sides of a button )</span>

<span class="cm">BSpVertical   = Pixels ( affects the spacing above/below a button )</span>

<span class="cm">BAlign        = 0 or 1 or 2  ( for Left, Center, Right alignment of Buttons )</span>
<span class="cm">                Default is 1</span>

<span class="cm">;- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
</pre></div>
