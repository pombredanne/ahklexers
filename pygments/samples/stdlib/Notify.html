<LINK href="styles.css" rel="stylesheet" type="text/css">

New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">;;;;;;;</span>
<span class="c-Singleline">;;;;;  Notify() 0.45                made by gwarble - sept 09</span>
<span class="c-Singleline">;;;      multiple tray area notifications</span>
<span class="c-Singleline">;          thanks to Rhys/engunneer/HugoV/Forum Posters</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;   Notify([Title,Message,Duration,Options,Image])</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;     Title      [!!!]          &quot;&quot; to omit title line</span>
<span class="c-Singleline">;     Message      []           &quot;&quot; to omit message line</span>
<span class="c-Singleline">;     Duration    [15]          seconds to show notification</span>
<span class="c-Singleline">;                                 0  to flash until clicked</span>
<span class="c-Singleline">;                                &lt;0  to ExitApp on click/timeout</span>
<span class="c-Singleline">;                               &quot;-0&quot; for permanent and exitOnClick</span>
<span class="c-Singleline">;     Options                   string of options... see function</span>
<span class="c-Singleline">;          [SI=999 GC=Blue...]  most options are remembered (static)</span>
<span class="c-Singleline">;                               &quot;Reset&quot; to restore default options</span>
<span class="c-Singleline">;                                 if you want to show as well, use NO=Reset</span>
<span class="c-Singleline">;                               &quot;Wait&quot; to wait for a notification  ***</span>
<span class="c-Singleline">;     Image []                  Image file name/library or</span>
<span class="c-Singleline">;                               number of icon in shell32.dll</span>
<span class="c-Singleline">;                               Gui Number to &quot;Wait&quot; for          ***</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;     Return                    Gui Number used                   ***</span>
<span class="c-Singleline">;                               0 if failed (too many open)</span>
<span class="c-Singleline">;</span>
<span class="n">Notify</span><span class="p">(</span><span class="n">Title</span><span class="o">=</span><span class="s">&quot;!!!&quot;</span><span class="p">,</span><span class="n">Message</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">Options</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">Image</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="nf"></span>
<span class="nf"> Static</span><span class="c-Singleline">                ;Options string: &quot;TS=12 GC=Blue...&quot;</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">GF</span> <span class="o">:=</span> <span class="mi">50</span><span class="c-Singleline">       ;    Gui First Number  ;= override Gui: # used</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">GL</span> <span class="o">:=</span> <span class="mi">74</span><span class="c-Singleline">       ;    Gui Last Number   ;= between GF and GL</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">GC</span> <span class="o">:=</span> <span class="s">&quot;FFFFAA&quot;</span><span class="c-Singleline"> ;    Gui Color         ;   ie: don&#39;t use GF&lt;=Gui#&lt;=GL</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">GR</span> <span class="o">:=</span> <span class="mi">9</span><span class="c-Singleline">        ;    Gui Radius        ;       elsewhere in your script</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">GT</span> <span class="o">:=</span> <span class="s">&quot;Off&quot;</span><span class="c-Singleline">    ;    Gui Transparency</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">TS</span> <span class="o">:=</span> <span class="mi">8</span><span class="c-Singleline">        ;  Title Font Size</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">TW</span> <span class="o">:=</span> <span class="mi">625</span><span class="c-Singleline">      ;  Title Font Weight</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">TC</span> <span class="o">:=</span> <span class="s">&quot;Black&quot;</span><span class="c-Singleline">  ;  Title Font Color</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">TF</span> <span class="o">:=</span> <span class="s">&quot;Arial&quot;</span><span class="c-Singleline">  ;  Title Font Face</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">MS</span> <span class="o">:=</span> <span class="mi">8</span><span class="c-Singleline">        ;Message Font Size</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">MW</span> <span class="o">:=</span> <span class="mi">550</span><span class="c-Singleline">      ;Message Font Weight</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">MC</span> <span class="o">:=</span> <span class="s">&quot;Black&quot;</span><span class="c-Singleline">  ;Message Font Color</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">MF</span> <span class="o">:=</span> <span class="s">&quot;Arial&quot;</span><span class="c-Singleline">  ;Message Font Face</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">BC</span> <span class="o">:=</span> <span class="s">&quot;000000&quot;</span><span class="c-Singleline">  ; Border Colors</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">BW</span> <span class="o">:=</span> <span class="mi">2</span><span class="c-Singleline">        ; Border Width/Thickness</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">BR</span> <span class="o">:=</span> <span class="mi">13</span><span class="c-Singleline">       ; Border Radius</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">BT</span> <span class="o">:=</span> <span class="mi">105</span><span class="c-Singleline">      ; Border Transpacency</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">BF</span> <span class="o">:=</span> <span class="mi">150</span><span class="c-Singleline">      ; Border Flash Speed</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">SI</span> <span class="o">:=</span> <span class="mi">350</span><span class="c-Singleline">      ;  Speed In (AnimateWindow)</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">SC</span> <span class="o">:=</span> <span class="mi">100</span><span class="c-Singleline">      ;  Speed Clicked (AnimateWindow)</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">ST</span> <span class="o">:=</span> <span class="mi">450</span><span class="c-Singleline">      ;  Speed TimeOut (AnimateWindow)</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">IW</span> <span class="o">:=</span> <span class="mi">32</span><span class="c-Singleline">       ;  Image Width</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">IH</span> <span class="o">:=</span> <span class="mi">32</span><span class="c-Singleline">       ;  Image Height</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">IN</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline">        ;  Image Icon Number (from Image)</span><span class="nf"></span>
<span class="nf"> static</span> <span class="n">AX</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline">        ; Action X Close Button (maybe add yes/no ok/cancel, etc...)</span><span class="nf"></span>
<span class="nf"> local</span> <span class="n">AC</span><span class="p">,</span> <span class="n">AT</span><span class="c-Singleline">          ;Actions Clicked/Timeout</span><span class="nf"></span>
<span class="nf"> local</span> <span class="n">_Notify_Action</span><span class="p">,</span> <span class="n">ImageOptions</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">OtherY</span><span class="w"></span>

<span class="nl">_Notify_:</span><span class="nf"></span>
<span class="nf"> local</span> <span class="n">NO</span> <span class="o">:=</span> <span class="mi">0</span><span class="c-Singleline">         ;NO is Notify Option [NO=Reset]</span>
<span class="w"> </span><span class="n">If</span><span class="p"> (</span><span class="n">Options</span><span class="p">)</span>
 <span class="p">{</span><span class="nf"></span>
<span class="nf">  IfInString</span><span class="p">,</span> <span class="n">Options</span><span class="p">,</span> <span class="o">=</span>
  <span class="p">{</span>
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span><span class="s">Parse</span><span class="p">,</span><span class="s">Options</span><span class="p">,</span><span class="nv">%A_Space%</span><span class="w"></span>
<span class="w">    </span> <span class="n">If</span> <span class="p">(</span><span class="n">Option</span><span class="o">:=</span><span class="nf"> SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="w">     </span><span class="nl">%Option%:</span><span class="o">=</span><span class="nf"> SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="nf"></span>
<span class="nf">   If </span><span class="n">NO</span> <span class="o">=</span> <span class="n">Reset</span>
   <span class="p">{</span>
<span class="w">    </span><span class="n">Options</span><span class="p"> </span><span class="o">:=</span> <span class="s">&quot;GF=50 GL=74 GC=FFFFAA GR=9 GT=Off &quot;</span>
     <span class="o">.</span> <span class="s">&quot;TS=8 TW=625 TC=Black TF=Arial MS=8 MW=550 MC=Black MF=Arial &quot;</span>
     <span class="o">.</span> <span class="s">&quot;BC=Black BW=2 BR=9 BT=105 BF=150 SC=300 SI=250 ST=100 &quot;</span>
     <span class="o">.</span> <span class="s">&quot;IW=32 IH=32 IN=0&quot;</span>
<span class="w">    </span><span class="nb">Goto</span><span class="p">,</span><span class="s"> _Notify_</span><span class="w"></span>
<span class="w">   </span> <span class="p">}</span>
  <span class="p">}</span>
<span class="w">  </span><span class="nb">Else</span><span class="w"> </span><span class="s">If Options = Wait</span><span class="w"></span>
<span class="w">   </span> <span class="n">Goto</span><span class="p">,</span> <span class="n">_Notify_Wait_</span>
 <span class="p">}</span><span class="w"></span>


<span class="w"> </span><span class="n">GN</span><span class="p"> </span><span class="o">:=</span> <span class="n">GF</span>
<span class="w"> </span><span class="nb">Loop</span><span class="w"></span>
<span class="w">  </span><span class="nf"> IfNotInString</span><span class="p">,</span> <span class="n">NotifyList</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;|&quot;</span> <span class="n">GN</span>
<span class="w">   </span><span class="nb">Break</span><span class="w"></span>
<span class="w">  </span> <span class="n">Else</span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="o">++</span><span class="n">GN</span> <span class="o">&gt;</span> <span class="n">GL</span><span class="p">)</span><span class="nf"></span>
<span class="nf">    Return</span> <span class="mi">0</span><span class="c-Singleline">              ;=== too many notifications open!</span>
<span class="w"> </span><span class="n">NotifyList</span><span class="p"> </span><span class="o">.=</span> <span class="s">&quot;|&quot;</span> <span class="n">GN</span>
<span class="w"> </span><span class="n">GN2</span><span class="p"> </span><span class="o">:=</span> <span class="n">GN</span> <span class="o">+</span> <span class="n">GL</span> <span class="o">-</span> <span class="n">GF</span> <span class="o">+</span> <span class="mi">1</span><span class="nf"></span>
<span class="nf"> If </span><span class="n">AC</span> <span class="o">&lt;&gt;</span>
<span class="w">  </span><span class="n">ActionList</span><span class="p"> </span><span class="o">.=</span> <span class="s">&quot;|&quot;</span> <span class="n">GN</span> <span class="s">&quot;=&quot;</span> <span class="n">AC</span><span class="w"></span>

<span class="w"> </span><span class="n">Prev_DetectHiddenWindows</span><span class="p"> </span><span class="o">:=</span> <span class="nv">A_DetectHiddenWindows</span>
<span class="w"> </span><span class="n">Prev_TitleMatchMode</span><span class="p"> </span><span class="o">:=</span> <span class="nv">A_TitleMatchMode</span>
<span class="w"> </span><span class="nb">DetectHiddenWindows</span><span class="w"> </span><span class="s">On</span><span class="w"></span>
<span class="w">  </span><span class="nb">SetTitleMatchMode</span><span class="w"> </span><span class="s">1</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="nf">WinExist</span><span class="p">(</span><span class="s">&quot;NotifyGui&quot;</span><span class="p">))</span><span class="c-Singleline">  ;=== find all Notifications from ALL scripts, for placement</span>
<span class="w">  </span><span class="nb">WinGetPos</span><span class="p">,</span><span class="s"> OtherX</span><span class="p">,</span><span class="s"> OtherY  </span><span class="c-Singleline">;=== change this to a loop for all open notifications?</span><span class="w"></span>
<span class="w">  </span><span class="nb">DetectHiddenWindows</span><span class="w"> </span><span class="nv">%Prev_DetectHiddenWindows%</span><span class="w"></span>
<span class="w">  </span><span class="nb">SetTitleMatchMode</span><span class="w"> </span><span class="nv">%Prev_TitleMatchMode%</span><span class="w"></span>

<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:-Caption +ToolWindow +AlwaysOnTop -Border</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Color</span><span class="p">,</span><span class="s"> %GC%</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Font</span><span class="p">,</span><span class="s"> w%TW% s%TS% c%TC%</span><span class="p">,</span><span class="s"> %TF%</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">Image</span><span class="p">)</span>
 <span class="p">{</span><span class="nf"></span>
<span class="nf">  If FileExist</span><span class="p">(</span><span class="n">Image</span><span class="p">)</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Add</span><span class="p">,</span><span class="s"> Picture</span><span class="p">,</span><span class="s"> w%IW% h%IH% Icon%IN%</span><span class="p">, % </span><span class="s">Image</span><span class="w"></span>
<span class="w">  </span> <span class="n">Else</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Add</span><span class="p">,</span><span class="s"> Picture</span><span class="p">,</span><span class="s"> w%IW% h%IH% Icon%Image%</span><span class="p">,</span><span class="s"> c:\windows\system32\shell32.dll</span><span class="w"></span>
<span class="w">  </span> <span class="n">ImageOptions</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">10</span>
 <span class="p">}</span><span class="nf"></span>
<span class="nf"> If </span><span class="n">Title</span> <span class="o">&lt;&gt;</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Add</span><span class="p">,</span><span class="s"> Text</span><span class="p">, % </span><span class="s">ImageOptions</span><span class="p">, % </span><span class="s">Title</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Font</span><span class="p">,</span><span class="s"> w%MW% s%MS% c%MC%</span><span class="p">,</span><span class="s"> %MF%</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> ((</span><span class="n">Title</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Message</span><span class="p">))</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Margin</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> -5</span><span class="w"></span>
<span class="w"> </span><span class="nf"> If </span><span class="n">Message</span> <span class="o">&lt;&gt;</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Add</span><span class="p">,</span><span class="s"> Text</span><span class="p">,, % </span><span class="s">Message</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> ((</span><span class="n">Title</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Message</span><span class="p">))</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Margin</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> 8</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Show</span><span class="p">,</span><span class="s"> Hide</span><span class="p">,</span><span class="s"> NotifyGui</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="w">  </span><span class="nv">%GN%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w">  </span><span class="nb">WinGetPos</span><span class="p">,</span><span class="s"> GX</span><span class="p">,</span><span class="s"> GY</span><span class="p">,</span><span class="s"> GW</span><span class="p">,</span><span class="s"> GH</span><span class="w"></span>

<span class="w"> </span><span class="nf"> If </span><span class="n">AX</span> <span class="o">=</span>
 <span class="p">{</span>
<span class="w">  </span><span class="n">GW</span><span class="p"> </span><span class="o">+=</span> <span class="mi">10</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Font</span><span class="p">,</span><span class="s"> w800 s6 c%MC%</span><span class="w"></span>
<span class="w">  </span> <span class="n">Gui</span><span class="p">,</span> <span class="nv">%GN%</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;x&quot;</span> <span class="n">GW</span><span class="o">-</span><span class="mi">11</span> <span class="s">&quot; y-1 Border Center w12 h12 g_Notify_Kill_&quot;</span> <span class="n">GN</span> <span class="o">-</span> <span class="n">GF</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span>
 <span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Add</span><span class="p">,</span><span class="s"> Text</span><span class="p">,</span><span class="s"> x0 y0 w%GW% h%GH% g_Notify_Action BackgroundTrans</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">GR</span><span class="p">)</span>
<span class="w">  </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> Region</span><span class="p">, % </span><span class="s">&quot;0-0 w&quot; GW &quot; h&quot; GH &quot; R&quot; GR &quot;-&quot; GR</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">GT</span><span class="p">)</span>
<span class="w">  </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> Transparent</span><span class="p">, % </span><span class="s">GT</span><span class="w"></span>

<span class="w">  </span><span class="nb">SysGet</span><span class="p">,</span><span class="s"> Workspace</span><span class="p">,</span><span class="s"> MonitorWorkArea</span><span class="w"></span>
<span class="w">  </span><span class="n">NewX</span><span class="p"> </span><span class="o">:=</span> <span class="n">WorkSpaceRight</span><span class="o">-</span><span class="n">GW</span><span class="o">-</span><span class="mi">5</span>
<span class="w"> </span><span class="n">If</span><span class="p"> (</span><span class="n">OtherY</span><span class="p">)</span>
<span class="w">  </span><span class="n">NewY</span><span class="p"> </span><span class="o">:=</span> <span class="n">OtherY</span><span class="o">-</span><span class="n">GH</span><span class="o">-</span><span class="mi">5</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span> <span class="n">NewY</span> <span class="o">:=</span> <span class="n">WorkspaceBottom</span><span class="o">-</span><span class="n">GH</span><span class="o">-</span><span class="mi">5</span><span class="nf"></span>
<span class="nf"> If </span><span class="n">NewY</span> <span class="o">&lt;</span> <span class="o">%</span> <span class="n">WorkspaceTop</span>
<span class="w">  </span><span class="n">NewY</span><span class="p"> </span><span class="o">:=</span> <span class="n">WorkspaceBottom</span><span class="o">-</span><span class="n">GH</span><span class="o">-</span><span class="mi">5</span><span class="w"></span>

<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN2%:-Caption +ToolWindow +AlwaysOnTop -Border +E0x20</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN2%:Color</span><span class="p">,</span><span class="s"> %BC%</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="w">  </span><span class="nv">%GN2%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">BR</span><span class="p">)</span>
<span class="w">  </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> Region</span><span class="p">, % </span><span class="s">&quot;0-0 w&quot; GW+(BW*2) &quot; h&quot; GH+(BW*2) &quot; R&quot; BR &quot;-&quot; BR</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">BT</span><span class="p">)</span>
<span class="w">  </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> Transparent</span><span class="p">, % </span><span class="s">BT</span><span class="w"></span>

<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN2%:Show</span><span class="p">, % </span><span class="s">&quot;Hide x&quot; NewX-BW &quot; y&quot; NewY-BW &quot; w&quot; GW+(BW*2) &quot; h&quot; GH+(BW*2)</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN%:Show</span><span class="p">,  % </span><span class="s">&quot;Hide x&quot; NewX &quot; y&quot; NewY &quot; w&quot; GW</span><span class="p">,</span><span class="s"> NotifyGui</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="w">  </span><span class="nv">%GN%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w"> </span><span class="nf"> If </span><span class="n">SI</span><span class="nf"></span>
<span class="nf">  DllCall</span><span class="p">(</span><span class="s">&quot;AnimateWindow&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">WinExist</span><span class="p">(),</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">SI</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="s">&quot;0x00040008&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span> <span class="n">Gui</span><span class="p">,</span> <span class="nv">%GN%</span><span class="o">:</span><span class="n">Show</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NotifyGui</span>
<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GN2%:Show</span><span class="p">,</span><span class="s"> NA</span><span class="w"></span>
<span class="w">  </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> AlwaysOnTop</span><span class="p">,</span><span class="s"> On</span><span class="w"></span>

<span class="w">  </span><span class="n">If</span><span class="p"> ((</span><span class="n">Duration</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">OR</span> <span class="p">(</span><span class="n">Duration</span> <span class="o">=</span> <span class="s">&quot;-0&quot;</span><span class="p">))</span>
<span class="w">  </span><span class="nb">Exit</span><span class="w"> </span><span class="o">:=</span> <span class="n">GN</span>
<span class="w"> </span><span class="n">If</span><span class="p"> (</span><span class="n">Duration</span><span class="p">)</span>
<span class="w">   </span><span class="nb">SetTimer</span><span class="p">,</span><span class="s"> % &quot;_Notify_Kill_&quot; GN - GF + 1</span><span class="p">, % </span><span class="o">-</span><span class="nf"> Abs</span><span class="p">(</span><span class="n">Duration</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span> <span class="n">SetTimer</span><span class="p">,</span> <span class="o">%</span> <span class="s">&quot;_Notify_Flash_&quot;</span> <span class="n">GN</span> <span class="o">-</span> <span class="n">GF</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">%</span> <span class="n">BF</span><span class="nf"></span>

<span class="nf">Return</span> <span class="o">%</span> <span class="n">GN</span><span class="c-Singleline"></span>

<span class="c-Singleline">;==========================================================================</span>
<span class="c-Singleline">;========================================== when a notification is clicked:</span>
<span class="nl">_Notify_Action:</span><span class="c-Singleline"></span>
<span class="c-Singleline"> ;Critical</span>
<span class="w"> </span><span class="nb">SetTimer</span><span class="p">,</span><span class="s"> % &quot;_Notify_Kill_&quot; A_Gui - GF + 1</span><span class="p">,</span><span class="s"> Off</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> % A_Gui + GL - GF + 1 &quot;:Destroy&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="w">  </span><span class="nv">%A_Gui%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w"> </span><span class="nf"> If </span><span class="n">SC</span><span class="nf"></span>
<span class="nf">  DllCall</span><span class="p">(</span><span class="s">&quot;AnimateWindow&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">WinExist</span><span class="p">(),</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">SC</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="s">&quot;0x00050001&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %A_Gui%:Destroy</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">ActionList</span><span class="p">)</span>
<span class="w">  </span><span class="nb">Loop</span><span class="p">,</span><span class="s">Parse</span><span class="p">,</span><span class="s">ActionList</span><span class="p">,</span><span class="s">|</span><span class="w"></span>
<span class="w">   </span> <span class="n">If</span> <span class="p">((</span><span class="n">Action</span> <span class="o">:=</span><span class="nf"> SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="nv">A_Gui</span><span class="p">)</span>
   <span class="p">{</span>
<span class="w">    </span><span class="nl">Temp_Notify_Action:</span><span class="o">=</span><span class="nf"> SubStr</span><span class="p">(</span><span class="nv">A_LoopField</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> ActionList</span><span class="p">,</span><span class="s"> ActionList</span><span class="p">, % </span><span class="s">&quot;|&quot; A_Gui &quot;=&quot; Temp_Notify_Action</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> All</span><span class="w"></span>
<span class="w">    </span><span class="nf"> If IsLabel</span><span class="p">(</span><span class="n">_Notify_Action</span> <span class="o">:=</span> <span class="n">Temp_Notify_Action</span><span class="p">)</span>
<span class="w">     </span><span class="nb">Gosub</span><span class="p">,</span><span class="s"> %_Notify_Action%</span><span class="w"></span>
<span class="w">    </span> <span class="n">_Notify_Action</span> <span class="o">=</span>
<span class="w">    </span><span class="nb">Break</span><span class="w"></span>
<span class="w">   </span> <span class="p">}</span>
<span class="w"> </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> NotifyList</span><span class="p">,</span><span class="s"> NotifyList</span><span class="p">, % </span><span class="s">&quot;|&quot; GN</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> All</span><span class="w"></span>
<span class="w">  </span><span class="nb">SetTimer</span><span class="p">,</span><span class="s"> % &quot;_Notify_Flash_&quot; A_Gui - GF + 1</span><span class="p">,</span><span class="s"> Off</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">Exit</span> <span class="o">=</span> <span class="nv">A_Gui</span><span class="p">)</span>
<span class="w">  </span><span class="nb">ExitApp</span><span class="w"></span>

<span class="nf">Return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;==========================================================================</span>
<span class="c-Singleline">;=========================================== when a notification times out:</span>
<span class="nl">_Notify_Kill_1:</span>
<span class="nl">_Notify_Kill_2:</span>
<span class="nl">_Notify_Kill_3:</span>
<span class="nl">_Notify_Kill_4:</span>
<span class="nl">_Notify_Kill_5:</span>
<span class="nl">_Notify_Kill_6:</span>
<span class="nl">_Notify_Kill_7:</span>
<span class="nl">_Notify_Kill_8:</span>
<span class="nl">_Notify_Kill_9:</span>
<span class="nl">_Notify_Kill_10:</span>
<span class="nl">_Notify_Kill_11:</span>
<span class="nl">_Notify_Kill_12:</span>
<span class="nl">_Notify_Kill_13:</span>
<span class="nl">_Notify_Kill_14:</span>
<span class="nl">_Notify_Kill_15:</span>
<span class="nl">_Notify_Kill_16:</span>
<span class="nl">_Notify_Kill_17:</span>
<span class="nl">_Notify_Kill_18:</span>
<span class="nl">_Notify_Kill_19:</span>
<span class="nl">_Notify_Kill_20:</span>
<span class="nl">_Notify_Kill_21:</span>
<span class="nl">_Notify_Kill_22:</span>
<span class="nl">_Notify_Kill_23:</span>
<span class="nl">_Notify_Kill_24:</span>
<span class="nl">_Notify_Kill_25:</span><span class="c-Singleline"></span>
<span class="c-Singleline"> ;Critical</span>
<span class="w"> </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> GK</span><span class="p">,</span><span class="s"> A_ThisLabel</span><span class="p">,</span><span class="s"> _Notify_Kill_</span><span class="w"></span>
<span class="w">  </span><span class="nb">SetTimer</span><span class="p">,</span><span class="s"> _Notify_Flash_%GK%</span><span class="p">,</span><span class="s"> Off</span><span class="w"></span>
<span class="w">  </span><span class="n">GK</span><span class="p"> </span><span class="o">+=</span> <span class="n">GF</span> <span class="o">-</span> <span class="mi">1</span>
<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> % GK + GL - GF + 1 &quot;:Destroy&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nb">Gui</span><span class="w">  </span><span class="nv">%GK%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w"> </span><span class="nf"> If </span><span class="n">ST</span><span class="nf"></span>
<span class="nf">  DllCall</span><span class="p">(</span><span class="s">&quot;AnimateWindow&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="nf">WinExist</span><span class="p">(),</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span> <span class="s">&quot;0x00050001&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %GK%:Destroy</span><span class="w"></span>
<span class="w">  </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> NotifyList</span><span class="p">,</span><span class="s"> NotifyList</span><span class="p">, % </span><span class="s">&quot;|&quot; GK</span><span class="w"></span>
<span class="w">  </span><span class="n">If</span><span class="p"> (</span><span class="n">Exit</span> <span class="o">=</span> <span class="n">GK</span><span class="p">)</span>
<span class="w">  </span><span class="nb">ExitApp</span><span class="w"></span>

<span class="nf">Return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;==========================================================================</span>
<span class="c-Singleline">;======================================== flashes a permanent notification:</span>
<span class="nl">_Notify_Flash_1:</span>
<span class="nl">_Notify_Flash_2:</span>
<span class="nl">_Notify_Flash_3:</span>
<span class="nl">_Notify_Flash_4:</span>
<span class="nl">_Notify_Flash_5:</span>
<span class="nl">_Notify_Flash_6:</span>
<span class="nl">_Notify_Flash_7:</span>
<span class="nl">_Notify_Flash_8:</span>
<span class="nl">_Notify_Flash_9:</span>
<span class="nl">_Notify_Flash_10:</span>
<span class="nl">_Notify_Flash_11:</span>
<span class="nl">_Notify_Flash_12:</span>
<span class="nl">_Notify_Flash_13:</span>
<span class="nl">_Notify_Flash_14:</span>
<span class="nl">_Notify_Flash_15:</span>
<span class="nl">_Notify_Flash_16:</span>
<span class="nl">_Notify_Flash_17:</span>
<span class="nl">_Notify_Flash_18:</span>
<span class="nl">_Notify_Flash_19:</span>
<span class="nl">_Notify_Flash_20:</span>
<span class="nl">_Notify_Flash_21:</span>
<span class="nl">_Notify_Flash_22:</span>
<span class="nl">_Notify_Flash_23:</span>
<span class="nl">_Notify_Flash_24:</span>
<span class="nl">_Notify_Flash_25:</span>
<span class="w"> </span><span class="nb">StringReplace</span><span class="p">,</span><span class="s"> FlashGN</span><span class="p">,</span><span class="s"> A_ThisLabel</span><span class="p">,</span><span class="s"> _Notify_Flash_</span><span class="w"></span>
<span class="w">  </span><span class="n">FlashGN</span><span class="p"> </span><span class="o">+=</span> <span class="n">GF</span> <span class="o">-</span> <span class="mi">1</span>
<span class="w"> </span><span class="n">FlashGN2</span><span class="p"> </span><span class="o">:=</span> <span class="n">FlashGN</span> <span class="o">+</span> <span class="n">GL</span> <span class="o">-</span> <span class="n">GF</span> <span class="o">+</span> <span class="mi">1</span><span class="nf"></span>
<span class="nf"> If </span><span class="n">Flashed</span><span class="nv">%FlashGN2%</span> <span class="o">:=</span> <span class="o">!</span><span class="n">Flashed</span><span class="nv">%FlashGN2%</span>
<span class="w">  </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %FlashGN2%:Color</span><span class="p">,</span><span class="s"> Silver</span><span class="w"></span>
<span class="w">  </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span> <span class="n">Gui</span><span class="p">,</span> <span class="nv">%FlashGN2%</span><span class="o">:</span><span class="n">Color</span><span class="p">,</span> <span class="o">%</span> <span class="n">BC</span><span class="nf"></span>
<span class="nf">Return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;==========================================================================</span>
<span class="c-Singleline">;============================= wait for (or force) a notification to close:</span>
<span class="nl">_Notify_Wait_:</span><span class="c-Singleline"></span>
<span class="c-Singleline"> ;Critical</span>
<span class="w"> </span><span class="n">If</span><span class="p"> (</span><span class="n">Image</span><span class="p">)</span>
 <span class="p">{</span>
<span class="w">  </span><span class="nb">Gui</span><span class="w"> </span><span class="nv">%Image%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w">  </span><span class="nf"> If </span><span class="n">NotifyGuiID</span> <span class="o">:=</span><span class="nf"> WinExist</span><span class="p">()</span>
  <span class="p">{</span>
<span class="w">   </span><span class="nb">WinWaitClose</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> </span><span class="p">, % </span><span class="s">Abs(Duration)</span><span class="w"></span>
<span class="w">   </span> <span class="n">If</span> <span class="p">(</span><span class="nv">ErrorLevel</span> <span class="o">&amp;&amp;</span> <span class="n">Duration</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
   <span class="p">{</span>
<span class="w">    </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> % Image + GL - GF + 1 &quot;:Destroy&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;AnimateWindow&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">NotifyGuiID</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="s">&quot;0x00050001&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %Image%:Destroy</span><span class="w"></span>
<span class="w">   </span> <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
<span class="w"> </span><span class="nb">Else</span><span class="w"></span>
<span class="w">  </span><span class="nb">Loop</span><span class="p">,</span><span class="s"> % GL-GF</span><span class="w"></span>
<span class="w"> </span> <span class="p">{</span>
<span class="w">  </span><span class="n">Image</span><span class="p"> </span><span class="o">:=</span> <span class="n">GL</span> <span class="o">-</span> <span class="p">(</span><span class="nv">A_Index</span><span class="p">)</span><span class="c-Singleline"> ;+ GF - 1)</span>
<span class="w">  </span><span class="nb">Gui</span><span class="w"> </span><span class="nv">%Image%</span><span class="s">:+LastFound</span><span class="w"></span>
<span class="w">  </span><span class="nf"> If </span><span class="n">NotifyGuiID</span> <span class="o">:=</span><span class="nf"> WinExist</span><span class="p">()</span>
  <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">   ;WinWaitClose, , , % Abs(Duration)</span>
<span class="c-Singleline">   ;If (ErrorLevel &amp;&amp; Duration &lt; 1)</span>
<span class="c-Singleline">   ;{</span>
<span class="w">    </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> % Image + GL - GF + 1 &quot;:Destroy&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nf"> DllCall</span><span class="p">(</span><span class="s">&quot;AnimateWindow&quot;</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="n">NotifyGuiID</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="s">&quot;UInt&quot;</span><span class="p">,</span><span class="s">&quot;0x00050001&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> %Image%:Destroy</span><span class="w"></span>
<span class="w">   </span><span class="c-Singleline"> ;}</span>
  <span class="p">}</span>
 <span class="p">}</span><span class="nf"></span>
<span class="nf">Return</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
