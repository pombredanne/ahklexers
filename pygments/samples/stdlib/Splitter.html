<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="cm">/* Title:    Splitter</span>
<span class="cm">			 Splitter control.</span>

<span class="cm">			 (see splitter.png)</span>

<span class="cm">			 Splitter is control that is created between controls that need to have dynamic separation.</span>
<span class="cm">			 To use it, you first need to create the splitter (&lt;Add&gt;), then you have to activate it when all controls</span>
<span class="cm">			 that it separates are created (&lt;Set&gt;).</span>
<span class="cm">			 You can set splitter position with &lt;SetPos&gt; and obtain it with &lt;GetPos&gt;. </span>
<span class="cm">			 You can also limit splitter movement with &lt;Limit&gt; function if you don&#39;t want controls it separates to be set completely invisible by the user.</span>
<span class="cm">			 </span>
<span class="cm"> Dependency:</span>
<span class="cm">			&lt;Win&gt; 1.24</span>

<span class="cm"> Effects:	</span>
<span class="cm">			- While user moves splitter, CoordMode of mouse is always returned to relative.</span>
<span class="cm">			- Upon movement, splitter will reset &lt;Attach&gt; for the parent, if present.			</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Add</span>
<span class="cm"> 			Add new Splitter.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			Opt	    - Splitter Gui options. Splitter is subclassed Text control (Static), so it accepts any Text options.</span>
<span class="cm">					plus one the following: blackframe, blackrect, grayframe, grayrect, whiteframe, whiterect, sunken.</span>
<span class="cm">			Text    - Text to set.</span>
<span class="cm">			Handler - Notification function. See bellow.</span>
<span class="cm">			</span>
<span class="cm"> Handler:</span>
<span class="cm"> &gt;			OnSplitter(Hwnd, Event, Pos)</span>
<span class="cm">		</span>
<span class="cm">			P - Triggered when user changes the position by dragging the splitter with mouse.</span>
<span class="cm">			D - User doubleclicked the splitter.</span>
<span class="cm">			R - User right clicked the splitter.</span>

<span class="cm"> Returns:</span>
<span class="cm">			Splitter handle.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			This function adds a new splitter on the given position. User is responsible for correct position of the splitter.</span>
<span class="cm">			Splitter is inactive until you call &lt;Set&gt; function.</span>
<span class="cm">			When setting dimension of the splitter (width or height) use even numbers.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Add</span><span class="p">(</span><span class="n">Opt</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">SS_NOTIFY</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">SS_CENTER</span><span class="o">=</span><span class="mh">0x200</span><span class="p">,</span> <span class="n">SS_SUNKEN</span><span class="o">=</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">SS_BLACKRECT</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">SS_GRAYRECT</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">SS_WHITERECT</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">SS_BLACKFRAME</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">SS_GRAYFRAM</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">SS_WHITEFRAME</span><span class="o">=</span><span class="mi">9</span>

	<span class="n">hStyle</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Opt</span><span class="p">,</span> <span class="nv">%A_Space%</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="ow">in</span> <span class="n">blackframe</span><span class="p">,</span><span class="n">blackrect</span><span class="p">,</span><span class="n">grayframe</span><span class="p">,</span><span class="n">grayrect</span><span class="p">,</span><span class="n">sunken</span><span class="p">,</span><span class="n">whiteframe</span><span class="p">,</span><span class="n">whiterect</span><span class="p">,</span><span class="n">sunken</span><span class="p">,</span><span class="n">center</span>
			<span class="n">hStyle</span> <span class="o">|=</span> <span class="n">SS_</span><span class="nv">%A_LoopField%</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">Opt</span> <span class="o">.=</span> <span class="nv">A_LoopField</span> <span class="s">&quot; &quot;</span>

<span class="w">	</span><span class="nb">Gui</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">HWNDhSep</span> <span class="o">-</span><span class="n">hscroll</span> <span class="o">-</span><span class="n">vscroll</span> <span class="nv">%SS_CENTERIMAGE%</span> <span class="nv">%SS_NOTIFY%</span> <span class="n">center</span> <span class="nv">%Opt%</span> <span class="nv">%hStyle%</span><span class="p">,</span> <span class="nv">%Text%</span>	
	<span class="n">hSep</span><span class="o">+=</span><span class="mi">0</span>
<span class="w">	</span><span class="nb">if </span><span class="nf">IsFunc(</span><span class="n">Handler</span><span class="p">)</span>
		<span class="n">Splitter</span><span class="p">(</span><span class="n">hSep</span> <span class="s">&quot;Handler&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hSep</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Add2Form</span>
<span class="cm"> 			Add Splitter into the form. </span>

<span class="cm"> Options:</span>
<span class="cm">			handler	- Splitter handler name.</span>
<span class="cm">			extra	- Extra parameters are transmited to &lt;Add&gt; Opt parameter.</span>
<span class="cm"> </span>
<span class="cm"> Remarks:</span>
<span class="cm">			Function is required by the Forms framework.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Add2Form</span><span class="p">(</span><span class="n">HParent</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">Opt</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">parse</span> <span class="o">=</span> <span class="s">&quot;Form_Parse&quot;</span>
	<span class="nv">%parse%</span><span class="p">(</span><span class="n">Opt</span><span class="p">,</span> <span class="s">&quot;handler&quot;</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">extra</span><span class="p">)</span>
	<span class="nf">DllCall(</span><span class="s">&quot;SetParent&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hCtrl</span> <span class="o">:=</span> <span class="n">Splitter_Add</span><span class="p">(</span><span class="n">extra</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">handler</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">HParent</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hCtrl</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetMax</span>
<span class="cm"> 			Returns maximum position of the splitter.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			Maximum position of the splitter will change if parent control is resized.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Win_Get</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="s">&quot;Lwh&quot;</span><span class="p">,</span> <span class="n">plw</span><span class="p">,</span> <span class="n">plh</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="p">(</span><span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">plw</span> <span class="o">:</span> <span class="n">plh</span><span class="p">)</span> <span class="o">-</span> <span class="n">Splitter_getSize</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="o">-</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L2&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L1&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetPos</span>
<span class="cm"> 			Get position of the splitter.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Flag	- Set to &quot;%&quot; to return procentage instead position.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			Position of the splitter is its x or y coordinate inside the parent window.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetPos</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="n">Flag</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span>
	<span class="n">pos</span> <span class="o">:=</span> <span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;*x&quot;</span> <span class="o">:</span> <span class="s">&quot;*y&quot;</span><span class="p">)</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Flag</span> <span class="o">=</span> <span class="s">&quot;%&quot;</span><span class="p">){</span>
		<span class="n">min</span> <span class="o">:=</span> <span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span> <span class="n">max</span> <span class="o">:=</span> <span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="n">min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max</span><span class="o">-</span><span class="n">min</span><span class="p">)</span>
	<span class="p">}</span> <span class="n">else</span> <span class="n">return</span> <span class="n">pos</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetSize</span>
<span class="cm"> 			Get size of the splitter.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetSize</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;wh&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Splitter</span><span class="p">(</span> <span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">w</span> <span class="o">:</span> <span class="n">h</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Set</span>
<span class="cm"> 			Initiates separation of controls.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			HSep - Splitter handle.</span>
<span class="cm">			Def	 - Splitter definition or words &quot;off&quot; or &quot;on&quot;. The syntax of splitter definition is given bellow.</span>
<span class="cm">			Pos	 - Position of the splitter to apply upon initialization (optional).</span>
<span class="cm">			Limit - Decimal, sets start and end limits for splitter movement. The minimum and maximum splitter value will</span>
<span class="cm">					be adjusted by this value. For instance, .100 means that maximum value will be less by 100.</span>

<span class="cm"> Splitter Defintion:</span>
<span class="cm"> &gt;		c11 c12 c13 ... Type c21 c22 c23 ...</span>
<span class="cm">		</span>
<span class="cm">		c1n - Controls left or top of the splitter.</span>
<span class="cm">		Type - Splitter type: &quot; | &quot; vertical or &quot; - &quot; horizontal.</span>
<span class="cm">		c2n	- Controls right or bottom of the splitter.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Set</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="n">Def</span><span class="p">,</span> <span class="n">Pos</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Limit</span><span class="o">=</span><span class="mf">0.0</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>

<span class="w">	</span><span class="nb">if </span><span class="n">Def</span><span class="o">=</span><span class="n">off</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="n">Def</span><span class="o">=</span><span class="n">on</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="n">bVert</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">InStr(</span><span class="n">Def</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">,</span> <span class="n">bVert</span><span class="p">)</span>

	<span class="n">old</span> <span class="o">:=</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">wnadProc</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;Splitter_wndProc&quot;</span> <span class="o">:</span> <span class="n">wndProc</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">)</span>

<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Limit</span><span class="p">,</span> <span class="o">.</span>
	<span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Def&quot;</span><span class="p">,</span> <span class="n">Def</span><span class="p">),</span>  <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L1&quot;</span><span class="p">,</span> <span class="n">L1</span><span class="p">),</span>  <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L2&quot;</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> 	<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Pos</span><span class="p">)</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> Function:	SetPos</span>
<span class="cm">			Set splitter position.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm">   			HSep - Splitter handle.</span>
<span class="cm">			Pos	 - Position to set. Position is the client x/y coordinate of the splitter control. </span>
<span class="cm">				   If followed by the sign %, position is set using procentage of splitter range. </span>
<span class="cm">				   If Pos is empty, function returns without any action. </span>

<span class="cm"> Remarks:</span>
<span class="cm">			Due to the rounding, if you set position using procentage, actuall position may be slightly different.</span>
<span class="cm">			You can find out what is exact position set if you use &lt;GetPos&gt; with Flag set to &quot;%&quot;.</span>
<span class="cm"> */</span>
<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="n">bInternal</span><span class="o">=</span><span class="nv">false</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,,</span> <span class="n">return</span>
	<span class="n">min</span> <span class="o">:=</span> <span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span> <span class="n">max</span> <span class="o">:=</span> <span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="nf">SubStr(</span><span class="n">Pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;%&quot;</span>
		<span class="n">Pos</span> <span class="o">:=</span> <span class="n">min</span> <span class="o">+</span> <span class="nf">SubStr(</span><span class="n">Pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">max</span><span class="o">-</span><span class="n">min</span><span class="p">)</span><span class="o">//</span><span class="mi">100</span>

	<span class="n">bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">),</span>  <span class="n">Def</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Def&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="nb">ifLess</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%min%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%min%</span>
<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Def</span><span class="p">,</span> <span class="nv">%A_Space%</span>

	<span class="n">Delta</span> <span class="o">:=</span> <span class="n">Pos</span> <span class="o">-</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="n">Delta</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>  <span class="n">h</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">Delta</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="nv">%s0%</span>
	<span class="p">{</span>
		<span class="n">s</span> <span class="o">:=</span> <span class="n">s</span><span class="nv">%A_Index%</span>
		<span class="n">if</span> <span class="o">!</span><span class="n">otherSide</span>
		<span class="p">{</span>
			<span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="w">			</span><span class="nb">if </span><span class="n">s</span> <span class="ow">in</span> <span class="o">|</span><span class="p">,</span><span class="o">-</span>
				<span class="n">otherSide</span> <span class="o">:=</span> <span class="nv">true</span><span class="p">,</span> <span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
		<span class="p">}</span> <span class="n">else</span> 	<span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span><span class="p">)</span>
	<span class="p">}</span>		
					
	<span class="n">Win_Redraw</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">)</span> <span class="p">)</span><span class="c-Singleline">						;redrawing imediate parent was not that good.</span>
	<span class="nf">IsFunc(</span><span class="n">f</span> <span class="o">:=</span> <span class="s">&quot;Attach&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">%f%</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="c-Singleline">	;reset attach for parent of HSep</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">handler</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Handler&quot;</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="n">bInternal</span>
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">,</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">))</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;=============================================== PRIVATE ===============================================</span>

<span class="n">Splitter_wndProc</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="n">WParam</span><span class="p">,</span> <span class="n">LParam</span><span class="p">)</span> <span class="p">{</span>	
<span class="w">	</span><span class="nb">static</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">WM_SETCURSOR</span> <span class="o">:=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="n">WM_MOUSEMOVE</span> <span class="o">:=</span> <span class="mh">0x200</span><span class="p">,</span> <span class="n">WM_LBUTTONDOWN</span><span class="o">=</span><span class="mh">0x201</span><span class="p">,</span> <span class="n">WM_LBUTTONUP</span><span class="o">=</span><span class="mh">0x202</span><span class="p">,</span> <span class="n">WM_LBUTTONDBLCLK</span><span class="o">=</span><span class="mi">515</span><span class="p">,</span> <span class="n">WM_RBUTTONUP</span><span class="o">=</span><span class="mi">517</span><span class="p">,</span> <span class="n">SIZENS</span> <span class="o">:=</span> <span class="mi">32645</span><span class="p">,</span> <span class="n">SIZEWE</span> <span class="o">:=</span> <span class="mi">32644</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_SETCURSOR</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="mi">1</span> 
	
	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_MOUSEMOVE</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">if</span> <span class="o">!</span><span class="nv">%Hwnd%</span><span class="n">_cursor</span>
			<span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">Hwnd</span> <span class="s">&quot;bVert&quot;</span><span class="p">),</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span> <span class="o">:=</span> <span class="nf">DllCall(</span><span class="s">&quot;LoadCursor&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">?</span> <span class="n">SIZEWE</span> <span class="o">:</span> <span class="n">SIZENS</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>

<span class="w">		</span><span class="nb">critical</span><span class="c-Singleline"> 	;safe, always in new thread.</span>
			<span class="nf">DllCall(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span><span class="p">)</span>
<span class="w">		</span><span class="nb">if </span><span class="n">moving</span> 
			<span class="n">Splitter_updateFocus</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_LBUTTONDOWN</span><span class="p">)</span> <span class="p">{</span>
		<span class="nf">DllCall(</span><span class="s">&quot;SetCapture&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">),</span>  <span class="n">parent</span> <span class="o">:=</span> <span class="nf">DllCall(</span><span class="s">&quot;GetParent&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>
		<span class="nf">VarSetCapacity(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">DllCall(</span><span class="s">&quot;GetWindowRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>

		<span class="n">sz</span> <span class="o">:=</span> <span class="n">Win_GetRect</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">?</span> <span class="s">&quot;w&quot;</span> <span class="o">:</span> <span class="s">&quot;h&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
		<span class="n">ch</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s">&quot;Nh&quot;</span> <span class="p">)</span><span class="c-Singleline">			;get caption size of parent window</span>

<span class="c-Singleline">	  ;prevent user from going offscreen with separator</span>
		<span class="nf">NumPut(</span> <span class="nf">NumGet(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">sz</span><span class="o">-</span><span class="mi">1</span>	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">NumPut(</span> <span class="nf">NumGet(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">sz</span><span class="o">+</span><span class="n">ch</span> <span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
		<span class="nf">NumPut(</span> <span class="nf">NumGet(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="n">sz</span><span class="o">+</span><span class="mi">4</span> 	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
		<span class="nf">NumPut(</span> <span class="nf">NumGet(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="o">-</span> <span class="n">sz</span><span class="o">+</span><span class="mi">4</span>	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
				
		<span class="nf">DllCall(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">),</span> <span class="nf">DllCall(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span><span class="p">)</span>
		<span class="n">moving</span> <span class="o">:=</span> <span class="nv">true</span>
	<span class="p">}</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_LBUTTONUP</span><span class="p">){</span>
		<span class="n">moving</span> <span class="o">:=</span> <span class="nv">false</span>
	
		<span class="nf">DllCall(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="nf">DllCall(</span><span class="s">&quot;ReleaseCapture&quot;</span><span class="p">)</span>
		<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">Splitter_updateFocus</span><span class="p">(),</span> <span class="nv">true</span><span class="p">)</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">if </span><span class="n">UMsg</span> <span class="ow">in</span> <span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span><span class="nv">%WM_RBUTTONUP%</span>
	<span class="p">{</span>
		<span class="n">handler</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">Hwnd</span> <span class="s">&quot;Handler&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">handler</span><span class="p">,,</span><span class="n">return</span>

<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">D</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">ifEqual</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="nv">%WM_RBUTTONUP%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">R</span>
			
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">))</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall(</span><span class="s">&quot;CallWindowProc&quot;</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nv">A_EventInfo</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">hwnd</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">uMsg</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">wParam</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">lParam</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;Updates focus rectangle while mouse is moving. </span>
<span class="c-Singleline">;If called without arguments it returns latest focus rectangle position.</span>
<span class="n">Splitter_updateFocus</span><span class="p">(</span> <span class="n">HSep</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">HSep</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">dc</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">MouseGetPos</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">my</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">dc</span> 
	<span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">adrDrawFocusRect</span><span class="p">,,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="o">%</span> <span class="nf">DllCall(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span> <span class="n">uint</span><span class="p">,</span> <span class="nf">DllCall(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;user32&quot;</span><span class="p">),</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;DrawFocusRect&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">CoordMode</span><span class="p">,</span> <span class="n">mouse</span><span class="p">,</span> <span class="n">relative</span><span class="c-Singleline"></span>

<span class="c-Singleline">	  ;initialize dc, RECT, idx, delta(distance between mouse and splitter position), sz, pos &amp; max when user starts moving.</span>
		<span class="n">dc</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;0D&quot;</span><span class="p">)</span><span class="c-Singleline">		; take root DC, for some reason it doesn&#39;t work good on parent&#39;s DC</span>

		<span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;!xywh&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">sh</span><span class="p">)</span>
		<span class="nf">VarSetCapacity(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">sx</span><span class="p">,</span> <span class="n">RECT</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">sy</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">sx</span><span class="o">+</span><span class="n">sw</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut(</span><span class="n">sy</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="p">,</span> <span class="n">sz</span> <span class="o">:=</span> <span class="n">sh</span>
<span class="w">		</span>
<span class="w">		</span><span class="nb">if </span><span class="n">bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span> <span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span> <span class="p">)</span>
			 <span class="n">idx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">delta</span> <span class="o">:=</span> <span class="n">mx</span><span class="o">-</span><span class="n">sx</span><span class="p">,</span>   <span class="n">sz</span> <span class="o">:=</span> <span class="n">sw</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">idx</span> <span class="o">:=</span> <span class="mi">4</span><span class="p">,</span>   <span class="n">delta</span> <span class="o">:=</span> <span class="n">my</span><span class="o">-</span><span class="n">sy</span><span class="p">,</span>   <span class="n">sz</span> <span class="o">:=</span> <span class="n">sh</span><span class="c-Singleline"></span>

<span class="c-Singleline">      ;if in Panel, there will be offset to mouse movement according to its position.</span>
		<span class="n">parent</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">WinGetClass</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%parent%</span>
		<span class="n">offset</span> <span class="o">:=</span>  <span class="n">cls</span> <span class="o">!=</span> <span class="s">&quot;Panel&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">Win_GetRect</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="n">bVert</span> <span class="o">?</span> <span class="s">&quot;!x&quot;</span> <span class="o">:</span> <span class="s">&quot;!y&quot;</span><span class="p">)</span>

		<span class="n">pos</span> <span class="o">:=</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span>  
		<span class="n">max</span> <span class="o">:=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">Splitter_getMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span>	 <span class="n">min</span> <span class="o">:=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">Splitter_getMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">DllCall(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">pos</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="n">mx</span><span class="o">-</span><span class="n">delta</span> <span class="o">:</span> <span class="n">my</span><span class="o">-</span><span class="n">delta</span>
<span class="w">	</span><span class="nb">ifLess</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%min%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%min%</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">ifGreater</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%max%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%max%</span>

	<span class="nf">DllCall(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
	<span class="nf">NumPut(</span><span class="n">pos</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span>   <span class="nf">NumPut(</span><span class="n">pos</span><span class="o">+</span><span class="n">sz</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="n">idx</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span>  <span class="nf">DllCall(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;storage</span>
<span class="n">Splitter</span><span class="p">(</span><span class="n">Var</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="s">&quot;~`a &quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>
	<span class="n">_</span> <span class="o">:=</span> <span class="nv">%var%</span>
<span class="w">	</span><span class="nb">ifNotEqual</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span><span class="o">~</span><span class="se">`a</span><span class="err"> </span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="nv">%var%</span><span class="p">,</span> <span class="nv">%value%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">_</span>
<span class="p">}</span>

<span class="nb">#include</span> <span class="o">*</span><span class="n">i</span> <span class="n">Win</span><span class="o">.</span><span class="n">ahk</span>

<span class="cm">/* Group: Examples</span>
<span class="cm"> (start code)</span>
<span class="cm">		w := 500, h := 600, sep := 5</span>
<span class="cm">		w1 := w//3, w2 := w-w1 , h1 := h // 2, h2 := h // 3</span>

<span class="cm">		Gui, Margin, 0, 0</span>
<span class="cm">		Gui, Add, Edit, HWNDc11 w%w1% h%h1%</span>
<span class="cm">		Gui, Add, Edit, HWNDc12 w%w1% h%h1%</span>
<span class="cm">		hSepV := Splitter_Add( &quot;x+0 y0 h&quot; h &quot; w&quot; sep )</span>
<span class="cm">		Gui, Add, Monthcal, HWNDc21 w%w2% h%h2% x+0</span>
<span class="cm">		Gui, Add, ListView, HWNDc22 w%w2% h%h2%, c1|c2|c3</span>
<span class="cm">		Gui, Add, ListBox,  HWNDc23 w%w2% h%h2% , 1|2|3</span>

<span class="cm">		sdef = %c11% %c12% | %c21% %c22% %c23%			;vertical splitter.</span>
<span class="cm">		Splitter_Set( hSepV, sdef )</span>

<span class="cm">		Gui, show, w%w% h%h%	</span>
<span class="cm">	return</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>

<span class="cm">/* Group: About</span>
<span class="cm">	o Ver 1.6 by majkinetor.</span>
<span class="cm">	o Licenced under BSD &lt;http://creativecommons.org/licenses/BSD/&gt;.</span>
<span class="cm"> */</span>
</pre></div>
