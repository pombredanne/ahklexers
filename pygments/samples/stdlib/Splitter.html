<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="o">/*</span><span class="w"> </span>Title<span class="o">:</span><span class="w">    </span>Splitter
<span class="w">			 </span>Splitter<span class="w"> </span><span class="k">control</span><span class="p">.</span>

<span class="w">			 </span><span class="p">(</span>see<span class="w"> </span>splitter<span class="p">.</span>png<span class="p">)</span>

<span class="w">			 </span>Splitter<span class="w"> </span>is<span class="w"> </span><span class="k">control</span><span class="w"> </span>that<span class="w"> </span>is<span class="w"> </span>created<span class="w"> </span>between<span class="w"> </span>controls<span class="w"> </span>that<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>have<span class="w"> </span>dynamic<span class="w"> </span>separation<span class="p">.</span>
<span class="w">			 </span>To<span class="w"> </span>use<span class="w"> </span>it<span class="p">,</span><span class="w"> </span>you<span class="w"> </span>first<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>create<span class="w"> </span>the<span class="w"> </span><span class="nf">splitter</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span>Add<span class="o">&gt;</span><span class="p">),</span><span class="w"> </span>then<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>activate<span class="w"> </span>it<span class="w"> </span>when<span class="w"> </span>all<span class="w"> </span>controls
<span class="w">			 </span>that<span class="w"> </span>it<span class="w"> </span>separates<span class="w"> </span>are<span class="w"> </span><span class="nf">created</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span>Set<span class="o">&gt;</span><span class="p">).</span>
<span class="w">			 </span>You<span class="w"> </span>can<span class="w"> </span>set<span class="w"> </span>splitter<span class="w"> </span>position<span class="w"> </span>with<span class="w"> </span><span class="o">&lt;</span>SetPos<span class="o">&gt;</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span>obtain<span class="w"> </span>it<span class="w"> </span>with<span class="w"> </span><span class="o">&lt;</span>GetPos<span class="o">&gt;</span><span class="p">.</span><span class="w"> </span>
<span class="w">			 </span>You<span class="w"> </span>can<span class="w"> </span>also<span class="w"> </span>limit<span class="w"> </span>splitter<span class="w"> </span>movement<span class="w"> </span>with<span class="w"> </span><span class="o">&lt;</span>Limit<span class="o">&gt;</span><span class="w"> </span>function<span class="w"> </span><span class="kr">if</span><span class="w"> </span>you<span class="w"> </span>don<span class="err">&#39;</span>t<span class="w"> </span>want<span class="w"> </span>controls<span class="w"> </span>it<span class="w"> </span>separates<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>set<span class="w"> </span>completely<span class="w"> </span>invisible<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>user<span class="p">.</span>
<span class="w">			 </span>
<span class="w"> </span>Dependency<span class="o">:</span>
<span class="w">			</span><span class="o">&lt;</span>Win<span class="o">&gt;</span><span class="w"> </span><span class="mf">1.24</span>

<span class="w"> </span><span class="nl">Effects:</span><span class="w">	</span>
<span class="w">			</span><span class="o">-</span><span class="w"> </span>While<span class="w"> </span>user<span class="w"> </span>moves<span class="w"> </span>splitter<span class="p">,</span><span class="w"> </span>CoordMode<span class="w"> </span>of<span class="w"> </span>mouse<span class="w"> </span>is<span class="w"> </span>always<span class="w"> </span>returned<span class="w"> </span>to<span class="w"> </span>relative<span class="p">.</span>
<span class="w">			</span><span class="o">-</span><span class="w"> </span>Upon<span class="w"> </span>movement<span class="p">,</span><span class="w"> </span>splitter<span class="w"> </span>will<span class="w"> </span>reset<span class="w"> </span><span class="o">&lt;</span>Attach<span class="o">&gt;</span><span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>parent<span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>present<span class="p">.</span><span class="w">			</span>
<span class="w"> </span><span class="o">*/</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>Add
<span class="w"> 			</span>Add<span class="w"> </span>new<span class="w"> </span>Splitter<span class="p">.</span>
<span class="w"> </span>
<span class="w"> </span>Parameters<span class="o">:</span>
<span class="w"> 			</span>Opt<span class="w">	    </span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>Gui<span class="w"> </span>options<span class="p">.</span><span class="w"> </span>Splitter<span class="w"> </span>is<span class="w"> </span>subclassed<span class="w"> </span>Text<span class="w"> </span>control<span class="w"> </span><span class="p">(</span><span class="kt">Static</span><span class="p">),</span><span class="w"> </span>so<span class="w"> </span>it<span class="w"> </span>accepts<span class="w"> </span>any<span class="w"> </span>Text<span class="w"> </span>options<span class="p">.</span>
<span class="w">					</span>plus<span class="w"> </span>one<span class="w"> </span>the<span class="w"> </span>following<span class="o">:</span><span class="w"> </span>blackframe<span class="p">,</span><span class="w"> </span>blackrect<span class="p">,</span><span class="w"> </span>grayframe<span class="p">,</span><span class="w"> </span>grayrect<span class="p">,</span><span class="w"> </span>whiteframe<span class="p">,</span><span class="w"> </span>whiterect<span class="p">,</span><span class="w"> </span>sunken<span class="p">.</span>
<span class="w">			</span>Text<span class="w">    </span><span class="o">-</span><span class="w"> </span>Text<span class="w"> </span>to<span class="w"> </span>set<span class="p">.</span>
<span class="w">			</span>Handler<span class="w"> </span><span class="o">-</span><span class="w"> </span>Notification<span class="w"> </span>function<span class="p">.</span><span class="w"> </span>See<span class="w"> </span>bellow<span class="p">.</span>
<span class="w">			</span>
<span class="w"> </span>Handler<span class="o">:</span>
<span class="w"> </span><span class="o">&gt;</span><span class="w">			</span>OnSplitter<span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span>Event<span class="p">,</span><span class="w"> </span>Pos<span class="p">)</span>
<span class="w">		</span>
<span class="w">			</span>P<span class="w"> </span><span class="o">-</span><span class="w"> </span>Triggered<span class="w"> </span>when<span class="w"> </span>user<span class="w"> </span>changes<span class="w"> </span>the<span class="w"> </span>position<span class="w"> </span>by<span class="w"> </span>dragging<span class="w"> </span>the<span class="w"> </span>splitter<span class="w"> </span>with<span class="w"> </span>mouse<span class="p">.</span>
<span class="w">			</span>D<span class="w"> </span><span class="o">-</span><span class="w"> </span>User<span class="w"> </span>doubleclicked<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>
<span class="w">			</span>R<span class="w"> </span><span class="o">-</span><span class="w"> </span>User<span class="w"> </span>right<span class="w"> </span>clicked<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>

<span class="w"> </span><span class="nl">Returns:</span>
<span class="w">			</span>Splitter<span class="w"> </span>handle<span class="p">.</span>

<span class="w"> </span><span class="nl">Remarks:</span>
<span class="w">			</span>This<span class="w"> </span>function<span class="w"> </span>adds<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>splitter<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>position<span class="p">.</span><span class="w"> </span>User<span class="w"> </span>is<span class="w"> </span>responsible<span class="w"> </span>for<span class="w"> </span>correct<span class="w"> </span>position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>
<span class="w">			</span>Splitter<span class="w"> </span>is<span class="w"> </span>inactive<span class="w"> </span>until<span class="w"> </span>you<span class="w"> </span>call<span class="w"> </span><span class="o">&lt;</span>Set<span class="o">&gt;</span><span class="w"> </span>function<span class="p">.</span>
<span class="w">			</span>When<span class="w"> </span>setting<span class="w"> </span>dimension<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span><span class="nf">splitter</span><span class="w"> </span><span class="p">(</span>width<span class="w"> </span><span class="kr">or</span><span class="w"> </span>height<span class="p">)</span><span class="w"> </span>use<span class="w"> </span>even<span class="w"> </span>numbers<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_Add</span><span class="p">(</span>Opt<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Text<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Handler<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>SS_NOTIFY<span class="o">=</span><span class="mh">0x100</span><span class="p">,</span><span class="w"> </span>SS_CENTER<span class="o">=</span><span class="mh">0x200</span><span class="p">,</span><span class="w"> </span>SS_SUNKEN<span class="o">=</span><span class="mh">0x1000</span><span class="p">,</span><span class="w"> </span>SS_BLACKRECT<span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span>SS_GRAYRECT<span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span>SS_WHITERECT<span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span>SS_BLACKFRAME<span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span>SS_GRAYFRAM<span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span>SS_WHITEFRAME<span class="o">=</span><span class="mi">9</span>

<span class="w">	</span>hStyle<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span><span class="k">loop</span><span class="p">,</span><span class="w"> </span>parse<span class="p">,</span><span class="w"> </span>Opt<span class="p">,</span><span class="w"> </span><span class="nv">%A_Space%</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span>in<span class="w"> </span>blackframe<span class="p">,</span>blackrect<span class="p">,</span>grayframe<span class="p">,</span>grayrect<span class="p">,</span>sunken<span class="p">,</span>whiteframe<span class="p">,</span>whiterect<span class="p">,</span>sunken<span class="p">,</span>center
<span class="w">			</span>hStyle<span class="w"> </span><span class="o">|=</span><span class="w"> </span>SS_<span class="nv">%A_LoopField%</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span>Opt<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="w"> </span><span class="s">&quot; &quot;</span>

<span class="w">	</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>HWNDhSep<span class="w"> </span><span class="o">-</span>hscroll<span class="w"> </span><span class="o">-</span>vscroll<span class="w"> </span><span class="nv">%SS_CENTERIMAGE%</span><span class="w"> </span><span class="nv">%SS_NOTIFY%</span><span class="w"> </span>center<span class="w"> </span><span class="nv">%Opt%</span><span class="w"> </span><span class="nv">%hStyle%</span><span class="p">,</span><span class="w"> </span><span class="nv">%Text%</span><span class="w">	</span>
<span class="w">	</span>hSep<span class="o">+=</span><span class="mi">0</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="nf">IsFunc</span><span class="p">(</span>Handler<span class="p">)</span>
<span class="w">		</span><span class="nf">Splitter</span><span class="p">(</span>hSep<span class="w"> </span><span class="s">&quot;Handler&quot;</span><span class="p">,</span><span class="w"> </span>Handler<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hSep
<span class="p">}</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>Add2Form
<span class="w"> 			</span>Add<span class="w"> </span>Splitter<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>form<span class="p">.</span><span class="w"> </span>

<span class="w"> </span><span class="nl">Options:</span>
<span class="w">			</span>handler<span class="w">	</span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>handler<span class="w"> </span>name<span class="p">.</span>
<span class="w">			</span>extra<span class="w">	</span><span class="o">-</span><span class="w"> </span>Extra<span class="w"> </span>parameters<span class="w"> </span>are<span class="w"> </span>transmited<span class="w"> </span>to<span class="w"> </span><span class="o">&lt;</span>Add<span class="o">&gt;</span><span class="w"> </span>Opt<span class="w"> </span>parameter<span class="p">.</span>
<span class="w"> </span>
<span class="w"> </span>Remarks<span class="o">:</span>
<span class="w">			</span>Function<span class="w"> </span>is<span class="w"> </span>required<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>Forms<span class="w"> </span>framework<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_Add2Form</span><span class="p">(</span>HParent<span class="p">,</span><span class="w"> </span>Txt<span class="p">,</span><span class="w"> </span>Opt<span class="p">){</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>parse<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Form_Parse&quot;</span>
<span class="w">	</span><span class="nv">%parse%</span><span class="p">(</span>Opt<span class="p">,</span><span class="w"> </span><span class="s">&quot;handler&quot;</span><span class="p">,</span><span class="w"> </span>handler<span class="p">,</span><span class="w"> </span>extra<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetParent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hCtrl<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_Add<span class="p">(</span>extra<span class="p">,</span><span class="w"> </span>Txt<span class="p">,</span><span class="w"> </span>handler<span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>HParent<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hCtrl
<span class="p">}</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>GetMax
<span class="w"> 			</span>Returns<span class="w"> </span>maximum<span class="w"> </span>position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>

<span class="w"> </span><span class="nl">Remarks:</span>
<span class="w">			</span>Maximum<span class="w"> </span>position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="w"> </span>will<span class="w"> </span>change<span class="w"> </span><span class="kr">if</span><span class="w"> </span>parent<span class="w"> </span><span class="k">control</span><span class="w"> </span>is<span class="w"> </span>resized<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_GetMax</span><span class="p">(</span>HSep<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="nf">Win_Get</span><span class="p">(</span><span class="w"> </span>Win_Get<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Lwh&quot;</span><span class="p">,</span><span class="w"> </span>plw<span class="p">,</span><span class="w"> </span>plh<span class="p">)</span>
<span class="w">	</span><span class="nf">return</span><span class="w"> </span><span class="p">(</span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>plw<span class="w"> </span><span class="o">:</span><span class="w"> </span>plh<span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter_getSize<span class="p">(</span>HSep<span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;L2&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">Splitter_GetMin</span><span class="p">(</span>HSep<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Splitter</span><span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;L1&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>GetPos
<span class="w"> 			</span>Get<span class="w"> </span>position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>

<span class="w"> </span><span class="nl">Parameters:</span>
<span class="w">			</span>Flag<span class="w">	</span><span class="o">-</span><span class="w"> </span>Set<span class="w"> </span>to<span class="w"> </span><span class="s">&quot;%&quot;</span><span class="w"> </span>to<span class="w"> </span>return<span class="w"> </span>procentage<span class="w"> </span>instead<span class="w"> </span>position<span class="p">.</span>

<span class="w"> </span><span class="nl">Remarks:</span>
<span class="w">			</span>Position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="w"> </span>is<span class="w"> </span>its<span class="w"> </span>x<span class="w"> </span><span class="kr">or</span><span class="w"> </span>y<span class="w"> </span>coordinate<span class="w"> </span>inside<span class="w"> </span>the<span class="w"> </span>parent<span class="w"> </span>window<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_GetPos</span><span class="p">(</span><span class="w"> </span>HSep<span class="p">,</span><span class="w"> </span>Flag<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span>pos<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_GetRect<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;*x&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;*y&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Flag<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">){</span>
<span class="w">		</span>min<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_GetMin<span class="p">(</span>HSep<span class="p">),</span><span class="w"> </span>max<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_GetMax<span class="p">(</span>HSep<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="p">(</span>pos<span class="o">-</span>min<span class="p">)</span><span class="o">/</span><span class="p">(</span>max<span class="o">-</span>min<span class="p">)</span>
<span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span>pos
<span class="p">}</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>GetSize
<span class="w"> 			</span>Get<span class="w"> </span>size<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_GetSize</span><span class="p">(</span>HSep<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="nf">Win_GetRect</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;wh&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Splitter</span><span class="p">(</span><span class="w"> </span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>w<span class="w"> </span><span class="o">:</span><span class="w"> </span>h
<span class="p">}</span>

<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>Set
<span class="w"> 			</span>Initiates<span class="w"> </span>separation<span class="w"> </span>of<span class="w"> </span>controls<span class="p">.</span>
<span class="w"> </span>
<span class="w"> </span>Parameters<span class="o">:</span>
<span class="w"> 			</span>HSep<span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>handle<span class="p">.</span>
<span class="w">			</span>Def<span class="w">	 </span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>definition<span class="w"> </span><span class="kr">or</span><span class="w"> </span>words<span class="w"> </span><span class="s">&quot;off&quot;</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="s">&quot;on&quot;</span><span class="p">.</span><span class="w"> </span>The<span class="w"> </span>syntax<span class="w"> </span>of<span class="w"> </span>splitter<span class="w"> </span>definition<span class="w"> </span>is<span class="w"> </span>given<span class="w"> </span>bellow<span class="p">.</span>
<span class="w">			</span>Pos<span class="w">	 </span><span class="o">-</span><span class="w"> </span>Position<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="w"> </span>to<span class="w"> </span>apply<span class="w"> </span>upon<span class="w"> </span>initialization<span class="w"> </span><span class="p">(</span>optional<span class="p">).</span>
<span class="w">			</span>Limit<span class="w"> </span><span class="o">-</span><span class="w"> </span>Decimal<span class="p">,</span><span class="w"> </span>sets<span class="w"> </span>start<span class="w"> </span><span class="kr">and</span><span class="w"> </span>end<span class="w"> </span>limits<span class="w"> </span>for<span class="w"> </span>splitter<span class="w"> </span>movement<span class="p">.</span><span class="w"> </span>The<span class="w"> </span>minimum<span class="w"> </span><span class="kr">and</span><span class="w"> </span>maximum<span class="w"> </span>splitter<span class="w"> </span>value<span class="w"> </span>will
<span class="w">					</span>be<span class="w"> </span>adjusted<span class="w"> </span>by<span class="w"> </span>this<span class="w"> </span>value<span class="p">.</span><span class="w"> </span>For<span class="w"> </span>instance<span class="p">,</span><span class="w"> </span><span class="mf">.100</span><span class="w"> </span>means<span class="w"> </span>that<span class="w"> </span>maximum<span class="w"> </span>value<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>less<span class="w"> </span>by<span class="w"> </span><span class="mf">100.</span>

<span class="w"> </span>Splitter<span class="w"> </span>Defintion<span class="o">:</span>
<span class="w"> </span><span class="o">&gt;</span><span class="w">		</span>c11<span class="w"> </span>c12<span class="w"> </span>c13<span class="w"> </span><span class="p">...</span><span class="w"> </span>Type<span class="w"> </span>c21<span class="w"> </span>c22<span class="w"> </span>c23<span class="w"> </span><span class="p">...</span>
<span class="w">		</span>
<span class="w">		</span>c1n<span class="w"> </span><span class="o">-</span><span class="w"> </span>Controls<span class="w"> </span>left<span class="w"> </span><span class="kr">or</span><span class="w"> </span>top<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>
<span class="w">		</span>Type<span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>type<span class="o">:</span><span class="w"> </span><span class="s">&quot; | &quot;</span><span class="w"> </span>vertical<span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="s">&quot; - &quot;</span><span class="w"> </span>horizontal<span class="p">.</span>
<span class="w">		</span>c2n<span class="w">	</span><span class="o">-</span><span class="w"> </span>Controls<span class="w"> </span>right<span class="w"> </span><span class="kr">or</span><span class="w"> </span>bottom<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_Set</span><span class="p">(</span><span class="w"> </span>HSep<span class="p">,</span><span class="w"> </span>Def<span class="p">,</span><span class="w"> </span>Pos<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Limit<span class="o">=</span><span class="mf">0.0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">static</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>Def<span class="o">=</span>off
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nf">Win_subclass</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>old<span class="p">)</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>Def<span class="o">=</span>on
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nf">Win_subclass</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>wndProc<span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>InStr<span class="p">(</span>Def<span class="p">,</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">Splitter</span><span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">,</span><span class="w"> </span>bVert<span class="p">)</span>

<span class="w">	</span>old<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_subclass<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>wnadProc<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Splitter_wndProc&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>wndProc<span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>wndProc<span class="p">)</span>

<span class="w">	</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>L<span class="p">,</span><span class="w"> </span>Limit<span class="p">,</span><span class="w"> </span><span class="p">.</span>
<span class="w">	</span><span class="nf">Splitter</span><span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;Def&quot;</span><span class="p">,</span><span class="w"> </span>Def<span class="p">),</span><span class="w">  </span><span class="nf">Splitter</span><span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;L1&quot;</span><span class="p">,</span><span class="w"> </span>L1<span class="p">),</span><span class="w">  </span><span class="nf">Splitter</span><span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;L2&quot;</span><span class="p">,</span><span class="w"> </span>L2<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> 	</span><span class="nf">Splitter_SetPos</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>Pos<span class="p">)</span>
<span class="p">}</span>
<span class="o">/*</span>
<span class="w"> </span>Function<span class="o">:</span><span class="w">	</span>SetPos
<span class="w">			</span>Set<span class="w"> </span>splitter<span class="w"> </span>position<span class="p">.</span>
<span class="w"> </span>
<span class="w"> </span>Parameters<span class="o">:</span>
<span class="w">   			</span>HSep<span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter<span class="w"> </span>handle<span class="p">.</span>
<span class="w">			</span>Pos<span class="w">	 </span><span class="o">-</span><span class="w"> </span>Position<span class="w"> </span>to<span class="w"> </span>set<span class="p">.</span><span class="w"> </span>Position<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>client<span class="w"> </span>x<span class="o">/</span>y<span class="w"> </span>coordinate<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>splitter<span class="w"> </span>control<span class="p">.</span><span class="w"> </span>
<span class="w">				   </span><span class="kr">If</span><span class="w"> </span>followed<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>sign<span class="w"> </span><span class="o">%</span><span class="p">,</span><span class="w"> </span>position<span class="w"> </span>is<span class="w"> </span>set<span class="w"> </span>using<span class="w"> </span>procentage<span class="w"> </span>of<span class="w"> </span>splitter<span class="w"> </span>range<span class="p">.</span><span class="w"> </span>
<span class="w">				   </span><span class="kr">If</span><span class="w"> </span>Pos<span class="w"> </span>is<span class="w"> </span>empty<span class="p">,</span><span class="w"> </span>function<span class="w"> </span>returns<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>action<span class="p">.</span><span class="w"> </span>

<span class="w"> </span><span class="nl">Remarks:</span>
<span class="w">			</span>Due<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>rounding<span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span>you<span class="w"> </span>set<span class="w"> </span>position<span class="w"> </span>using<span class="w"> </span>procentage<span class="p">,</span><span class="w"> </span>actuall<span class="w"> </span>position<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>slightly<span class="w"> </span>different<span class="p">.</span>
<span class="w">			</span>You<span class="w"> </span>can<span class="w"> </span>find<span class="w"> </span>out<span class="w"> </span>what<span class="w"> </span>is<span class="w"> </span>exact<span class="w"> </span>position<span class="w"> </span>set<span class="w"> </span><span class="kr">if</span><span class="w"> </span>you<span class="w"> </span>use<span class="w"> </span><span class="o">&lt;</span>GetPos<span class="o">&gt;</span><span class="w"> </span>with<span class="w"> </span>Flag<span class="w"> </span>set<span class="w"> </span>to<span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="nf">Splitter_SetPos</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>Pos<span class="p">,</span><span class="w"> </span>bInternal<span class="o">=</span>false<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span>ifEqual<span class="p">,</span><span class="w"> </span>Pos<span class="p">,,</span><span class="w"> </span><span class="k">return</span>
<span class="w">	</span>min<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_GetMin<span class="p">(</span>HSep<span class="p">),</span><span class="w"> </span>max<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_GetMax<span class="p">(</span>HSep<span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="nf">SubStr</span><span class="p">(</span>Pos<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;%&quot;</span>
<span class="w">		</span>Pos<span class="w"> </span><span class="o">:=</span><span class="w"> </span>min<span class="w"> </span><span class="o">+</span><span class="w"> </span>SubStr<span class="p">(</span>Pos<span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>max<span class="o">-</span>min<span class="p">)</span><span class="o">//</span><span class="mi">100</span>

<span class="w">	</span>bVert<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">),</span><span class="w">  </span>Def<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;Def&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="k">ifLess</span><span class="p">,</span><span class="w"> </span>Pos<span class="p">,</span><span class="w"> </span><span class="nv">%min%</span><span class="p">,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>Pos<span class="p">,</span><span class="w"> </span><span class="nv">%min%</span>
<span class="w">	</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>s<span class="p">,</span><span class="w"> </span>Def<span class="p">,</span><span class="w"> </span><span class="nv">%A_Space%</span>

<span class="w">	</span>Delta<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Pos<span class="w"> </span><span class="o">-</span><span class="w"> </span>Splitter_GetPos<span class="p">(</span>HSep<span class="p">)</span>
<span class="w">	</span>v<span class="w"> </span><span class="o">:=</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span>Delta<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w">  </span>h<span class="w"> </span><span class="o">:=</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Delta
<span class="w">	</span><span class="k">loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%s0%</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>s<span class="w"> </span><span class="o">:=</span><span class="w"> </span>s<span class="nv">%A_Index%</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>otherSide
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="nf">Win_MoveDelta</span><span class="p">(</span>s<span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>v<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">			</span><span class="kr">if</span><span class="w"> </span>s<span class="w"> </span>in<span class="w"> </span><span class="o">|</span><span class="p">,</span><span class="o">-</span>
<span class="w">				</span>otherSide<span class="w"> </span><span class="o">:=</span><span class="w"> </span>true<span class="p">,</span><span class="w"> </span>Win_MoveDelta<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span>v<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> 	</span><span class="nf">Win_MoveDelta</span><span class="p">(</span>s<span class="p">,</span><span class="w"> </span>v<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="o">-</span>v<span class="p">,</span><span class="w"> </span><span class="o">-</span>h<span class="p">)</span>
<span class="w">	</span><span class="p">}</span><span class="w">		</span>
<span class="w">					</span>
<span class="w">	</span><span class="nf">Win_Redraw</span><span class="p">(</span><span class="w"> </span>Win_Get<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">						</span><span class="c1">;redrawing imediate parent was not that good.</span>
<span class="w">	</span><span class="nf">IsFunc</span><span class="p">(</span>f<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Attach&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nv">%f%</span><span class="p">(</span><span class="w"> </span>Win_Get<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">	</span><span class="c1">;reset attach for parent of HSep</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>handler<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span>HSep<span class="w"> </span><span class="s">&quot;Handler&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>bInternal
<span class="w">		</span><span class="nv">%handler%</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">Splitter_GetPos</span><span class="p">(</span>HSep<span class="p">))</span>
<span class="p">}</span>

<span class="c1">;=============================================== PRIVATE ===============================================</span>

<span class="nf">Splitter_wndProc</span><span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span>UMsg<span class="p">,</span><span class="w"> </span>WParam<span class="p">,</span><span class="w"> </span>LParam<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">	</span>
<span class="w">	</span><span class="kt">static</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>WM_SETCURSOR<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span>WM_MOUSEMOVE<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x200</span><span class="p">,</span><span class="w"> </span>WM_LBUTTONDOWN<span class="o">=</span><span class="mh">0x201</span><span class="p">,</span><span class="w"> </span>WM_LBUTTONUP<span class="o">=</span><span class="mh">0x202</span><span class="p">,</span><span class="w"> </span>WM_LBUTTONDBLCLK<span class="o">=</span><span class="mi">515</span><span class="p">,</span><span class="w"> </span>WM_RBUTTONUP<span class="o">=</span><span class="mi">517</span><span class="p">,</span><span class="w"> </span>SIZENS<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">32645</span><span class="p">,</span><span class="w"> </span>SIZEWE<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">32644</span>

<span class="w">	</span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>UMsg<span class="w"> </span><span class="o">=</span><span class="w"> </span>WM_SETCURSOR<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<span class="w">	</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>UMsg<span class="w"> </span><span class="o">=</span><span class="w"> </span>WM_MOUSEMOVE<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nv">%Hwnd%</span>_cursor
<span class="w">			</span><span class="nv">%Hwnd%</span>_bVert<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span>Hwnd<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="p">),</span><span class="w"> </span><span class="nv">%Hwnd%</span>_cursor<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;LoadCursor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>_bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span>SIZEWE<span class="w"> </span><span class="o">:</span><span class="w"> </span>SIZENS<span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">)</span>

<span class="w">		</span><span class="k">critical</span><span class="w"> 	</span><span class="c1">;safe, always in new thread.</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>_cursor<span class="p">)</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>moving<span class="w"> </span>
<span class="w">			</span><span class="nf">Splitter_updateFocus</span><span class="p">(</span>Hwnd<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>UMsg<span class="w"> </span><span class="o">=</span><span class="w"> </span>WM_LBUTTONDOWN<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetCapture&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Hwnd<span class="p">),</span><span class="w">  </span>parent<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetParent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Hwnd<span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetWindowRect&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>parent<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RECT<span class="p">)</span>

<span class="w">		</span>sz<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_GetRect<span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>_bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;h&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span>
<span class="w">		</span>ch<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_Get<span class="p">(</span>parent<span class="p">,</span><span class="w"> </span><span class="s">&quot;Nh&quot;</span><span class="w"> </span><span class="p">)</span><span class="w">			</span><span class="c1">;get caption size of parent window</span>

<span class="w">	  </span><span class="c1">;prevent user from going offscreen with separator</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span><span class="w"> </span>NumGet<span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>sz<span class="o">-</span><span class="mi">1</span><span class="w">	</span><span class="p">,</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span><span class="w"> </span>NumGet<span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>sz<span class="o">+</span>ch<span class="w"> </span><span class="p">,</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span><span class="w"> </span>NumGet<span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>sz<span class="o">+</span><span class="mi">4</span><span class="w"> 	</span><span class="p">,</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span><span class="w"> </span>NumGet<span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="o">-</span><span class="w"> </span>sz<span class="o">+</span><span class="mi">4</span><span class="w">	</span><span class="p">,</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span>
<span class="w">				</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RECT<span class="p">),</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">%Hwnd%</span>_cursor<span class="p">)</span>
<span class="w">		</span>moving<span class="w"> </span><span class="o">:=</span><span class="w"> </span>true
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>UMsg<span class="w"> </span><span class="o">=</span><span class="w"> </span>WM_LBUTTONUP<span class="p">){</span>
<span class="w">		</span>moving<span class="w"> </span><span class="o">:=</span><span class="w"> </span>false
<span class="w">	</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">  </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseCapture&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nf">Splitter_SetPos</span><span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span>Splitter_updateFocus<span class="p">(),</span><span class="w"> </span>true<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>UMsg<span class="w"> </span>in<span class="w"> </span><span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span><span class="nv">%WM_RBUTTONUP%</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>handler<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span>Hwnd<span class="w"> </span><span class="s">&quot;Handler&quot;</span><span class="p">)</span>
<span class="w">		</span>ifEqual<span class="p">,</span><span class="w"> </span>handler<span class="p">,,</span><span class="k">return</span>

<span class="w">		</span>ifEqual<span class="p">,</span><span class="w"> </span>UMsg<span class="p">,</span><span class="w"> </span><span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>Event<span class="p">,</span><span class="w"> </span>D
<span class="w">		</span><span class="k">else</span><span class="w"> </span>ifEqual<span class="p">,</span><span class="w"> </span>UMsg<span class="p">,</span><span class="w"> </span><span class="nv">%WM_RBUTTONUP%</span><span class="p">,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>Event<span class="p">,</span><span class="w"> </span>R
<span class="w">			</span>
<span class="w">		</span><span class="nv">%handler%</span><span class="p">(</span>Hwnd<span class="p">,</span><span class="w"> </span>Event<span class="p">,</span><span class="w"> </span><span class="nf">Splitter_GetPos</span><span class="p">(</span>Hwnd<span class="p">))</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CallWindowProc&quot;</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nb">A_EventInfo</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span>hwnd<span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span>uMsg<span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span>wParam<span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span>lParam<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;Updates focus rectangle while mouse is moving. </span>
<span class="c1">;If called without arguments it returns latest focus rectangle position.</span>
<span class="nf">Splitter_updateFocus</span><span class="p">(</span><span class="w"> </span>HSep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">static</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>HSep
<span class="w">		</span><span class="k">return</span><span class="w"> </span>pos<span class="w"> </span><span class="o">-</span><span class="w"> </span>offset<span class="p">,</span><span class="w"> </span>dc<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span>
<span class="w">	</span><span class="k">MouseGetPos</span><span class="p">,</span><span class="w"> </span>mx<span class="p">,</span><span class="w"> </span>my
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>dc<span class="w"> </span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>ifEqual<span class="p">,</span><span class="w"> </span>adrDrawFocusRect<span class="p">,,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>adrDrawFocusRect<span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span><span class="w"> </span>uint<span class="p">,</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span>str<span class="p">,</span><span class="w"> </span><span class="s">&quot;user32&quot;</span><span class="p">),</span><span class="w"> </span>str<span class="p">,</span><span class="w"> </span><span class="s">&quot;DrawFocusRect&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">CoordMode</span><span class="p">,</span><span class="w"> </span>mouse<span class="p">,</span><span class="w"> </span>relative

<span class="w">	  </span><span class="c1">;initialize dc, RECT, idx, delta(distance between mouse and splitter position), sz, pos &amp; max when user starts moving.</span>
<span class="w">		</span>dc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_Get<span class="p">(</span><span class="w"> </span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;0D&quot;</span><span class="p">)</span><span class="w">		</span><span class="c1">; take root DC, for some reason it doesn&#39;t work good on parent&#39;s DC</span>

<span class="w">		</span><span class="nf">Win_GetRect</span><span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;!xywh&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span>sw<span class="p">,</span><span class="w"> </span>sh<span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>sx<span class="p">,</span><span class="w"> </span>RECT<span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>sy<span class="p">,</span><span class="w"> </span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>sx<span class="o">+</span>sw<span class="p">,</span><span class="w"> </span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">),</span><span class="w"> </span>NumPut<span class="p">(</span>sy<span class="o">+</span>sh<span class="p">,</span><span class="w"> </span>RECT<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span>sz<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sh
<span class="w">		</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter<span class="p">(</span><span class="w"> </span>HSep<span class="w"> </span><span class="s">&quot;bVert&quot;</span><span class="w"> </span><span class="p">)</span>
<span class="w">			 </span>idx<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">   </span>delta<span class="w"> </span><span class="o">:=</span><span class="w"> </span>mx<span class="o">-</span>sx<span class="p">,</span><span class="w">   </span>sz<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sw
<span class="w">		</span><span class="k">else</span><span class="w"> </span>idx<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">   </span>delta<span class="w"> </span><span class="o">:=</span><span class="w"> </span>my<span class="o">-</span>sy<span class="p">,</span><span class="w">   </span>sz<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sh

<span class="w">      </span><span class="c1">;if in Panel, there will be offset to mouse movement according to its position.</span>
<span class="w">		</span>parent<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Win_Get<span class="p">(</span>HSep<span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">WinGetClass</span><span class="p">,</span><span class="w"> </span>cls<span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%parent%</span>
<span class="w">		</span>offset<span class="w"> </span><span class="o">:=</span><span class="w">  </span>cls<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;Panel&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Win_GetRect<span class="p">(</span><span class="w"> </span>parent<span class="p">,</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;!x&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;!y&quot;</span><span class="p">)</span>

<span class="w">		</span>pos<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_GetPos<span class="p">(</span>HSep<span class="p">),</span><span class="w">  </span>
<span class="w">		</span>max<span class="w"> </span><span class="o">:=</span><span class="w"> </span>offset<span class="w"> </span><span class="o">+</span><span class="w"> </span>Splitter_getMax<span class="p">(</span>HSep<span class="p">),</span><span class="w">	 </span>min<span class="w"> </span><span class="o">:=</span><span class="w"> </span>offset<span class="w"> </span><span class="o">+</span><span class="w"> </span>Splitter_getMin<span class="p">(</span>HSep<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span>adrDrawFocusRect<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>dc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RECT<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span>pos<span class="w"> </span><span class="o">:=</span><span class="w"> </span>bVert<span class="w"> </span><span class="o">?</span><span class="w"> </span>mx<span class="o">-</span>delta<span class="w"> </span><span class="o">:</span><span class="w"> </span>my<span class="o">-</span>delta
<span class="w">	</span><span class="k">ifLess</span><span class="p">,</span><span class="w"> </span>pos<span class="p">,</span><span class="w"> </span><span class="nv">%min%</span><span class="p">,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>pos<span class="p">,</span><span class="w"> </span><span class="nv">%min%</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">ifGreater</span><span class="p">,</span><span class="w"> </span>pos<span class="p">,</span><span class="w"> </span><span class="nv">%max%</span><span class="p">,</span><span class="w"> </span><span class="k">SetEnv</span><span class="p">,</span><span class="w"> </span>pos<span class="p">,</span><span class="w"> </span><span class="nv">%max%</span>

<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span>adrDrawFocusRect<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>dc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RECT<span class="p">)</span>
<span class="w">	</span><span class="nf">NumPut</span><span class="p">(</span>pos<span class="p">,</span><span class="w"> </span>RECT<span class="p">,</span><span class="w"> </span>idx<span class="p">),</span><span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>pos<span class="o">+</span>sz<span class="p">,</span><span class="w"> </span>RECT<span class="p">,</span><span class="w"> </span>idx<span class="o">+</span><span class="mi">8</span><span class="p">),</span><span class="w">  </span>DllCall<span class="p">(</span>adrDrawFocusRect<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>dc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RECT<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;storage</span>
<span class="nf">Splitter</span><span class="p">(</span>Var<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Value<span class="o">=</span><span class="s">&quot;~</span><span class="se">`a</span><span class="s"> &quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o1<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o2<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o3<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o4<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o5<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>o6<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="kt">static</span>
<span class="w">	</span>_<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%var%</span>
<span class="w">	</span><span class="k">ifNotEqual</span><span class="p">,</span><span class="w"> </span>value<span class="p">,</span><span class="o">~</span><span class="p">`</span>a<span class="err"> </span><span class="p">,</span><span class="w"> </span>SetEnv<span class="p">,</span><span class="w"> </span><span class="nv">%var%</span><span class="p">,</span><span class="w"> </span><span class="nv">%value%</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>_
<span class="p">}</span>

<span class="k">#include </span><span class="o">*</span>i<span class="w"> </span>Win<span class="p">.</span>ahk

<span class="o">/*</span><span class="w"> </span>Group<span class="o">:</span><span class="w"> </span>Examples
<span class="w"> </span><span class="p">(</span>start<span class="w"> </span>code<span class="p">)</span>
<span class="w">		</span>w<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span>h<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w"> </span>sep<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">		</span>w1<span class="w"> </span><span class="o">:=</span><span class="w"> </span>w<span class="o">//</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span>w2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>w<span class="o">-</span>w1<span class="w"> </span><span class="p">,</span><span class="w"> </span>h1<span class="w"> </span><span class="o">:=</span><span class="w"> </span>h<span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span>h2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>h<span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">3</span>

<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Margin<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>Edit<span class="p">,</span><span class="w"> </span>HWNDc11<span class="w"> </span>w<span class="nv">%w1%</span><span class="w"> </span>h<span class="nv">%h1%</span>
<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>Edit<span class="p">,</span><span class="w"> </span>HWNDc12<span class="w"> </span>w<span class="nv">%w1%</span><span class="w"> </span>h<span class="nv">%h1%</span>
<span class="w">		</span>hSepV<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Splitter_Add<span class="p">(</span><span class="w"> </span><span class="s">&quot;x+0 y0 h&quot;</span><span class="w"> </span>h<span class="w"> </span><span class="s">&quot; w&quot;</span><span class="w"> </span>sep<span class="w"> </span><span class="p">)</span>
<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>Monthcal<span class="p">,</span><span class="w"> </span>HWNDc21<span class="w"> </span>w<span class="nv">%w2%</span><span class="w"> </span>h<span class="nv">%h2%</span><span class="w"> </span>x<span class="o">+</span><span class="mi">0</span>
<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>ListView<span class="p">,</span><span class="w"> </span>HWNDc22<span class="w"> </span>w<span class="nv">%w2%</span><span class="w"> </span>h<span class="nv">%h2%</span><span class="p">,</span><span class="w"> </span>c1<span class="o">|</span>c2<span class="o">|</span>c3
<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>Add<span class="p">,</span><span class="w"> </span>ListBox<span class="p">,</span><span class="w">  </span>HWNDc23<span class="w"> </span>w<span class="nv">%w2%</span><span class="w"> </span>h<span class="nv">%h2%</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">|</span><span class="mi">2</span><span class="o">|</span><span class="mi">3</span>

<span class="w">		</span><span class="n">sdef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">%c11%</span><span class="w"> </span><span class="nv">%c12%</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">%c21%</span><span class="w"> </span><span class="nv">%c22%</span><span class="w"> </span><span class="nv">%c23%</span><span class="w">			</span><span class="c1">;vertical splitter.</span>
<span class="w">		</span><span class="nf">Splitter_Set</span><span class="p">(</span><span class="w"> </span>hSepV<span class="p">,</span><span class="w"> </span>sdef<span class="w"> </span><span class="p">)</span>

<span class="w">		</span><span class="k">Gui</span><span class="p">,</span><span class="w"> </span>show<span class="p">,</span><span class="w"> </span>w<span class="nv">%w%</span><span class="w"> </span>h<span class="nv">%h%</span><span class="w">	</span>
<span class="w">	</span><span class="nf">return</span><span class="w"></span>
<span class="w"> </span><span class="p">(</span>end<span class="w"> </span>code<span class="p">)</span>
<span class="w"> </span><span class="o">*/</span>

<span class="o">/*</span><span class="w"> </span>Group<span class="o">:</span><span class="w"> </span>About
<span class="w">	</span>o<span class="w"> </span>Ver<span class="w"> </span><span class="mf">1.6</span><span class="w"> </span>by<span class="w"> </span>majkinetor<span class="p">.</span>
<span class="w">	</span>o<span class="w"> </span>Licenced<span class="w"> </span>under<span class="w"> </span>BSD<span class="w"> </span><span class="o">&lt;</span>http<span class="o">://</span>creativecommons<span class="p">.</span>org<span class="o">/</span>licenses<span class="o">/</span>BSD<span class="o">/&gt;</span><span class="p">.</span>
<span class="w"> </span><span class="o">*/</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="cm">/* Title:    Splitter</span>
<span class="cm">			 Splitter control.</span>

<span class="cm">			 (see splitter.png)</span>

<span class="cm">			 Splitter is control that is created between controls that need to have dynamic separation.</span>
<span class="cm">			 To use it, you first need to create the splitter (&lt;Add&gt;), then you have to activate it when all controls</span>
<span class="cm">			 that it separates are created (&lt;Set&gt;).</span>
<span class="cm">			 You can set splitter position with &lt;SetPos&gt; and obtain it with &lt;GetPos&gt;. </span>
<span class="cm">			 You can also limit splitter movement with &lt;Limit&gt; function if you don&#39;t want controls it separates to be set completely invisible by the user.</span>
<span class="cm">			 </span>
<span class="cm"> Dependency:</span>
<span class="cm">			&lt;Win&gt; 1.24</span>

<span class="cm"> Effects:	</span>
<span class="cm">			- While user moves splitter, CoordMode of mouse is always returned to relative.</span>
<span class="cm">			- Upon movement, splitter will reset &lt;Attach&gt; for the parent, if present.			</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Add</span>
<span class="cm"> 			Add new Splitter.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			Opt	    - Splitter Gui options. Splitter is subclassed Text control (Static), so it accepts any Text options.</span>
<span class="cm">					plus one the following: blackframe, blackrect, grayframe, grayrect, whiteframe, whiterect, sunken.</span>
<span class="cm">			Text    - Text to set.</span>
<span class="cm">			Handler - Notification function. See bellow.</span>
<span class="cm">			</span>
<span class="cm"> Handler:</span>
<span class="cm"> &gt;			OnSplitter(Hwnd, Event, Pos)</span>
<span class="cm">		</span>
<span class="cm">			P - Triggered when user changes the position by dragging the splitter with mouse.</span>
<span class="cm">			D - User doubleclicked the splitter.</span>
<span class="cm">			R - User right clicked the splitter.</span>

<span class="cm"> Returns:</span>
<span class="cm">			Splitter handle.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			This function adds a new splitter on the given position. User is responsible for correct position of the splitter.</span>
<span class="cm">			Splitter is inactive until you call &lt;Set&gt; function.</span>
<span class="cm">			When setting dimension of the splitter (width or height) use even numbers.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Add</span><span class="p">(</span><span class="n">Opt</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">SS_NOTIFY</span><span class="o">=</span><span class="mh">0x100</span><span class="p">,</span> <span class="n">SS_CENTER</span><span class="o">=</span><span class="mh">0x200</span><span class="p">,</span> <span class="n">SS_SUNKEN</span><span class="o">=</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">SS_BLACKRECT</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">SS_GRAYRECT</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">SS_WHITERECT</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">SS_BLACKFRAME</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">SS_GRAYFRAM</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">SS_WHITEFRAME</span><span class="o">=</span><span class="mi">9</span>

	<span class="n">hStyle</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="n">parse</span><span class="p">,</span> <span class="n">Opt</span><span class="p">,</span> <span class="nv">%A_Space%</span>
<span class="w">		</span><span class="nb">if </span><span class="nv">A_LoopField</span> <span class="ow">in</span> <span class="n">blackframe</span><span class="p">,</span><span class="n">blackrect</span><span class="p">,</span><span class="n">grayframe</span><span class="p">,</span><span class="n">grayrect</span><span class="p">,</span><span class="n">sunken</span><span class="p">,</span><span class="n">whiteframe</span><span class="p">,</span><span class="n">whiterect</span><span class="p">,</span><span class="n">sunken</span><span class="p">,</span><span class="n">center</span>
			<span class="n">hStyle</span> <span class="o">|=</span> <span class="n">SS_</span><span class="nv">%A_LoopField%</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">Opt</span> <span class="o">.=</span> <span class="nv">A_LoopField</span> <span class="s">&quot; &quot;</span>

<span class="w">	</span><span class="nb">Gui</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">HWNDhSep</span> <span class="o">-</span><span class="n">hscroll</span> <span class="o">-</span><span class="n">vscroll</span> <span class="nv">%SS_CENTERIMAGE%</span> <span class="nv">%SS_NOTIFY%</span> <span class="n">center</span> <span class="nv">%Opt%</span> <span class="nv">%hStyle%</span><span class="p">,</span> <span class="nv">%Text%</span>	
	<span class="n">hSep</span><span class="o">+=</span><span class="mi">0</span>
<span class="w">	</span><span class="nb">if </span><span class="nf">IsFunc</span><span class="p">(</span><span class="n">Handler</span><span class="p">)</span>
		<span class="n">Splitter</span><span class="p">(</span><span class="n">hSep</span> <span class="s">&quot;Handler&quot;</span><span class="p">,</span> <span class="n">Handler</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hSep</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Add2Form</span>
<span class="cm"> 			Add Splitter into the form. </span>

<span class="cm"> Options:</span>
<span class="cm">			handler	- Splitter handler name.</span>
<span class="cm">			extra	- Extra parameters are transmited to &lt;Add&gt; Opt parameter.</span>
<span class="cm"> </span>
<span class="cm"> Remarks:</span>
<span class="cm">			Function is required by the Forms framework.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Add2Form</span><span class="p">(</span><span class="n">HParent</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">Opt</span><span class="p">){</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">parse</span> <span class="o">=</span> <span class="s">&quot;Form_Parse&quot;</span>
	<span class="nv">%parse%</span><span class="p">(</span><span class="n">Opt</span><span class="p">,</span> <span class="s">&quot;handler&quot;</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">extra</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetParent&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hCtrl</span> <span class="o">:=</span> <span class="n">Splitter_Add</span><span class="p">(</span><span class="n">extra</span><span class="p">,</span> <span class="n">Txt</span><span class="p">,</span> <span class="n">handler</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">HParent</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hCtrl</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetMax</span>
<span class="cm"> 			Returns maximum position of the splitter.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			Maximum position of the splitter will change if parent control is resized.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Win_Get</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="s">&quot;Lwh&quot;</span><span class="p">,</span> <span class="n">plw</span><span class="p">,</span> <span class="n">plh</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="p">(</span><span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">plw</span> <span class="o">:</span> <span class="n">plh</span><span class="p">)</span> <span class="o">-</span> <span class="n">Splitter_getSize</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="o">-</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L2&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L1&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetPos</span>
<span class="cm"> 			Get position of the splitter.</span>

<span class="cm"> Parameters:</span>
<span class="cm">			Flag	- Set to &quot;%&quot; to return procentage instead position.</span>

<span class="cm"> Remarks:</span>
<span class="cm">			Position of the splitter is its x or y coordinate inside the parent window.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetPos</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="n">Flag</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span>
	<span class="n">pos</span> <span class="o">:=</span> <span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;*x&quot;</span> <span class="o">:</span> <span class="s">&quot;*y&quot;</span><span class="p">)</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Flag</span> <span class="o">=</span> <span class="s">&quot;%&quot;</span><span class="p">){</span>
		<span class="n">min</span> <span class="o">:=</span> <span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span> <span class="n">max</span> <span class="o">:=</span> <span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="n">min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max</span><span class="o">-</span><span class="n">min</span><span class="p">)</span>
	<span class="p">}</span> <span class="n">else</span> <span class="n">return</span> <span class="n">pos</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	GetSize</span>
<span class="cm"> 			Get size of the splitter.</span>
<span class="cm"> */</span>
<span class="n">Splitter_GetSize</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;wh&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Splitter</span><span class="p">(</span> <span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">w</span> <span class="o">:</span> <span class="n">h</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> Function:	Set</span>
<span class="cm"> 			Initiates separation of controls.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm"> 			HSep - Splitter handle.</span>
<span class="cm">			Def	 - Splitter definition or words &quot;off&quot; or &quot;on&quot;. The syntax of splitter definition is given bellow.</span>
<span class="cm">			Pos	 - Position of the splitter to apply upon initialization (optional).</span>
<span class="cm">			Limit - Decimal, sets start and end limits for splitter movement. The minimum and maximum splitter value will</span>
<span class="cm">					be adjusted by this value. For instance, .100 means that maximum value will be less by 100.</span>

<span class="cm"> Splitter Defintion:</span>
<span class="cm"> &gt;		c11 c12 c13 ... Type c21 c22 c23 ...</span>
<span class="cm">		</span>
<span class="cm">		c1n - Controls left or top of the splitter.</span>
<span class="cm">		Type - Splitter type: &quot; | &quot; vertical or &quot; - &quot; horizontal.</span>
<span class="cm">		c2n	- Controls right or bottom of the splitter.</span>
<span class="cm"> */</span>
<span class="n">Splitter_Set</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="n">Def</span><span class="p">,</span> <span class="n">Pos</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Limit</span><span class="o">=</span><span class="mf">0.0</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>

<span class="w">	</span><span class="nb">if </span><span class="n">Def</span><span class="o">=</span><span class="n">off</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="n">Def</span><span class="o">=</span><span class="n">on</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="n">bVert</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">InStr</span><span class="p">(</span><span class="n">Def</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">,</span> <span class="n">bVert</span><span class="p">)</span>

	<span class="n">old</span> <span class="o">:=</span> <span class="n">Win_subclass</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">wnadProc</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">?</span> <span class="s">&quot;Splitter_wndProc&quot;</span> <span class="o">:</span> <span class="n">wndProc</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">wndProc</span><span class="p">)</span>

<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Limit</span><span class="p">,</span> <span class="o">.</span>
	<span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Def&quot;</span><span class="p">,</span> <span class="n">Def</span><span class="p">),</span>  <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L1&quot;</span><span class="p">,</span> <span class="n">L1</span><span class="p">),</span>  <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;L2&quot;</span><span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> 	<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Pos</span><span class="p">)</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> Function:	SetPos</span>
<span class="cm">			Set splitter position.</span>
<span class="cm"> </span>
<span class="cm"> Parameters:</span>
<span class="cm">   			HSep - Splitter handle.</span>
<span class="cm">			Pos	 - Position to set. Position is the client x/y coordinate of the splitter control. </span>
<span class="cm">				   If followed by the sign %, position is set using procentage of splitter range. </span>
<span class="cm">				   If Pos is empty, function returns without any action. </span>

<span class="cm"> Remarks:</span>
<span class="cm">			Due to the rounding, if you set position using procentage, actuall position may be slightly different.</span>
<span class="cm">			You can find out what is exact position set if you use &lt;GetPos&gt; with Flag set to &quot;%&quot;.</span>
<span class="cm"> */</span>
<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="n">bInternal</span><span class="o">=</span><span class="nv">false</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,,</span> <span class="n">return</span>
	<span class="n">min</span> <span class="o">:=</span> <span class="n">Splitter_GetMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span> <span class="n">max</span> <span class="o">:=</span> <span class="n">Splitter_GetMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="nf">SubStr</span><span class="p">(</span><span class="n">Pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;%&quot;</span>
		<span class="n">Pos</span> <span class="o">:=</span> <span class="n">min</span> <span class="o">+</span> <span class="nf">SubStr</span><span class="p">(</span><span class="n">Pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">max</span><span class="o">-</span><span class="n">min</span><span class="p">)</span><span class="o">//</span><span class="mi">100</span>

	<span class="n">bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span><span class="p">),</span>  <span class="n">Def</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Def&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="nb">ifLess</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%min%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Pos</span><span class="p">,</span> <span class="nv">%min%</span>
<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Def</span><span class="p">,</span> <span class="nv">%A_Space%</span>

	<span class="n">Delta</span> <span class="o">:=</span> <span class="n">Pos</span> <span class="o">-</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="n">Delta</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>  <span class="n">h</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="o">:</span> <span class="n">Delta</span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span> <span class="nv">%s0%</span>
	<span class="p">{</span>
		<span class="n">s</span> <span class="o">:=</span> <span class="n">s</span><span class="nv">%A_Index%</span>
		<span class="n">if</span> <span class="o">!</span><span class="n">otherSide</span>
		<span class="p">{</span>
			<span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="w">			</span><span class="nb">if </span><span class="n">s</span> <span class="ow">in</span> <span class="o">|</span><span class="p">,</span><span class="o">-</span>
				<span class="n">otherSide</span> <span class="o">:=</span> <span class="nv">true</span><span class="p">,</span> <span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
		<span class="p">}</span> <span class="n">else</span> 	<span class="n">Win_MoveDelta</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span><span class="p">)</span>
	<span class="p">}</span>		
					
	<span class="n">Win_Redraw</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">)</span> <span class="p">)</span><span class="c-Singleline">						;redrawing imediate parent was not that good.</span>
	<span class="nf">IsFunc</span><span class="p">(</span><span class="n">f</span> <span class="o">:=</span> <span class="s">&quot;Attach&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">%f%</span><span class="p">(</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="c-Singleline">	;reset attach for parent of HSep</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">handler</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">HSep</span> <span class="s">&quot;Handler&quot;</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="n">bInternal</span>
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">,</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">))</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;=============================================== PRIVATE ===============================================</span>

<span class="n">Splitter_wndProc</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="n">WParam</span><span class="p">,</span> <span class="n">LParam</span><span class="p">)</span> <span class="p">{</span>	
<span class="w">	</span><span class="nb">static</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">WM_SETCURSOR</span> <span class="o">:=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="n">WM_MOUSEMOVE</span> <span class="o">:=</span> <span class="mh">0x200</span><span class="p">,</span> <span class="n">WM_LBUTTONDOWN</span><span class="o">=</span><span class="mh">0x201</span><span class="p">,</span> <span class="n">WM_LBUTTONUP</span><span class="o">=</span><span class="mh">0x202</span><span class="p">,</span> <span class="n">WM_LBUTTONDBLCLK</span><span class="o">=</span><span class="mi">515</span><span class="p">,</span> <span class="n">WM_RBUTTONUP</span><span class="o">=</span><span class="mi">517</span><span class="p">,</span> <span class="n">SIZENS</span> <span class="o">:=</span> <span class="mi">32645</span><span class="p">,</span> <span class="n">SIZEWE</span> <span class="o">:=</span> <span class="mi">32644</span>

	<span class="n">If</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_SETCURSOR</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="mi">1</span> 
	
	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_MOUSEMOVE</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">if</span> <span class="o">!</span><span class="nv">%Hwnd%</span><span class="n">_cursor</span>
			<span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">Hwnd</span> <span class="s">&quot;bVert&quot;</span><span class="p">),</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;LoadCursor&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">?</span> <span class="n">SIZEWE</span> <span class="o">:</span> <span class="n">SIZENS</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>

<span class="w">		</span><span class="nb">critical</span><span class="c-Singleline"> 	;safe, always in new thread.</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span><span class="p">)</span>
<span class="w">		</span><span class="nb">if </span><span class="n">moving</span> 
			<span class="n">Splitter_updateFocus</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_LBUTTONDOWN</span><span class="p">)</span> <span class="p">{</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetCapture&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">),</span>  <span class="n">parent</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetParent&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetWindowRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>

		<span class="n">sz</span> <span class="o">:=</span> <span class="n">Win_GetRect</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_bVert</span> <span class="o">?</span> <span class="s">&quot;w&quot;</span> <span class="o">:</span> <span class="s">&quot;h&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
		<span class="n">ch</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s">&quot;Nh&quot;</span> <span class="p">)</span><span class="c-Singleline">			;get caption size of parent window</span>

<span class="c-Singleline">	  ;prevent user from going offscreen with separator</span>
		<span class="nf">NumPut</span><span class="p">(</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">sz</span><span class="o">-</span><span class="mi">1</span>	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">NumPut</span><span class="p">(</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">sz</span><span class="o">+</span><span class="n">ch</span> <span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
		<span class="nf">NumPut</span><span class="p">(</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="n">sz</span><span class="o">+</span><span class="mi">4</span> 	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
		<span class="nf">NumPut</span><span class="p">(</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="o">-</span> <span class="n">sz</span><span class="o">+</span><span class="mi">4</span>	<span class="p">,</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
				
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">),</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nv">%Hwnd%</span><span class="n">_cursor</span><span class="p">)</span>
		<span class="n">moving</span> <span class="o">:=</span> <span class="nv">true</span>
	<span class="p">}</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">UMsg</span> <span class="o">=</span> <span class="n">WM_LBUTTONUP</span><span class="p">){</span>
		<span class="n">moving</span> <span class="o">:=</span> <span class="nv">false</span>
	
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ClipCursor&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseCapture&quot;</span><span class="p">)</span>
		<span class="n">Splitter_SetPos</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">Splitter_updateFocus</span><span class="p">(),</span> <span class="nv">true</span><span class="p">)</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">if </span><span class="n">UMsg</span> <span class="ow">in</span> <span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span><span class="nv">%WM_RBUTTONUP%</span>
	<span class="p">{</span>
		<span class="n">handler</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span><span class="n">Hwnd</span> <span class="s">&quot;Handler&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">handler</span><span class="p">,,</span><span class="n">return</span>

<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="nv">%WM_LBUTTONDBLCLK%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">D</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">ifEqual</span><span class="p">,</span> <span class="n">UMsg</span><span class="p">,</span> <span class="nv">%WM_RBUTTONUP%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">R</span>
			
		<span class="nv">%handler%</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">Hwnd</span><span class="p">))</span>
	<span class="p">}</span>

<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CallWindowProc&quot;</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nv">A_EventInfo</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">hwnd</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">uMsg</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">wParam</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="n">lParam</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;Updates focus rectangle while mouse is moving. </span>
<span class="c-Singleline">;If called without arguments it returns latest focus rectangle position.</span>
<span class="n">Splitter_updateFocus</span><span class="p">(</span> <span class="n">HSep</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">HSep</span>
<span class="w">		</span><span class="nb">return</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">dc</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span>
<span class="w">	</span><span class="nb">MouseGetPos</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">my</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">dc</span> 
	<span class="p">{</span>
<span class="w">		</span><span class="nb">ifEqual</span><span class="p">,</span> <span class="n">adrDrawFocusRect</span><span class="p">,,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="o">%</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetProcAddress&quot;</span><span class="p">,</span> <span class="n">uint</span><span class="p">,</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;user32&quot;</span><span class="p">),</span> <span class="n">str</span><span class="p">,</span> <span class="s">&quot;DrawFocusRect&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">CoordMode</span><span class="p">,</span> <span class="n">mouse</span><span class="p">,</span> <span class="n">relative</span><span class="c-Singleline"></span>

<span class="c-Singleline">	  ;initialize dc, RECT, idx, delta(distance between mouse and splitter position), sz, pos &amp; max when user starts moving.</span>
		<span class="n">dc</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span> <span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;0D&quot;</span><span class="p">)</span><span class="c-Singleline">		; take root DC, for some reason it doesn&#39;t work good on parent&#39;s DC</span>

		<span class="n">Win_GetRect</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;!xywh&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">sh</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">RECT</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">sy</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">sx</span><span class="o">+</span><span class="n">sw</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">sy</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="p">,</span> <span class="n">sz</span> <span class="o">:=</span> <span class="n">sh</span>
<span class="w">		</span>
<span class="w">		</span><span class="nb">if </span><span class="n">bVert</span> <span class="o">:=</span> <span class="n">Splitter</span><span class="p">(</span> <span class="n">HSep</span> <span class="s">&quot;bVert&quot;</span> <span class="p">)</span>
			 <span class="n">idx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">delta</span> <span class="o">:=</span> <span class="n">mx</span><span class="o">-</span><span class="n">sx</span><span class="p">,</span>   <span class="n">sz</span> <span class="o">:=</span> <span class="n">sw</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">idx</span> <span class="o">:=</span> <span class="mi">4</span><span class="p">,</span>   <span class="n">delta</span> <span class="o">:=</span> <span class="n">my</span><span class="o">-</span><span class="n">sy</span><span class="p">,</span>   <span class="n">sz</span> <span class="o">:=</span> <span class="n">sh</span><span class="c-Singleline"></span>

<span class="c-Singleline">      ;if in Panel, there will be offset to mouse movement according to its position.</span>
		<span class="n">parent</span> <span class="o">:=</span> <span class="n">Win_Get</span><span class="p">(</span><span class="n">HSep</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">WinGetClass</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%parent%</span>
		<span class="n">offset</span> <span class="o">:=</span>  <span class="n">cls</span> <span class="o">!=</span> <span class="s">&quot;Panel&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">Win_GetRect</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="n">bVert</span> <span class="o">?</span> <span class="s">&quot;!x&quot;</span> <span class="o">:</span> <span class="s">&quot;!y&quot;</span><span class="p">)</span>

		<span class="n">pos</span> <span class="o">:=</span> <span class="n">Splitter_GetPos</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span>  
		<span class="n">max</span> <span class="o">:=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">Splitter_getMax</span><span class="p">(</span><span class="n">HSep</span><span class="p">),</span>	 <span class="n">min</span> <span class="o">:=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">Splitter_getMin</span><span class="p">(</span><span class="n">HSep</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">pos</span> <span class="o">:=</span> <span class="n">bVert</span> <span class="o">?</span> <span class="n">mx</span><span class="o">-</span><span class="n">delta</span> <span class="o">:</span> <span class="n">my</span><span class="o">-</span><span class="n">delta</span>
<span class="w">	</span><span class="nb">ifLess</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%min%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%min%</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">ifGreater</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%max%</span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="nv">%max%</span>

	<span class="nf">DllCall</span><span class="p">(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span>   <span class="nf">NumPut</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="n">sz</span><span class="p">,</span> <span class="n">RECT</span><span class="p">,</span> <span class="n">idx</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span>  <span class="nf">DllCall</span><span class="p">(</span><span class="n">adrDrawFocusRect</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RECT</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;storage</span>
<span class="n">Splitter</span><span class="p">(</span><span class="n">Var</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="o">=</span><span class="s">&quot;~`a &quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o1</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o2</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o3</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o4</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o5</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">o6</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="w">	</span><span class="nb">static</span>
	<span class="n">_</span> <span class="o">:=</span> <span class="nv">%var%</span>
<span class="w">	</span><span class="nb">ifNotEqual</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span><span class="o">~</span><span class="se">`a</span><span class="err"> </span><span class="p">,</span> <span class="n">SetEnv</span><span class="p">,</span> <span class="nv">%var%</span><span class="p">,</span> <span class="nv">%value%</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">_</span>
<span class="p">}</span>

<span class="nb">#include</span> <span class="o">*</span><span class="n">i</span> <span class="n">Win</span><span class="o">.</span><span class="n">ahk</span>

<span class="cm">/* Group: Examples</span>
<span class="cm"> (start code)</span>
<span class="cm">		w := 500, h := 600, sep := 5</span>
<span class="cm">		w1 := w//3, w2 := w-w1 , h1 := h // 2, h2 := h // 3</span>

<span class="cm">		Gui, Margin, 0, 0</span>
<span class="cm">		Gui, Add, Edit, HWNDc11 w%w1% h%h1%</span>
<span class="cm">		Gui, Add, Edit, HWNDc12 w%w1% h%h1%</span>
<span class="cm">		hSepV := Splitter_Add( &quot;x+0 y0 h&quot; h &quot; w&quot; sep )</span>
<span class="cm">		Gui, Add, Monthcal, HWNDc21 w%w2% h%h2% x+0</span>
<span class="cm">		Gui, Add, ListView, HWNDc22 w%w2% h%h2%, c1|c2|c3</span>
<span class="cm">		Gui, Add, ListBox,  HWNDc23 w%w2% h%h2% , 1|2|3</span>

<span class="cm">		sdef = %c11% %c12% | %c21% %c22% %c23%			;vertical splitter.</span>
<span class="cm">		Splitter_Set( hSepV, sdef )</span>

<span class="cm">		Gui, show, w%w% h%h%	</span>
<span class="cm">	return</span>
<span class="cm"> (end code)</span>
<span class="cm"> */</span>

<span class="cm">/* Group: About</span>
<span class="cm">	o Ver 1.6 by majkinetor.</span>
<span class="cm">	o Licenced under BSD &lt;http://creativecommons.org/licenses/BSD/&gt;.</span>
<span class="cm"> */</span>
</pre></div>
