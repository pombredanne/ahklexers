<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; Gdip standard library v1.38 by tic (Tariq Porter) 28/08/10</span>
<span class="c1">;</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">; STATUS ENUMERATION</span>
<span class="c1">; Return values for functions specified to have status enumerated return type</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">;</span>
<span class="c1">; Ok =						= 0</span>
<span class="c1">; GenericError				= 1</span>
<span class="c1">; InvalidParameter			= 2</span>
<span class="c1">; OutOfMemory				= 3</span>
<span class="c1">; ObjectBusy				= 4</span>
<span class="c1">; InsufficientBuffer		= 5</span>
<span class="c1">; NotImplemented			= 6</span>
<span class="c1">; Win32Error				= 7</span>
<span class="c1">; WrongState				= 8</span>
<span class="c1">; Aborted					= 9</span>
<span class="c1">; FileNotFound				= 10</span>
<span class="c1">; ValueOverflow				= 11</span>
<span class="c1">; AccessDenied				= 12</span>
<span class="c1">; UnknownImageFormat		= 13</span>
<span class="c1">; FontFamilyNotFound		= 14</span>
<span class="c1">; FontStyleNotFound			= 15</span>
<span class="c1">; NotTrueTypeFont			= 16</span>
<span class="c1">; UnsupportedGdiplusVersion	= 17</span>
<span class="c1">; GdiplusNotInitialized		= 18</span>
<span class="c1">; PropertyNotFound			= 19</span>
<span class="c1">; PropertyNotSupported		= 20</span>
<span class="c1">; ProfileNotFound			= 21</span>
<span class="c1">;</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">; FUNCTIONS</span>
<span class="c1">;#####################################################################################</span>
<span class="c1">;</span>
<span class="c1">; UpdateLayeredWindow(hwnd, hdc, x=&quot;&quot;, y=&quot;&quot;, w=&quot;&quot;, h=&quot;&quot;, Alpha=255)</span>
<span class="c1">; BitBlt(ddc, dx, dy, dw, dh, sdc, sx, sy, Raster=&quot;&quot;)</span>
<span class="c1">; StretchBlt(dDC, dx, dy, dw, dh, sDC, sx, sy, sw, sh, Raster=&quot;&quot;)</span>
<span class="c1">; SetImage(hwnd, hBitmap)</span>
<span class="c1">; Gdip_BitmapFromScreen(Screen=0, Raster=&quot;&quot;)</span>
<span class="c1">; CreateRectF(ByRef RectF, x, y, w, h)</span>
<span class="c1">; CreateSizeF(ByRef SizeF, w, h)</span>
<span class="c1">; CreateDIBSection</span>
<span class="c1">;</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function:     			UpdateLayeredWindow</span>
<span class="c1">; Description:  			Updates a layered window with the handle to the DC of a gdi bitmap</span>
<span class="c1">; </span>
<span class="c1">; hwnd        				Handle of the layered window to update</span>
<span class="c1">; hdc           			Handle to the DC of the GDI bitmap to update the window with</span>
<span class="c1">; Layeredx      			x position to place the window</span>
<span class="c1">; Layeredy      			y position to place the window</span>
<span class="c1">; Layeredw      			Width of the window</span>
<span class="c1">; Layeredh      			Height of the window</span>
<span class="c1">; Alpha         			Default = 255 : The transparency (0-255) to set the window transparency</span>
<span class="c1">;</span>
<span class="c1">; return      				If the function succeeds, the return value is nonzero</span>
<span class="c1">;</span>
<span class="c1">; notes						If x or y omitted, then layered window will use its current coordinates</span>
<span class="c1">;							If w or h omitted then current width and height will be used</span>

<span class="nf">UpdateLayeredWindow</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span>x<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Alpha<span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>x<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>y<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>pt<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>x<span class="p">,</span><span class="w"> </span>pt<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>y<span class="p">,</span><span class="w"> </span>pt<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>w<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="p">(</span>h<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">WinGetPos</span><span class="p">,,,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwnd%</span>
<span class="w">   </span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;UpdateLayeredWindow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hwnd<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">((</span>x<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>y<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span>pt
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int64*&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="o">|</span>h<span class="o">&lt;&lt;</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int64*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Alpha<span class="o">&lt;&lt;</span><span class="mi">16</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				BitBlt</span>
<span class="c1">; Description			The BitBlt function performs a bit-block transfer of the color data corresponding to a rectangle </span>
<span class="c1">;						of pixels from the specified source device context into a destination device context.</span>
<span class="c1">;</span>
<span class="c1">; dDC					handle to destination DC</span>
<span class="c1">; dx					x-coord of destination upper-left corner</span>
<span class="c1">; dy					y-coord of destination upper-left corner</span>
<span class="c1">; dw					width of the area to copy</span>
<span class="c1">; dh					height of the area to copy</span>
<span class="c1">; sDC					handle to source DC</span>
<span class="c1">; sx					x-coordinate of source upper-left corner</span>
<span class="c1">; sy					y-coordinate of source upper-left corner</span>
<span class="c1">; Raster				raster operation code</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is nonzero</span>
<span class="c1">;</span>
<span class="c1">; notes					If no raster operation is specified, then SRCCOPY is used, which copies the source directly to the destination rectangle</span>
<span class="c1">;</span>
<span class="c1">; BLACKNESS				= 0x00000042</span>
<span class="c1">; NOTSRCERASE			= 0x001100A6</span>
<span class="c1">; NOTSRCCOPY			= 0x00330008</span>
<span class="c1">; SRCERASE				= 0x00440328</span>
<span class="c1">; DSTINVERT				= 0x00550009</span>
<span class="c1">; PATINVERT				= 0x005A0049</span>
<span class="c1">; SRCINVERT				= 0x00660046</span>
<span class="c1">; SRCAND				= 0x008800C6</span>
<span class="c1">; MERGEPAINT			= 0x00BB0226</span>
<span class="c1">; MERGECOPY				= 0x00C000CA</span>
<span class="c1">; SRCCOPY				= 0x00CC0020</span>
<span class="c1">; SRCPAINT				= 0x00EE0086</span>
<span class="c1">; PATCOPY				= 0x00F00021</span>
<span class="c1">; PATPAINT				= 0x00FB0A09</span>
<span class="c1">; WHITENESS				= 0x00FF0062</span>
<span class="c1">; CAPTUREBLT			= 0x40000000</span>
<span class="c1">; NOMIRRORBITMAP		= 0x80000000</span>

<span class="nf">BitBlt</span><span class="p">(</span>ddc<span class="p">,</span><span class="w"> </span>dx<span class="p">,</span><span class="w"> </span>dy<span class="p">,</span><span class="w"> </span>dw<span class="p">,</span><span class="w"> </span>dh<span class="p">,</span><span class="w"> </span>sdc<span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span>Raster<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\BitBlt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>dDC<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dx<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dy<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dw<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dh
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>sDC<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Raster<span class="w"> </span><span class="o">?</span><span class="w"> </span>Raster<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">0x00CC0020</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				StretchBlt</span>
<span class="c1">; Description			The StretchBlt function copies a bitmap from a source rectangle into a destination rectangle, </span>
<span class="c1">;						stretching or compressing the bitmap to fit the dimensions of the destination rectangle, if necessary.</span>
<span class="c1">;						The system stretches or compresses the bitmap according to the stretching mode currently set in the destination device context.</span>
<span class="c1">;</span>
<span class="c1">; ddc					handle to destination DC</span>
<span class="c1">; dx					x-coord of destination upper-left corner</span>
<span class="c1">; dy					y-coord of destination upper-left corner</span>
<span class="c1">; dw					width of destination rectangle</span>
<span class="c1">; dh					height of destination rectangle</span>
<span class="c1">; sdc					handle to source DC</span>
<span class="c1">; sx					x-coordinate of source upper-left corner</span>
<span class="c1">; sy					y-coordinate of source upper-left corner</span>
<span class="c1">; sw					width of source rectangle</span>
<span class="c1">; sh					height of source rectangle</span>
<span class="c1">; Raster				raster operation code</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is nonzero</span>
<span class="c1">;</span>
<span class="c1">; notes					If no raster operation is specified, then SRCCOPY is used. It uses the same raster operations as BitBlt		</span>

<span class="nf">StretchBlt</span><span class="p">(</span>ddc<span class="p">,</span><span class="w"> </span>dx<span class="p">,</span><span class="w"> </span>dy<span class="p">,</span><span class="w"> </span>dw<span class="p">,</span><span class="w"> </span>dh<span class="p">,</span><span class="w"> </span>sdc<span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span>sw<span class="p">,</span><span class="w"> </span>sh<span class="p">,</span><span class="w"> </span>Raster<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\StretchBlt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ddc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dx<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dy<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dw<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>dh
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>sdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sw<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>sh<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Raster<span class="w"> </span><span class="o">?</span><span class="w"> </span>Raster<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">0x00CC0020</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				SetStretchBltMode</span>
<span class="c1">; Description			The SetStretchBltMode function sets the bitmap stretching mode in the specified device context</span>
<span class="c1">;</span>
<span class="c1">; hdc					handle to the DC</span>
<span class="c1">; iStretchMode			The stretching mode, describing how the target will be stretched</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is the previous stretching mode. If it fails it will return 0</span>
<span class="c1">;</span>
<span class="c1">; STRETCH_ANDSCANS 		= 0x01</span>
<span class="c1">; STRETCH_ORSCANS 		= 0x02</span>
<span class="c1">; STRETCH_DELETESCANS 	= 0x03</span>
<span class="c1">; STRETCH_HALFTONE 		= 0x04</span>

<span class="nf">SetStretchBltMode</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>iStretchMode<span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\SetStretchBltMode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>iStretchMode<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				SetImage</span>
<span class="c1">; Description			Associates a new image with a static control</span>
<span class="c1">;</span>
<span class="c1">; hwnd					handle of the control to update</span>
<span class="c1">; hBitmap				a gdi bitmap to associate the static control with</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is nonzero</span>

<span class="nf">SetImage</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>hBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span><span class="mh">0x172</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0</span><span class="p">,</span><span class="w"> </span>hBitmap<span class="p">,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwnd%</span>
<span class="w">	</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>ErrorLevel
<span class="w">	</span><span class="nf">DeleteObject</span><span class="p">(</span>E<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				SetSysColorToControl</span>
<span class="c1">; Description			Sets a solid colour to a control</span>
<span class="c1">;</span>
<span class="c1">; hwnd					handle of the control to update</span>
<span class="c1">; SysColor				A system colour to set to the control</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is zero</span>
<span class="c1">;</span>
<span class="c1">; notes					A control must have the 0xE style set to it so it is recognised as a bitmap</span>
<span class="c1">;						By default SysColor=15 is used which is COLOR_3DFACE. This is the standard background for a control</span>
<span class="c1">;</span>
<span class="c1">; COLOR_3DDKSHADOW				= 21</span>
<span class="c1">; COLOR_3DFACE					= 15</span>
<span class="c1">; COLOR_3DHIGHLIGHT				= 20</span>
<span class="c1">; COLOR_3DHILIGHT				= 20</span>
<span class="c1">; COLOR_3DLIGHT					= 22</span>
<span class="c1">; COLOR_3DSHADOW				= 16</span>
<span class="c1">; COLOR_ACTIVEBORDER			= 10</span>
<span class="c1">; COLOR_ACTIVECAPTION			= 2</span>
<span class="c1">; COLOR_APPWORKSPACE			= 12</span>
<span class="c1">; COLOR_BACKGROUND				= 1</span>
<span class="c1">; COLOR_BTNFACE					= 15</span>
<span class="c1">; COLOR_BTNHIGHLIGHT			= 20</span>
<span class="c1">; COLOR_BTNHILIGHT				= 20</span>
<span class="c1">; COLOR_BTNSHADOW				= 16</span>
<span class="c1">; COLOR_BTNTEXT					= 18</span>
<span class="c1">; COLOR_CAPTIONTEXT				= 9</span>
<span class="c1">; COLOR_DESKTOP					= 1</span>
<span class="c1">; COLOR_GRADIENTACTIVECAPTION	= 27</span>
<span class="c1">; COLOR_GRADIENTINACTIVECAPTION	= 28</span>
<span class="c1">; COLOR_GRAYTEXT				= 17</span>
<span class="c1">; COLOR_HIGHLIGHT				= 13</span>
<span class="c1">; COLOR_HIGHLIGHTTEXT			= 14</span>
<span class="c1">; COLOR_HOTLIGHT				= 26</span>
<span class="c1">; COLOR_INACTIVEBORDER			= 11</span>
<span class="c1">; COLOR_INACTIVECAPTION			= 3</span>
<span class="c1">; COLOR_INACTIVECAPTIONTEXT		= 19</span>
<span class="c1">; COLOR_INFOBK					= 24</span>
<span class="c1">; COLOR_INFOTEXT				= 23</span>
<span class="c1">; COLOR_MENU					= 4</span>
<span class="c1">; COLOR_MENUHILIGHT				= 29</span>
<span class="c1">; COLOR_MENUBAR					= 30</span>
<span class="c1">; COLOR_MENUTEXT				= 7</span>
<span class="c1">; COLOR_SCROLLBAR				= 0</span>
<span class="c1">; COLOR_WINDOW					= 5</span>
<span class="c1">; COLOR_WINDOWFRAME				= 6</span>
<span class="c1">; COLOR_WINDOWTEXT				= 8</span>

<span class="nf">SetSysColorToControl</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>SysColor<span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">WinGetPos</span><span class="p">,,,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwnd%</span>
<span class="w">   </span>bc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetSysColor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Int&quot;</span><span class="p">,</span><span class="w"> </span>SysColor<span class="p">)</span>
<span class="w">   </span>pBrushClear<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_BrushCreateSolid<span class="p">(</span><span class="mh">0xff000000</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span>bc<span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">|</span><span class="w"> </span>bc<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff00</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span>bc<span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">16</span><span class="p">))</span>
<span class="w">   </span>pBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmap<span class="p">(</span>w<span class="p">,</span><span class="w"> </span>h<span class="p">),</span><span class="w"> </span>G<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GraphicsFromImage<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">   </span><span class="nf">Gdip_FillRectangle</span><span class="p">(</span>G<span class="p">,</span><span class="w"> </span>pBrushClear<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">   </span>hBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateHBITMAPFromBitmap<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">   </span><span class="nf">SetImage</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>hBitmap<span class="p">)</span>
<span class="w">   </span><span class="nf">Gdip_DeleteBrush</span><span class="p">(</span>pBrushClear<span class="p">)</span>
<span class="w">   </span><span class="nf">Gdip_DeleteGraphics</span><span class="p">(</span>G<span class="p">),</span><span class="w"> </span><span class="nf">Gdip_DisposeImage</span><span class="p">(</span>pBitmap<span class="p">),</span><span class="w"> </span><span class="nf">DeleteObject</span><span class="p">(</span>hBitmap<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_BitmapFromScreen</span>
<span class="c1">; Description			Gets a gdi+ bitmap from the screen</span>
<span class="c1">;</span>
<span class="c1">; Screen				0 = All screens</span>
<span class="c1">;						Any numerical value = Just that screen</span>
<span class="c1">;						x|y|w|h = Take specific coordinates with a width and height</span>
<span class="c1">; Raster				raster operation code</span>
<span class="c1">;</span>
<span class="c1">; return      			If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c1">;						-1:		one or more of x,y,w,h not passed properly</span>
<span class="c1">;</span>
<span class="c1">; notes					If no raster operation is specified, then SRCCOPY is used to the returned bitmap</span>

<span class="nf">Gdip_BitmapFromScreen</span><span class="p">(</span>Screen<span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Raster<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Screen<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">Sysget</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="mi">76</span>
<span class="w">		</span><span class="k">Sysget</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="mi">77</span><span class="w">	</span>
<span class="w">		</span><span class="k">Sysget</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="mi">78</span>
<span class="w">		</span><span class="k">Sysget</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="mi">79</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Screen<span class="o">&amp;</span><span class="mi">1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">Sysget</span><span class="p">,</span><span class="w"> </span>M<span class="p">,</span><span class="w"> </span>Monitor<span class="p">,</span><span class="w"> </span><span class="nv">%Screen%</span>
<span class="w">		</span>x<span class="w"> </span><span class="o">:=</span><span class="w"> </span>MLeft<span class="p">,</span><span class="w"> </span>y<span class="w"> </span><span class="o">:=</span><span class="w"> </span>MTop<span class="p">,</span><span class="w"> </span>w<span class="w"> </span><span class="o">:=</span><span class="w"> </span>MRight<span class="o">-</span>MLeft<span class="p">,</span><span class="w"> </span>h<span class="w"> </span><span class="o">:=</span><span class="w"> </span>MBottom<span class="o">-</span>MTop
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>S<span class="p">,</span><span class="w"> </span>Screen<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">		</span>x<span class="w"> </span><span class="o">:=</span><span class="w"> </span>S1<span class="p">,</span><span class="w"> </span>y<span class="w"> </span><span class="o">:=</span><span class="w"> </span>S2<span class="p">,</span><span class="w"> </span>w<span class="w"> </span><span class="o">:=</span><span class="w"> </span>S3<span class="p">,</span><span class="w"> </span>h<span class="w"> </span><span class="o">:=</span><span class="w"> </span>S4
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>x<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>y<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>w<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>h<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">	</span>
<span class="w">	</span>chdc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateCompatibleDC<span class="p">(),</span><span class="w"> </span>hbm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateDIBSection<span class="p">(</span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>chdc<span class="p">),</span><span class="w"> </span>obm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>SelectObject<span class="p">(</span>chdc<span class="p">,</span><span class="w"> </span>hbm<span class="p">),</span><span class="w"> </span>hhdc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>GetDC<span class="p">()</span>
<span class="w">	</span><span class="nf">BitBlt</span><span class="p">(</span>chdc<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>hhdc<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>Raster<span class="p">)</span>
<span class="w">	</span><span class="nf">ReleaseDC</span><span class="p">(</span>hhdc<span class="p">)</span>
<span class="w">	</span>
<span class="w">	</span>pBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmapFromHBITMAP<span class="p">(</span>hbm<span class="p">)</span>
<span class="w">	</span><span class="nf">SelectObject</span><span class="p">(</span>hhdc<span class="p">,</span><span class="w"> </span>obm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteObject</span><span class="p">(</span>hbm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteDC</span><span class="p">(</span>hhdc<span class="p">),</span><span class="w"> </span><span class="nf">DeleteDC</span><span class="p">(</span>chdc<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_BitmapFromHWND</span>
<span class="c1">; Description			Uses PrintWindow to get a handle to the specified window and return a bitmap from it</span>
<span class="c1">;</span>
<span class="c1">; hwnd					handle to the window to get a bitmap from</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c1">;</span>
<span class="c1">; notes					Window must not be not minimised in order to get a handle to it&#39;s client area</span>

<span class="nf">Gdip_BitmapFromHWND</span><span class="p">(</span>hwnd<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">WinGetPos</span><span class="p">,,,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwnd%</span>
<span class="w">	</span>hbm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateDIBSection<span class="p">(</span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">),</span><span class="w"> </span>hdc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateCompatibleDC<span class="p">(),</span><span class="w"> </span>obm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>SelectObject<span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>hbm<span class="p">)</span>
<span class="w">	</span><span class="nf">PrintWindow</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="w">	</span>pBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmapFromHBITMAP<span class="p">(</span>hbm<span class="p">)</span>
<span class="w">	</span><span class="nf">SelectObject</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>obm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteObject</span><span class="p">(</span>hbm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteDC</span><span class="p">(</span>hdc<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function    			CreateRectF</span>
<span class="c1">; Description			Creates a RectF object, containing a the coordinates and dimensions of a rectangle</span>
<span class="c1">;</span>
<span class="c1">; RectF       			Name to call the RectF object</span>
<span class="c1">; x            			x-coordinate of the upper left corner of the rectangle</span>
<span class="c1">; y            			y-coordinate of the upper left corner of the rectangle</span>
<span class="c1">; w            			Width of the rectangle</span>
<span class="c1">; h            			Height of the rectangle</span>
<span class="c1">;</span>
<span class="c1">; return      			No return value</span>

<span class="nf">CreateRectF</span><span class="p">(</span>ByRef<span class="w"> </span>RectF<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>RectF<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>x<span class="p">,</span><span class="w"> </span>RectF<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>y<span class="p">,</span><span class="w"> </span>RectF<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>w<span class="p">,</span><span class="w"> </span>RectF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>h<span class="p">,</span><span class="w"> </span>RectF<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function		    	CreateSizeF</span>
<span class="c1">; Description			Creates a SizeF object, containing an 2 values</span>
<span class="c1">;</span>
<span class="c1">; SizeF         		Name to call the SizeF object</span>
<span class="c1">; w            			w-value for the SizeF object</span>
<span class="c1">; h            			h-value for the SizeF object</span>
<span class="c1">;</span>
<span class="c1">; return      			No Return value</span>

<span class="nf">CreateSizeF</span><span class="p">(</span>ByRef<span class="w"> </span>SizeF<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>SizeF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>w<span class="p">,</span><span class="w"> </span>SizeF<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>h<span class="p">,</span><span class="w"> </span>SizeF<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w">     </span>
<span class="p">}</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function		    	CreatePointF</span>
<span class="c1">; Description			Creates a SizeF object, containing an 2 values</span>
<span class="c1">;</span>
<span class="c1">; SizeF         		Name to call the SizeF object</span>
<span class="c1">; w            			w-value for the SizeF object</span>
<span class="c1">; h            			h-value for the SizeF object</span>
<span class="c1">;</span>
<span class="c1">; return      			No Return value</span>

<span class="nf">CreatePointF</span><span class="p">(</span>ByRef<span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<span class="w">   </span><span class="nf">NumPut</span><span class="p">(</span>x<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>y<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w">     </span>
<span class="p">}</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				CreateDIBSection</span>
<span class="c1">; Description			The CreateDIBSection function creates a DIB (Device Independent Bitmap) that applications can write to directly</span>
<span class="c1">;</span>
<span class="c1">; w						width of the bitmap to create</span>
<span class="c1">; h						height of the bitmap to create</span>
<span class="c1">; hdc					a handle to the device context to use the palette from</span>
<span class="c1">; bpp					bits per pixel (32 = ARGB)</span>
<span class="c1">; ppvBits				A pointer to a variable that receives a pointer to the location of the DIB bit values</span>
<span class="c1">;</span>
<span class="c1">; return				returns a DIB. A gdi bitmap</span>
<span class="c1">;</span>
<span class="c1">; notes					ppvBits will receive the location of the pixels in the DIB</span>

<span class="nf">CreateDIBSection</span><span class="p">(</span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>hdc<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>bpp<span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>ppvBits<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>hdc2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>hdc<span class="w"> </span><span class="o">?</span><span class="w"> </span>hdc<span class="w"> </span><span class="o">:</span><span class="w"> </span>GetDC<span class="p">()</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>bi<span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nf">NumPut</span><span class="p">(</span>w<span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>h<span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ushort&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="nf">NumPut</span><span class="p">(</span>bpp<span class="p">,</span><span class="w"> </span>bi<span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ushort&quot;</span><span class="p">)</span>
<span class="w">	</span>hbm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;CreateDIBSection&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span>hdc2<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>bi<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ppvBits<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span>
<span class="w">	</span><span class="kr">If</span><span class="w"> </span><span class="o">!</span>hdc
<span class="w">		</span><span class="nf">ReleaseDC</span><span class="p">(</span>hdc2<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hbm
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				PrintWindow</span>
<span class="c1">; Description			The PrintWindow function copies a visual window into the specified device context (DC), typically a printer DC</span>
<span class="c1">;</span>
<span class="c1">; hwnd					A handle to the window that will be copied</span>
<span class="c1">; hdc					A handle to the device context</span>
<span class="c1">; Flags					Drawing options</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, it returns a nonzero value</span>
<span class="c1">;</span>
<span class="c1">; PW_CLIENTONLY			= 1</span>

<span class="nf">PrintWindow</span><span class="p">(</span>hwnd<span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span>Flags<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PrintWindow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hwnd<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Flags<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				DestroyIcon</span>
<span class="c1">; Description			Destroys an icon and frees any memory the icon occupied</span>
<span class="c1">;</span>
<span class="c1">; hIcon					Handle to the icon to be destroyed. The icon must not be in use</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is nonzero</span>

<span class="nf">DestroyIcon</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DestroyIcon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="nf">PaintDesktop</span><span class="p">(</span>hdc<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PaintDesktop&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="nf">CreateCompatibleBitmap</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\CreateCompatibleBitmap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				CreateCompatibleDC</span>
<span class="c1">; Description			This function creates a memory device context (DC) compatible with the specified device</span>
<span class="c1">;</span>
<span class="c1">; hdc					Handle to an existing device context					</span>
<span class="c1">;</span>
<span class="c1">; return				returns the handle to a device context or 0 on failure</span>
<span class="c1">;</span>
<span class="c1">; notes					If this handle is 0 (by default), the function creates a memory device context compatible with the application&#39;s current screen</span>

<span class="nf">CreateCompatibleDC</span><span class="p">(</span>hdc<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateCompatibleDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				SelectObject</span>
<span class="c1">; Description			The SelectObject function selects an object into the specified device context (DC). The new object replaces the previous object of the same type</span>
<span class="c1">;</span>
<span class="c1">; hdc					Handle to a DC</span>
<span class="c1">; hgdiobj				A handle to the object to be selected into the DC</span>
<span class="c1">;</span>
<span class="c1">; return				If the selected object is not a region and the function succeeds, the return value is a handle to the object being replaced</span>
<span class="c1">;</span>
<span class="c1">; notes					The specified object must have been created by using one of the following functions</span>
<span class="c1">;						Bitmap - CreateBitmap, CreateBitmapIndirect, CreateCompatibleBitmap, CreateDIBitmap, CreateDIBSection (A single bitmap cannot be selected into more than one DC at the same time)</span>
<span class="c1">;						Brush - CreateBrushIndirect, CreateDIBPatternBrush, CreateDIBPatternBrushPt, CreateHatchBrush, CreatePatternBrush, CreateSolidBrush</span>
<span class="c1">;						Font - CreateFont, CreateFontIndirect</span>
<span class="c1">;						Pen - CreatePen, CreatePenIndirect</span>
<span class="c1">;						Region - CombineRgn, CreateEllipticRgn, CreateEllipticRgnIndirect, CreatePolygonRgn, CreateRectRgn, CreateRectRgnIndirect</span>
<span class="c1">;</span>
<span class="c1">; notes					If the selected object is a region and the function succeeds, the return value is one of the following value</span>
<span class="c1">;</span>
<span class="c1">; SIMPLEREGION			= 2 Region consists of a single rectangle</span>
<span class="c1">; COMPLEXREGION			= 3 Region consists of more than one rectangle</span>
<span class="c1">; NULLREGION			= 1 Region is empty</span>

<span class="nf">SelectObject</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>hgdiobj<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hgdiobj<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				DeleteObject</span>
<span class="c1">; Description			This function deletes a logical pen, brush, font, bitmap, region, or palette, freeing all system resources associated with the object</span>
<span class="c1">;						After the object is deleted, the specified handle is no longer valid</span>
<span class="c1">;</span>
<span class="c1">; hObject				Handle to a logical pen, brush, font, bitmap, region, or palette to delete</span>
<span class="c1">;</span>
<span class="c1">; return				Nonzero indicates success. Zero indicates that the specified handle is not valid or that the handle is currently selected into a device context</span>

<span class="nf">DeleteObject</span><span class="p">(</span>hObject<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hObject<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				GetDC</span>
<span class="c1">; Description			This function retrieves a handle to a display device context (DC) for the client area of the specified window.</span>
<span class="c1">;						The display device context can be used in subsequent graphics display interface (GDI) functions to draw in the client area of the window. </span>
<span class="c1">;</span>
<span class="c1">; hwnd					Handle to the window whose device context is to be retrieved. If this value is NULL, GetDC retrieves the device context for the entire screen					</span>
<span class="c1">;</span>
<span class="c1">; return				The handle the device context for the specified window&#39;s client area indicates success. NULL indicates failure</span>

<span class="nf">GetDC</span><span class="p">(</span>hwnd<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hwnd<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				ReleaseDC</span>
<span class="c1">; Description			This function releases a device context (DC), freeing it for use by other applications. The effect of ReleaseDC depends on the type of device context</span>
<span class="c1">;</span>
<span class="c1">; hdc					Handle to the device context to be released</span>
<span class="c1">; hwnd					Handle to the window whose device context is to be released</span>
<span class="c1">;</span>
<span class="c1">; return				1 = released</span>
<span class="c1">;						0 = not released</span>
<span class="c1">;</span>
<span class="c1">; notes					The application must call the ReleaseDC function for each call to the GetWindowDC function and for each call to the GetDC function that retrieves a common device context</span>
<span class="c1">;						An application cannot use the ReleaseDC function to release a device context that was created by calling the CreateDC function; instead, it must use the DeleteDC function. </span>

<span class="nf">ReleaseDC</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>hwnd<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hwnd<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				DeleteDC</span>
<span class="c1">; Description			The DeleteDC function deletes the specified device context (DC)</span>
<span class="c1">;</span>
<span class="c1">; hdc					A handle to the device context</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is nonzero</span>
<span class="c1">;</span>
<span class="c1">; notes					An application must not delete a DC whose handle was obtained by calling the GetDC function. Instead, it must call the ReleaseDC function to free the DC</span>

<span class="nf">DeleteDC</span><span class="p">(</span>hdc<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">}</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_LibraryVersion</span>
<span class="c1">; Description			Get the current library version</span>
<span class="c1">;</span>
<span class="c1">; return				the library version</span>
<span class="c1">;</span>
<span class="c1">; notes					This is useful for non compiled programs to ensure that a person doesn&#39;t run an old version when testing your scripts</span>

<span class="nf">Gdip_LibraryVersion</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mf">1.38</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function:    			Gdip_BitmapFromBRA</span>
<span class="c1">; Description: 			Gets a pointer to a gdi+ bitmap from a BRA file</span>
<span class="c1">;</span>
<span class="c1">; BRAFromMemIn			The variable for a BRA file read to memory</span>
<span class="c1">; File					The name of the file, or its number that you would like (This depends on alternate parameter)</span>
<span class="c1">; Alternate				Changes whether the File parameter is the file name or its number</span>
<span class="c1">;</span>
<span class="c1">; return      			If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c1">;						-1 = The BRA variable is empty</span>
<span class="c1">;						-2 = The BRA has an incorrect header</span>
<span class="c1">;						-3 = The BRA has information missing</span>
<span class="c1">;						-4 = Could not find file inside the BRA</span>

<span class="nf">Gdip_BitmapFromBRA</span><span class="p">(</span>ByRef<span class="w"> </span>BRAFromMemIn<span class="p">,</span><span class="w"> </span>File<span class="p">,</span><span class="w"> </span>Alternate<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>BRAFromMemIn
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span>BRAFromMemIn<span class="p">,</span><span class="w"> </span><span class="p">`</span>n
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="nb">A_Index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Header<span class="p">,</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">			</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Header0<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>Header2<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;BRA!&quot;</span><span class="p">)</span>
<span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="nb">A_Index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Info<span class="p">,</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">			</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Info0<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span>
<span class="w">			</span><span class="k">break</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>Alternate
<span class="w">		</span><span class="k">StringReplace</span><span class="p">,</span><span class="w"> </span>File<span class="p">,</span><span class="w"> </span>File<span class="p">,</span><span class="w"> </span><span class="p">\,</span><span class="w"> </span><span class="p">\\,</span><span class="w"> </span>All
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>BRAFromMemIn<span class="p">,</span><span class="w"> </span><span class="s">&quot;mi</span><span class="se">`n</span><span class="s">)^&quot;</span><span class="w"> </span><span class="p">(</span>Alternate<span class="w"> </span><span class="o">?</span><span class="w"> </span>File<span class="w"> </span><span class="s">&quot;\|.+?\|(\d+)\|(\d+)&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;\d+\|&quot;</span><span class="w"> </span>File<span class="w"> </span><span class="s">&quot;\|(\d+)\|(\d+)&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;$&quot;</span><span class="p">,</span><span class="w"> </span>FileInfo<span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>FileInfo
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>

<span class="w">	</span>hData<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GlobalAlloc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>FileInfo2<span class="p">)</span>
<span class="w">	</span>pData<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GlobalLock&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hData<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pData<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>BRAFromMemIn<span class="o">+</span>Info2<span class="o">+</span>FileInfo1<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>FileInfo2<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalUnlock&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hData<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CreateStreamOnHGlobal&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hData<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pStream<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromStream&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pStream<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span>NumGet<span class="p">(</span>NumGet<span class="p">(</span><span class="mi">1</span><span class="o">*</span>pStream<span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pStream<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawRectangle</span>
<span class="c1">; Description			This function uses a pen to draw the outline of a rectangle into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x						x-coordinate of the top left of the rectangle</span>
<span class="c1">; y						y-coordinate of the top left of the rectangle</span>
<span class="c1">; w						width of the rectanlge</span>
<span class="c1">; h						height of the rectangle</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawRectangle</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawRectangle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawRoundedRectangle</span>
<span class="c1">; Description			This function uses a pen to draw the outline of a rounded rectangle into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x						x-coordinate of the top left of the rounded rectangle</span>
<span class="c1">; y						y-coordinate of the top left of the rounded rectangle</span>
<span class="c1">; w						width of the rectanlge</span>
<span class="c1">; h						height of the rectangle</span>
<span class="c1">; r						radius of the rounded corners</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawRoundedRectangle</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>r<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_DrawRectangle<span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_ResetClip</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="o">+</span>r<span class="p">,</span><span class="w"> </span>w<span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>h<span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_ResetClip</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawEllipse</span>
<span class="c1">; Description			This function uses a pen to draw the outline of an ellipse into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x						x-coordinate of the top left of the rectangle the ellipse will be drawn into</span>
<span class="c1">; y						y-coordinate of the top left of the rectangle the ellipse will be drawn into</span>
<span class="c1">; w						width of the ellipse</span>
<span class="c1">; h						height of the ellipse</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawEllipse&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawBezier</span>
<span class="c1">; Description			This function uses a pen to draw the outline of a bezier (a weighted curve) into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x1					x-coordinate of the start of the bezier</span>
<span class="c1">; y1					y-coordinate of the start of the bezier</span>
<span class="c1">; x2					x-coordinate of the first arc of the bezier</span>
<span class="c1">; y2					y-coordinate of the first arc of the bezier</span>
<span class="c1">; x3					x-coordinate of the second arc of the bezier</span>
<span class="c1">; y3					y-coordinate of the second arc of the bezier</span>
<span class="c1">; x4					x-coordinate of the end of the bezier</span>
<span class="c1">; y4					y-coordinate of the end of the bezier</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawBezier</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x1<span class="p">,</span><span class="w"> </span>y1<span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span>y2<span class="p">,</span><span class="w"> </span>x3<span class="p">,</span><span class="w"> </span>y3<span class="p">,</span><span class="w"> </span>x4<span class="p">,</span><span class="w"> </span>y4<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawBezier&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pgraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x1<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y1<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y2
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x3<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y3<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x4<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y4<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawArc</span>
<span class="c1">; Description			This function uses a pen to draw the outline of an arc into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x						x-coordinate of the start of the arc</span>
<span class="c1">; y						y-coordinate of the start of the arc</span>
<span class="c1">; w						width of the arc</span>
<span class="c1">; h						height of the arc</span>
<span class="c1">; StartAngle			specifies the angle between the x-axis and the starting point of the arc</span>
<span class="c1">; SweepAngle			specifies the angle between the starting and ending points of the arc</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawArc</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawArc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawPie</span>
<span class="c1">; Description			This function uses a pen to draw the outline of a pie into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x						x-coordinate of the start of the pie</span>
<span class="c1">; y						y-coordinate of the start of the pie</span>
<span class="c1">; w						width of the pie</span>
<span class="c1">; h						height of the pie</span>
<span class="c1">; StartAngle			specifies the angle between the x-axis and the starting point of the pie</span>
<span class="c1">; SweepAngle			specifies the angle between the starting and ending points of the pie</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="nf">Gdip_DrawPie</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawPie&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawLine</span>
<span class="c1">; Description			This function uses a pen to draw a line into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; x1					x-coordinate of the start of the line</span>
<span class="c1">; y1					y-coordinate of the start of the line</span>
<span class="c1">; x2					x-coordinate of the end of the line</span>
<span class="c1">; y2					y-coordinate of the end of the line</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success		</span>

<span class="nf">Gdip_DrawLine</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>x1<span class="p">,</span><span class="w"> </span>y1<span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span>y2<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawLine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x1<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y1<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y2<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawLines</span>
<span class="c1">; Description			This function uses a pen to draw a series of joined lines into the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pPen					Pointer to a pen</span>
<span class="c1">; Points				the coordinates of all the points passed as x1,y1|x2,y2|x3,y3.....</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success				</span>

<span class="nf">Gdip_DrawLines</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span>Points<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span>Points0<span class="p">)</span><span class="w">   </span>
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%Points0%</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Coord<span class="p">,</span><span class="w"> </span>Points<span class="nv">%A_Index%</span><span class="p">,</span><span class="w"> </span><span class="p">`,</span>
<span class="w">      </span><span class="nf">NumPut</span><span class="p">(</span>Coord1<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span>NumPut<span class="p">(</span>Coord2<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawLines&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Points0<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillRectangle</span>
<span class="c1">; Description			This function uses a brush to fill a rectangle in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; x						x-coordinate of the top left of the rectangle</span>
<span class="c1">; y						y-coordinate of the top left of the rectangle</span>
<span class="c1">; w						width of the rectanlge</span>
<span class="c1">; h						height of the rectangle</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_FillRectangle</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillRectangle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>pBrush
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillRoundedRectangle</span>
<span class="c1">; Description			This function uses a brush to fill a rounded rectangle in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; x						x-coordinate of the top left of the rounded rectangle</span>
<span class="c1">; y						y-coordinate of the top left of the rounded rectangle</span>
<span class="c1">; w						width of the rectanlge</span>
<span class="c1">; h						height of the rectangle</span>
<span class="c1">; r						radius of the rounded corners</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_FillRoundedRectangle</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>r<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>Region<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetClipRegion<span class="p">(</span>pGraphics<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_FillRectangle<span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRegion</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Region<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="o">+</span>r<span class="p">,</span><span class="w"> </span>w<span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>r<span class="p">,</span><span class="w"> </span>y<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>h<span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_FillEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_FillEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_FillEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_FillEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="o">+</span>w<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span>y<span class="o">+</span>h<span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span>r<span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span>r<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetClipRegion</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Region<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DeleteRegion</span><span class="p">(</span>Region<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillPolygon</span>
<span class="c1">; Description			This function uses a brush to fill a polygon in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; Points				the coordinates of all the points passed as x1,y1|x2,y2|x3,y3.....</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					Alternate will fill the polygon as a whole, wheras winding will fill each new &quot;segment&quot;</span>
<span class="c1">; Alternate 			= 0</span>
<span class="c1">; Winding 				= 1</span>

<span class="nf">Gdip_FillPolygon</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>FillMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">   </span><span class="nf">VarSetCapacity</span><span class="p">(</span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span>Points0<span class="p">)</span><span class="w">   </span>
<span class="w">   </span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%Points0%</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Coord<span class="p">,</span><span class="w"> </span>Points<span class="nv">%A_Index%</span><span class="p">,</span><span class="w"> </span><span class="p">`,</span>
<span class="w">      </span><span class="nf">NumPut</span><span class="p">(</span>Coord1<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span>NumPut<span class="p">(</span>Coord2<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="w">   </span><span class="p">}</span><span class="w">   </span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPolygon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Points0<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>FillMode<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillPie</span>
<span class="c1">; Description			This function uses a brush to fill a pie in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; x						x-coordinate of the top left of the pie</span>
<span class="c1">; y						y-coordinate of the top left of the pie</span>
<span class="c1">; w						width of the pie</span>
<span class="c1">; h						height of the pie</span>
<span class="c1">; StartAngle			specifies the angle between the x-axis and the starting point of the pie</span>
<span class="c1">; SweepAngle			specifies the angle between the starting and ending points of the pie</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_FillPie</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPie&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush
<span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>StartAngle<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>SweepAngle<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillEllipse</span>
<span class="c1">; Description			This function uses a brush to fill an ellipse in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; x						x-coordinate of the top left of the ellipse</span>
<span class="c1">; y						y-coordinate of the top left of the ellipse</span>
<span class="c1">; w						width of the ellipse</span>
<span class="c1">; h						height of the ellipse</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_FillEllipse</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillEllipse&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillRegion</span>
<span class="c1">; Description			This function uses a brush to fill a region in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; Region				Pointer to a Region</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					You can create a region Gdip_CreateRegion() and then add to this</span>

<span class="nf">Gdip_FillRegion</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>Region<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillRegion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Region<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_FillPath</span>
<span class="c1">; Description			This function uses a brush to fill a path in the Graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBrush				Pointer to a brush</span>
<span class="c1">; Region				Pointer to a Path</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_FillPath</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>Path<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawImagePointsRect</span>
<span class="c1">; Description			This function draws a bitmap into the Graphics of another bitmap and skews it</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBitmap				Pointer to a bitmap to be drawn</span>
<span class="c1">; Points				Points passed as x1,y1|x2,y2|x3,y3 (3 points: top left, top right, bottom left) describing the drawing of the bitmap</span>
<span class="c1">; sx					x-coordinate of source upper-left corner</span>
<span class="c1">; sy					y-coordinate of source upper-left corner</span>
<span class="c1">; sw					width of source rectangle</span>
<span class="c1">; sh					height of source rectangle</span>
<span class="c1">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					if sx,sy,sw,sh are missed then the entire source bitmap will be used</span>
<span class="c1">;						Matrix can be omitted to just draw with no alteration to ARGB</span>
<span class="c1">;						Matrix may be passed as a digit from 0 - 1 to change just transparency</span>
<span class="c1">;						Matrix can be passed as a matrix with any delimiter</span>

<span class="nf">Gdip_DrawImagePointsRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>sx<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sw<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sh<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Matrix<span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span>Points0<span class="p">)</span><span class="w">   </span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%Points0%</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Coord<span class="p">,</span><span class="w"> </span>Points<span class="nv">%A_Index%</span><span class="p">,</span><span class="w"> </span><span class="p">`,</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span>Coord1<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span>NumPut<span class="p">(</span>Coord2<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Matrix<span class="o">&amp;</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span>ImageAttr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_SetImageAttributesColorMatrix<span class="p">(</span>Matrix<span class="p">)</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Matrix<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span>ImageAttr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_SetImageAttributesColorMatrix<span class="p">(</span><span class="s">&quot;1|0|0|0|0|0|1|0|0|0|0|0|1|0|0|0|0|0|&quot;</span><span class="w"> </span>Matrix<span class="w"> </span><span class="s">&quot;|0|0|0|0|0|1&quot;</span><span class="p">)</span>
<span class="w">		</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>sx<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sy<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sw<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>sx<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>sy<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">		</span>sw<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageWidth<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">		</span>sh<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageHeight<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawImagePointsRect&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Points0<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sw<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sh
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ImageAttr<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span>ImageAttr
<span class="w">		</span><span class="nf">Gdip_DisposeImageAttributes</span><span class="p">(</span>ImageAttr<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_DrawImage</span>
<span class="c1">; Description			This function draws a bitmap into the Graphics of another bitmap</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c1">; pBitmap				Pointer to a bitmap to be drawn</span>
<span class="c1">; dx					x-coord of destination upper-left corner</span>
<span class="c1">; dy					y-coord of destination upper-left corner</span>
<span class="c1">; dw					width of destination image</span>
<span class="c1">; dh					height of destination image</span>
<span class="c1">; sx					x-coordinate of source upper-left corner</span>
<span class="c1">; sy					y-coordinate of source upper-left corner</span>
<span class="c1">; sw					width of source image</span>
<span class="c1">; sh					height of source image</span>
<span class="c1">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					if sx,sy,sw,sh are missed then the entire source bitmap will be used</span>
<span class="c1">;						Gdip_DrawImage performs faster</span>
<span class="c1">;						Matrix can be omitted to just draw with no alteration to ARGB</span>
<span class="c1">;						Matrix may be passed as a digit from 0 - 1 to change just transparency</span>
<span class="c1">;						Matrix can be passed as a matrix with any delimiter. For example:</span>
<span class="c1">;						MatrixBright=</span>
<span class="c1">;						(</span>
<span class="c1">;						1.5		|0		|0		|0		|0</span>
<span class="c1">;						0		|1.5	|0		|0		|0</span>
<span class="c1">;						0		|0		|1.5	|0		|0</span>
<span class="c1">;						0		|0		|0		|1		|0</span>
<span class="c1">;						0.05	|0.05	|0.05	|0		|1</span>
<span class="c1">;						)</span>
<span class="c1">;</span>
<span class="c1">; notes					MatrixBright = 1.5|0|0|0|0|0|1.5|0|0|0|0|0|1.5|0|0|0|0|0|1|0|0.05|0.05|0.05|0|1</span>
<span class="c1">;						MatrixGreyScale = 0.299|0.299|0.299|0|0|0.587|0.587|0.587|0|0|0.114|0.114|0.114|0|0|0|0|0|1|0|0|0|0|0|1</span>
<span class="c1">;						MatrixNegative = -1|0|0|0|0|0|-1|0|0|0|0|0|-1|0|0|0|0|0|1|0|0|0|0|0|1</span>

<span class="nf">Gdip_DrawImage</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span>dx<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>dy<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>dw<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>dh<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sw<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>sh<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Matrix<span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Matrix<span class="o">&amp;</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span>ImageAttr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_SetImageAttributesColorMatrix<span class="p">(</span>Matrix<span class="p">)</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Matrix<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span>ImageAttr<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_SetImageAttributesColorMatrix<span class="p">(</span><span class="s">&quot;1|0|0|0|0|0|1|0|0|0|0|0|1|0|0|0|0|0|&quot;</span><span class="w"> </span>Matrix<span class="w"> </span><span class="s">&quot;|0|0|0|0|0|1&quot;</span><span class="p">)</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>sx<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sy<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sw<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sh<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>dx<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>dy<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>dw<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>dh<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span>sx<span class="w"> </span><span class="o">:=</span><span class="w"> </span>dx<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>sy<span class="w"> </span><span class="o">:=</span><span class="w"> </span>dy<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">			</span>sw<span class="w"> </span><span class="o">:=</span><span class="w"> </span>dw<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageWidth<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">			</span>sh<span class="w"> </span><span class="o">:=</span><span class="w"> </span>dh<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageHeight<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span>sx<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sy<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">			</span>sw<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageWidth<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">			</span>sh<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageHeight<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawImageRectRect&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>dx<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>dy<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>dw<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>dh
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sx<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sy<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sw<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>sh
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ImageAttr<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span>ImageAttr
<span class="w">		</span><span class="nf">Gdip_DisposeImageAttributes</span><span class="p">(</span>ImageAttr<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_SetImageAttributesColorMatrix</span>
<span class="c1">; Description			This function creates an image matrix ready for drawing</span>
<span class="c1">;</span>
<span class="c1">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c1">;						passed with any delimeter</span>
<span class="c1">;</span>
<span class="c1">; return				returns an image matrix on sucess or 0 if it fails</span>
<span class="c1">;</span>
<span class="c1">; notes					MatrixBright = 1.5|0|0|0|0|0|1.5|0|0|0|0|0|1.5|0|0|0|0|0|1|0|0.05|0.05|0.05|0|1</span>
<span class="c1">;						MatrixGreyScale = 0.299|0.299|0.299|0|0|0.587|0.587|0.587|0|0|0.114|0.114|0.114|0|0|0|0|0|1|0|0|0|0|0|1</span>
<span class="c1">;						MatrixNegative = -1|0|0|0|0|0|-1|0|0|0|0|0|-1|0|0|0|0|0|1|0|0|0|0|0|1</span>

<span class="nf">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span>Matrix<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>ColourMatrix<span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span>Matrix<span class="w"> </span><span class="o">:=</span><span class="w"> </span>RegExReplace<span class="p">(</span>RegExReplace<span class="p">(</span>Matrix<span class="p">,</span><span class="w"> </span><span class="s">&quot;^[^\d-\.]+([\d\.])&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;$1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;[^\d-\.]+&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Matrix<span class="p">,</span><span class="w"> </span>Matrix<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>Matrix<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>Matrix<span class="nv">%A_Index%</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Matrix<span class="nv">%A_Index%</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Mod<span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span>Matrix<span class="p">,</span><span class="w"> </span>ColourMatrix<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateImageAttributes&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ImageAttr<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetImageAttributesColorMatrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ImageAttr<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>ColourMatrix<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>ImageAttr
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GraphicsFromImage</span>
<span class="c1">; Description			This function gets the graphics for a bitmap used for drawing functions</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap to get the pointer to its graphics</span>
<span class="c1">;</span>
<span class="c1">; return				returns a pointer to the graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; notes					a bitmap can be drawn into the graphics of another bitmap</span>

<span class="nf">Gdip_GraphicsFromImage</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageGraphicsContext&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>pGraphics
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GraphicsFromHDC</span>
<span class="c1">; Description			This function gets the graphics from the handle to a device context</span>
<span class="c1">;</span>
<span class="c1">; hdc					This is the handle to the device context</span>
<span class="c1">;</span>
<span class="c1">; return				returns a pointer to the graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; notes					You can draw a bitmap into the graphics of another bitmap</span>

<span class="nf">Gdip_GraphicsFromHDC</span><span class="p">(</span>hdc<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFromHDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>pGraphics
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetDC</span>
<span class="c1">; Description			This function gets the device context of the passed Graphics</span>
<span class="c1">;</span>
<span class="c1">; hdc					This is the handle to the device context</span>
<span class="c1">;</span>
<span class="c1">; return				returns the device context for the graphics of a bitmap</span>

<span class="nf">Gdip_GetDC</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hdc
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_ReleaseDC</span>
<span class="c1">; Description			This function releases a device context from use for further use</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the graphics of a bitmap</span>
<span class="c1">; hdc					This is the handle to the device context</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_ReleaseDC</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipReleaseDC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GraphicsClear</span>
<span class="c1">; Description			Clears the graphics of a bitmap ready for further drawing</span>
<span class="c1">;</span>
<span class="c1">; pGraphics				Pointer to the graphics of a bitmap</span>
<span class="c1">; ARGB					The colour to clear the graphics to</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>
<span class="c1">;</span>
<span class="c1">; notes					By default this will make the background invisible</span>
<span class="c1">;						Using clipping regions you can clear a particular area on the graphics rather than clearing the entire graphics</span>

<span class="nf">Gdip_GraphicsClear</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>ARGB<span class="o">=</span><span class="mh">0x00ffffff</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGraphicsClear&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_BlurBitmap</span>
<span class="c1">; Description			Gives a pointer to a blurred bitmap from a pointer to a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap to be blurred</span>
<span class="c1">; Blur					The Amount to blur a bitmap by from 1 (least blur) to 100 (most blur)</span>
<span class="c1">;</span>
<span class="c1">; return				If the function succeeds, the return value is a pointer to the new blurred bitmap</span>
<span class="c1">;						-1 = The blur parameter is outside the range 1-100</span>
<span class="c1">;</span>
<span class="c1">; notes					This function will not dispose of the original bitmap</span>

<span class="nf">Gdip_BlurBitmap</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>Blur<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Blur<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>Blur<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">	</span>
<span class="w">	</span>
<span class="w">	</span>sWidth<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageWidth<span class="p">(</span>pBitmap<span class="p">),</span><span class="w"> </span>sHeight<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageHeight<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">	</span>dWidth<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sWidth<span class="o">//</span>Blur<span class="p">,</span><span class="w"> </span>dHeight<span class="w"> </span><span class="o">:=</span><span class="w"> </span>sHeight<span class="o">//</span>Blur

<span class="w">	</span>pBitmap1<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmap<span class="p">(</span>dWidth<span class="p">,</span><span class="w"> </span>dHeight<span class="p">)</span>
<span class="w">	</span>G1<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GraphicsFromImage<span class="p">(</span>pBitmap1<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetInterpolationMode</span><span class="p">(</span>G1<span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawImage</span><span class="p">(</span>G1<span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>dWidth<span class="p">,</span><span class="w"> </span>dHeight<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>sWidth<span class="p">,</span><span class="w"> </span>sHeight<span class="p">)</span>

<span class="w">	</span><span class="nf">Gdip_DeleteGraphics</span><span class="p">(</span>G1<span class="p">)</span>

<span class="w">	</span>pBitmap2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmap<span class="p">(</span>sWidth<span class="p">,</span><span class="w"> </span>sHeight<span class="p">)</span>
<span class="w">	</span>G2<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GraphicsFromImage<span class="p">(</span>pBitmap2<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetInterpolationMode</span><span class="p">(</span>G2<span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DrawImage</span><span class="p">(</span>G2<span class="p">,</span><span class="w"> </span>pBitmap1<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>sWidth<span class="p">,</span><span class="w"> </span>sHeight<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>dWidth<span class="p">,</span><span class="w"> </span>dHeight<span class="p">)</span>

<span class="w">	</span><span class="nf">Gdip_DeleteGraphics</span><span class="p">(</span>G2<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DisposeImage</span><span class="p">(</span>pBitmap1<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap2
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function:     		Gdip_SaveBitmapToFile</span>
<span class="c1">; Description:  		Saves a bitmap to a file in any supported format onto disk</span>
<span class="c1">;   </span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">; sOutput      			The name of the file that the bitmap will be saved to. Supported extensions are: .BMP,.DIB,.RLE,.JPG,.JPEG,.JPE,.JFIF,.GIF,.TIF,.TIFF,.PNG</span>
<span class="c1">; Quality      			If saving as jpg (.JPG,.JPEG,.JPE,.JFIF) then quality can be 1-100 with default at maximum quality</span>
<span class="c1">;</span>
<span class="c1">; return      			If the function succeeds, the return value is zero, otherwise:</span>
<span class="c1">;						-1 = Extension supplied is not a supported file format</span>
<span class="c1">;						-2 = Could not get a list of encoders on system</span>
<span class="c1">;						-3 = Could not find matching encoder for specified file format</span>
<span class="c1">;						-4 = Could not get WideChar name of output file</span>
<span class="c1">;						-5 = Could not save file to disk</span>
<span class="c1">;</span>
<span class="c1">; notes					This function will use the extension supplied from the sOutput parameter to determine the output format</span>

<span class="nf">Gdip_SaveBitmapToFile</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>sOutput<span class="p">,</span><span class="w"> </span>Quality<span class="o">=</span><span class="mi">75</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">SplitPath</span><span class="p">,</span><span class="w"> </span>sOutput<span class="p">,,,</span><span class="w"> </span>Extension
<span class="w">	</span><span class="kr">if</span><span class="w"> </span>Extension<span class="w"> </span>not<span class="w"> </span>in<span class="w"> </span>BMP<span class="p">,</span>DIB<span class="p">,</span>RLE<span class="p">,</span>JPG<span class="p">,</span>JPEG<span class="p">,</span>JPE<span class="p">,</span>JFIF<span class="p">,</span>GIF<span class="p">,</span>TIF<span class="p">,</span>TIFF<span class="p">,</span>PNG
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">	</span>Extension<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span>Extension

<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncodersSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>nCount<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>ci<span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncoders&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>nCount<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>ci<span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>nCount<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">   </span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%nCount%</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>Location<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>ci<span class="p">,</span><span class="w"> </span><span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">)</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Location<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">			</span><span class="nf">VarSetCapacity</span><span class="p">(</span>sString<span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Location<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">			</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>InStr<span class="p">(</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"> </span>Extension<span class="p">)</span>
<span class="w">				</span><span class="k">continue</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Location<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">			</span>sString<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">			</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%nSize%</span>
<span class="w">				</span>sString<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span>Chr<span class="p">(</span>NumGet<span class="p">(</span>Location<span class="o">+</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;char&quot;</span><span class="p">))</span>
<span class="w">			</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>InStr<span class="p">(</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"> </span>Extension<span class="p">)</span>
<span class="w">				</span><span class="k">continue</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span>pCodec<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span>ci<span class="o">+</span><span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="k">break</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>pCodec
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>

<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Quality<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">75</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>Quality<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>Quality<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>Quality<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Quality
<span class="w">		</span><span class="kr">if</span><span class="w"> </span>Extension<span class="w"> </span>in<span class="w"> </span><span class="p">.</span>JPG<span class="p">,.</span>JPEG<span class="p">,.</span>JPE<span class="p">,.</span>JFIF
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterListSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pCodec<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">			</span><span class="nf">VarSetCapacity</span><span class="p">(</span>EncoderParameters<span class="p">,</span><span class="w"> </span>nSize<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterList&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pCodec<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>EncoderParameters<span class="p">)</span>
<span class="w">			</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span>NumGet<span class="p">(</span>EncoderParameters<span class="p">)</span><span class="w">      </span><span class="c1">;%</span>
<span class="w">			</span><span class="p">{</span>
<span class="w">				</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>NumGet<span class="p">(</span>EncoderParameters<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>NumGet<span class="p">(</span>EncoderParameters<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="w">				</span><span class="p">{</span>
<span class="w">				   </span>p<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+&amp;</span>EncoderParameters
<span class="w">				   </span><span class="nf">NumPut</span><span class="p">(</span>Quality<span class="p">,</span><span class="w"> </span>NumGet<span class="p">(</span>NumPut<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span>NumPut<span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>p<span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">)))</span>
<span class="w">				   </span><span class="k">break</span>
<span class="w">				</span><span class="p">}</span>
<span class="w">			</span><span class="p">}</span><span class="w">      </span>
<span class="w">	  </span><span class="p">}</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sOutput<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wOutput<span class="p">,</span><span class="w"> </span>nSize<span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sOutput<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wOutput<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wOutput<span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>VarSetCapacity<span class="p">(</span>wOutput<span class="p">)</span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">		</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;gdiplus\GdipSaveImageToFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wOutput<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pCodec<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>p<span class="w"> </span><span class="o">?</span><span class="w"> </span>p<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">		</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;gdiplus\GdipSaveImageToFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sOutput<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pCodec<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>p<span class="w"> </span><span class="o">?</span><span class="w"> </span>p<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetPixel</span>
<span class="c1">; Description			Gets the ARGB of a pixel in a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">; x						x-coordinate of the pixel</span>
<span class="c1">; y						y-coordinate of the pixel</span>
<span class="c1">;</span>
<span class="c1">; return				Returns the ARGB value of the pixel</span>

<span class="nf">Gdip_GetPixel</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipBitmapGetPixel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>ARGB<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>ARGB
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_SetPixel</span>
<span class="c1">; Description			Sets the ARGB of a pixel in a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">; x						x-coordinate of the pixel</span>
<span class="c1">; y						y-coordinate of the pixel</span>
<span class="c1">;</span>
<span class="c1">; return				status enumeration. 0 = success</span>

<span class="nf">Gdip_SetPixel</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>ARGB<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipBitmapSetPixel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetImageWidth</span>
<span class="c1">; Description			Gives the width of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">;</span>
<span class="c1">; return				Returns the width in pixels of the supplied bitmap</span>

<span class="nf">Gdip_GetImageWidth</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageWidth&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>Width
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetImageHeight</span>
<span class="c1">; Description			Gives the height of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">;</span>
<span class="c1">; return				Returns the height in pixels of the supplied bitmap</span>

<span class="nf">Gdip_GetImageHeight</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageHeight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>Height
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetDimensions</span>
<span class="c1">; Description			Gives the width and height of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">; Width					ByRef variable. This variable will be set to the width of the bitmap</span>
<span class="c1">; Height				ByRef variable. This variable will be set to the height of the bitmap</span>
<span class="c1">;</span>
<span class="c1">; return				No return value</span>
<span class="c1">;						Gdip_GetDimensions(pBitmap, ThisWidth, ThisHeight) will set ThisWidth to the width and ThisHeight to the height</span>

<span class="nf">Gdip_GetDimensions</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>Height<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>Width<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageWidth<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">	</span>Height<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GetImageHeight<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_GetImagePixelFormat</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImagePixelFormat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Format<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>Format
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>

<span class="c1">; Function				Gdip_GetDpiX</span>
<span class="c1">; Description			Gives the horizontal dots per inch of the graphics of a bitmap</span>
<span class="c1">;</span>
<span class="c1">; pBitmap				Pointer to a bitmap</span>
<span class="c1">; Width					ByRef variable. This variable will be set to the width of the bitmap</span>
<span class="c1">; Height				ByRef variable. This variable will be set to the height of the bitmap</span>
<span class="c1">;</span>
<span class="c1">; return				No return value</span>
<span class="c1">;						Gdip_GetDimensions(pBitmap, ThisWidth, ThisHeight) will set ThisWidth to the width and ThisHeight to the height</span>

<span class="nf">Gdip_GetDpiX</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDpiX&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>dpix<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Round</span><span class="p">(</span>dpix<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetDpiY</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDpiY&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>dpiy<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Round</span><span class="p">(</span>dpiy<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetImageHorizontalResolution</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageHorizontalResolution&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>dpix<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Round</span><span class="p">(</span>dpix<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetImageVerticalResolution</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageVerticalResolution&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;float*&quot;</span><span class="p">,</span><span class="w"> </span>dpiy<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">Round</span><span class="p">(</span>dpiy<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_CreateBitmapFromFile</span><span class="p">(</span>sFile<span class="p">,</span><span class="w"> </span>IconNumber<span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>IconSize<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">SplitPath</span><span class="p">,</span><span class="w"> </span>sFile<span class="p">,,,</span><span class="w"> </span>ext
<span class="w">	</span><span class="kr">if</span><span class="w"> </span>ext<span class="w"> </span>in<span class="w"> </span>exe<span class="p">,</span>dll
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>Sizes<span class="w"> </span><span class="o">:=</span><span class="w"> </span>IconSize<span class="w"> </span><span class="o">?</span><span class="w"> </span>IconSize<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span><span class="mi">16</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>buf<span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span>
<span class="w">		</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span>Sizes<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PrivateExtractIcons&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span>sFile<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>IconNumber<span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">A_LoopField</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">			</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>hIcon
<span class="w">				</span><span class="k">continue</span>

<span class="w">			</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;GetIconInfo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>buf<span class="p">)</span>
<span class="w">			</span><span class="p">{</span>
<span class="w">				</span><span class="nf">DestroyIcon</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="w">				</span><span class="k">continue</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span>hbmColor<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>buf<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">			</span>hbmMask<span class="w">  </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>buf<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span>

<span class="w">			</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>hbmColor<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hbmColor<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>buf<span class="p">))</span>
<span class="w">			</span><span class="p">{</span>
<span class="w">				</span><span class="nf">DestroyIcon</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="w">				</span><span class="k">continue</span>
<span class="w">			</span><span class="p">}</span>
<span class="w">			</span><span class="k">break</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>hIcon
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="w">		</span>Width<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>buf<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">),</span><span class="w">  </span>Height<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>buf<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">)</span>
<span class="w">		</span>hbm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateDIBSection<span class="p">(</span>Width<span class="p">,</span><span class="w"> </span><span class="o">-</span>Height<span class="p">),</span><span class="w"> </span>hdc<span class="w"> </span><span class="o">:=</span><span class="w"> </span>CreateCompatibleDC<span class="p">(),</span><span class="w"> </span>obm<span class="w"> </span><span class="o">:=</span><span class="w"> </span>SelectObject<span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>hbm<span class="p">)</span>

<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;DrawIconEx&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdc<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="nf">DestroyIcon</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">		</span><span class="p">}</span>

<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>dib<span class="p">,</span><span class="w"> </span><span class="mi">84</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hbm<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">84</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>dib<span class="p">)</span>
<span class="w">		</span>Stride<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>dib<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">),</span><span class="w"> </span>Bits<span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>dib<span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>

<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromScan0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Stride<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mh">0x26200A</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Bits<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmapOld<span class="p">)</span>
<span class="w">		</span>pBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmap<span class="p">(</span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">),</span><span class="w"> </span>G<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_GraphicsFromImage<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">		</span><span class="nf">Gdip_DrawImage</span><span class="p">(</span>G<span class="p">,</span><span class="w"> </span>pBitmapOld<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">)</span>
<span class="w">		</span><span class="nf">SelectObject</span><span class="p">(</span>hdc<span class="p">,</span><span class="w"> </span>obm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteObject</span><span class="p">(</span>hbm<span class="p">),</span><span class="w"> </span><span class="nf">DeleteDC</span><span class="p">(</span>hdc<span class="p">)</span>
<span class="w">		</span><span class="nf">Gdip_DeleteGraphics</span><span class="p">(</span>G<span class="p">),</span><span class="w"> </span><span class="nf">Gdip_DisposeImage</span><span class="p">(</span>pBitmapOld<span class="p">)</span>
<span class="w">		</span><span class="nf">DestroyIcon</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">		</span><span class="p">{</span>
<span class="w">			</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wFile<span class="p">,</span><span class="w"> </span><span class="mi">1023</span><span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;kernel32\MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sFile<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wFile<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">)</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wFile<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">		</span><span class="p">}</span>
<span class="w">		</span><span class="k">else</span>
<span class="w">			</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sFile<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="nf">Gdip_CreateBitmapFromHBITMAP</span><span class="p">(</span>hBitmap<span class="p">,</span><span class="w"> </span>Palette<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHBITMAP&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Palette<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="nf">Gdip_CreateHBITMAPFromBitmap</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>Background<span class="o">=</span><span class="mh">0xffffffff</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHBITMAPFromBitmap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hbm<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Background<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hbm
<span class="p">}</span>

<span class="nf">Gdip_CreateBitmapFromHICON</span><span class="p">(</span>hIcon<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHICON&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="nf">Gdip_CreateHICONFromBitmap</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHICONFromBitmap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hIcon<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hIcon
<span class="p">}</span>

<span class="nf">Gdip_CreateBitmap</span><span class="p">(</span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span>Format<span class="o">=</span><span class="mh">0x26200A</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromScan0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Format<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="w">    </span><span class="k">Return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="nf">Gdip_CreateBitmapFromClipboard</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;IsClipboardFormatAvailable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>hBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetClipboardData&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>pBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateBitmapFromHBITMAP<span class="p">(</span>hBitmap<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span>
<span class="w">	</span><span class="nf">DeleteObject</span><span class="p">(</span>hBitmap<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmap
<span class="p">}</span>

<span class="nf">Gdip_SetBitmapToClipboard</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>hBitmap<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateHBITMAPFromBitmap<span class="p">(</span>pBitmap<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>VarSetCapacity<span class="p">(</span>oi<span class="p">,</span><span class="w"> </span><span class="mi">84</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>oi<span class="p">)</span>
<span class="w">	</span>hdib<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GlobalAlloc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="o">+</span>NumGet<span class="p">(</span>oi<span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="p">))</span>
<span class="w">	</span>pdib<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GlobalLock&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdib<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pdib<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>oi<span class="o">+</span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span>pdib<span class="o">+</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Uint&quot;</span><span class="p">,</span><span class="w"> </span>NumGet<span class="p">(</span>oi<span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>NumGet<span class="p">(</span>oi<span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="p">))</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalUnlock&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdib<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hBitmap<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;EmptyClipboard&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetClipboardData&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hdib<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_CloneBitmapArea</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>Format<span class="o">=</span><span class="mh">0x26200A</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCloneBitmapArea&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h
<span class="w">	</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Format<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBitmapDest<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBitmapDest
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Create resources</span>
<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_CreatePen</span><span class="p">(</span>ARGB<span class="p">,</span><span class="w"> </span>w<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePen1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>pPen
<span class="p">}</span>

<span class="nf">Gdip_CreatePenFromBrush</span><span class="p">(</span>pBrush<span class="p">,</span><span class="w"> </span>w<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePen2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pPen
<span class="p">}</span>

<span class="nf">Gdip_BrushCreateSolid</span><span class="p">(</span>ARGB<span class="o">=</span><span class="mh">0xff000000</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateSolidFill&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBrush
<span class="p">}</span>

<span class="c1">; HatchStyleHorizontal = 0</span>
<span class="c1">; HatchStyleVertical = 1</span>
<span class="c1">; HatchStyleForwardDiagonal = 2</span>
<span class="c1">; HatchStyleBackwardDiagonal = 3</span>
<span class="c1">; HatchStyleCross = 4</span>
<span class="c1">; HatchStyleDiagonalCross = 5</span>
<span class="c1">; HatchStyle05Percent = 6</span>
<span class="c1">; HatchStyle10Percent = 7</span>
<span class="c1">; HatchStyle20Percent = 8</span>
<span class="c1">; HatchStyle25Percent = 9</span>
<span class="c1">; HatchStyle30Percent = 10</span>
<span class="c1">; HatchStyle40Percent = 11</span>
<span class="c1">; HatchStyle50Percent = 12</span>
<span class="c1">; HatchStyle60Percent = 13</span>
<span class="c1">; HatchStyle70Percent = 14</span>
<span class="c1">; HatchStyle75Percent = 15</span>
<span class="c1">; HatchStyle80Percent = 16</span>
<span class="c1">; HatchStyle90Percent = 17</span>
<span class="c1">; HatchStyleLightDownwardDiagonal = 18</span>
<span class="c1">; HatchStyleLightUpwardDiagonal = 19</span>
<span class="c1">; HatchStyleDarkDownwardDiagonal = 20</span>
<span class="c1">; HatchStyleDarkUpwardDiagonal = 21</span>
<span class="c1">; HatchStyleWideDownwardDiagonal = 22</span>
<span class="c1">; HatchStyleWideUpwardDiagonal = 23</span>
<span class="c1">; HatchStyleLightVertical = 24</span>
<span class="c1">; HatchStyleLightHorizontal = 25</span>
<span class="c1">; HatchStyleNarrowVertical = 26</span>
<span class="c1">; HatchStyleNarrowHorizontal = 27</span>
<span class="c1">; HatchStyleDarkVertical = 28</span>
<span class="c1">; HatchStyleDarkHorizontal = 29</span>
<span class="c1">; HatchStyleDashedDownwardDiagonal = 30</span>
<span class="c1">; HatchStyleDashedUpwardDiagonal = 31</span>
<span class="c1">; HatchStyleDashedHorizontal = 32</span>
<span class="c1">; HatchStyleDashedVertical = 33</span>
<span class="c1">; HatchStyleSmallConfetti = 34</span>
<span class="c1">; HatchStyleLargeConfetti = 35</span>
<span class="c1">; HatchStyleZigZag = 36</span>
<span class="c1">; HatchStyleWave = 37</span>
<span class="c1">; HatchStyleDiagonalBrick = 38</span>
<span class="c1">; HatchStyleHorizontalBrick = 39</span>
<span class="c1">; HatchStyleWeave = 40</span>
<span class="c1">; HatchStylePlaid = 41</span>
<span class="c1">; HatchStyleDivot = 42</span>
<span class="c1">; HatchStyleDottedGrid = 43</span>
<span class="c1">; HatchStyleDottedDiamond = 44</span>
<span class="c1">; HatchStyleShingle = 45</span>
<span class="c1">; HatchStyleTrellis = 46</span>
<span class="c1">; HatchStyleSphere = 47</span>
<span class="c1">; HatchStyleSmallGrid = 48</span>
<span class="c1">; HatchStyleSmallCheckerBoard = 49</span>
<span class="c1">; HatchStyleLargeCheckerBoard = 50</span>
<span class="c1">; HatchStyleOutlinedDiamond = 51</span>
<span class="c1">; HatchStyleSolidDiamond = 52</span>
<span class="c1">; HatchStyleTotal = 53</span>
<span class="nf">Gdip_BrushCreateHatch</span><span class="p">(</span>ARGBfront<span class="p">,</span><span class="w"> </span>ARGBback<span class="p">,</span><span class="w"> </span>HatchStyle<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHatchBrush&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>HatchStyle<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGBfront<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGBback<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBrush
<span class="p">}</span>

<span class="c1">;GpStatus WINGDIPAPI GdipCreateTexture2I(GpImage *image, GpWrapMode wrapmode, INT x, INT y, INT width, INT height, GpTexture **texture)</span>
<span class="c1">;GpStatus WINGDIPAPI GdipCreateTexture2(GpImage *image, GpWrapMode wrapmode, REAL x, REAL y, REAL width, REAL height, GpTexture **texture)</span>
<span class="c1">;GpStatus WINGDIPAPI GdipCreateTexture(GpImage *image, GpWrapMode wrapmode, GpTexture **texture)</span>

<span class="nf">Gdip_CreateTextureBrush</span><span class="p">(</span>pBitmap<span class="p">,</span><span class="w"> </span>WrapMode<span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>x<span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>y<span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>w<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>w<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateTexture&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>WrapMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateTexture2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>WrapMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pBrush
<span class="p">}</span>

<span class="c1">; WrapModeTile = 0</span>
<span class="c1">; WrapModeTileFlipX = 1</span>
<span class="c1">; WrapModeTileFlipY = 2</span>
<span class="c1">; WrapModeTileFlipXY = 3</span>
<span class="c1">; WrapModeClamp = 4</span>
<span class="nf">Gdip_CreateLineBrush</span><span class="p">(</span>x1<span class="p">,</span><span class="w"> </span>y1<span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span>y2<span class="p">,</span><span class="w"> </span>ARGB1<span class="p">,</span><span class="w"> </span>ARGB2<span class="p">,</span><span class="w"> </span>WrapMode<span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">CreatePointF</span><span class="p">(</span>PointF1<span class="p">,</span><span class="w"> </span>x1<span class="p">,</span><span class="w"> </span>y1<span class="p">),</span><span class="w"> </span><span class="nf">CreatePointF</span><span class="p">(</span>PointF2<span class="p">,</span><span class="w"> </span>x2<span class="p">,</span><span class="w"> </span>y2<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateLineBrush&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF1<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF2<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB1<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB2<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>WrapMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>LGpBrush<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>LGpBrush
<span class="p">}</span>

<span class="c1">; LinearGradientModeHorizontal = 0</span>
<span class="c1">; LinearGradientModeVertical = 1</span>
<span class="c1">; LinearGradientModeForwardDiagonal = 2</span>
<span class="c1">; LinearGradientModeBackwardDiagonal = 3</span>
<span class="nf">Gdip_CreateLineBrushFromRect</span><span class="p">(</span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>ARGB1<span class="p">,</span><span class="w"> </span>ARGB2<span class="p">,</span><span class="w"> </span>LinearGradientMode<span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>WrapMode<span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">CreateRectF</span><span class="p">(</span>RectF<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateLineBrushFromRect&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RectF<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB1<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>ARGB2<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>LinearGradientMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>WrapMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>LGpBrush<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>LGpBrush
<span class="p">}</span>

<span class="nf">Gdip_CloneBrush</span><span class="p">(</span>pBrush<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kt">static</span><span class="w"> </span>pNewBrush
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>pNewBrush<span class="p">,</span><span class="w"> </span><span class="mi">288</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>pNewBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">288</span><span class="p">)</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>pNewBrush<span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span>pNewBrush
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Delete resources</span>
<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_DeletePen</span><span class="p">(</span>pPen<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeletePen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pPen<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteBrush</span><span class="p">(</span>pBrush<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteBrush&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DisposeImage</span><span class="p">(</span>pBitmap<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDisposeImage&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBitmap<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteGraphics</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteGraphics&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DisposeImageAttributes</span><span class="p">(</span>ImageAttr<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDisposeImageAttributes&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>ImageAttr<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteFont</span><span class="p">(</span>hFont<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteFont&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteStringFormat</span><span class="p">(</span>hFormat<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteStringFormat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteFontFamily</span><span class="p">(</span>hFamily<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteFontFamily&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFamily<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeleteMatrix</span><span class="p">(</span>Matrix<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteMatrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Matrix<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Text functions</span>
<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_TextToGraphics</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>Options<span class="p">,</span><span class="w"> </span>Font<span class="o">=</span><span class="s">&quot;Arial&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>Measure<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>IWidth<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>IHeight<span class="o">:=</span><span class="w"> </span>Height
<span class="w">	</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)X([\-\d\.]+)(p*)&quot;</span><span class="p">,</span><span class="w"> </span>xpos<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)Y([\-\d\.]+)(p*)&quot;</span><span class="p">,</span><span class="w"> </span>ypos<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)W([\-\d\.]+)(p*)&quot;</span><span class="p">,</span><span class="w"> </span>Width<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)H([\-\d\.]+)(p*)&quot;</span><span class="p">,</span><span class="w"> </span>Height<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)C(?!(entre|enter))([a-f\d]+)&quot;</span><span class="p">,</span><span class="w"> </span>Colour<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)Top|Up|Bottom|Down|vCentre|vCenter&quot;</span><span class="p">,</span><span class="w"> </span>vPos<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)R(\d)&quot;</span><span class="p">,</span><span class="w"> </span>Rendering<span class="p">)</span>
<span class="w">	</span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;i)S(\d+)(p*)&quot;</span><span class="p">,</span><span class="w"> </span>Size<span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>Gdip_DeleteBrush<span class="p">(</span>Gdip_CloneBrush<span class="p">(</span>Colour2<span class="p">))</span>
<span class="w">		</span>PassBrush<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>pBrush<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Colour2
<span class="w">	</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>IWidth<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>IHeight<span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>xpos2<span class="w"> </span><span class="o">||</span><span class="w"> </span>ypos2<span class="w"> </span><span class="o">||</span><span class="w"> </span>Width2<span class="w"> </span><span class="o">||</span><span class="w"> </span>Height2<span class="w"> </span><span class="o">||</span><span class="w"> </span>Size2<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="w">	</span>Style<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Styles<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Regular|Bold|Italic|BoldItalic|Underline|Strikeout&quot;</span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span>Styles<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;\b&quot;</span><span class="w"> </span><span class="nb">A_loopField</span><span class="p">)</span>
<span class="w">		</span>Style<span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="nb">A_LoopField</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;StrikeOut&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">  </span>
<span class="w">	</span>Align<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Alignments<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Near|Left|Centre|Center|Far|Right&quot;</span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span>Parse<span class="p">,</span><span class="w"> </span>Alignments<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="kr">if</span><span class="w"> </span><span class="nf">RegExMatch</span><span class="p">(</span>Options<span class="p">,</span><span class="w"> </span><span class="s">&quot;\b&quot;</span><span class="w"> </span><span class="nb">A_loopField</span><span class="p">)</span>
<span class="w">			</span>Align<span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="nb">A_Index</span><span class="o">//</span><span class="mf">2.1</span><span class="w">      </span><span class="c1">; 0|0|1|1|2|2</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span>xpos<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>xpos1<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>xpos2<span class="w"> </span><span class="o">?</span><span class="w"> </span>IWidth<span class="o">*</span><span class="p">(</span>xpos1<span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>xpos1<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span>ypos<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>ypos1<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>ypos2<span class="w"> </span><span class="o">?</span><span class="w"> </span>IHeight<span class="o">*</span><span class="p">(</span>ypos1<span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>ypos1<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span>Width<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Width1<span class="w"> </span><span class="o">?</span><span class="w"> </span>Width2<span class="w"> </span><span class="o">?</span><span class="w"> </span>IWidth<span class="o">*</span><span class="p">(</span>Width1<span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Width1<span class="w"> </span><span class="o">:</span><span class="w"> </span>IWidth
<span class="w">	</span>Height<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Height1<span class="w"> </span><span class="o">?</span><span class="w"> </span>Height2<span class="w"> </span><span class="o">?</span><span class="w"> </span>IHeight<span class="o">*</span><span class="p">(</span>Height1<span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Height1<span class="w"> </span><span class="o">:</span><span class="w"> </span>IHeight
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>PassBrush
<span class="w">		</span>Colour<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;0x&quot;</span><span class="w"> </span><span class="p">(</span>Colour2<span class="w"> </span><span class="o">?</span><span class="w"> </span>Colour2<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;ff000000&quot;</span><span class="p">)</span>
<span class="w">	</span>Rendering<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">((</span>Rendering1<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Rendering1<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Rendering1<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">	</span>Size<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>Size1<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Size2<span class="w"> </span><span class="o">?</span><span class="w"> </span>IHeight<span class="o">*</span><span class="p">(</span>Size1<span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>Size1<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">12</span>

<span class="w">	</span>hFamily<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_FontFamilyCreate<span class="p">(</span>Font<span class="p">)</span>
<span class="w">	</span>hFont<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_FontCreate<span class="p">(</span>hFamily<span class="p">,</span><span class="w"> </span>Size<span class="p">,</span><span class="w"> </span>Style<span class="p">)</span>
<span class="w">	</span>hFormat<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_StringFormatCreate<span class="p">(</span><span class="mh">0x4000</span><span class="p">)</span>
<span class="w">	</span>pBrush<span class="w"> </span><span class="o">:=</span><span class="w"> </span>PassBrush<span class="w"> </span><span class="o">?</span><span class="w"> </span>pBrush<span class="w"> </span><span class="o">:</span><span class="w"> </span>Gdip_BrushCreateSolid<span class="p">(</span>Colour<span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>hFamily<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>hFont<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>hFormat<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>pBrush<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">!</span>pGraphics<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">!</span>hFamily<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">!</span>hFont<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">!</span>hFormat<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">!</span>pBrush<span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">   </span>
<span class="w">	</span><span class="nf">CreateRectF</span><span class="p">(</span>RC<span class="p">,</span><span class="w"> </span>xpos<span class="p">,</span><span class="w"> </span>ypos<span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetStringFormatAlign</span><span class="p">(</span>hFormat<span class="p">,</span><span class="w"> </span>Align<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_SetTextRenderingHint</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Rendering<span class="p">)</span>
<span class="w">	</span>ReturnRC<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_MeasureString<span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span>RC<span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span>vPos
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>ReturnRC<span class="p">,</span><span class="w"> </span>ReturnRC<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">		</span>
<span class="w">		</span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;vCentre&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;vCenter&quot;</span><span class="p">)</span>
<span class="w">			</span>ypos<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span>Height<span class="o">-</span>ReturnRC4<span class="p">)</span><span class="o">//</span><span class="mi">2</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Top&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Up&quot;</span><span class="p">)</span>
<span class="w">			</span>ypos<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Bottom&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>vPos<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Down&quot;</span><span class="p">)</span>
<span class="w">			</span>ypos<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Height<span class="o">-</span>ReturnRC4
<span class="w">		</span>
<span class="w">		</span><span class="nf">CreateRectF</span><span class="p">(</span>RC<span class="p">,</span><span class="w"> </span>xpos<span class="p">,</span><span class="w"> </span>ypos<span class="p">,</span><span class="w"> </span>Width<span class="p">,</span><span class="w"> </span>ReturnRC4<span class="p">)</span>
<span class="w">		</span>ReturnRC<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_MeasureString<span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span>RC<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>Measure
<span class="w">		</span>E<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_DrawString<span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Text<span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>RC<span class="p">)</span>

<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>PassBrush
<span class="w">		</span><span class="nf">Gdip_DeleteBrush</span><span class="p">(</span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DeleteStringFormat</span><span class="p">(</span>hFormat<span class="p">)</span><span class="w">   </span>
<span class="w">	</span><span class="nf">Gdip_DeleteFont</span><span class="p">(</span>hFont<span class="p">)</span>
<span class="w">	</span><span class="nf">Gdip_DeleteFontFamily</span><span class="p">(</span>hFamily<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>E<span class="w"> </span><span class="o">?</span><span class="w"> </span>E<span class="w"> </span><span class="o">:</span><span class="w"> </span>ReturnRC
<span class="p">}</span>

<span class="nf">Gdip_DrawString</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>sString<span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span>pBrush<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>RectF<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wString<span class="p">,</span><span class="w"> </span>nSize<span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics
<span class="w">		</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RectF<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics
<span class="w">		</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RectF<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pBrush<span class="p">)</span>
<span class="w">	</span><span class="p">}</span><span class="w">	</span>
<span class="p">}</span>

<span class="nf">Gdip_MeasureString</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>sString<span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>RectF<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>RC<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wString<span class="p">,</span><span class="w"> </span>nSize<span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="w">   </span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipMeasureString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics
<span class="w">		</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RectF<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RC<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Chars<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Lines<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipMeasureString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics
<span class="w">		</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>sString<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RectF<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>RC<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Chars<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Lines<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span>RC<span class="w"> </span><span class="o">?</span><span class="w"> </span>NumGet<span class="p">(</span>RC<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span>NumGet<span class="p">(</span>RC<span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span>NumGet<span class="p">(</span>RC<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span>NumGet<span class="p">(</span>RC<span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span>Chars<span class="w"> </span><span class="s">&quot;|&quot;</span><span class="w"> </span>Lines<span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>

<span class="c1">; Near = 0</span>
<span class="c1">; Center = 1</span>
<span class="c1">; Far = 2</span>
<span class="nf">Gdip_SetStringFormatAlign</span><span class="p">(</span>hFormat<span class="p">,</span><span class="w"> </span>Align<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetStringFormatAlign&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Align<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_StringFormatCreate</span><span class="p">(</span>Format<span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>Lang<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateStringFormat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Format<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Lang<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hFormat<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>hFormat
<span class="p">}</span>

<span class="c1">; Regular = 0</span>
<span class="c1">; Bold = 1</span>
<span class="c1">; Italic = 2</span>
<span class="c1">; BoldItalic = 3</span>
<span class="c1">; Underline = 4</span>
<span class="c1">; Strikeout = 8</span>
<span class="nf">Gdip_FontCreate</span><span class="p">(</span>hFamily<span class="p">,</span><span class="w"> </span>Size<span class="p">,</span><span class="w"> </span>Style<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFont&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hFamily<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>Size<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Style<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hFont<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>hFont
<span class="p">}</span>

<span class="nf">Gdip_FontFamilyCreate</span><span class="p">(</span>Font<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="nb">A_IsUnicode</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span>nSize<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>Font<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nf">VarSetCapacity</span><span class="p">(</span>wFont<span class="p">,</span><span class="w"> </span>nSize<span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>Font<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>nSize<span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFontFamilyFromName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>wFont<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hFamily<span class="p">)</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">	</span><span class="k">else</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFontFamilyFromName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>Font<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>hFamily<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>hFamily
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Matrix functions</span>
<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_CreateAffineMatrix</span><span class="p">(</span>m11<span class="p">,</span><span class="w"> </span>m12<span class="p">,</span><span class="w"> </span>m21<span class="p">,</span><span class="w"> </span>m22<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateMatrix2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>m11<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>m12<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>m21<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>m22<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Matrix<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>Matrix
<span class="p">}</span>

<span class="nf">Gdip_CreateMatrix</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateMatrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Matrix<span class="p">)</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span>Matrix
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; GraphicsPath functions</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; Alternate = 0</span>
<span class="c1">; Winding = 1</span>
<span class="nf">Gdip_CreatePath</span><span class="p">(</span>BrushMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>BrushMode<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>Path
<span class="p">}</span>

<span class="nf">Gdip_AddPathEllipse</span><span class="p">(</span>Path<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipAddPathEllipse&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_AddPathPolygon</span><span class="p">(</span>Path<span class="p">,</span><span class="w"> </span>Points<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span>Points<span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span>Points0<span class="p">)</span><span class="w">   </span>
<span class="w">	</span><span class="k">Loop</span><span class="p">,</span><span class="w"> </span><span class="nv">%Points0%</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">		</span><span class="k">StringSplit</span><span class="p">,</span><span class="w"> </span>Coord<span class="p">,</span><span class="w"> </span>Points<span class="nv">%A_Index%</span><span class="p">,</span><span class="w"> </span><span class="p">`,</span>
<span class="w">		</span><span class="nf">NumPut</span><span class="p">(</span>Coord1<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">),</span><span class="w"> </span>NumPut<span class="p">(</span>Coord2<span class="p">,</span><span class="w"> </span>PointF<span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nb">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">}</span><span class="w">   </span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipAddPathPolygon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>PointF<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>Points0<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_DeletePath</span><span class="p">(</span>Path<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeletePath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Quality functions</span>
<span class="c1">;#####################################################################################</span>

<span class="c1">; SystemDefault = 0</span>
<span class="c1">; SingleBitPerPixelGridFit = 1</span>
<span class="c1">; SingleBitPerPixel = 2</span>
<span class="c1">; AntiAliasGridFit = 3</span>
<span class="c1">; AntiAlias = 4</span>
<span class="nf">Gdip_SetTextRenderingHint</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>RenderingHint<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetTextRenderingHint&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>RenderingHint<span class="p">)</span>
<span class="p">}</span>

<span class="c1">; Default = 0</span>
<span class="c1">; LowQuality = 1</span>
<span class="c1">; HighQuality = 2</span>
<span class="c1">; Bilinear = 3</span>
<span class="c1">; Bicubic = 4</span>
<span class="c1">; NearestNeighbor = 5</span>
<span class="c1">; HighQualityBilinear = 6</span>
<span class="c1">; HighQualityBicubic = 7</span>
<span class="nf">Gdip_SetInterpolationMode</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>InterpolationMode<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetInterpolationMode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>InterpolationMode<span class="p">)</span>
<span class="p">}</span>

<span class="c1">; Default = 0</span>
<span class="c1">; HighSpeed = 1</span>
<span class="c1">; HighQuality = 2</span>
<span class="c1">; None = 3</span>
<span class="c1">; AntiAlias = 4</span>
<span class="nf">Gdip_SetSmoothingMode</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>SmoothingMode<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetSmoothingMode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>SmoothingMode<span class="p">)</span>
<span class="p">}</span>

<span class="c1">; CompositingModeSourceOver = 0 (blended)</span>
<span class="c1">; CompositingModeSourceCopy = 1 (overwrite)</span>
<span class="nf">Gdip_SetCompositingMode</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>CompositingMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetCompositingMode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>CompositingMode<span class="p">)</span>
<span class="p">}</span>

<span class="c1">;#####################################################################################</span>
<span class="c1">; Extra functions</span>
<span class="c1">;#####################################################################################</span>

<span class="nf">Gdip_Startup</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nf">VarSetCapacity</span><span class="p">(</span>si<span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span>si<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Chr<span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusStartup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>pToken<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span>si<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>pToken
<span class="p">}</span>

<span class="nf">Gdip_Shutdown</span><span class="p">(</span>pToken<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusShutdown&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pToken<span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span>hModule<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;FreeLibrary&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>hModule<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>

<span class="c1">; Prepend = 0; The new operation is applied before the old operation.</span>
<span class="c1">; Append = 1; The new operation is applied after the old operation.</span>
<span class="nf">Gdip_RotateWorldTransform</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Angle<span class="p">,</span><span class="w"> </span>MatrixOrder<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipRotateWorldTransform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>Angle<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>MatrixOrder<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_ScaleWorldTransform</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>MatrixOrder<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipScaleWorldTransform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>MatrixOrder<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_TranslateWorldTransform</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>MatrixOrder<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipTranslateWorldTransform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>MatrixOrder<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_ResetWorldTransform</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipResetWorldTransform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetRotatedTranslation</span><span class="p">(</span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span>Angle<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>xTranslation<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>yTranslation<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>pi<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">3.14159</span><span class="p">,</span><span class="w"> </span>TAngle<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Angle<span class="o">*</span><span class="p">(</span>pi<span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="w">	</span>

<span class="w">	</span>Bound<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>Angle<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>Mod<span class="p">(</span>Angle<span class="p">,</span><span class="w"> </span><span class="mi">360</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">360</span><span class="o">-</span>Mod<span class="p">(</span><span class="o">-</span>Angle<span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">360</span><span class="p">)</span>
<span class="w">	</span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>Bound<span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Bound<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span>
<span class="w">		</span>xTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Height<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">),</span><span class="w"> </span>yTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>Bound<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Bound<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">180</span><span class="p">))</span>
<span class="w">		</span>xTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>Height<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">))</span><span class="o">-</span><span class="p">(</span>Width<span class="o">*</span>Cos<span class="p">(</span>TAngle<span class="p">)),</span><span class="w"> </span>yTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span>Height<span class="o">*</span>Cos<span class="p">(</span>TAngle<span class="p">)</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>Bound<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">180</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Bound<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">270</span><span class="p">))</span>
<span class="w">		</span>xTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span>Width<span class="o">*</span>Cos<span class="p">(</span>TAngle<span class="p">)),</span><span class="w"> </span>yTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span>Height<span class="o">*</span>Cos<span class="p">(</span>TAngle<span class="p">))</span><span class="o">-</span><span class="p">(</span>Width<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">))</span>
<span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>Bound<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">270</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>Bound<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">360</span><span class="p">))</span>
<span class="w">		</span>xTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>yTranslation<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span>Width<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetRotatedDimensions</span><span class="p">(</span>Width<span class="p">,</span><span class="w"> </span>Height<span class="p">,</span><span class="w"> </span>Angle<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>RWidth<span class="p">,</span><span class="w"> </span>ByRef<span class="w"> </span>RHeight<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>pi<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">3.14159</span><span class="p">,</span><span class="w"> </span>TAngle<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Angle<span class="o">*</span><span class="p">(</span>pi<span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="w">	</span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>Width<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>Height<span class="p">)</span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">	</span>RWidth<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Ceil<span class="p">(</span>Abs<span class="p">(</span>Width<span class="o">*</span>Cos<span class="p">(</span>TAngle<span class="p">))</span><span class="o">+</span>Abs<span class="p">(</span>Height<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">)))</span>
<span class="w">	</span>RHeight<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Ceil<span class="p">(</span>Abs<span class="p">(</span>Width<span class="o">*</span>Sin<span class="p">(</span>TAngle<span class="p">))</span><span class="o">+</span>Abs<span class="p">(</span>Height<span class="o">*</span>Cos<span class="p">(</span>Tangle<span class="p">)))</span>
<span class="p">}</span>

<span class="c1">; Replace = 0</span>
<span class="c1">; Intersect = 1</span>
<span class="c1">; Union = 2</span>
<span class="c1">; Xor = 3</span>
<span class="c1">; Exclude = 4</span>
<span class="c1">; Complement = 5</span>
<span class="nf">Gdip_SetClipRect</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span>CombineMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipRect&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>x<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>y<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>w<span class="p">,</span><span class="w"> </span><span class="s">&quot;float&quot;</span><span class="p">,</span><span class="w"> </span>h<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>CombineMode<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_SetClipPath</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Path<span class="p">,</span><span class="w"> </span>CombineMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipPath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Path<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>CombineMode<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_ResetClip</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipResetClip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_GetClipRegion</span><span class="p">(</span>pGraphics<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span>Region<span class="w"> </span><span class="o">:=</span><span class="w"> </span>Gdip_CreateRegion<span class="p">()</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetClip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Region<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>Region
<span class="p">}</span>

<span class="nf">Gdip_SetClipRegion</span><span class="p">(</span>pGraphics<span class="p">,</span><span class="w"> </span>Region<span class="p">,</span><span class="w"> </span>CombineMode<span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipRegion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>pGraphics<span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Region<span class="p">,</span><span class="w"> </span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="w"> </span>CombineMode<span class="p">)</span>
<span class="p">}</span>

<span class="nf">Gdip_CreateRegion</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">	</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateRegion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint*&quot;</span><span class="p">,</span><span class="w"> </span>Region<span class="p">)</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span>Region
<span class="p">}</span>

<span class="nf">Gdip_DeleteRegion</span><span class="p">(</span>Region<span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteRegion&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>Region<span class="p">)</span>
<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; Gdip standard library v1.38 by tic (Tariq Porter) 28/08/10</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; STATUS ENUMERATION</span>
<span class="c-Singleline">; Return values for functions specified to have status enumerated return type</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; Ok =						= 0</span>
<span class="c-Singleline">; GenericError				= 1</span>
<span class="c-Singleline">; InvalidParameter			= 2</span>
<span class="c-Singleline">; OutOfMemory				= 3</span>
<span class="c-Singleline">; ObjectBusy				= 4</span>
<span class="c-Singleline">; InsufficientBuffer		= 5</span>
<span class="c-Singleline">; NotImplemented			= 6</span>
<span class="c-Singleline">; Win32Error				= 7</span>
<span class="c-Singleline">; WrongState				= 8</span>
<span class="c-Singleline">; Aborted					= 9</span>
<span class="c-Singleline">; FileNotFound				= 10</span>
<span class="c-Singleline">; ValueOverflow				= 11</span>
<span class="c-Singleline">; AccessDenied				= 12</span>
<span class="c-Singleline">; UnknownImageFormat		= 13</span>
<span class="c-Singleline">; FontFamilyNotFound		= 14</span>
<span class="c-Singleline">; FontStyleNotFound			= 15</span>
<span class="c-Singleline">; NotTrueTypeFont			= 16</span>
<span class="c-Singleline">; UnsupportedGdiplusVersion	= 17</span>
<span class="c-Singleline">; GdiplusNotInitialized		= 18</span>
<span class="c-Singleline">; PropertyNotFound			= 19</span>
<span class="c-Singleline">; PropertyNotSupported		= 20</span>
<span class="c-Singleline">; ProfileNotFound			= 21</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; FUNCTIONS</span>
<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; UpdateLayeredWindow(hwnd, hdc, x=&quot;&quot;, y=&quot;&quot;, w=&quot;&quot;, h=&quot;&quot;, Alpha=255)</span>
<span class="c-Singleline">; BitBlt(ddc, dx, dy, dw, dh, sdc, sx, sy, Raster=&quot;&quot;)</span>
<span class="c-Singleline">; StretchBlt(dDC, dx, dy, dw, dh, sDC, sx, sy, sw, sh, Raster=&quot;&quot;)</span>
<span class="c-Singleline">; SetImage(hwnd, hBitmap)</span>
<span class="c-Singleline">; Gdip_BitmapFromScreen(Screen=0, Raster=&quot;&quot;)</span>
<span class="c-Singleline">; CreateRectF(ByRef RectF, x, y, w, h)</span>
<span class="c-Singleline">; CreateSizeF(ByRef SizeF, w, h)</span>
<span class="c-Singleline">; CreateDIBSection</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function:     			UpdateLayeredWindow</span>
<span class="c-Singleline">; Description:  			Updates a layered window with the handle to the DC of a gdi bitmap</span>
<span class="c-Singleline">; </span>
<span class="c-Singleline">; hwnd        				Handle of the layered window to update</span>
<span class="c-Singleline">; hdc           			Handle to the DC of the GDI bitmap to update the window with</span>
<span class="c-Singleline">; Layeredx      			x position to place the window</span>
<span class="c-Singleline">; Layeredy      			y position to place the window</span>
<span class="c-Singleline">; Layeredw      			Width of the window</span>
<span class="c-Singleline">; Layeredh      			Height of the window</span>
<span class="c-Singleline">; Alpha         			Default = 255 : The transparency (0-255) to set the window transparency</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      				If the function succeeds, the return value is nonzero</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes						If x or y omitted, then layered window will use its current coordinates</span>
<span class="c-Singleline">;							If w or h omitted then current width and height will be used</span>

<span class="n">UpdateLayeredWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">||</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">WinGetPos</span><span class="p">,,,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span>
<span class="w">   </span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;UpdateLayeredWindow&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hwnd</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="p">((</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">))</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">&amp;</span><span class="n">pt</span>
	<span class="p">,</span> <span class="s">&quot;int64*&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">|</span><span class="n">h</span><span class="o">&lt;&lt;</span><span class="mi">32</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;int64*&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Alpha</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				BitBlt</span>
<span class="c-Singleline">; Description			The BitBlt function performs a bit-block transfer of the color data corresponding to a rectangle </span>
<span class="c-Singleline">;						of pixels from the specified source device context into a destination device context.</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; dDC					handle to destination DC</span>
<span class="c-Singleline">; dx					x-coord of destination upper-left corner</span>
<span class="c-Singleline">; dy					y-coord of destination upper-left corner</span>
<span class="c-Singleline">; dw					width of the area to copy</span>
<span class="c-Singleline">; dh					height of the area to copy</span>
<span class="c-Singleline">; sDC					handle to source DC</span>
<span class="c-Singleline">; sx					x-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sy					y-coordinate of source upper-left corner</span>
<span class="c-Singleline">; Raster				raster operation code</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is nonzero</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					If no raster operation is specified, then SRCCOPY is used, which copies the source directly to the destination rectangle</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; BLACKNESS				= 0x00000042</span>
<span class="c-Singleline">; NOTSRCERASE			= 0x001100A6</span>
<span class="c-Singleline">; NOTSRCCOPY			= 0x00330008</span>
<span class="c-Singleline">; SRCERASE				= 0x00440328</span>
<span class="c-Singleline">; DSTINVERT				= 0x00550009</span>
<span class="c-Singleline">; PATINVERT				= 0x005A0049</span>
<span class="c-Singleline">; SRCINVERT				= 0x00660046</span>
<span class="c-Singleline">; SRCAND				= 0x008800C6</span>
<span class="c-Singleline">; MERGEPAINT			= 0x00BB0226</span>
<span class="c-Singleline">; MERGECOPY				= 0x00C000CA</span>
<span class="c-Singleline">; SRCCOPY				= 0x00CC0020</span>
<span class="c-Singleline">; SRCPAINT				= 0x00EE0086</span>
<span class="c-Singleline">; PATCOPY				= 0x00F00021</span>
<span class="c-Singleline">; PATPAINT				= 0x00FB0A09</span>
<span class="c-Singleline">; WHITENESS				= 0x00FF0062</span>
<span class="c-Singleline">; CAPTUREBLT			= 0x40000000</span>
<span class="c-Singleline">; NOMIRRORBITMAP		= 0x80000000</span>

<span class="n">BitBlt</span><span class="p">(</span><span class="n">ddc</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">sdc</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">Raster</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\BitBlt&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dh</span>
	<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">sDC</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Raster</span> <span class="o">?</span> <span class="n">Raster</span> <span class="o">:</span> <span class="mh">0x00CC0020</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				StretchBlt</span>
<span class="c-Singleline">; Description			The StretchBlt function copies a bitmap from a source rectangle into a destination rectangle, </span>
<span class="c-Singleline">;						stretching or compressing the bitmap to fit the dimensions of the destination rectangle, if necessary.</span>
<span class="c-Singleline">;						The system stretches or compresses the bitmap according to the stretching mode currently set in the destination device context.</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; ddc					handle to destination DC</span>
<span class="c-Singleline">; dx					x-coord of destination upper-left corner</span>
<span class="c-Singleline">; dy					y-coord of destination upper-left corner</span>
<span class="c-Singleline">; dw					width of destination rectangle</span>
<span class="c-Singleline">; dh					height of destination rectangle</span>
<span class="c-Singleline">; sdc					handle to source DC</span>
<span class="c-Singleline">; sx					x-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sy					y-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sw					width of source rectangle</span>
<span class="c-Singleline">; sh					height of source rectangle</span>
<span class="c-Singleline">; Raster				raster operation code</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is nonzero</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					If no raster operation is specified, then SRCCOPY is used. It uses the same raster operations as BitBlt		</span>

<span class="n">StretchBlt</span><span class="p">(</span><span class="n">ddc</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">sdc</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="n">Raster</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\StretchBlt&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ddc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">dh</span>
	<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">sdc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Raster</span> <span class="o">?</span> <span class="n">Raster</span> <span class="o">:</span> <span class="mh">0x00CC0020</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				SetStretchBltMode</span>
<span class="c-Singleline">; Description			The SetStretchBltMode function sets the bitmap stretching mode in the specified device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					handle to the DC</span>
<span class="c-Singleline">; iStretchMode			The stretching mode, describing how the target will be stretched</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is the previous stretching mode. If it fails it will return 0</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; STRETCH_ANDSCANS 		= 0x01</span>
<span class="c-Singleline">; STRETCH_ORSCANS 		= 0x02</span>
<span class="c-Singleline">; STRETCH_DELETESCANS 	= 0x03</span>
<span class="c-Singleline">; STRETCH_HALFTONE 		= 0x04</span>

<span class="n">SetStretchBltMode</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">iStretchMode</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\SetStretchBltMode&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">iStretchMode</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				SetImage</span>
<span class="c-Singleline">; Description			Associates a new image with a static control</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hwnd					handle of the control to update</span>
<span class="c-Singleline">; hBitmap				a gdi bitmap to associate the static control with</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is nonzero</span>

<span class="n">SetImage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">SendMessage</span><span class="p">,</span> <span class="mh">0x172</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span>
	<span class="n">E</span> <span class="o">:=</span> <span class="nv">ErrorLevel</span>
	<span class="n">DeleteObject</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				SetSysColorToControl</span>
<span class="c-Singleline">; Description			Sets a solid colour to a control</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hwnd					handle of the control to update</span>
<span class="c-Singleline">; SysColor				A system colour to set to the control</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is zero</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					A control must have the 0xE style set to it so it is recognised as a bitmap</span>
<span class="c-Singleline">;						By default SysColor=15 is used which is COLOR_3DFACE. This is the standard background for a control</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; COLOR_3DDKSHADOW				= 21</span>
<span class="c-Singleline">; COLOR_3DFACE					= 15</span>
<span class="c-Singleline">; COLOR_3DHIGHLIGHT				= 20</span>
<span class="c-Singleline">; COLOR_3DHILIGHT				= 20</span>
<span class="c-Singleline">; COLOR_3DLIGHT					= 22</span>
<span class="c-Singleline">; COLOR_3DSHADOW				= 16</span>
<span class="c-Singleline">; COLOR_ACTIVEBORDER			= 10</span>
<span class="c-Singleline">; COLOR_ACTIVECAPTION			= 2</span>
<span class="c-Singleline">; COLOR_APPWORKSPACE			= 12</span>
<span class="c-Singleline">; COLOR_BACKGROUND				= 1</span>
<span class="c-Singleline">; COLOR_BTNFACE					= 15</span>
<span class="c-Singleline">; COLOR_BTNHIGHLIGHT			= 20</span>
<span class="c-Singleline">; COLOR_BTNHILIGHT				= 20</span>
<span class="c-Singleline">; COLOR_BTNSHADOW				= 16</span>
<span class="c-Singleline">; COLOR_BTNTEXT					= 18</span>
<span class="c-Singleline">; COLOR_CAPTIONTEXT				= 9</span>
<span class="c-Singleline">; COLOR_DESKTOP					= 1</span>
<span class="c-Singleline">; COLOR_GRADIENTACTIVECAPTION	= 27</span>
<span class="c-Singleline">; COLOR_GRADIENTINACTIVECAPTION	= 28</span>
<span class="c-Singleline">; COLOR_GRAYTEXT				= 17</span>
<span class="c-Singleline">; COLOR_HIGHLIGHT				= 13</span>
<span class="c-Singleline">; COLOR_HIGHLIGHTTEXT			= 14</span>
<span class="c-Singleline">; COLOR_HOTLIGHT				= 26</span>
<span class="c-Singleline">; COLOR_INACTIVEBORDER			= 11</span>
<span class="c-Singleline">; COLOR_INACTIVECAPTION			= 3</span>
<span class="c-Singleline">; COLOR_INACTIVECAPTIONTEXT		= 19</span>
<span class="c-Singleline">; COLOR_INFOBK					= 24</span>
<span class="c-Singleline">; COLOR_INFOTEXT				= 23</span>
<span class="c-Singleline">; COLOR_MENU					= 4</span>
<span class="c-Singleline">; COLOR_MENUHILIGHT				= 29</span>
<span class="c-Singleline">; COLOR_MENUBAR					= 30</span>
<span class="c-Singleline">; COLOR_MENUTEXT				= 7</span>
<span class="c-Singleline">; COLOR_SCROLLBAR				= 0</span>
<span class="c-Singleline">; COLOR_WINDOW					= 5</span>
<span class="c-Singleline">; COLOR_WINDOWFRAME				= 6</span>
<span class="c-Singleline">; COLOR_WINDOWTEXT				= 8</span>

<span class="n">SetSysColorToControl</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">SysColor</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">WinGetPos</span><span class="p">,,,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span>
   <span class="n">bc</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetSysColor&quot;</span><span class="p">,</span> <span class="s">&quot;Int&quot;</span><span class="p">,</span> <span class="n">SysColor</span><span class="p">)</span>
   <span class="n">pBrushClear</span> <span class="o">:=</span> <span class="n">Gdip_BrushCreateSolid</span><span class="p">(</span><span class="mh">0xff000000</span> <span class="o">|</span> <span class="p">(</span><span class="n">bc</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">bc</span> <span class="o">&amp;</span> <span class="mh">0xff00</span> <span class="o">|</span> <span class="p">(</span><span class="n">bc</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">))</span>
   <span class="n">pBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmap</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">G</span> <span class="o">:=</span> <span class="n">Gdip_GraphicsFromImage</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
   <span class="n">Gdip_FillRectangle</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pBrushClear</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
   <span class="n">hBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateHBITMAPFromBitmap</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
   <span class="n">SetImage</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">)</span>
   <span class="n">Gdip_DeleteBrush</span><span class="p">(</span><span class="n">pBrushClear</span><span class="p">)</span>
   <span class="n">Gdip_DeleteGraphics</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">Gdip_DisposeImage</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">),</span> <span class="n">DeleteObject</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="mi">0</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_BitmapFromScreen</span>
<span class="c-Singleline">; Description			Gets a gdi+ bitmap from the screen</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; Screen				0 = All screens</span>
<span class="c-Singleline">;						Any numerical value = Just that screen</span>
<span class="c-Singleline">;						x|y|w|h = Take specific coordinates with a width and height</span>
<span class="c-Singleline">; Raster				raster operation code</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c-Singleline">;						-1:		one or more of x,y,w,h not passed properly</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					If no raster operation is specified, then SRCCOPY is used to the returned bitmap</span>

<span class="n">Gdip_BitmapFromScreen</span><span class="p">(</span><span class="n">Screen</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Raster</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Screen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">Sysget</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">76</span>
<span class="w">		</span><span class="nb">Sysget</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">77</span>	
<span class="w">		</span><span class="nb">Sysget</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">78</span>
<span class="w">		</span><span class="nb">Sysget</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">79</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Screen</span><span class="o">&amp;</span><span class="mi">1</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">Sysget</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">Monitor</span><span class="p">,</span> <span class="nv">%Screen%</span>
		<span class="n">x</span> <span class="o">:=</span> <span class="n">MLeft</span><span class="p">,</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">MTop</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">MRight</span><span class="o">-</span><span class="n">MLeft</span><span class="p">,</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">MBottom</span><span class="o">-</span><span class="n">MTop</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Screen</span><span class="p">,</span> <span class="o">|</span>
		<span class="n">x</span> <span class="o">:=</span> <span class="n">S1</span><span class="p">,</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">S2</span><span class="p">,</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">S3</span><span class="p">,</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">S4</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">w</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>
	
	<span class="n">chdc</span> <span class="o">:=</span> <span class="n">CreateCompatibleDC</span><span class="p">(),</span> <span class="n">hbm</span> <span class="o">:=</span> <span class="n">CreateDIBSection</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">chdc</span><span class="p">),</span> <span class="n">obm</span> <span class="o">:=</span> <span class="n">SelectObject</span><span class="p">(</span><span class="n">chdc</span><span class="p">,</span> <span class="n">hbm</span><span class="p">),</span> <span class="n">hhdc</span> <span class="o">:=</span> <span class="n">GetDC</span><span class="p">()</span>
	<span class="n">BitBlt</span><span class="p">(</span><span class="n">chdc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">hhdc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Raster</span><span class="p">)</span>
	<span class="n">ReleaseDC</span><span class="p">(</span><span class="n">hhdc</span><span class="p">)</span>
	
	<span class="n">pBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmapFromHBITMAP</span><span class="p">(</span><span class="n">hbm</span><span class="p">)</span>
	<span class="n">SelectObject</span><span class="p">(</span><span class="n">hhdc</span><span class="p">,</span> <span class="n">obm</span><span class="p">),</span> <span class="n">DeleteObject</span><span class="p">(</span><span class="n">hbm</span><span class="p">),</span> <span class="n">DeleteDC</span><span class="p">(</span><span class="n">hhdc</span><span class="p">),</span> <span class="n">DeleteDC</span><span class="p">(</span><span class="n">chdc</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_BitmapFromHWND</span>
<span class="c-Singleline">; Description			Uses PrintWindow to get a handle to the specified window and return a bitmap from it</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hwnd					handle to the window to get a bitmap from</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					Window must not be not minimised in order to get a handle to it&#39;s client area</span>

<span class="n">Gdip_BitmapFromHWND</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">WinGetPos</span><span class="p">,,,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span>
	<span class="n">hbm</span> <span class="o">:=</span> <span class="n">CreateDIBSection</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">),</span> <span class="n">hdc</span> <span class="o">:=</span> <span class="n">CreateCompatibleDC</span><span class="p">(),</span> <span class="n">obm</span> <span class="o">:=</span> <span class="n">SelectObject</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">hbm</span><span class="p">)</span>
	<span class="n">PrintWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
	<span class="n">pBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmapFromHBITMAP</span><span class="p">(</span><span class="n">hbm</span><span class="p">)</span>
	<span class="n">SelectObject</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">obm</span><span class="p">),</span> <span class="n">DeleteObject</span><span class="p">(</span><span class="n">hbm</span><span class="p">),</span> <span class="n">DeleteDC</span><span class="p">(</span><span class="n">hdc</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function    			CreateRectF</span>
<span class="c-Singleline">; Description			Creates a RectF object, containing a the coordinates and dimensions of a rectangle</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; RectF       			Name to call the RectF object</span>
<span class="c-Singleline">; x            			x-coordinate of the upper left corner of the rectangle</span>
<span class="c-Singleline">; y            			y-coordinate of the upper left corner of the rectangle</span>
<span class="c-Singleline">; w            			Width of the rectangle</span>
<span class="c-Singleline">; h            			Height of the rectangle</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			No return value</span>

<span class="n">CreateRectF</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">RectF</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RectF</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">RectF</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">RectF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">RectF</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">RectF</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function		    	CreateSizeF</span>
<span class="c-Singleline">; Description			Creates a SizeF object, containing an 2 values</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; SizeF         		Name to call the SizeF object</span>
<span class="c-Singleline">; w            			w-value for the SizeF object</span>
<span class="c-Singleline">; h            			h-value for the SizeF object</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			No Return value</span>

<span class="n">CreateSizeF</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">SizeF</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">SizeF</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">SizeF</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">SizeF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>     
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function		    	CreatePointF</span>
<span class="c-Singleline">; Description			Creates a SizeF object, containing an 2 values</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; SizeF         		Name to call the SizeF object</span>
<span class="c-Singleline">; w            			w-value for the SizeF object</span>
<span class="c-Singleline">; h            			h-value for the SizeF object</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			No Return value</span>

<span class="n">CreatePointF</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">PointF</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
   <span class="nf">NumPut</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>     
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				CreateDIBSection</span>
<span class="c-Singleline">; Description			The CreateDIBSection function creates a DIB (Device Independent Bitmap) that applications can write to directly</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; w						width of the bitmap to create</span>
<span class="c-Singleline">; h						height of the bitmap to create</span>
<span class="c-Singleline">; hdc					a handle to the device context to use the palette from</span>
<span class="c-Singleline">; bpp					bits per pixel (32 = ARGB)</span>
<span class="c-Singleline">; ppvBits				A pointer to a variable that receives a pointer to the location of the DIB bit values</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns a DIB. A gdi bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					ppvBits will receive the location of the pixels in the DIB</span>

<span class="n">CreateDIBSection</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">hdc</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">bpp</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">ppvBits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">hdc2</span> <span class="o">:=</span> <span class="n">hdc</span> <span class="o">?</span> <span class="n">hdc</span> <span class="o">:</span> <span class="n">GetDC</span><span class="p">()</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">bi</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">NumPut</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;ushort&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">bpp</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&quot;ushort&quot;</span><span class="p">)</span>
	<span class="n">hbm</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateDIBSection&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="p">,</span> <span class="n">hdc2</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="p">,</span> <span class="o">&amp;</span><span class="n">bi</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ppvBits</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	
	<span class="n">If</span> <span class="o">!</span><span class="n">hdc</span>
		<span class="n">ReleaseDC</span><span class="p">(</span><span class="n">hdc2</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hbm</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				PrintWindow</span>
<span class="c-Singleline">; Description			The PrintWindow function copies a visual window into the specified device context (DC), typically a printer DC</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hwnd					A handle to the window that will be copied</span>
<span class="c-Singleline">; hdc					A handle to the device context</span>
<span class="c-Singleline">; Flags					Drawing options</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, it returns a nonzero value</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; PW_CLIENTONLY			= 1</span>

<span class="n">PrintWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="n">Flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PrintWindow&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hwnd</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Flags</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				DestroyIcon</span>
<span class="c-Singleline">; Description			Destroys an icon and frees any memory the icon occupied</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hIcon					Handle to the icon to be destroyed. The icon must not be in use</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is nonzero</span>

<span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DestroyIcon&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="n">PaintDesktop</span><span class="p">(</span><span class="n">hdc</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PaintDesktop&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="n">CreateCompatibleBitmap</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdi32\CreateCompatibleBitmap&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				CreateCompatibleDC</span>
<span class="c-Singleline">; Description			This function creates a memory device context (DC) compatible with the specified device</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					Handle to an existing device context					</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns the handle to a device context or 0 on failure</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					If this handle is 0 (by default), the function creates a memory device context compatible with the application&#39;s current screen</span>

<span class="n">CreateCompatibleDC</span><span class="p">(</span><span class="n">hdc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateCompatibleDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				SelectObject</span>
<span class="c-Singleline">; Description			The SelectObject function selects an object into the specified device context (DC). The new object replaces the previous object of the same type</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					Handle to a DC</span>
<span class="c-Singleline">; hgdiobj				A handle to the object to be selected into the DC</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the selected object is not a region and the function succeeds, the return value is a handle to the object being replaced</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					The specified object must have been created by using one of the following functions</span>
<span class="c-Singleline">;						Bitmap - CreateBitmap, CreateBitmapIndirect, CreateCompatibleBitmap, CreateDIBitmap, CreateDIBSection (A single bitmap cannot be selected into more than one DC at the same time)</span>
<span class="c-Singleline">;						Brush - CreateBrushIndirect, CreateDIBPatternBrush, CreateDIBPatternBrushPt, CreateHatchBrush, CreatePatternBrush, CreateSolidBrush</span>
<span class="c-Singleline">;						Font - CreateFont, CreateFontIndirect</span>
<span class="c-Singleline">;						Pen - CreatePen, CreatePenIndirect</span>
<span class="c-Singleline">;						Region - CombineRgn, CreateEllipticRgn, CreateEllipticRgnIndirect, CreatePolygonRgn, CreateRectRgn, CreateRectRgnIndirect</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					If the selected object is a region and the function succeeds, the return value is one of the following value</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; SIMPLEREGION			= 2 Region consists of a single rectangle</span>
<span class="c-Singleline">; COMPLEXREGION			= 3 Region consists of more than one rectangle</span>
<span class="c-Singleline">; NULLREGION			= 1 Region is empty</span>

<span class="n">SelectObject</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">hgdiobj</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SelectObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hgdiobj</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				DeleteObject</span>
<span class="c-Singleline">; Description			This function deletes a logical pen, brush, font, bitmap, region, or palette, freeing all system resources associated with the object</span>
<span class="c-Singleline">;						After the object is deleted, the specified handle is no longer valid</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hObject				Handle to a logical pen, brush, font, bitmap, region, or palette to delete</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				Nonzero indicates success. Zero indicates that the specified handle is not valid or that the handle is currently selected into a device context</span>

<span class="n">DeleteObject</span><span class="p">(</span><span class="n">hObject</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hObject</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				GetDC</span>
<span class="c-Singleline">; Description			This function retrieves a handle to a display device context (DC) for the client area of the specified window.</span>
<span class="c-Singleline">;						The display device context can be used in subsequent graphics display interface (GDI) functions to draw in the client area of the window. </span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hwnd					Handle to the window whose device context is to be retrieved. If this value is NULL, GetDC retrieves the device context for the entire screen					</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				The handle the device context for the specified window&#39;s client area indicates success. NULL indicates failure</span>

<span class="n">GetDC</span><span class="p">(</span><span class="n">hwnd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hwnd</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				ReleaseDC</span>
<span class="c-Singleline">; Description			This function releases a device context (DC), freeing it for use by other applications. The effect of ReleaseDC depends on the type of device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					Handle to the device context to be released</span>
<span class="c-Singleline">; hwnd					Handle to the window whose device context is to be released</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				1 = released</span>
<span class="c-Singleline">;						0 = not released</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					The application must call the ReleaseDC function for each call to the GetWindowDC function and for each call to the GetDC function that retrieves a common device context</span>
<span class="c-Singleline">;						An application cannot use the ReleaseDC function to release a device context that was created by calling the CreateDC function; instead, it must use the DeleteDC function. </span>

<span class="n">ReleaseDC</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">hwnd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ReleaseDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hwnd</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				DeleteDC</span>
<span class="c-Singleline">; Description			The DeleteDC function deletes the specified device context (DC)</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					A handle to the device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is nonzero</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					An application must not delete a DC whose handle was obtained by calling the GetDC function. Instead, it must call the ReleaseDC function to free the DC</span>

<span class="n">DeleteDC</span><span class="p">(</span><span class="n">hdc</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_LibraryVersion</span>
<span class="c-Singleline">; Description			Get the current library version</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				the library version</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					This is useful for non compiled programs to ensure that a person doesn&#39;t run an old version when testing your scripts</span>

<span class="n">Gdip_LibraryVersion</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="mf">1.38</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function:    			Gdip_BitmapFromBRA</span>
<span class="c-Singleline">; Description: 			Gets a pointer to a gdi+ bitmap from a BRA file</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; BRAFromMemIn			The variable for a BRA file read to memory</span>
<span class="c-Singleline">; File					The name of the file, or its number that you would like (This depends on alternate parameter)</span>
<span class="c-Singleline">; Alternate				Changes whether the File parameter is the file name or its number</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			If the function succeeds, the return value is a pointer to a gdi+ bitmap</span>
<span class="c-Singleline">;						-1 = The BRA variable is empty</span>
<span class="c-Singleline">;						-2 = The BRA has an incorrect header</span>
<span class="c-Singleline">;						-3 = The BRA has information missing</span>
<span class="c-Singleline">;						-4 = Could not find file inside the BRA</span>

<span class="n">Gdip_BitmapFromBRA</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">BRAFromMemIn</span><span class="p">,</span> <span class="n">File</span><span class="p">,</span> <span class="n">Alternate</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">BRAFromMemIn</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">BRAFromMemIn</span><span class="p">,</span> <span class="se">`n</span>
	<span class="p">{</span>
		<span class="n">if</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
<span class="w">			</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Header</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="o">|</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">Header0</span> <span class="o">!=</span> <span class="mi">4</span> <span class="o">||</span> <span class="n">Header2</span> <span class="o">!=</span> <span class="s">&quot;BRA!&quot;</span><span class="p">)</span>
<span class="w">				</span><span class="nb">return</span> <span class="o">-</span><span class="mi">2</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="nv">A_Index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
		<span class="p">{</span>
<span class="w">			</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Info</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="o">|</span>
			<span class="n">if</span> <span class="p">(</span><span class="n">Info0</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span>
<span class="w">				</span><span class="nb">return</span> <span class="o">-</span><span class="mi">3</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">else</span>
<span class="w">			</span><span class="nb">break</span>
	<span class="p">}</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">Alternate</span>
<span class="w">		</span><span class="nb">StringReplace</span><span class="p">,</span> <span class="n">File</span><span class="p">,</span> <span class="n">File</span><span class="p">,</span> \<span class="p">,</span> \\<span class="p">,</span> <span class="n">All</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">BRAFromMemIn</span><span class="p">,</span> <span class="s">&quot;mi`n)^&quot;</span> <span class="p">(</span><span class="n">Alternate</span> <span class="o">?</span> <span class="n">File</span> <span class="s">&quot;\|.+?\|(\d+)\|(\d+)&quot;</span> <span class="o">:</span> <span class="s">&quot;\d+\|&quot;</span> <span class="n">File</span> <span class="s">&quot;\|(\d+)\|(\d+)&quot;</span><span class="p">)</span> <span class="s">&quot;$&quot;</span><span class="p">,</span> <span class="n">FileInfo</span><span class="p">)</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">FileInfo</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">4</span>

	<span class="n">hData</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalAlloc&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">FileInfo2</span><span class="p">)</span>
	<span class="n">pData</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalLock&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hData</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pData</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">BRAFromMemIn</span><span class="o">+</span><span class="n">Info2</span><span class="o">+</span><span class="n">FileInfo1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">FileInfo2</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalUnlock&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hData</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;ole32\CreateStreamOnHGlobal&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hData</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pStream</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromStream&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pStream</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">pStream</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pStream</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawRectangle</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of a rectangle into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the rectangle</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the rectangle</span>
<span class="c-Singleline">; w						width of the rectanlge</span>
<span class="c-Singleline">; h						height of the rectangle</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawRectangle&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawRoundedRectangle</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of a rounded rectangle into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the rounded rectangle</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the rounded rectangle</span>
<span class="c-Singleline">; w						width of the rectanlge</span>
<span class="c-Singleline">; h						height of the rectangle</span>
<span class="c-Singleline">; r						radius of the rounded corners</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawRoundedRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">E</span> <span class="o">:=</span> <span class="n">Gdip_DrawRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="n">Gdip_ResetClip</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">h</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_DrawEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_DrawEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_DrawEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_DrawEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_ResetClip</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawEllipse</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of an ellipse into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the rectangle the ellipse will be drawn into</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the rectangle the ellipse will be drawn into</span>
<span class="c-Singleline">; w						width of the ellipse</span>
<span class="c-Singleline">; h						height of the ellipse</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawEllipse&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawBezier</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of a bezier (a weighted curve) into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x1					x-coordinate of the start of the bezier</span>
<span class="c-Singleline">; y1					y-coordinate of the start of the bezier</span>
<span class="c-Singleline">; x2					x-coordinate of the first arc of the bezier</span>
<span class="c-Singleline">; y2					y-coordinate of the first arc of the bezier</span>
<span class="c-Singleline">; x3					x-coordinate of the second arc of the bezier</span>
<span class="c-Singleline">; y3					y-coordinate of the second arc of the bezier</span>
<span class="c-Singleline">; x4					x-coordinate of the end of the bezier</span>
<span class="c-Singleline">; y4					y-coordinate of the end of the bezier</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawBezier</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawBezier&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pgraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y2</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y4</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawArc</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of an arc into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x						x-coordinate of the start of the arc</span>
<span class="c-Singleline">; y						y-coordinate of the start of the arc</span>
<span class="c-Singleline">; w						width of the arc</span>
<span class="c-Singleline">; h						height of the arc</span>
<span class="c-Singleline">; StartAngle			specifies the angle between the x-axis and the starting point of the arc</span>
<span class="c-Singleline">; SweepAngle			specifies the angle between the starting and ending points of the arc</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawArc</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawArc&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawPie</span>
<span class="c-Singleline">; Description			This function uses a pen to draw the outline of a pie into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x						x-coordinate of the start of the pie</span>
<span class="c-Singleline">; y						y-coordinate of the start of the pie</span>
<span class="c-Singleline">; w						width of the pie</span>
<span class="c-Singleline">; h						height of the pie</span>
<span class="c-Singleline">; StartAngle			specifies the angle between the x-axis and the starting point of the pie</span>
<span class="c-Singleline">; SweepAngle			specifies the angle between the starting and ending points of the pie</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					as all coordinates are taken from the top left of each pixel, then the entire width/height should be specified as subtracting the pen width</span>

<span class="n">Gdip_DrawPie</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawPie&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawLine</span>
<span class="c-Singleline">; Description			This function uses a pen to draw a line into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; x1					x-coordinate of the start of the line</span>
<span class="c-Singleline">; y1					y-coordinate of the start of the line</span>
<span class="c-Singleline">; x2					x-coordinate of the end of the line</span>
<span class="c-Singleline">; y2					y-coordinate of the end of the line</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success		</span>

<span class="n">Gdip_DrawLine</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawLine&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawLines</span>
<span class="c-Singleline">; Description			This function uses a pen to draw a series of joined lines into the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pPen					Pointer to a pen</span>
<span class="c-Singleline">; Points				the coordinates of all the points passed as x1,y1|x2,y2|x3,y3.....</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success				</span>

<span class="n">Gdip_DrawLines</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="n">Points</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="o">|</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">Points0</span><span class="p">)</span>   
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%Points0%</span>
   <span class="p">{</span>
<span class="w">      </span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">Points</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="se">`,</span>
      <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord1</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord2</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
   <span class="p">}</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawLines&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Points0</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillRectangle</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a rectangle in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the rectangle</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the rectangle</span>
<span class="c-Singleline">; w						width of the rectanlge</span>
<span class="c-Singleline">; h						height of the rectangle</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_FillRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillRectangle&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">pBrush</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillRoundedRectangle</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a rounded rectangle in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the rounded rectangle</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the rounded rectangle</span>
<span class="c-Singleline">; w						width of the rectanlge</span>
<span class="c-Singleline">; h						height of the rectangle</span>
<span class="c-Singleline">; r						radius of the rounded corners</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_FillRoundedRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Region</span> <span class="o">:=</span> <span class="n">Gdip_GetClipRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">E</span> <span class="o">:=</span> <span class="n">Gdip_FillRectangle</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Region</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">h</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">Gdip_FillEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_FillEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_FillEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_FillEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
	<span class="n">Gdip_SetClipRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Region</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="n">Gdip_DeleteRegion</span><span class="p">(</span><span class="n">Region</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillPolygon</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a polygon in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; Points				the coordinates of all the points passed as x1,y1|x2,y2|x3,y3.....</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					Alternate will fill the polygon as a whole, wheras winding will fill each new &quot;segment&quot;</span>
<span class="c-Singleline">; Alternate 			= 0</span>
<span class="c-Singleline">; Winding 				= 1</span>

<span class="n">Gdip_FillPolygon</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">FillMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="o">|</span>
   <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">Points0</span><span class="p">)</span>   
<span class="w">   </span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%Points0%</span>
   <span class="p">{</span>
<span class="w">      </span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">Points</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="se">`,</span>
      <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord1</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord2</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
   <span class="p">}</span>   
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPolygon&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Points0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">FillMode</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillPie</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a pie in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the pie</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the pie</span>
<span class="c-Singleline">; w						width of the pie</span>
<span class="c-Singleline">; h						height of the pie</span>
<span class="c-Singleline">; StartAngle			specifies the angle between the x-axis and the starting point of the pie</span>
<span class="c-Singleline">; SweepAngle			specifies the angle between the starting and ending points of the pie</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_FillPie</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPie&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span>
   <span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">StartAngle</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">SweepAngle</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillEllipse</span>
<span class="c-Singleline">; Description			This function uses a brush to fill an ellipse in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; x						x-coordinate of the top left of the ellipse</span>
<span class="c-Singleline">; y						y-coordinate of the top left of the ellipse</span>
<span class="c-Singleline">; w						width of the ellipse</span>
<span class="c-Singleline">; h						height of the ellipse</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_FillEllipse</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillEllipse&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillRegion</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a region in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; Region				Pointer to a Region</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					You can create a region Gdip_CreateRegion() and then add to this</span>

<span class="n">Gdip_FillRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">Region</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillRegion&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Region</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_FillPath</span>
<span class="c-Singleline">; Description			This function uses a brush to fill a path in the Graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBrush				Pointer to a brush</span>
<span class="c-Singleline">; Region				Pointer to a Path</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_FillPath</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipFillPath&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawImagePointsRect</span>
<span class="c-Singleline">; Description			This function draws a bitmap into the Graphics of another bitmap and skews it</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap to be drawn</span>
<span class="c-Singleline">; Points				Points passed as x1,y1|x2,y2|x3,y3 (3 points: top left, top right, bottom left) describing the drawing of the bitmap</span>
<span class="c-Singleline">; sx					x-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sy					y-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sw					width of source rectangle</span>
<span class="c-Singleline">; sh					height of source rectangle</span>
<span class="c-Singleline">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					if sx,sy,sw,sh are missed then the entire source bitmap will be used</span>
<span class="c-Singleline">;						Matrix can be omitted to just draw with no alteration to ARGB</span>
<span class="c-Singleline">;						Matrix may be passed as a digit from 0 - 1 to change just transparency</span>
<span class="c-Singleline">;						Matrix can be passed as a matrix with any delimiter</span>

<span class="n">Gdip_DrawImagePointsRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Matrix</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="o">|</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">Points0</span><span class="p">)</span>   
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%Points0%</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">Points</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="se">`,</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord1</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord2</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Matrix</span><span class="o">&amp;</span><span class="mi">1</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="n">ImageAttr</span> <span class="o">:=</span> <span class="n">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Matrix</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">ImageAttr</span> <span class="o">:=</span> <span class="n">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span><span class="s">&quot;1|0|0|0|0|0|1|0|0|0|0|0|1|0|0|0|0|0|&quot;</span> <span class="n">Matrix</span> <span class="s">&quot;|0|0|0|0|0|1&quot;</span><span class="p">)</span>
		
	<span class="n">if</span> <span class="p">(</span><span class="n">sx</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sy</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sw</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">sx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sy</span> <span class="o">:=</span> <span class="mi">0</span>
		<span class="n">sw</span> <span class="o">:=</span> <span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
		<span class="n">sh</span> <span class="o">:=</span> <span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">E</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawImagePointsRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span>
	<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Points0</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sh</span>
	<span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ImageAttr</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">ImageAttr</span>
		<span class="n">Gdip_DisposeImageAttributes</span><span class="p">(</span><span class="n">ImageAttr</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_DrawImage</span>
<span class="c-Singleline">; Description			This function draws a bitmap into the Graphics of another bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the Graphics of a bitmap</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap to be drawn</span>
<span class="c-Singleline">; dx					x-coord of destination upper-left corner</span>
<span class="c-Singleline">; dy					y-coord of destination upper-left corner</span>
<span class="c-Singleline">; dw					width of destination image</span>
<span class="c-Singleline">; dh					height of destination image</span>
<span class="c-Singleline">; sx					x-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sy					y-coordinate of source upper-left corner</span>
<span class="c-Singleline">; sw					width of source image</span>
<span class="c-Singleline">; sh					height of source image</span>
<span class="c-Singleline">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					if sx,sy,sw,sh are missed then the entire source bitmap will be used</span>
<span class="c-Singleline">;						Gdip_DrawImage performs faster</span>
<span class="c-Singleline">;						Matrix can be omitted to just draw with no alteration to ARGB</span>
<span class="c-Singleline">;						Matrix may be passed as a digit from 0 - 1 to change just transparency</span>
<span class="c-Singleline">;						Matrix can be passed as a matrix with any delimiter. For example:</span>
<span class="c-Singleline">;						MatrixBright=</span>
<span class="c-Singleline">;						(</span>
<span class="c-Singleline">;						1.5		|0		|0		|0		|0</span>
<span class="c-Singleline">;						0		|1.5	|0		|0		|0</span>
<span class="c-Singleline">;						0		|0		|1.5	|0		|0</span>
<span class="c-Singleline">;						0		|0		|0		|1		|0</span>
<span class="c-Singleline">;						0.05	|0.05	|0.05	|0		|1</span>
<span class="c-Singleline">;						)</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					MatrixBright = 1.5|0|0|0|0|0|1.5|0|0|0|0|0|1.5|0|0|0|0|0|1|0|0.05|0.05|0.05|0|1</span>
<span class="c-Singleline">;						MatrixGreyScale = 0.299|0.299|0.299|0|0|0.587|0.587|0.587|0|0|0.114|0.114|0.114|0|0|0|0|0|1|0|0|0|0|0|1</span>
<span class="c-Singleline">;						MatrixNegative = -1|0|0|0|0|0|-1|0|0|0|0|0|-1|0|0|0|0|0|1|0|0|0|0|0|1</span>

<span class="n">Gdip_DrawImage</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">dw</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sh</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Matrix</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Matrix</span><span class="o">&amp;</span><span class="mi">1</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="n">ImageAttr</span> <span class="o">:=</span> <span class="n">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Matrix</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">ImageAttr</span> <span class="o">:=</span> <span class="n">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span><span class="s">&quot;1|0|0|0|0|0|1|0|0|0|0|0|1|0|0|0|0|0|&quot;</span> <span class="n">Matrix</span> <span class="s">&quot;|0|0|0|0|0|1&quot;</span><span class="p">)</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">sx</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sy</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sw</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">if</span> <span class="p">(</span><span class="n">dx</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">dy</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">dw</span> <span class="o">=</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">dh</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">sx</span> <span class="o">:=</span> <span class="n">dx</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sy</span> <span class="o">:=</span> <span class="n">dy</span> <span class="o">:=</span> <span class="mi">0</span>
			<span class="n">sw</span> <span class="o">:=</span> <span class="n">dw</span> <span class="o">:=</span> <span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
			<span class="n">sh</span> <span class="o">:=</span> <span class="n">dh</span> <span class="o">:=</span> <span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">else</span>
		<span class="p">{</span>
			<span class="n">sx</span> <span class="o">:=</span> <span class="n">sy</span> <span class="o">:=</span> <span class="mi">0</span>
			<span class="n">sw</span> <span class="o">:=</span> <span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
			<span class="n">sh</span> <span class="o">:=</span> <span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">E</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawImageRectRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span>
	<span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">dh</span>
	<span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">sh</span>
	<span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ImageAttr</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">ImageAttr</span>
		<span class="n">Gdip_DisposeImageAttributes</span><span class="p">(</span><span class="n">ImageAttr</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_SetImageAttributesColorMatrix</span>
<span class="c-Singleline">; Description			This function creates an image matrix ready for drawing</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; Matrix				a matrix used to alter image attributes when drawing</span>
<span class="c-Singleline">;						passed with any delimeter</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns an image matrix on sucess or 0 if it fails</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					MatrixBright = 1.5|0|0|0|0|0|1.5|0|0|0|0|0|1.5|0|0|0|0|0|1|0|0.05|0.05|0.05|0|1</span>
<span class="c-Singleline">;						MatrixGreyScale = 0.299|0.299|0.299|0|0|0.587|0.587|0.587|0|0|0.114|0.114|0.114|0|0|0|0|0|1|0|0|0|0|0|1</span>
<span class="c-Singleline">;						MatrixNegative = -1|0|0|0|0|0|-1|0|0|0|0|0|-1|0|0|0|0|0|1|0|0|0|0|0|1</span>

<span class="n">Gdip_SetImageAttributesColorMatrix</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">ColourMatrix</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="n">Matrix</span> <span class="o">:=</span> <span class="nf">RegExReplace</span><span class="p">(</span><span class="nf">RegExReplace</span><span class="p">(</span><span class="n">Matrix</span><span class="p">,</span> <span class="s">&quot;^[^\d-\.]+([\d\.])&quot;</span><span class="p">,</span> <span class="s">&quot;$1&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;[^\d-\.]+&quot;</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="o">|</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="mi">25</span>
	<span class="p">{</span>
		<span class="n">Matrix</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Matrix</span><span class="nv">%A_Index%</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">Matrix</span><span class="nv">%A_Index%</span> <span class="o">:</span> <span class="nf">Mod</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">Matrix</span><span class="p">,</span> <span class="n">ColourMatrix</span><span class="p">,</span> <span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateImageAttributes&quot;</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ImageAttr</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetImageAttributesColorMatrix&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ImageAttr</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ColourMatrix</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">ImageAttr</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GraphicsFromImage</span>
<span class="c-Singleline">; Description			This function gets the graphics for a bitmap used for drawing functions</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap to get the pointer to its graphics</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns a pointer to the graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					a bitmap can be drawn into the graphics of another bitmap</span>

<span class="n">Gdip_GraphicsFromImage</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageGraphicsContext&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">pGraphics</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GraphicsFromHDC</span>
<span class="c-Singleline">; Description			This function gets the graphics from the handle to a device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					This is the handle to the device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns a pointer to the graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					You can draw a bitmap into the graphics of another bitmap</span>

<span class="n">Gdip_GraphicsFromHDC</span><span class="p">(</span><span class="n">hdc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFromHDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="w">    </span><span class="nb">return</span> <span class="n">pGraphics</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetDC</span>
<span class="c-Singleline">; Description			This function gets the device context of the passed Graphics</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; hdc					This is the handle to the device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				returns the device context for the graphics of a bitmap</span>

<span class="n">Gdip_GetDC</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hdc</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_ReleaseDC</span>
<span class="c-Singleline">; Description			This function releases a device context from use for further use</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the graphics of a bitmap</span>
<span class="c-Singleline">; hdc					This is the handle to the device context</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_ReleaseDC</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipReleaseDC&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GraphicsClear</span>
<span class="c-Singleline">; Description			Clears the graphics of a bitmap ready for further drawing</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pGraphics				Pointer to the graphics of a bitmap</span>
<span class="c-Singleline">; ARGB					The colour to clear the graphics to</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					By default this will make the background invisible</span>
<span class="c-Singleline">;						Using clipping regions you can clear a particular area on the graphics rather than clearing the entire graphics</span>

<span class="n">Gdip_GraphicsClear</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">ARGB</span><span class="o">=</span><span class="mh">0x00ffffff</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGraphicsClear&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_BlurBitmap</span>
<span class="c-Singleline">; Description			Gives a pointer to a blurred bitmap from a pointer to a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap to be blurred</span>
<span class="c-Singleline">; Blur					The Amount to blur a bitmap by from 1 (least blur) to 100 (most blur)</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				If the function succeeds, the return value is a pointer to the new blurred bitmap</span>
<span class="c-Singleline">;						-1 = The blur parameter is outside the range 1-100</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					This function will not dispose of the original bitmap</span>

<span class="n">Gdip_BlurBitmap</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">Blur</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="p">(</span><span class="n">Blur</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">Blur</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>	
	
	<span class="n">sWidth</span> <span class="o">:=</span> <span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">),</span> <span class="n">sHeight</span> <span class="o">:=</span> <span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
	<span class="n">dWidth</span> <span class="o">:=</span> <span class="n">sWidth</span><span class="o">//</span><span class="n">Blur</span><span class="p">,</span> <span class="n">dHeight</span> <span class="o">:=</span> <span class="n">sHeight</span><span class="o">//</span><span class="n">Blur</span>

	<span class="n">pBitmap1</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmap</span><span class="p">(</span><span class="n">dWidth</span><span class="p">,</span> <span class="n">dHeight</span><span class="p">)</span>
	<span class="n">G1</span> <span class="o">:=</span> <span class="n">Gdip_GraphicsFromImage</span><span class="p">(</span><span class="n">pBitmap1</span><span class="p">)</span>
	<span class="n">Gdip_SetInterpolationMode</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="n">Gdip_DrawImage</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dWidth</span><span class="p">,</span> <span class="n">dHeight</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sWidth</span><span class="p">,</span> <span class="n">sHeight</span><span class="p">)</span>

	<span class="n">Gdip_DeleteGraphics</span><span class="p">(</span><span class="n">G1</span><span class="p">)</span>

	<span class="n">pBitmap2</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmap</span><span class="p">(</span><span class="n">sWidth</span><span class="p">,</span> <span class="n">sHeight</span><span class="p">)</span>
	<span class="n">G2</span> <span class="o">:=</span> <span class="n">Gdip_GraphicsFromImage</span><span class="p">(</span><span class="n">pBitmap2</span><span class="p">)</span>
	<span class="n">Gdip_SetInterpolationMode</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="n">Gdip_DrawImage</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span> <span class="n">pBitmap1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sWidth</span><span class="p">,</span> <span class="n">sHeight</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dWidth</span><span class="p">,</span> <span class="n">dHeight</span><span class="p">)</span>

	<span class="n">Gdip_DeleteGraphics</span><span class="p">(</span><span class="n">G2</span><span class="p">)</span>
	<span class="n">Gdip_DisposeImage</span><span class="p">(</span><span class="n">pBitmap1</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap2</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function:     		Gdip_SaveBitmapToFile</span>
<span class="c-Singleline">; Description:  		Saves a bitmap to a file in any supported format onto disk</span>
<span class="c-Singleline">;   </span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">; sOutput      			The name of the file that the bitmap will be saved to. Supported extensions are: .BMP,.DIB,.RLE,.JPG,.JPEG,.JPE,.JFIF,.GIF,.TIF,.TIFF,.PNG</span>
<span class="c-Singleline">; Quality      			If saving as jpg (.JPG,.JPEG,.JPE,.JFIF) then quality can be 1-100 with default at maximum quality</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return      			If the function succeeds, the return value is zero, otherwise:</span>
<span class="c-Singleline">;						-1 = Extension supplied is not a supported file format</span>
<span class="c-Singleline">;						-2 = Could not get a list of encoders on system</span>
<span class="c-Singleline">;						-3 = Could not find matching encoder for specified file format</span>
<span class="c-Singleline">;						-4 = Could not get WideChar name of output file</span>
<span class="c-Singleline">;						-5 = Could not save file to disk</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; notes					This function will use the extension supplied from the sOutput parameter to determine the output format</span>

<span class="n">Gdip_SaveBitmapToFile</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">sOutput</span><span class="p">,</span> <span class="n">Quality</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">SplitPath</span><span class="p">,</span> <span class="n">sOutput</span><span class="p">,,,</span> <span class="n">Extension</span>
<span class="w">	</span><span class="nb">if </span><span class="n">Extension</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">BMP</span><span class="p">,</span><span class="n">DIB</span><span class="p">,</span><span class="n">RLE</span><span class="p">,</span><span class="n">JPG</span><span class="p">,</span><span class="n">JPEG</span><span class="p">,</span><span class="n">JPE</span><span class="p">,</span><span class="n">JFIF</span><span class="p">,</span><span class="n">GIF</span><span class="p">,</span><span class="n">TIF</span><span class="p">,</span><span class="n">TIFF</span><span class="p">,</span><span class="n">PNG</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>
	<span class="n">Extension</span> <span class="o">:=</span> <span class="s">&quot;.&quot;</span> <span class="n">Extension</span>

	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncodersSize&quot;</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">nCount</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageEncoders&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">nCount</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ci</span><span class="p">)</span>
	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">nCount</span> <span class="o">&amp;&amp;</span> <span class="n">nSize</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">2</span>
<span class="w">   </span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%nCount%</span>
	<span class="p">{</span>
		<span class="n">Location</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">44</span><span class="p">)</span>
		<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
		<span class="p">{</span>
			<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">if</span> <span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;*&quot;</span> <span class="n">Extension</span><span class="p">)</span>
<span class="w">				</span><span class="nb">continue</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">else</span>
		<span class="p">{</span>
			<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;WideCharToMultiByte&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">sString</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
<span class="w">			</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%nSize%</span>
				<span class="n">sString</span> <span class="o">.=</span> <span class="nf">Chr</span><span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">Location</span><span class="o">+</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;char&quot;</span><span class="p">))</span>
			<span class="n">if</span> <span class="o">!</span><span class="nf">InStr</span><span class="p">(</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;*&quot;</span> <span class="n">Extension</span><span class="p">)</span>
<span class="w">				</span><span class="nb">continue</span>
		<span class="p">}</span>
		<span class="n">pCodec</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">ci</span><span class="o">+</span><span class="mi">76</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">		</span><span class="nb">break</span>
	<span class="p">}</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">pCodec</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">3</span>

	<span class="n">if</span> <span class="p">(</span><span class="n">Quality</span> <span class="o">!=</span> <span class="mi">75</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Quality</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Quality</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="p">(</span><span class="n">Quality</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="n">Quality</span>
<span class="w">		</span><span class="nb">if </span><span class="n">Extension</span> <span class="ow">in</span> <span class="o">.</span><span class="n">JPG</span><span class="p">,</span><span class="o">.</span><span class="n">JPEG</span><span class="p">,</span><span class="o">.</span><span class="n">JPE</span><span class="p">,</span><span class="o">.</span><span class="n">JFIF</span>
		<span class="p">{</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterListSize&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
			<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">EncoderParameters</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetEncoderParameterList&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">EncoderParameters</span><span class="p">)</span>
<span class="w">			</span><span class="nb">Loop</span><span class="p">,</span> <span class="o">%</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">EncoderParameters</span><span class="p">)</span><span class="c-Singleline">      ;%</span>
			<span class="p">{</span>
				<span class="n">if</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">EncoderParameters</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">EncoderParameters</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
				<span class="p">{</span>
				   <span class="n">p</span> <span class="o">:=</span> <span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+&amp;</span><span class="n">EncoderParameters</span>
				   <span class="nf">NumPut</span><span class="p">(</span><span class="n">Quality</span><span class="p">,</span> <span class="nf">NumGet</span><span class="p">(</span><span class="nf">NumPut</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nf">NumPut</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">)))</span>
<span class="w">				   </span><span class="nb">break</span>
				<span class="p">}</span>
			<span class="p">}</span>      
	  <span class="p">}</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
	<span class="p">{</span>
		<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOutput</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wOutput</span><span class="p">,</span> <span class="n">nSize</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOutput</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wOutput</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wOutput</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">if</span> <span class="o">!</span><span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wOutput</span><span class="p">)</span>
<span class="w">			</span><span class="nb">return</span> <span class="o">-</span><span class="mi">4</span>
		<span class="n">E</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSaveImageToFile&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wOutput</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">p</span> <span class="o">?</span> <span class="n">p</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
		<span class="n">E</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSaveImageToFile&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sOutput</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pCodec</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">p</span> <span class="o">?</span> <span class="n">p</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span> <span class="o">?</span> <span class="o">-</span><span class="mi">5</span> <span class="o">:</span> <span class="mi">0</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetPixel</span>
<span class="c-Singleline">; Description			Gets the ARGB of a pixel in a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">; x						x-coordinate of the pixel</span>
<span class="c-Singleline">; y						y-coordinate of the pixel</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				Returns the ARGB value of the pixel</span>

<span class="n">Gdip_GetPixel</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipBitmapGetPixel&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">ARGB</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_SetPixel</span>
<span class="c-Singleline">; Description			Sets the ARGB of a pixel in a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">; x						x-coordinate of the pixel</span>
<span class="c-Singleline">; y						y-coordinate of the pixel</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				status enumeration. 0 = success</span>

<span class="n">Gdip_SetPixel</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipBitmapSetPixel&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetImageWidth</span>
<span class="c-Singleline">; Description			Gives the width of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				Returns the width in pixels of the supplied bitmap</span>

<span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageWidth&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">Width</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetImageHeight</span>
<span class="c-Singleline">; Description			Gives the height of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				Returns the height in pixels of the supplied bitmap</span>

<span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageHeight&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">Height</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetDimensions</span>
<span class="c-Singleline">; Description			Gives the width and height of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">; Width					ByRef variable. This variable will be set to the width of the bitmap</span>
<span class="c-Singleline">; Height				ByRef variable. This variable will be set to the height of the bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				No return value</span>
<span class="c-Singleline">;						Gdip_GetDimensions(pBitmap, ThisWidth, ThisHeight) will set ThisWidth to the width and ThisHeight to the height</span>

<span class="n">Gdip_GetDimensions</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Width</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Height</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Width</span> <span class="o">:=</span> <span class="n">Gdip_GetImageWidth</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
	<span class="n">Height</span> <span class="o">:=</span> <span class="n">Gdip_GetImageHeight</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_GetImagePixelFormat</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImagePixelFormat&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Format</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Format</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Function				Gdip_GetDpiX</span>
<span class="c-Singleline">; Description			Gives the horizontal dots per inch of the graphics of a bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; pBitmap				Pointer to a bitmap</span>
<span class="c-Singleline">; Width					ByRef variable. This variable will be set to the width of the bitmap</span>
<span class="c-Singleline">; Height				ByRef variable. This variable will be set to the height of the bitmap</span>
<span class="c-Singleline">;</span>
<span class="c-Singleline">; return				No return value</span>
<span class="c-Singleline">;						Gdip_GetDimensions(pBitmap, ThisWidth, ThisHeight) will set ThisWidth to the width and ThisHeight to the height</span>

<span class="n">Gdip_GetDpiX</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDpiX&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">dpix</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">Round</span><span class="p">(</span><span class="n">dpix</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetDpiY</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetDpiY&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">dpiy</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">Round</span><span class="p">(</span><span class="n">dpiy</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetImageHorizontalResolution</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageHorizontalResolution&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">dpix</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">Round</span><span class="p">(</span><span class="n">dpix</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetImageVerticalResolution</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetImageVerticalResolution&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;float*&quot;</span><span class="p">,</span> <span class="n">dpiy</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">Round</span><span class="p">(</span><span class="n">dpiy</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_CreateBitmapFromFile</span><span class="p">(</span><span class="n">sFile</span><span class="p">,</span> <span class="n">IconNumber</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">IconSize</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">SplitPath</span><span class="p">,</span> <span class="n">sFile</span><span class="p">,,,</span> <span class="n">ext</span>
<span class="w">	</span><span class="nb">if </span><span class="n">ext</span> <span class="ow">in</span> <span class="n">exe</span><span class="p">,</span><span class="n">dll</span>
	<span class="p">{</span>
		<span class="n">Sizes</span> <span class="o">:=</span> <span class="n">IconSize</span> <span class="o">?</span> <span class="n">IconSize</span> <span class="o">:</span> <span class="mi">256</span> <span class="s">&quot;|&quot;</span> <span class="mi">128</span> <span class="s">&quot;|&quot;</span> <span class="mi">64</span> <span class="s">&quot;|&quot;</span> <span class="mi">48</span> <span class="s">&quot;|&quot;</span> <span class="mi">32</span> <span class="s">&quot;|&quot;</span> <span class="mi">16</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="w">		</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">Sizes</span><span class="p">,</span> <span class="o">|</span>
		<span class="p">{</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;PrivateExtractIcons&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="n">sFile</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">IconNumber</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="nv">A_LoopField</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">if</span> <span class="o">!</span><span class="n">hIcon</span>
<span class="w">				</span><span class="nb">continue</span>

			<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetIconInfo&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
<span class="w">				</span><span class="nb">continue</span>
			<span class="p">}</span>
			<span class="n">hbmColor</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
			<span class="n">hbmMask</span>  <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

			<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">hbmColor</span> <span class="o">&amp;&amp;</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hbmColor</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">))</span>
			<span class="p">{</span>
				<span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
<span class="w">				</span><span class="nb">continue</span>
			<span class="p">}</span>
<span class="w">			</span><span class="nb">break</span>
		<span class="p">}</span>
		<span class="n">if</span> <span class="o">!</span><span class="n">hIcon</span>
<span class="w">			</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>

		<span class="n">Width</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">),</span>  <span class="n">Height</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">)</span>
		<span class="n">hbm</span> <span class="o">:=</span> <span class="n">CreateDIBSection</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="o">-</span><span class="n">Height</span><span class="p">),</span> <span class="n">hdc</span> <span class="o">:=</span> <span class="n">CreateCompatibleDC</span><span class="p">(),</span> <span class="n">obm</span> <span class="o">:=</span> <span class="n">SelectObject</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">hbm</span><span class="p">)</span>

		<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DrawIconEx&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdc</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
<span class="w">			</span><span class="nb">return</span> <span class="o">-</span><span class="mi">2</span>
		<span class="p">}</span>

		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">dib</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hbm</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dib</span><span class="p">)</span>
		<span class="n">Stride</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">dib</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">Bits</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">dib</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromScan0&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Stride</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mh">0x26200A</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Bits</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmapOld</span><span class="p">)</span>
		<span class="n">pBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmap</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">),</span> <span class="n">G</span> <span class="o">:=</span> <span class="n">Gdip_GraphicsFromImage</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
		<span class="n">Gdip_DrawImage</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pBitmapOld</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span>
		<span class="n">SelectObject</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="n">obm</span><span class="p">),</span> <span class="n">DeleteObject</span><span class="p">(</span><span class="n">hbm</span><span class="p">),</span> <span class="n">DeleteDC</span><span class="p">(</span><span class="n">hdc</span><span class="p">)</span>
		<span class="n">Gdip_DeleteGraphics</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">Gdip_DisposeImage</span><span class="p">(</span><span class="n">pBitmapOld</span><span class="p">)</span>
		<span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
	<span class="p">{</span>
		<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
		<span class="p">{</span>
			<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wFile</span><span class="p">,</span> <span class="mi">1023</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;kernel32\MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sFile</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wFile</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromFile&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wFile</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
		<span class="p">}</span>
<span class="w">		</span><span class="nb">else</span>
			<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromFile&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sFile</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span>

<span class="n">Gdip_CreateBitmapFromHBITMAP</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">,</span> <span class="n">Palette</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHBITMAP&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Palette</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span>

<span class="n">Gdip_CreateHBITMAPFromBitmap</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">Background</span><span class="o">=</span><span class="mh">0xffffffff</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHBITMAPFromBitmap&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hbm</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Background</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hbm</span>
<span class="p">}</span>

<span class="n">Gdip_CreateBitmapFromHICON</span><span class="p">(</span><span class="n">hIcon</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromHICON&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span>

<span class="n">Gdip_CreateHICONFromBitmap</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHICONFromBitmap&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hIcon</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hIcon</span>
<span class="p">}</span>

<span class="n">Gdip_CreateBitmap</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Format</span><span class="o">=</span><span class="mh">0x26200A</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateBitmapFromScan0&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Format</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
<span class="w">    </span><span class="nb">Return</span> <span class="n">pBitmap</span>
<span class="p">}</span>

<span class="n">Gdip_CreateBitmapFromClipboard</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>
	<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;IsClipboardFormatAvailable&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">2</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">hBitmap</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetClipboardData&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">3</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">pBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateBitmapFromHBITMAP</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">4</span>
	<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">5</span>
	<span class="n">DeleteObject</span><span class="p">(</span><span class="n">hBitmap</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmap</span>
<span class="p">}</span>

<span class="n">Gdip_SetBitmapToClipboard</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">hBitmap</span> <span class="o">:=</span> <span class="n">Gdip_CreateHBITMAPFromBitmap</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="p">)</span>
	<span class="n">hdib</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalAlloc&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="o">+</span><span class="nf">NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
	<span class="n">pdib</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalLock&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdib</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pdib</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oi</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="n">pdib</span><span class="o">+</span><span class="mi">40</span><span class="p">,</span> <span class="s">&quot;Uint&quot;</span><span class="p">,</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">oi</span><span class="p">,</span> <span class="mi">44</span><span class="p">))</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GlobalUnlock&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdib</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hBitmap</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;OpenClipboard&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;EmptyClipboard&quot;</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;SetClipboardData&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hdib</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CloseClipboard&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_CloneBitmapArea</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Format</span><span class="o">=</span><span class="mh">0x26200A</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCloneBitmapArea&quot;</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span>
	<span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Format</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBitmapDest</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBitmapDest</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Create resources</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_CreatePen</span><span class="p">(</span><span class="n">ARGB</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePen1&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">pPen</span>
<span class="p">}</span>

<span class="n">Gdip_CreatePenFromBrush</span><span class="p">(</span><span class="n">pBrush</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePen2&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pPen</span>
<span class="p">}</span>

<span class="n">Gdip_BrushCreateSolid</span><span class="p">(</span><span class="n">ARGB</span><span class="o">=</span><span class="mh">0xff000000</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateSolidFill&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBrush</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; HatchStyleHorizontal = 0</span>
<span class="c-Singleline">; HatchStyleVertical = 1</span>
<span class="c-Singleline">; HatchStyleForwardDiagonal = 2</span>
<span class="c-Singleline">; HatchStyleBackwardDiagonal = 3</span>
<span class="c-Singleline">; HatchStyleCross = 4</span>
<span class="c-Singleline">; HatchStyleDiagonalCross = 5</span>
<span class="c-Singleline">; HatchStyle05Percent = 6</span>
<span class="c-Singleline">; HatchStyle10Percent = 7</span>
<span class="c-Singleline">; HatchStyle20Percent = 8</span>
<span class="c-Singleline">; HatchStyle25Percent = 9</span>
<span class="c-Singleline">; HatchStyle30Percent = 10</span>
<span class="c-Singleline">; HatchStyle40Percent = 11</span>
<span class="c-Singleline">; HatchStyle50Percent = 12</span>
<span class="c-Singleline">; HatchStyle60Percent = 13</span>
<span class="c-Singleline">; HatchStyle70Percent = 14</span>
<span class="c-Singleline">; HatchStyle75Percent = 15</span>
<span class="c-Singleline">; HatchStyle80Percent = 16</span>
<span class="c-Singleline">; HatchStyle90Percent = 17</span>
<span class="c-Singleline">; HatchStyleLightDownwardDiagonal = 18</span>
<span class="c-Singleline">; HatchStyleLightUpwardDiagonal = 19</span>
<span class="c-Singleline">; HatchStyleDarkDownwardDiagonal = 20</span>
<span class="c-Singleline">; HatchStyleDarkUpwardDiagonal = 21</span>
<span class="c-Singleline">; HatchStyleWideDownwardDiagonal = 22</span>
<span class="c-Singleline">; HatchStyleWideUpwardDiagonal = 23</span>
<span class="c-Singleline">; HatchStyleLightVertical = 24</span>
<span class="c-Singleline">; HatchStyleLightHorizontal = 25</span>
<span class="c-Singleline">; HatchStyleNarrowVertical = 26</span>
<span class="c-Singleline">; HatchStyleNarrowHorizontal = 27</span>
<span class="c-Singleline">; HatchStyleDarkVertical = 28</span>
<span class="c-Singleline">; HatchStyleDarkHorizontal = 29</span>
<span class="c-Singleline">; HatchStyleDashedDownwardDiagonal = 30</span>
<span class="c-Singleline">; HatchStyleDashedUpwardDiagonal = 31</span>
<span class="c-Singleline">; HatchStyleDashedHorizontal = 32</span>
<span class="c-Singleline">; HatchStyleDashedVertical = 33</span>
<span class="c-Singleline">; HatchStyleSmallConfetti = 34</span>
<span class="c-Singleline">; HatchStyleLargeConfetti = 35</span>
<span class="c-Singleline">; HatchStyleZigZag = 36</span>
<span class="c-Singleline">; HatchStyleWave = 37</span>
<span class="c-Singleline">; HatchStyleDiagonalBrick = 38</span>
<span class="c-Singleline">; HatchStyleHorizontalBrick = 39</span>
<span class="c-Singleline">; HatchStyleWeave = 40</span>
<span class="c-Singleline">; HatchStylePlaid = 41</span>
<span class="c-Singleline">; HatchStyleDivot = 42</span>
<span class="c-Singleline">; HatchStyleDottedGrid = 43</span>
<span class="c-Singleline">; HatchStyleDottedDiamond = 44</span>
<span class="c-Singleline">; HatchStyleShingle = 45</span>
<span class="c-Singleline">; HatchStyleTrellis = 46</span>
<span class="c-Singleline">; HatchStyleSphere = 47</span>
<span class="c-Singleline">; HatchStyleSmallGrid = 48</span>
<span class="c-Singleline">; HatchStyleSmallCheckerBoard = 49</span>
<span class="c-Singleline">; HatchStyleLargeCheckerBoard = 50</span>
<span class="c-Singleline">; HatchStyleOutlinedDiamond = 51</span>
<span class="c-Singleline">; HatchStyleSolidDiamond = 52</span>
<span class="c-Singleline">; HatchStyleTotal = 53</span>
<span class="n">Gdip_BrushCreateHatch</span><span class="p">(</span><span class="n">ARGBfront</span><span class="p">,</span> <span class="n">ARGBback</span><span class="p">,</span> <span class="n">HatchStyle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateHatchBrush&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">HatchStyle</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGBfront</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGBback</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBrush</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;GpStatus WINGDIPAPI GdipCreateTexture2I(GpImage *image, GpWrapMode wrapmode, INT x, INT y, INT width, INT height, GpTexture **texture)</span>
<span class="c-Singleline">;GpStatus WINGDIPAPI GdipCreateTexture2(GpImage *image, GpWrapMode wrapmode, REAL x, REAL y, REAL width, REAL height, GpTexture **texture)</span>
<span class="c-Singleline">;GpStatus WINGDIPAPI GdipCreateTexture(GpImage *image, GpWrapMode wrapmode, GpTexture **texture)</span>

<span class="n">Gdip_CreateTextureBrush</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">,</span> <span class="n">WrapMode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">w</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateTexture&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">WrapMode</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateTexture2&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">WrapMode</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pBrush</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; WrapModeTile = 0</span>
<span class="c-Singleline">; WrapModeTileFlipX = 1</span>
<span class="c-Singleline">; WrapModeTileFlipY = 2</span>
<span class="c-Singleline">; WrapModeTileFlipXY = 3</span>
<span class="c-Singleline">; WrapModeClamp = 4</span>
<span class="n">Gdip_CreateLineBrush</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ARGB1</span><span class="p">,</span> <span class="n">ARGB2</span><span class="p">,</span> <span class="n">WrapMode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CreatePointF</span><span class="p">(</span><span class="n">PointF1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">CreatePointF</span><span class="p">(</span><span class="n">PointF2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateLineBrush&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF2</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB1</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB2</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">WrapMode</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">LGpBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">LGpBrush</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; LinearGradientModeHorizontal = 0</span>
<span class="c-Singleline">; LinearGradientModeVertical = 1</span>
<span class="c-Singleline">; LinearGradientModeForwardDiagonal = 2</span>
<span class="c-Singleline">; LinearGradientModeBackwardDiagonal = 3</span>
<span class="n">Gdip_CreateLineBrushFromRect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">ARGB1</span><span class="p">,</span> <span class="n">ARGB2</span><span class="p">,</span> <span class="n">LinearGradientMode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">WrapMode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">CreateRectF</span><span class="p">(</span><span class="n">RectF</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateLineBrushFromRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RectF</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB1</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">ARGB2</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">LinearGradientMode</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">WrapMode</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">LGpBrush</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">LGpBrush</span>
<span class="p">}</span>

<span class="n">Gdip_CloneBrush</span><span class="p">(</span><span class="n">pBrush</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">static</span> <span class="n">pNewBrush</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">pNewBrush</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pNewBrush</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">pNewBrush</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="o">&amp;</span><span class="n">pNewBrush</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Delete resources</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_DeletePen</span><span class="p">(</span><span class="n">pPen</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeletePen&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pPen</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteBrush</span><span class="p">(</span><span class="n">pBrush</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteBrush&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DisposeImage</span><span class="p">(</span><span class="n">pBitmap</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDisposeImage&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBitmap</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteGraphics</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteGraphics&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DisposeImageAttributes</span><span class="p">(</span><span class="n">ImageAttr</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDisposeImageAttributes&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">ImageAttr</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteFont</span><span class="p">(</span><span class="n">hFont</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteFont&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteStringFormat</span><span class="p">(</span><span class="n">hFormat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteStringFormat&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteFontFamily</span><span class="p">(</span><span class="n">hFamily</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteFontFamily&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFamily</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteMatrix</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteMatrix&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Text functions</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_TextToGraphics</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">Options</span><span class="p">,</span> <span class="n">Font</span><span class="o">=</span><span class="s">&quot;Arial&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">Measure</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IWidth</span> <span class="o">:=</span> <span class="n">Width</span><span class="p">,</span> <span class="n">IHeight</span><span class="o">:=</span> <span class="n">Height</span>
	
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)X([\-\d\.]+)(p*)&quot;</span><span class="p">,</span> <span class="n">xpos</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)Y([\-\d\.]+)(p*)&quot;</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)W([\-\d\.]+)(p*)&quot;</span><span class="p">,</span> <span class="n">Width</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)H([\-\d\.]+)(p*)&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)C(?!(entre|enter))([a-f\d]+)&quot;</span><span class="p">,</span> <span class="n">Colour</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)Top|Up|Bottom|Down|vCentre|vCenter&quot;</span><span class="p">,</span> <span class="n">vPos</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)R(\d)&quot;</span><span class="p">,</span> <span class="n">Rendering</span><span class="p">)</span>
	<span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;i)S(\d+)(p*)&quot;</span><span class="p">,</span> <span class="n">Size</span><span class="p">)</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">Gdip_DeleteBrush</span><span class="p">(</span><span class="n">Gdip_CloneBrush</span><span class="p">(</span><span class="n">Colour2</span><span class="p">))</span>
		<span class="n">PassBrush</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pBrush</span> <span class="o">:=</span> <span class="n">Colour2</span>
	
	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">IWidth</span> <span class="o">&amp;&amp;</span> <span class="n">IHeight</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">xpos2</span> <span class="o">||</span> <span class="n">ypos2</span> <span class="o">||</span> <span class="n">Width2</span> <span class="o">||</span> <span class="n">Height2</span> <span class="o">||</span> <span class="n">Size2</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>

	<span class="n">Style</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Styles</span> <span class="o">:=</span> <span class="s">&quot;Regular|Bold|Italic|BoldItalic|Underline|Strikeout&quot;</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">Styles</span><span class="p">,</span> <span class="o">|</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">if </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;\b&quot;</span> <span class="nv">A_loopField</span><span class="p">)</span>
		<span class="n">Style</span> <span class="o">|=</span> <span class="p">(</span><span class="nv">A_LoopField</span> <span class="o">!=</span> <span class="s">&quot;StrikeOut&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="mi">8</span>
	<span class="p">}</span>
  
	<span class="n">Align</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Alignments</span> <span class="o">:=</span> <span class="s">&quot;Near|Left|Centre|Center|Far|Right&quot;</span>
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">Alignments</span><span class="p">,</span> <span class="o">|</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">if </span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Options</span><span class="p">,</span> <span class="s">&quot;\b&quot;</span> <span class="nv">A_loopField</span><span class="p">)</span>
			<span class="n">Align</span> <span class="o">|=</span> <span class="nv">A_Index</span><span class="o">//</span><span class="mf">2.1</span><span class="c-Singleline">      ; 0|0|1|1|2|2</span>
	<span class="p">}</span>

	<span class="n">xpos</span> <span class="o">:=</span> <span class="p">(</span><span class="n">xpos1</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">xpos2</span> <span class="o">?</span> <span class="n">IWidth</span><span class="o">*</span><span class="p">(</span><span class="n">xpos1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">:</span> <span class="n">xpos1</span> <span class="o">:</span> <span class="mi">0</span>
	<span class="n">ypos</span> <span class="o">:=</span> <span class="p">(</span><span class="n">ypos1</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="n">ypos2</span> <span class="o">?</span> <span class="n">IHeight</span><span class="o">*</span><span class="p">(</span><span class="n">ypos1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">:</span> <span class="n">ypos1</span> <span class="o">:</span> <span class="mi">0</span>
	<span class="n">Width</span> <span class="o">:=</span> <span class="n">Width1</span> <span class="o">?</span> <span class="n">Width2</span> <span class="o">?</span> <span class="n">IWidth</span><span class="o">*</span><span class="p">(</span><span class="n">Width1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">:</span> <span class="n">Width1</span> <span class="o">:</span> <span class="n">IWidth</span>
	<span class="n">Height</span> <span class="o">:=</span> <span class="n">Height1</span> <span class="o">?</span> <span class="n">Height2</span> <span class="o">?</span> <span class="n">IHeight</span><span class="o">*</span><span class="p">(</span><span class="n">Height1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">:</span> <span class="n">Height1</span> <span class="o">:</span> <span class="n">IHeight</span>
	<span class="n">if</span> <span class="o">!</span><span class="n">PassBrush</span>
		<span class="n">Colour</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="p">(</span><span class="n">Colour2</span> <span class="o">?</span> <span class="n">Colour2</span> <span class="o">:</span> <span class="s">&quot;ff000000&quot;</span><span class="p">)</span>
	<span class="n">Rendering</span> <span class="o">:=</span> <span class="p">((</span><span class="n">Rendering1</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Rendering1</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">))</span> <span class="o">?</span> <span class="n">Rendering1</span> <span class="o">:</span> <span class="mi">4</span>
	<span class="n">Size</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Size1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="n">Size2</span> <span class="o">?</span> <span class="n">IHeight</span><span class="o">*</span><span class="p">(</span><span class="n">Size1</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">:</span> <span class="n">Size1</span> <span class="o">:</span> <span class="mi">12</span>

	<span class="n">hFamily</span> <span class="o">:=</span> <span class="n">Gdip_FontFamilyCreate</span><span class="p">(</span><span class="n">Font</span><span class="p">)</span>
	<span class="n">hFont</span> <span class="o">:=</span> <span class="n">Gdip_FontCreate</span><span class="p">(</span><span class="n">hFamily</span><span class="p">,</span> <span class="n">Size</span><span class="p">,</span> <span class="n">Style</span><span class="p">)</span>
	<span class="n">hFormat</span> <span class="o">:=</span> <span class="n">Gdip_StringFormatCreate</span><span class="p">(</span><span class="mh">0x4000</span><span class="p">)</span>
	<span class="n">pBrush</span> <span class="o">:=</span> <span class="n">PassBrush</span> <span class="o">?</span> <span class="n">pBrush</span> <span class="o">:</span> <span class="n">Gdip_BrushCreateSolid</span><span class="p">(</span><span class="n">Colour</span><span class="p">)</span>
	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">hFamily</span> <span class="o">&amp;&amp;</span> <span class="n">hFont</span> <span class="o">&amp;&amp;</span> <span class="n">hFormat</span> <span class="o">&amp;&amp;</span> <span class="n">pBrush</span> <span class="o">&amp;&amp;</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">!</span><span class="n">pGraphics</span> <span class="o">?</span> <span class="o">-</span><span class="mi">2</span> <span class="o">:</span> <span class="o">!</span><span class="n">hFamily</span> <span class="o">?</span> <span class="o">-</span><span class="mi">3</span> <span class="o">:</span> <span class="o">!</span><span class="n">hFont</span> <span class="o">?</span> <span class="o">-</span><span class="mi">4</span> <span class="o">:</span> <span class="o">!</span><span class="n">hFormat</span> <span class="o">?</span> <span class="o">-</span><span class="mi">5</span> <span class="o">:</span> <span class="o">!</span><span class="n">pBrush</span> <span class="o">?</span> <span class="o">-</span><span class="mi">6</span> <span class="o">:</span> <span class="mi">0</span>
   
	<span class="n">CreateRectF</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">)</span>
	<span class="n">Gdip_SetStringFormatAlign</span><span class="p">(</span><span class="n">hFormat</span><span class="p">,</span> <span class="n">Align</span><span class="p">)</span>
	<span class="n">Gdip_SetTextRenderingHint</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Rendering</span><span class="p">)</span>
	<span class="n">ReturnRC</span> <span class="o">:=</span> <span class="n">Gdip_MeasureString</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="n">RC</span><span class="p">)</span>

<span class="w">	</span><span class="nb">if </span><span class="n">vPos</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">ReturnRC</span><span class="p">,</span> <span class="n">ReturnRC</span><span class="p">,</span> <span class="o">|</span>
		
		<span class="n">if</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;vCentre&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;vCenter&quot;</span><span class="p">)</span>
			<span class="n">ypos</span> <span class="o">+=</span> <span class="p">(</span><span class="n">Height</span><span class="o">-</span><span class="n">ReturnRC4</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;Top&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;Up&quot;</span><span class="p">)</span>
			<span class="n">ypos</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">		</span><span class="nb">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;Bottom&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">vPos</span> <span class="o">=</span> <span class="s">&quot;Down&quot;</span><span class="p">)</span>
			<span class="n">ypos</span> <span class="o">:=</span> <span class="n">Height</span><span class="o">-</span><span class="n">ReturnRC4</span>
		
		<span class="n">CreateRectF</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">ReturnRC4</span><span class="p">)</span>
		<span class="n">ReturnRC</span> <span class="o">:=</span> <span class="n">Gdip_MeasureString</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="n">RC</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">Measure</span>
		<span class="n">E</span> <span class="o">:=</span> <span class="n">Gdip_DrawString</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">RC</span><span class="p">)</span>

	<span class="n">if</span> <span class="o">!</span><span class="n">PassBrush</span>
		<span class="n">Gdip_DeleteBrush</span><span class="p">(</span><span class="n">pBrush</span><span class="p">)</span>
	<span class="n">Gdip_DeleteStringFormat</span><span class="p">(</span><span class="n">hFormat</span><span class="p">)</span>   
	<span class="n">Gdip_DeleteFont</span><span class="p">(</span><span class="n">hFont</span><span class="p">)</span>
	<span class="n">Gdip_DeleteFontFamily</span><span class="p">(</span><span class="n">hFamily</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">E</span> <span class="o">?</span> <span class="n">E</span> <span class="o">:</span> <span class="n">ReturnRC</span>
<span class="p">}</span>

<span class="n">Gdip_DrawString</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">sString</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">RectF</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
	<span class="p">{</span>
		<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wString</span><span class="p">,</span> <span class="n">nSize</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawString&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span>
		<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RectF</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDrawString&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span>
		<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RectF</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pBrush</span><span class="p">)</span>
	<span class="p">}</span>	
<span class="p">}</span>

<span class="n">Gdip_MeasureString</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">sString</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">RectF</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
	<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
	<span class="p">{</span>
		<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wString</span><span class="p">,</span> <span class="n">nSize</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>   
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipMeasureString&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span>
		<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RectF</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RC</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Chars</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Lines</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
	<span class="p">{</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipMeasureString&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span>
		<span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sString</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RectF</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">RC</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Chars</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Lines</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">return</span> <span class="o">&amp;</span><span class="n">RC</span> <span class="o">?</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span> <span class="s">&quot;|&quot;</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span> <span class="s">&quot;|&quot;</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span> <span class="s">&quot;|&quot;</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RC</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span> <span class="s">&quot;|&quot;</span> <span class="n">Chars</span> <span class="s">&quot;|&quot;</span> <span class="n">Lines</span> <span class="o">:</span> <span class="mi">0</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Near = 0</span>
<span class="c-Singleline">; Center = 1</span>
<span class="c-Singleline">; Far = 2</span>
<span class="n">Gdip_SetStringFormatAlign</span><span class="p">(</span><span class="n">hFormat</span><span class="p">,</span> <span class="n">Align</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetStringFormatAlign&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Align</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_StringFormatCreate</span><span class="p">(</span><span class="n">Format</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lang</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateStringFormat&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Format</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Lang</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hFormat</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">hFormat</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Regular = 0</span>
<span class="c-Singleline">; Bold = 1</span>
<span class="c-Singleline">; Italic = 2</span>
<span class="c-Singleline">; BoldItalic = 3</span>
<span class="c-Singleline">; Underline = 4</span>
<span class="c-Singleline">; Strikeout = 8</span>
<span class="n">Gdip_FontCreate</span><span class="p">(</span><span class="n">hFamily</span><span class="p">,</span> <span class="n">Size</span><span class="p">,</span> <span class="n">Style</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFont&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hFamily</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">Size</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hFont</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">hFont</span>
<span class="p">}</span>

<span class="n">Gdip_FontFamilyCreate</span><span class="p">(</span><span class="n">Font</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="nv">A_IsUnicode</span>
	<span class="p">{</span>
		<span class="n">nSize</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Font</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">wFont</span><span class="p">,</span> <span class="n">nSize</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;MultiByteToWideChar&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Font</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wFont</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">nSize</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFontFamilyFromName&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wFont</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hFamily</span><span class="p">)</span>
	<span class="p">}</span>
<span class="w">	</span><span class="nb">else</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateFontFamilyFromName&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Font</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">hFamily</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">hFamily</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Matrix functions</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_CreateAffineMatrix</span><span class="p">(</span><span class="n">m11</span><span class="p">,</span> <span class="n">m12</span><span class="p">,</span> <span class="n">m21</span><span class="p">,</span> <span class="n">m22</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateMatrix2&quot;</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">m11</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">m12</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">m21</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">m22</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">Matrix</span>
<span class="p">}</span>

<span class="n">Gdip_CreateMatrix</span><span class="p">()</span>
<span class="p">{</span>
   <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateMatrix&quot;</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">)</span>
<span class="w">   </span><span class="nb">return</span> <span class="n">Matrix</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; GraphicsPath functions</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; Alternate = 0</span>
<span class="c-Singleline">; Winding = 1</span>
<span class="n">Gdip_CreatePath</span><span class="p">(</span><span class="n">BrushMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreatePath&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">BrushMode</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Path</span>
<span class="p">}</span>

<span class="n">Gdip_AddPathEllipse</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipAddPathEllipse&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_AddPathPolygon</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">Points</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="n">Points</span><span class="p">,</span> <span class="o">|</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">Points0</span><span class="p">)</span>   
<span class="w">	</span><span class="nb">Loop</span><span class="p">,</span> <span class="nv">%Points0%</span>
	<span class="p">{</span>
<span class="w">		</span><span class="nb">StringSplit</span><span class="p">,</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">Points</span><span class="nv">%A_Index%</span><span class="p">,</span> <span class="se">`,</span>
		<span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord1</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s">&quot;float&quot;</span><span class="p">),</span> <span class="nf">NumPut</span><span class="p">(</span><span class="n">Coord2</span><span class="p">,</span> <span class="n">PointF</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="nv">A_Index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">)</span>
	<span class="p">}</span>   

<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipAddPathPolygon&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PointF</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">Points0</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_DeletePath</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeletePath&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Quality functions</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="c-Singleline">; SystemDefault = 0</span>
<span class="c-Singleline">; SingleBitPerPixelGridFit = 1</span>
<span class="c-Singleline">; SingleBitPerPixel = 2</span>
<span class="c-Singleline">; AntiAliasGridFit = 3</span>
<span class="c-Singleline">; AntiAlias = 4</span>
<span class="n">Gdip_SetTextRenderingHint</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">RenderingHint</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetTextRenderingHint&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">RenderingHint</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Default = 0</span>
<span class="c-Singleline">; LowQuality = 1</span>
<span class="c-Singleline">; HighQuality = 2</span>
<span class="c-Singleline">; Bilinear = 3</span>
<span class="c-Singleline">; Bicubic = 4</span>
<span class="c-Singleline">; NearestNeighbor = 5</span>
<span class="c-Singleline">; HighQualityBilinear = 6</span>
<span class="c-Singleline">; HighQualityBicubic = 7</span>
<span class="n">Gdip_SetInterpolationMode</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">InterpolationMode</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetInterpolationMode&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">InterpolationMode</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Default = 0</span>
<span class="c-Singleline">; HighSpeed = 1</span>
<span class="c-Singleline">; HighQuality = 2</span>
<span class="c-Singleline">; None = 3</span>
<span class="c-Singleline">; AntiAlias = 4</span>
<span class="n">Gdip_SetSmoothingMode</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">SmoothingMode</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetSmoothingMode&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">SmoothingMode</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; CompositingModeSourceOver = 0 (blended)</span>
<span class="c-Singleline">; CompositingModeSourceCopy = 1 (overwrite)</span>
<span class="n">Gdip_SetCompositingMode</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">CompositingMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetCompositingMode&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">CompositingMode</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;#####################################################################################</span>
<span class="c-Singleline">; Extra functions</span>
<span class="c-Singleline">;#####################################################################################</span>

<span class="n">Gdip_Startup</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">if</span> <span class="o">!</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
	<span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">si</span> <span class="o">:=</span> <span class="nf">Chr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusStartup&quot;</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">pToken</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">pToken</span>
<span class="p">}</span>

<span class="n">Gdip_Shutdown</span><span class="p">(</span><span class="n">pToken</span><span class="p">)</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdiplusShutdown&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pToken</span><span class="p">)</span>
<span class="w">	</span><span class="nb">if </span><span class="n">hModule</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="s">&quot;str&quot;</span><span class="p">,</span> <span class="s">&quot;gdiplus&quot;</span><span class="p">)</span>
		<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;FreeLibrary&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">hModule</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="mi">0</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Prepend = 0; The new operation is applied before the old operation.</span>
<span class="c-Singleline">; Append = 1; The new operation is applied after the old operation.</span>
<span class="n">Gdip_RotateWorldTransform</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Angle</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipRotateWorldTransform&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_ScaleWorldTransform</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipScaleWorldTransform&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_TranslateWorldTransform</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipTranslateWorldTransform&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">MatrixOrder</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_ResetWorldTransform</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipResetWorldTransform&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetRotatedTranslation</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Angle</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">xTranslation</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">yTranslation</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">pi</span> <span class="o">:=</span> <span class="mf">3.14159</span><span class="p">,</span> <span class="n">TAngle</span> <span class="o">:=</span> <span class="n">Angle</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>	

	<span class="n">Bound</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Angle</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="nf">Mod</span><span class="p">(</span><span class="n">Angle</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span> <span class="o">:</span> <span class="mi">360</span><span class="o">-</span><span class="nf">Mod</span><span class="p">(</span><span class="o">-</span><span class="n">Angle</span><span class="p">,</span> <span class="o">-</span><span class="mi">360</span><span class="p">)</span>
	<span class="n">if</span> <span class="p">((</span><span class="n">Bound</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Bound</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">))</span>
		<span class="n">xTranslation</span> <span class="o">:=</span> <span class="n">Height</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">),</span> <span class="n">yTranslation</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">((</span><span class="n">Bound</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Bound</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">))</span>
		<span class="n">xTranslation</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Height</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">TAngle</span><span class="p">)),</span> <span class="n">yTranslation</span> <span class="o">:=</span> <span class="o">-</span><span class="n">Height</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">TAngle</span><span class="p">)</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">((</span><span class="n">Bound</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Bound</span> <span class="o">&lt;=</span> <span class="mi">270</span><span class="p">))</span>
		<span class="n">xTranslation</span> <span class="o">:=</span> <span class="o">-</span><span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">TAngle</span><span class="p">)),</span> <span class="n">yTranslation</span> <span class="o">:=</span> <span class="o">-</span><span class="p">(</span><span class="n">Height</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">TAngle</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">))</span>
<span class="w">	</span><span class="nb">else</span> <span class="n">if</span> <span class="p">((</span><span class="n">Bound</span> <span class="o">&gt;</span> <span class="mi">270</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Bound</span> <span class="o">&lt;=</span> <span class="mi">360</span><span class="p">))</span>
		<span class="n">xTranslation</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">yTranslation</span> <span class="o">:=</span> <span class="o">-</span><span class="n">Width</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetRotatedDimensions</span><span class="p">(</span><span class="n">Width</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Angle</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">RWidth</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">RHeight</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">pi</span> <span class="o">:=</span> <span class="mf">3.14159</span><span class="p">,</span> <span class="n">TAngle</span> <span class="o">:=</span> <span class="n">Angle</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
	<span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="n">Width</span> <span class="o">&amp;&amp;</span> <span class="n">Height</span><span class="p">)</span>
<span class="w">		</span><span class="nb">return</span> <span class="o">-</span><span class="mi">1</span>
	<span class="n">RWidth</span> <span class="o">:=</span> <span class="nf">Ceil</span><span class="p">(</span><span class="nf">Abs</span><span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">TAngle</span><span class="p">))</span><span class="o">+</span><span class="nf">Abs</span><span class="p">(</span><span class="n">Height</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">)))</span>
	<span class="n">RHeight</span> <span class="o">:=</span> <span class="nf">Ceil</span><span class="p">(</span><span class="nf">Abs</span><span class="p">(</span><span class="n">Width</span><span class="o">*</span><span class="nf">Sin</span><span class="p">(</span><span class="n">TAngle</span><span class="p">))</span><span class="o">+</span><span class="nf">Abs</span><span class="p">(</span><span class="n">Height</span><span class="o">*</span><span class="nf">Cos</span><span class="p">(</span><span class="n">Tangle</span><span class="p">)))</span>
<span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Replace = 0</span>
<span class="c-Singleline">; Intersect = 1</span>
<span class="c-Singleline">; Union = 2</span>
<span class="c-Singleline">; Xor = 3</span>
<span class="c-Singleline">; Exclude = 4</span>
<span class="c-Singleline">; Complement = 5</span>
<span class="n">Gdip_SetClipRect</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">CombineMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipRect&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">CombineMode</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_SetClipPath</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">CombineMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipPath&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">CombineMode</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_ResetClip</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipResetClip&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_GetClipRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Region</span> <span class="o">:=</span> <span class="n">Gdip_CreateRegion</span><span class="p">()</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipGetClip&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Region</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Region</span>
<span class="p">}</span>

<span class="n">Gdip_SetClipRegion</span><span class="p">(</span><span class="n">pGraphics</span><span class="p">,</span> <span class="n">Region</span><span class="p">,</span> <span class="n">CombineMode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipSetClipRegion&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">pGraphics</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Region</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="n">CombineMode</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">Gdip_CreateRegion</span><span class="p">()</span>
<span class="p">{</span>
	<span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipCreateRegion&quot;</span><span class="p">,</span> <span class="s">&quot;uint*&quot;</span><span class="p">,</span> <span class="n">Region</span><span class="p">)</span>
<span class="w">	</span><span class="nb">return</span> <span class="n">Region</span>
<span class="p">}</span>

<span class="n">Gdip_DeleteRegion</span><span class="p">(</span><span class="n">Region</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="nb">return</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;gdiplus\GdipDeleteRegion&quot;</span><span class="p">,</span> <span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">Region</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
