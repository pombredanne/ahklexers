<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; 2010 Added by Tuncay a prefix &quot;InternetFileRead_&quot; to all functions.</span>
<span class="cm">/*</span>
<span class="cm">       ___       _                       _   _____ _ _      ____                _</span>
<span class="cm">      |_ _|_ __ | |_ ___ _ __ _ __   ___| |_|  ___(_) | ___|  _ \ ___  __ _  __| |</span>
<span class="cm">       | || &#39;_ \| __/ _ \ &#39;__| &#39;_ \ / _ \ __| |_  | | |/ _ \ |_) / _ \/ _` |/ _` |</span>
<span class="cm">       | || | | | ||  __/ |  | | | |  __/ |_|  _| | | |  __/  _ &lt;  __/ (_| | (_| |</span>
<span class="cm">      |___|_| |_|\__\___|_|  |_| |_|\___|\__|_|   |_|_|\___|_| \_\___|\__,_|\__,_|</span>

<span class="cm">                              by SKAN ( Suresh Kumar A N, arian.suresh@gmail.com )</span>
<span class="cm">                                      Created: 24-Jun-2009 | LastEdit: 03-Jul-2009</span>
<span class="cm">                       Forum Topic: www.autohotkey.com/forum/viewtopic.php?t=45718</span>
<span class="cm">           Included : InternetFileRead(), DLP() Progress Bar, VarZ_Save(),Examples</span>
<span class="cm">      ____________________________________________________________________________</span>
<span class="cm">      Credit:</span>

<span class="cm">      Olfen for his topics:</span>

<span class="cm">                          DllCall: HttpQueryInfo - Get HTTP headers</span>
<span class="cm">                          - www.autohotkey.com/forum/topic10510.html</span>
<span class="cm">                          UrlDownloadToVar()</span>
<span class="cm">                          - www.autohotkey.com/forum/topic10466.html</span>
<span class="cm">      Lexikos for:</span>
<span class="cm">                          For supporting this project with valuable info,</span>
<span class="cm">                          especially:</span>

<span class="cm">                          code/method to support FTP read</span>
<span class="cm">                          - www.autohotkey.com/forum/viewtopic.php?p=277646#277646</span>

<span class="cm">                          clarifying alternative parameter for proxy issues</span>
<span class="cm">                          - www.autohotkey.com/forum/viewtopic.php?p=279205#279205</span>
<span class="cm">                          - www.autohotkey.com/forum/viewtopic.php?p=279210#279210</span>

<span class="cm">      Thanks to all the replies in Forum Topic which motivates me to perfect this.</span>
<span class="cm">*/</span><span class="c-Singleline"></span>

<span class="c-Singleline">;?out-begin</span>
<span class="cm">/*</span>
<span class="cm">#SingleInstance Force</span>

<span class="cm">; Example 1: Download the leading 100 bytes of default HTML and extract a part of text.</span>
<span class="cm">URL := &quot;http://www.formyip.com/&quot;</span>
<span class="cm">If ( InternetFileRead( IP, URL, 100, 100, &quot;No-Progress&quot; ) &gt; 0 )</span>
<span class="cm">  MsgBox, 64, Your External IP Address</span>
<span class="cm">        , % IP := SubStr( IP,SP:=InStr(IP,&quot;My ip address &quot;)+17,InStr(IP,&quot; &quot;,0,SP+1)-SP )</span>


<span class="cm">; Example 2, Download a binary file ( AHK Script Decompiler ) and save it.</span>
<span class="cm">URL := &quot;http://www.autohotkey.com/download/Exe2Ahk.exe&quot;</span>
<span class="cm">If ( InternetFileRead( binData, URL, False, 10240, &quot;No-Progress&quot; ) &gt; 0 &amp;&amp; !ErrorLevel )</span>
<span class="cm">  If VarZ_Save( binData, A_ScriptDir &quot;\Exe2Ahk.exe&quot; )</span>
<span class="cm">     MsgBox, 64, AHK Script Compiler Downloaded and Saved, % A_ScriptDir &quot;\Exe2Ahk.exe&quot;</span>


<span class="cm">; Example 3, Download a FTP file: EditPlus 3.11 Evaluation Version (1 MB) and save it.</span>
<span class="cm">URL := &quot;ftp://ftp.editplus.com/epp311_en.exe&quot;</span>
<span class="cm">If ( InternetFileRead( binData, URL ) &gt; 0 &amp;&amp; !ErrorLevel )</span>
<span class="cm">    If VarZ_Save( binData, A_Temp &quot;\epp311_en.exe&quot; ) {</span>
<span class="cm">         Sleep 500</span>
<span class="cm">         DLP( False ) ; or use Progress, off</span>
<span class="cm">         Run %A_Temp%\epp311_en.exe</span>
<span class="cm">       }</span>

<span class="cm">; AHK will automatically unload libraries on exit. If you are particular, here is a method</span>
<span class="cm">; to unload Wininet library without a handle.</span>
<span class="cm">DllCall( &quot;FreeLibrary&quot;, UInt,DllCall( &quot;GetModuleHandle&quot;, Str,&quot;wininet.dll&quot;) )</span>
<span class="cm">Return ;                                                 // end of auto-execute section //</span>
<span class="cm">*/</span><span class="c-Singleline"></span>
<span class="c-Singleline">;?out-end</span>

<span class="n">InternetFileRead</span><span class="p">(</span> <span class="n">ByRef</span> <span class="n">V</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">RB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bSz</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">DLP</span><span class="o">=</span><span class="s">&quot;DLP&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="mh">0x84000000</span> <span class="p">)</span> <span class="p">{</span>
 <span class="n">Static</span> <span class="n">LIB</span><span class="o">=</span><span class="s">&quot;WININET\&quot;</span><span class="p">,</span> <span class="n">QRL</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">CL</span><span class="o">=</span><span class="s">&quot;00000000000000&quot;</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="s">&quot;&quot;</span>
 <span class="n">If</span> ! <span class="nf">DllCall(</span> <span class="s">&quot;GetModuleHandle&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;wininet.dll&quot;</span> <span class="p">)</span>
      <span class="nf">DllCall(</span> <span class="s">&quot;LoadLibrary&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;wininet.dll&quot;</span> <span class="p">)</span>
 <span class="n">If</span> ! <span class="n">hIO</span>:<span class="o">=</span><span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetOpenA&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="o">-</span><span class="mi">1</span>
 <span class="n">If</span> ! <span class="p">((</span> <span class="n">hIU</span>:<span class="o">=</span><span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetOpenUrlA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIO</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">URL</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">F</span>
                                                            <span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="o">||</span> <span class="nv">ErrorLevel</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="mi">0</span> <span class="o">-</span> <span class="p">(</span> !<span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetCloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIO</span> <span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
 <span class="n">If</span> ! <span class="p">(</span> <span class="n">RB</span>  <span class="p">)</span>
 <span class="n">If</span> <span class="p">(</span> <span class="nf">SubStr(</span><span class="n">URL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;ftp:&quot;</span> <span class="p">)</span>
    <span class="n">CL</span> :<span class="o">=</span> <span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;FtpGetFileSize&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIU</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">Else</span> <span class="n">If</span> ! <span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;HttpQueryInfoA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIU</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">QRL</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="mi">0</span> <span class="o">-</span> <span class="p">(</span> !<span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetCloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIU</span> <span class="p">)</span> <span class="p">)</span>
            <span class="o">-</span> <span class="p">(</span> !<span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetCloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIO</span> <span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
 <span class="nf">VarSetCapacity(</span> <span class="n">V</span><span class="p">,</span><span class="mi">64</span> <span class="p">),</span> <span class="nf">VarSetCapacity(</span> <span class="n">V</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
<span class="w"> </span><span class="nb">SplitPath</span><span class="p">,</span> <span class="n">URL</span><span class="p">,</span> <span class="n">FN</span><span class="p">,,,,</span> <span class="n">DN</span>
<span class="w"> </span><span class="nl">FN:</span><span class="o">=</span><span class="p">(</span><span class="n">FN</span> ? <span class="n">FN</span> : <span class="n">DN</span><span class="p">),</span> <span class="n">CL</span>:<span class="o">=</span><span class="p">(</span><span class="n">RB</span> ? <span class="n">RB</span> : <span class="n">CL</span><span class="p">),</span> <span class="nf">VarSetCapacity(</span> <span class="n">V</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span><span class="mi">32</span> <span class="p">),</span> <span class="n">P</span>:<span class="o">=&amp;</span><span class="n">V</span><span class="p">,</span>
<span class="w"> </span><span class="nl">B:</span><span class="o">=</span><span class="p">(</span><span class="n">bSz</span><span class="o">&gt;</span><span class="n">CL</span> ? <span class="n">CL</span> : <span class="n">bSz</span><span class="p">),</span> <span class="n">TtlB</span>:<span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">LP</span> :<span class="o">=</span> <span class="n">RB</span> ? <span class="s">&quot;Unknown&quot;</span> : <span class="n">CL</span><span class="p">,</span>  <span class="nv">%InternetFileRead_DLP%</span><span class="p">(</span> <span class="nv">True</span><span class="p">,</span><span class="n">CL</span><span class="p">,</span><span class="n">FN</span> <span class="p">)</span><span class="c-Singleline"> ;?Added Prefix to %DLP% </span>
<span class="w"> </span><span class="nb">Loop</span> <span class="p">{</span>
       <span class="n">If</span> <span class="p">(</span> <span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetReadFile&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIU</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">P</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">B</span><span class="p">,</span> <span class="n">UIntP</span><span class="p">,</span><span class="n">R</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> !<span class="n">R</span> <span class="p">)</span>
<span class="w">       </span><span class="nb">Break</span>
<span class="w">       </span><span class="nl">P:</span><span class="o">=</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="n">R</span><span class="p">),</span> <span class="n">TtlB</span>:<span class="o">=</span><span class="p">(</span><span class="n">TtlB</span><span class="o">+</span><span class="n">R</span><span class="p">),</span> <span class="n">RemB</span>:<span class="o">=</span><span class="p">(</span><span class="n">CL</span><span class="o">-</span><span class="n">TtlB</span><span class="p">),</span> <span class="n">B</span>:<span class="o">=</span><span class="p">(</span><span class="n">RemB</span><span class="o">&lt;</span><span class="n">B</span> ? <span class="n">RemB</span> : <span class="n">B</span><span class="p">),</span> <span class="nv">%InternetFileRead_DLP%</span><span class="p">(</span> <span class="n">TtlB</span><span class="p">,</span><span class="n">LP</span> <span class="p">)</span><span class="c-Singleline"> ;?Added Prefix to %DLP% </span>
<span class="w">       </span><span class="nb">Sleep</span> <span class="o">-</span><span class="mi">1</span>
 <span class="p">}</span> <span class="n">TtlB</span><span class="o">&lt;&gt;</span><span class="n">CL</span> ? <span class="nf">VarSetCapacity(</span> <span class="n">T</span><span class="p">,</span><span class="n">TtlB</span> <span class="p">)</span> <span class="nf">DllCall(</span> <span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">T</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">V</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">TtlB</span> <span class="p">)</span>
  <span class="o">.</span> <span class="nf">VarSetCapacity(</span> <span class="n">V</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span> <span class="o">.</span> <span class="nf">VarSetCapacity(</span> <span class="n">V</span><span class="p">,</span><span class="n">TtlB</span><span class="p">,</span><span class="mi">32</span> <span class="p">)</span> <span class="o">.</span> <span class="nf">DllCall(</span> <span class="s">&quot;RtlMoveMemory&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">V</span>
  <span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">T</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">TtlB</span> <span class="p">)</span> <span class="o">.</span> <span class="nv">%InternetFileRead_DLP%</span><span class="p">(</span> <span class="n">TtlB</span><span class="p">,</span> <span class="n">TtlB</span> <span class="p">)</span> : <span class="n">N</span><span class="c-Singleline"> ;?Added Prefix to %DLP% </span>
 <span class="n">If</span> <span class="p">(</span> !<span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetCloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIU</span> <span class="p">)</span> <span class="p">)</span>
  <span class="o">+</span> <span class="p">(</span> !<span class="nf">DllCall(</span> <span class="n">LIB</span> <span class="s">&quot;InternetCloseHandle&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hIO</span> <span class="p">)</span> <span class="p">)</span>
<span class="w">   </span><span class="nb">Return</span> <span class="o">-</span><span class="mi">6</span>
<span class="nb">Return</span><span class="p">,</span> <span class="nf">VarSetCapacity(</span><span class="n">V</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="nv">ErrorLevel</span>:<span class="o">=</span><span class="p">(</span><span class="n">RB</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">TtlB</span><span class="o">&lt;</span><span class="n">RB</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="n">RB</span><span class="o">=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">TtlB</span><span class="o">=</span><span class="n">CL</span><span class="p">)</span> ? <span class="mi">0</span> : <span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">64</span><span class="p">)</span>
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c-Singleline">; The following function is an add-on to provide &quot;Download Progress&quot; to InternetFileRead()</span>
<span class="c-Singleline">; InternetFileRead() calls DLP() dynamically, i.e., will not error-out if DLP() is missing</span>
<span class="c-Singleline">;  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>

<span class="n">InternetFileRead_DLP</span><span class="p">(</span> <span class="n">WP</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">LP</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Msg</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ;?Added Prefix</span>
 <span class="n">If</span> <span class="p">(</span> <span class="n">WP</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
<span class="w"> </span><span class="nb">SysGet</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">MonitorWorkArea</span><span class="p">,</span> <span class="mi">1</span>
<span class="w"> </span><span class="nl">y:</span><span class="o">=</span><span class="p">(</span><span class="n">mBottom</span><span class="o">-</span><span class="mi">46</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span>:<span class="o">=</span><span class="p">(</span><span class="n">mRight</span><span class="o">-</span><span class="mi">370</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="nf">VarSetCapacity(</span> <span class="n">Size</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
 <span class="nf">DllCall(</span> <span class="s">&quot;shlwapi.dll\StrFormatByteSize64A&quot;</span><span class="p">,</span> <span class="n">Int64</span><span class="p">,</span><span class="n">LP</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">Size</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">16</span> <span class="p">)</span>
 <span class="n">Size</span> :<span class="o">=</span> <span class="p">(</span> <span class="n">Size</span><span class="o">=</span><span class="s">&quot;0 bytes&quot;</span> <span class="p">)</span> ? <span class="n">N</span> : <span class="s">&quot;«&quot;</span> <span class="n">Size</span> <span class="s">&quot;»&quot;</span>
<span class="w"> </span><span class="nb">Progress</span><span class="p">,</span> <span class="n">CWE6E3E4</span> <span class="n">CT000020</span> <span class="n">CBF73D00</span> <span class="n">x</span><span class="nv">%x%</span> <span class="n">y</span><span class="nv">%y%</span> <span class="n">w370</span> <span class="n">h46</span> <span class="n">B1</span> <span class="n">FS8</span> <span class="n">WM700</span> <span class="n">WS400</span> <span class="n">FM8</span> <span class="n">ZH8</span> <span class="n">ZY3</span>
         <span class="p">,,</span> <span class="nv">%Msg%</span>  <span class="nv">%Size%</span><span class="p">,</span> <span class="n">InternetFileRead</span><span class="p">(),</span> <span class="n">Tahoma</span>
<span class="w"> </span><span class="nb">WinSet</span><span class="p">,</span> <span class="n">Transparent</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="n">InternetFileRead</span><span class="p">()</span>
 <span class="p">}</span> <span class="n">Progress</span><span class="p">,</span><span class="o">%</span> <span class="p">(</span><span class="n">P</span>:<span class="o">=</span><span class="nf">Round(</span><span class="n">WP</span><span class="o">/</span><span class="n">LP</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span><span class="o">%</span> <span class="s">&quot;Memory Download: &quot;</span> <span class="n">wp</span> <span class="s">&quot; / &quot;</span> <span class="n">lp</span> <span class="s">&quot; [ &quot;</span> <span class="n">P</span> <span class="s">&quot;`% ]&quot;</span>
<span class="w"> </span><span class="nb">IfEqual</span><span class="p">,</span><span class="n">wP</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Progress</span><span class="p">,</span> <span class="n">Off</span>
<span class="p">}</span><span class="c-Singleline"></span>
<span class="c-Singleline">;  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c-Singleline">; The following function is a part of: VarZ 46L - Native Data Compression</span>
<span class="c-Singleline">; View topic : www.autohotkey.com/forum/viewtopic.php?t=45559</span>
<span class="c-Singleline">;  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>

<span class="n">InternetFileRead_VarZ_Save</span><span class="p">(</span> <span class="n">byRef</span> <span class="n">V</span><span class="p">,</span> <span class="n">File</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ;   www.autohotkey.net/~Skan/wrapper/FileIO16/FileIO16.ahk ;?Added Prefix</span>
<span class="nb">Return</span> <span class="p">(</span> <span class="p">(</span> <span class="n">hFile</span> :<span class="o">=</span>  <span class="nf">DllCall(</span> <span class="s">&quot;_lcreat&quot;</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">File</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
                 ?   <span class="nf">DllCall(</span> <span class="s">&quot;_lwrite&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hFile</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="n">V</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nf">VarSetCapacity(</span><span class="n">V</span><span class="p">)</span> <span class="p">)</span>
                 <span class="o">+</span> <span class="p">(</span> <span class="nf">DllCall(</span> <span class="s">&quot;_lclose&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hFile</span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span> <span class="p">)</span> : <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
