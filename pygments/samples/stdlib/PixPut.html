<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">     ____  _      ____        __</span>
<span class="cm">    / __ \(_)  __/ __ \__  __/ /_             Bitmap Static Control -  Ver 1.0</span>
<span class="cm">   / /_/ / / |/_/ /_/ / / / / __/      www.autohotkey.com/forum/viewtopic.php?t=59248</span>
<span class="cm">  / ____/ /&gt;  &lt;/ ____/ /_/ / /_          Suresh Kumar A N ( arian.suresh@gmail.com )</span>
<span class="cm"> /_/   /_/_/|_/_/    \__,_/\__/          Created: 14-Jun-2010 | LastMod: 14-Jun-2010</span>

<span class="cm"> PixPut() simplifies Drawing Colored Horizontal/Vertical lines and Solid Rectangles on GUI</span>

<span class="cm">*/</span>

<span class="n">PixPut</span><span class="p">(</span> <span class="n">Hwnd</span><span class="p">,</span> <span class="n">ColorRef</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">IsChild</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">          ; Puts a Pixel on GUI</span>
<span class="w"> </span><span class="nb">Static</span> <span class="n">BMD</span><span class="p">,</span> <span class="n">pBMD</span><span class="c-Singleline">             ;     by applying a single colored Bitmap on  Static Control</span>
 <span class="n">If</span> <span class="o">!</span> <span class="nf">VarSetCapacity(</span> <span class="n">BMD</span> <span class="p">)</span>
 <span class="nf">VarSetCapacity(</span> <span class="n">BMD</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">0</span> <span class="p">),</span> <span class="n">pBMD</span> <span class="o">:=</span> <span class="nf">NumPut(</span> <span class="n">ColorRef</span><span class="p">,</span> <span class="nf">NumPut(</span> <span class="mi">4</span><span class="p">,</span> <span class="nf">NumPut(</span> <span class="mh">0x18000100000001</span>
 <span class="p">,</span> <span class="nf">NumPut(</span> <span class="mh">0x100000028</span><span class="p">,</span> <span class="n">BMD</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&quot;Int64&quot;</span> <span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Int64&quot;</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">12</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">58</span><span class="c-Singleline">    ; BitMapData</span>
<span class="w"> </span><span class="nb">Else</span> <span class="nf">NumPut(</span> <span class="n">ColorRef</span><span class="p">,</span> <span class="n">BMD</span><span class="p">,</span> <span class="mi">54</span> <span class="p">)</span>
 <span class="n">hBMP</span> <span class="o">:=</span> <span class="nf">DllCall(</span> <span class="s">&quot;CreateDIBitmap&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span> <span class="n">hDC</span> <span class="o">:=</span> <span class="nf">DllCall(</span><span class="s">&quot;GetDC&quot;</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="n">hwnd</span> <span class="p">)</span>
                <span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">pBMD</span><span class="o">+</span><span class="mi">14</span><span class="p">,</span><span class="n">UInt</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">pBMD</span><span class="o">+</span><span class="mi">54</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">pBMD</span><span class="o">+</span><span class="mi">14</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
 <span class="n">cHwnd</span> <span class="o">:=</span> <span class="n">IsChild</span> <span class="o">?</span> <span class="n">Hwnd</span> <span class="o">:</span> <span class="nf">DllCall(</span> <span class="s">&quot;CreateWindowEx&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;Static&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span>
         <span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mh">0x4000010E</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">X</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
 <span class="nf">DllCall(</span> <span class="s">&quot;ReleaseDC&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hWnd</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hDC</span> <span class="p">)</span>
 <span class="nf">DllCall(</span> <span class="s">&quot;SetProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hBMP</span> <span class="p">)</span>
 <span class="nf">DllCall(</span> <span class="s">&quot;SendMessageA&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mh">0x172</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hBMP</span> <span class="p">)</span>
 <span class="nf">DllCall(</span> <span class="s">&quot;SetWindowPos&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">X</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">W</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span><span class="n">H</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="mh">0x40</span> <span class="p">)</span>
<span class="nb">Return</span> <span class="n">cHwnd</span>
<span class="p">}</span>
 
<span class="n">PixClr</span><span class="p">(</span> <span class="n">cHwnd</span><span class="p">,</span> <span class="n">ColorRef</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline"> ;     Changes the Color of existing PixPut() created control</span>
<span class="w"> </span><span class="nb">If </span><span class="n">hBMP</span> <span class="o">:=</span> <span class="nf">DllCall(</span> <span class="s">&quot;GetProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span> <span class="p">{</span>
<span class="w">    </span><span class="nb">ControlGetPos</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%cHwnd%</span>
    <span class="n">PixPut</span><span class="p">(</span> <span class="n">cHwnd</span><span class="p">,</span> <span class="n">ColorRef</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="nv">True</span> <span class="p">)</span>
    <span class="nf">DllCall(</span> <span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hBMP</span> <span class="p">)</span>
<span class="p">}}</span>

<span class="n">PixRmv</span><span class="p">(</span> <span class="n">cHwnd</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">             ;     Destroys a single control created by PixPut()</span>
<span class="w"> </span><span class="nb">If </span><span class="n">hBMP</span> <span class="o">:=</span> <span class="nf">DllCall(</span> <span class="s">&quot;GetProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span>
    <span class="nf">DllCall(</span> <span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hBMP</span> <span class="p">)</span>
  <span class="p">,</span> <span class="nf">DllCall(</span> <span class="s">&quot;RemoveProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span>
<span class="nb">Return</span> <span class="n">hBMP</span> <span class="o">?</span> <span class="o">!!</span><span class="nf">DllCall(</span> <span class="s">&quot;DestroyWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">cHwnd</span> <span class="p">)</span> <span class="o">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="n">PixRmvAll</span><span class="p">(</span> <span class="n">Hwnd</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">           ;     Destroys all controls created by PixPut().</span>
<span class="w"> </span><span class="nb">Critical</span><span class="c-Singleline">                     ;     Call this function before ExitApp or Gui,Destroy</span>
<span class="w"> </span><span class="nb">WinGet</span><span class="p">,</span> <span class="n">CtrlList</span><span class="p">,</span> <span class="n">ControlListHwnd</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span><span class="c-Singleline">   ; Depends on &#39;DetectHiddenWindows, On&#39;</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">CtrlList</span><span class="p">,</span> <span class="se">`n</span>
<span class="w">   </span><span class="nb">If </span><span class="n">hBMP</span> <span class="o">:=</span> <span class="nf">DllCall(</span> <span class="s">&quot;GetProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span>
      <span class="nf">DllCall(</span> <span class="s">&quot;DeleteObject&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="n">hBMP</span> <span class="p">),</span>
    <span class="p">,</span> <span class="nf">DllCall(</span> <span class="s">&quot;RemoveProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span>
    <span class="p">,</span> <span class="nf">DllCall(</span> <span class="s">&quot;DestroyWindow&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nv">A_LoopField</span> <span class="p">)</span>
<span class="p">}</span>

<span class="n">PixLst</span><span class="p">(</span> <span class="n">Hwnd</span> <span class="p">)</span> <span class="p">{</span><span class="c-Singleline">              ;     Returns all Control Hwnds created by PixPut()</span>
<span class="w"> </span><span class="nb">Critical</span>
<span class="w"> </span><span class="nb">WinGet</span><span class="p">,</span> <span class="n">CtrlList</span><span class="p">,</span> <span class="n">ControlListHwnd</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%hwnd%</span>
<span class="w"> </span><span class="nb">Loop</span><span class="p">,</span> <span class="n">Parse</span><span class="p">,</span> <span class="n">CtrlList</span><span class="p">,</span> <span class="se">`n</span>
   <span class="n">PixLst</span> <span class="o">.=</span> <span class="nf">DllCall(</span> <span class="s">&quot;GetProp&quot;</span><span class="p">,</span> <span class="n">UInt</span><span class="p">,</span><span class="nv">A_LoopField</span><span class="p">,</span> <span class="n">Str</span><span class="p">,</span><span class="s">&quot;PixPut&quot;</span> <span class="p">)</span> <span class="o">?</span> <span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span> <span class="nv">A_LoopField</span> <span class="o">:</span>
<span class="nb">Return</span> <span class="nf">SubStr(</span> <span class="n">PixLst</span><span class="p">,</span><span class="mi">2</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>
