<LINK href="styles.css" rel="stylesheet" type="text/css">old lexer: 
<div class="highlight"><pre><span class="c1">; SB_SetProgress</span>
<span class="c1">; (w) by DerRaphael / Released under the Terms of EUPL 1.0</span>
<span class="c1">; see http://ec.europa.eu/idabc/en/document/7330 for details</span>

<span class="nf">SB_SetProgress</span><span class="p">(</span>Value<span class="o">=</span><span class="mi">0</span><span class="p">,</span>Seg<span class="o">=</span><span class="mi">1</span><span class="p">,</span>Ops<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="c1">; Definition of Constants   </span>
<span class="w">   </span><span class="kt">Static</span><span class="w"> </span>SB_GETRECT<span class="w">      </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x40a</span><span class="w">      </span><span class="c1">; (WM_USER:=0x400) + 10</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>SB_GETPARTS<span class="w">     </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x406</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>SB_PROGRESS<span class="w">                   </span><span class="c1">; Container for all used hwndBar:Seg:hProgress</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>PBM_SETPOS<span class="w">      </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x402</span><span class="w">      </span><span class="c1">; (WM_USER:=0x400) + 2</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>PBM_SETRANGE32<span class="w">  </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x406</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>PBM_SETBARCOLOR<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x409</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>PBM_SETBKCOLOR<span class="w">  </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x2001</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span>dwStyle<span class="w">         </span><span class="o">:=</span><span class="w"> </span><span class="mh">0x50000001</span><span class="w"> </span><span class="c1">; forced dwStyle WS_CHILD|WS_VISIBLE|PBS_SMOOTH</span>

<span class="w">   </span><span class="c1">; Find the hWnd of the currentGui&#39;s StatusbarControl</span>
<span class="w">   </span><span class="k">Gui</span><span class="p">,</span><span class="o">+</span>LastFound
<span class="w">   </span><span class="k">ControlGet</span><span class="p">,</span>hwndBar<span class="p">,</span>hWnd<span class="p">,,</span>msctls_statusbar321

<span class="w">   </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span>StrLen<span class="p">(</span>hwndBar<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span>rErrorLevel<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;FAIL: No StatusBar Control&quot;</span><span class="w">     </span><span class="c1">; Drop ErrorLevel on Error</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>Seg<span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span>rErrorLevel<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;FAIL: Wrong Segment Parameter&quot;</span><span class="w">  </span><span class="c1">; Drop ErrorLevel on Error</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>Seg<span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">; Segment count</span>
<span class="w">      </span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span>SB_GETPARTS<span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwndBar%</span>
<span class="w">      </span>SB_Parts<span class="w"> </span><span class="o">:=</span><span class="w">  </span>ErrorLevel<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="nf">If</span><span class="w"> </span><span class="p">((</span>SB_Parts<span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>SB_Parts<span class="o">&lt;</span>Seg<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span>rErrorLevel<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;FAIL: Wrong Segment Count&quot;</span><span class="w">  </span><span class="c1">; Drop ErrorLevel on Error</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="c1">; Get Segment Dimensions in any case, so that the progress control</span>
<span class="w">         </span><span class="c1">; can be readjusted in position if neccessary</span>
<span class="w">         </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>SB_Parts<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nf">VarSetCapacity</span><span class="p">(</span>RECT<span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w">     </span><span class="c1">; RECT = 4*4 Bytes / 4 Byte &lt;=&gt; Int</span>
<span class="w">            </span><span class="c1">; Segment Size :: 0-base Index =&gt; 1. Element -&gt; #0</span>
<span class="w">            </span><span class="k">SendMessage</span><span class="p">,</span>SB_GETRECT<span class="p">,</span>Seg<span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">&amp;</span>RECT<span class="p">,,</span>ahk_id<span class="w"> </span><span class="nv">%hwndBar%</span>
<span class="w">            </span><span class="kr">If</span><span class="w"> </span>ErrorLevel
<span class="w">               </span><span class="k">Loop</span><span class="p">,</span><span class="mi">4</span>
<span class="w">                  </span>n<span class="nv">%A_index%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>NumGet<span class="p">(</span>RECT<span class="p">,(</span><span class="nb">a_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">               </span>rErrorLevel<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;FAIL: Segmentdimensions&quot;</span><span class="w"> </span><span class="c1">; Drop ErrorLevel on Error</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">; We dont have any parts, so use the entire statusbar for our progress</span>
<span class="w">            </span>n1<span class="w"> </span><span class="o">:=</span><span class="w"> </span>n2<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">ControlGetPos</span><span class="p">,,,</span>n3<span class="p">,</span>n4<span class="p">,,</span>ahk_id<span class="w"> </span><span class="nv">%hwndBar%</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="c1">; if SB_Parts</span>

<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>InStr<span class="p">(</span>SB_Progress<span class="p">,</span><span class="s">&quot;:&quot;</span><span class="w"> </span>Seg<span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span>hWndProg<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>SB_Progress<span class="p">,</span><span class="w"> </span>hwndBar<span class="w"> </span><span class="s">&quot;\:&quot;</span><span class="w"> </span>seg<span class="w"> </span><span class="s">&quot;\:(?P&lt;hWnd&gt;([^,]+|.+))&quot;</span><span class="p">,</span>p<span class="p">))</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>phWnd<span class="w"> </span><span class="o">:</span>

<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>Ops<span class="p">,</span><span class="s">&quot;i)-smooth&quot;</span><span class="p">))</span>
<span class="w">               </span>dwStyle<span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mh">0x1</span>

<span class="w">            </span>hWndProg<span class="w"> </span><span class="o">:=</span><span class="w"> </span>DllCall<span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="s">&quot;msctls_progress32&quot;</span>
<span class="w">               </span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="w"> </span>dwStyle
<span class="w">               </span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="c1">; segment-progress :: X/Y/W/H</span>
<span class="w">               </span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetAncestor&quot;</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span>hwndBar<span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">; gui hwnd</span>
<span class="w">               </span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="w">            </span>SB_Progress<span class="w"> </span><span class="p">.</span><span class="o">=</span><span class="w"> </span><span class="p">(</span>StrLen<span class="p">(</span>SB_Progress<span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span>hwndBar<span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span>Seg<span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span>hWndProg

<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="c1">; If InStr Prog &lt;-&gt; Seg</span>

<span class="w">         </span><span class="c1">; HTML Colors</span>
<span class="w">         </span>Black<span class="o">:=</span><span class="mh">0x000000</span><span class="p">,</span>Green<span class="o">:=</span><span class="mh">0x008000</span><span class="p">,</span>Silver<span class="o">:=</span><span class="mh">0xC0C0C0</span><span class="p">,</span>Lime<span class="o">:=</span><span class="mh">0x00FF00</span><span class="p">,</span>Gray<span class="o">:=</span><span class="mh">0x808080</span>
<span class="w">         </span>Olive<span class="o">:=</span><span class="mh">0x808000</span><span class="p">,</span>White<span class="o">:=</span><span class="mh">0xFFFFFF</span><span class="p">,</span>Yellow<span class="o">:=</span><span class="mh">0xFFFF00</span><span class="p">,</span>Maroon<span class="o">:=</span><span class="mh">0x800000</span><span class="p">,</span>Navy<span class="o">:=</span><span class="mh">0x000080</span>
<span class="w">         </span>Red<span class="o">:=</span><span class="mh">0xFF0000</span><span class="p">,</span>Blue<span class="o">:=</span><span class="mh">0x0000FF</span><span class="p">,</span>Fuchsia<span class="o">:=</span><span class="mh">0xFF00FF</span><span class="p">,</span>Aqua<span class="o">:=</span><span class="mh">0x00FFFF</span>

<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bBackground(?P&lt;C&gt;[a-z0-9]+)\b&quot;</span><span class="p">,</span>bg<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>strlen<span class="p">(</span>bgC<span class="p">)</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span>RegExMatch<span class="p">(</span>bgC<span class="p">,</span><span class="s">&quot;i)([0-9a-f]{6})&quot;</span><span class="p">)))</span>
<span class="w">                  </span>bgC<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;0x&quot;</span><span class="w"> </span>bgC
<span class="w">              </span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>RegExMatch<span class="p">(</span>bgC<span class="p">,</span><span class="s">&quot;i)^0x([0-9a-f]{1,6})&quot;</span><span class="p">))</span>
<span class="w">                  </span>bgC<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%bgC%</span>
<span class="w">              </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>bgC<span class="o">+</span><span class="mi">0</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span>PBM_SETBKCOLOR<span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                      </span><span class="p">,</span><span class="w"> </span><span class="p">((</span>bgC<span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span>bgC<span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span>bgC<span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="c1">; BGR</span>
<span class="w">                      </span><span class="p">,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwndProg%</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="c1">; If RegEx BGC</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bc(?P&lt;C&gt;[a-z0-9]+)\b&quot;</span><span class="p">,</span>fg<span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>strlen<span class="p">(</span>fgC<span class="p">)</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span>RegExMatch<span class="p">(</span>fgC<span class="p">,</span><span class="s">&quot;i)([0-9a-f]{6})&quot;</span><span class="p">)))</span>
<span class="w">                  </span>fgC<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;0x&quot;</span><span class="w"> </span>fgC
<span class="w">              </span><span class="k">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="o">!</span><span class="p">(</span>RegExMatch<span class="p">(</span>fgC<span class="p">,</span><span class="s">&quot;i)^0x([0-9a-f]{1,6})&quot;</span><span class="p">))</span>
<span class="w">                  </span>fgC<span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">%fgC%</span>
<span class="w">              </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span>fgC<span class="o">+</span><span class="mi">0</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="k">SendMessage</span><span class="p">,</span><span class="w"> </span>PBM_SETBARCOLOR<span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                      </span><span class="p">,</span><span class="w"> </span><span class="p">((</span>fgC<span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span>fgC<span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span>fgC<span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="c1">; BGR</span>
<span class="w">                      </span><span class="p">,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hwndProg%</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="c1">; If RegEx FGC</span>

<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">((</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)(?P&lt;In&gt;[^ ])?range((?P&lt;Lo&gt;\-?\d+)\-(?P&lt;Hi&gt;\-?\d+))?&quot;</span><span class="p">,</span>r<span class="p">))</span>
<span class="w">              </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>rIn<span class="o">!=</span><span class="s">&quot;-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>rHi<span class="o">&gt;</span>rLo<span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">; Set new LowRange and HighRange</span>
<span class="w">              </span><span class="k">SendMessage</span><span class="p">,</span><span class="mh">0x406</span><span class="p">,</span>rLo<span class="p">,</span>rHi<span class="p">,,</span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">((</span>rIn<span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span>rLo<span class="o">&gt;</span>rHi<span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">; restore defaults on remove or invalid values</span>
<span class="w">              </span><span class="k">SendMessage</span><span class="p">,</span><span class="mh">0x406</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,,</span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="c1">; If RegEx Range</span>
<span class="w">     </span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bEnable\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="k">Control</span><span class="p">,</span><span class="w"> </span>Enable<span class="p">,,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bDisable\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="k">Control</span><span class="p">,</span><span class="w"> </span>Disable<span class="p">,,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bHide\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="k">Control</span><span class="p">,</span><span class="w"> </span>Hide<span class="p">,,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>
<span class="w">         </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>RegExMatch<span class="p">(</span>ops<span class="p">,</span><span class="s">&quot;i)\bShow\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="k">Control</span><span class="p">,</span><span class="w"> </span>Show<span class="p">,,,</span><span class="w"> </span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>

<span class="w">         </span><span class="k">ControlGetPos</span><span class="p">,</span>xb<span class="p">,</span>yb<span class="p">,,,,</span>ahk_id<span class="w"> </span><span class="nv">%hwndBar%</span>
<span class="w">         </span><span class="k">ControlMove</span><span class="p">,,</span>xb<span class="o">+</span>n1<span class="p">,</span>yb<span class="o">+</span>n2<span class="p">,</span>n3<span class="o">-</span>n1<span class="p">,</span>n4<span class="o">-</span>n2<span class="p">,</span>ahk_id<span class="w"> </span><span class="nv">%hwndProg%</span>
<span class="w">         </span><span class="k">SendMessage</span><span class="p">,</span>PBM_SETPOS<span class="p">,</span>value<span class="p">,</span><span class="mi">0</span><span class="p">,,</span>ahk_id<span class="w"> </span><span class="nv">%hWndProg%</span>

<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="c1">; if Seg greater than count</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="c1">; if Seg greater zero</span>

<span class="w">   </span><span class="nf">If</span><span class="w"> </span><span class="p">(</span>regExMatch<span class="p">(</span>rErrorLevel<span class="p">,</span><span class="s">&quot;^FAIL&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span>ErrorLevel<span class="w"> </span><span class="o">:=</span><span class="w"> </span>rErrorLevel
<span class="w">      </span><span class="k">Return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">      </span><span class="k">Return</span><span class="w"> </span>hWndProg

<span class="p">}</span>
</pre></div>


New Lexer: 
<div class="highlight"><pre><span class="c-Singleline">; SB_SetProgress</span>
<span class="c-Singleline">; (w) by DerRaphael / Released under the Terms of EUPL 1.0</span>
<span class="c-Singleline">; see http://ec.europa.eu/idabc/en/document/7330 for details</span>

<span class="n">SB_SetProgress</span><span class="p">(</span><span class="n">Value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Seg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ops</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">   ; Definition of Constants   </span>
<span class="w">   </span><span class="nb">Static</span> <span class="n">SB_GETRECT</span>      <span class="o">:=</span> <span class="mh">0x40a</span><span class="c-Singleline">      ; (WM_USER:=0x400) + 10</span>
        <span class="p">,</span> <span class="n">SB_GETPARTS</span>     <span class="o">:=</span> <span class="mh">0x406</span>
        <span class="p">,</span> <span class="n">SB_PROGRESS</span><span class="c-Singleline">                   ; Container for all used hwndBar:Seg:hProgress</span>
        <span class="p">,</span> <span class="n">PBM_SETPOS</span>      <span class="o">:=</span> <span class="mh">0x402</span><span class="c-Singleline">      ; (WM_USER:=0x400) + 2</span>
        <span class="p">,</span> <span class="n">PBM_SETRANGE32</span>  <span class="o">:=</span> <span class="mh">0x406</span>
        <span class="p">,</span> <span class="n">PBM_SETBARCOLOR</span> <span class="o">:=</span> <span class="mh">0x409</span>
        <span class="p">,</span> <span class="n">PBM_SETBKCOLOR</span>  <span class="o">:=</span> <span class="mh">0x2001</span>
        <span class="p">,</span> <span class="n">dwStyle</span>         <span class="o">:=</span> <span class="mh">0x50000001</span><span class="c-Singleline"> ; forced dwStyle WS_CHILD|WS_VISIBLE|PBS_SMOOTH</span>

<span class="c-Singleline">   ; Find the hWnd of the currentGui&#39;s StatusbarControl</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="o">+</span><span class="n">LastFound</span>
<span class="w">   </span><span class="nb">ControlGet</span><span class="p">,</span><span class="n">hwndBar</span><span class="p">,</span><span class="n">hWnd</span><span class="p">,,</span><span class="n">msctls_statusbar321</span>

   <span class="n">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">hwndBar</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">rErrorLevel</span> <span class="o">:=</span> <span class="s">&quot;FAIL: No StatusBar Control&quot;</span><span class="c-Singleline">     ; Drop ErrorLevel on Error</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">If</span> <span class="p">(</span><span class="n">Seg</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">rErrorLevel</span> <span class="o">:=</span> <span class="s">&quot;FAIL: Wrong Segment Parameter&quot;</span><span class="c-Singleline">  ; Drop ErrorLevel on Error</span>
   <span class="p">}</span> <span class="n">else</span> <span class="n">if</span> <span class="p">(</span><span class="n">Seg</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">      ; Segment count</span>
<span class="w">      </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">SB_GETPARTS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hwndBar%</span>
      <span class="n">SB_Parts</span> <span class="o">:=</span>  <span class="nv">ErrorLevel</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="n">If</span> <span class="p">((</span><span class="n">SB_Parts</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">SB_Parts</span><span class="o">&lt;</span><span class="n">Seg</span><span class="p">))</span> <span class="p">{</span>
         <span class="n">rErrorLevel</span> <span class="o">:=</span> <span class="s">&quot;FAIL: Wrong Segment Count&quot;</span><span class="c-Singleline">  ; Drop ErrorLevel on Error</span>
      <span class="p">}</span> <span class="n">else</span> <span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">         ; Get Segment Dimensions in any case, so that the progress control</span>
<span class="c-Singleline">         ; can be readjusted in position if neccessary</span>
         <span class="n">if</span> <span class="p">(</span><span class="n">SB_Parts</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">VarSetCapacity</span><span class="p">(</span><span class="n">RECT</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="c-Singleline">     ; RECT = 4*4 Bytes / 4 Byte &lt;=&gt; Int</span>
<span class="c-Singleline">            ; Segment Size :: 0-base Index =&gt; 1. Element -&gt; #0</span>
<span class="w">            </span><span class="nb">SendMessage</span><span class="p">,</span><span class="n">SB_GETRECT</span><span class="p">,</span><span class="n">Seg</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">RECT</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hwndBar%</span>
<span class="w">            </span><span class="nb">If </span><span class="nv">ErrorLevel</span>
<span class="w">               </span><span class="nb">Loop</span><span class="p">,</span><span class="mi">4</span>
                  <span class="n">n</span><span class="nv">%A_index%</span> <span class="o">:=</span> <span class="nf">NumGet</span><span class="p">(</span><span class="n">RECT</span><span class="p">,(</span><span class="nv">a_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;Int&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nb">else</span>
               <span class="n">rErrorLevel</span> <span class="o">:=</span> <span class="s">&quot;FAIL: Segmentdimensions&quot;</span><span class="c-Singleline"> ; Drop ErrorLevel on Error</span>
         <span class="p">}</span> <span class="n">else</span> <span class="p">{</span><span class="c-Singleline"> ; We dont have any parts, so use the entire statusbar for our progress</span>
            <span class="n">n1</span> <span class="o">:=</span> <span class="n">n2</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="w">            </span><span class="nb">ControlGetPos</span><span class="p">,,,</span><span class="n">n3</span><span class="p">,</span><span class="n">n4</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hwndBar%</span>
         <span class="p">}</span><span class="c-Singleline"> ; if SB_Parts</span>

         <span class="n">If</span> <span class="p">(</span><span class="nf">InStr</span><span class="p">(</span><span class="n">SB_Progress</span><span class="p">,</span><span class="s">&quot;:&quot;</span> <span class="n">Seg</span> <span class="s">&quot;:&quot;</span><span class="p">))</span> <span class="p">{</span>

            <span class="n">hWndProg</span> <span class="o">:=</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">SB_Progress</span><span class="p">,</span> <span class="n">hwndBar</span> <span class="s">&quot;\:&quot;</span> <span class="n">seg</span> <span class="s">&quot;\:(?P&lt;hWnd&gt;([^,]+|.+))&quot;</span><span class="p">,</span><span class="n">p</span><span class="p">))</span> <span class="o">?</span> <span class="n">phWnd</span> <span class="o">:</span>

         <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>

            <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">Ops</span><span class="p">,</span><span class="s">&quot;i)-smooth&quot;</span><span class="p">))</span>
               <span class="n">dwStyle</span> <span class="o">^=</span> <span class="mh">0x1</span>

            <span class="n">hWndProg</span> <span class="o">:=</span> <span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;CreateWindowEx&quot;</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="s">&quot;msctls_progress32&quot;</span>
               <span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span> <span class="n">dwStyle</span>
               <span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;int&quot;</span><span class="p">,</span><span class="mi">0</span><span class="c-Singleline"> ; segment-progress :: X/Y/W/H</span>
               <span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="nf">DllCall</span><span class="p">(</span><span class="s">&quot;GetAncestor&quot;</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="n">hwndBar</span><span class="p">,</span><span class="s">&quot;uInt&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="c-Singleline"> ; gui hwnd</span>
               <span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;uint&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">SB_Progress</span> <span class="o">.=</span> <span class="p">(</span><span class="nf">StrLen</span><span class="p">(</span><span class="n">SB_Progress</span><span class="p">)</span> <span class="o">?</span> <span class="s">&quot;,&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="n">hwndBar</span> <span class="s">&quot;:&quot;</span> <span class="n">Seg</span> <span class="s">&quot;:&quot;</span> <span class="n">hWndProg</span>

         <span class="p">}</span><span class="c-Singleline"> ; If InStr Prog &lt;-&gt; Seg</span>

<span class="c-Singleline">         ; HTML Colors</span>
<span class="w">         </span><span class="nl">Black:</span><span class="o">=</span><span class="mh">0x000000</span><span class="p">,</span><span class="n">Green</span><span class="o">:=</span><span class="mh">0x008000</span><span class="p">,</span><span class="n">Silver</span><span class="o">:=</span><span class="mh">0xC0C0C0</span><span class="p">,</span><span class="n">Lime</span><span class="o">:=</span><span class="mh">0x00FF00</span><span class="p">,</span><span class="n">Gray</span><span class="o">:=</span><span class="mh">0x808080</span>
<span class="w">         </span><span class="nl">Olive:</span><span class="o">=</span><span class="mh">0x808000</span><span class="p">,</span><span class="n">White</span><span class="o">:=</span><span class="mh">0xFFFFFF</span><span class="p">,</span><span class="n">Yellow</span><span class="o">:=</span><span class="mh">0xFFFF00</span><span class="p">,</span><span class="n">Maroon</span><span class="o">:=</span><span class="mh">0x800000</span><span class="p">,</span><span class="n">Navy</span><span class="o">:=</span><span class="mh">0x000080</span>
<span class="w">         </span><span class="nl">Red:</span><span class="o">=</span><span class="mh">0xFF0000</span><span class="p">,</span><span class="n">Blue</span><span class="o">:=</span><span class="mh">0x0000FF</span><span class="p">,</span><span class="n">Fuchsia</span><span class="o">:=</span><span class="mh">0xFF00FF</span><span class="p">,</span><span class="n">Aqua</span><span class="o">:=</span><span class="mh">0x00FFFF</span>

         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bBackground(?P&lt;C&gt;[a-z0-9]+)\b&quot;</span><span class="p">,</span><span class="n">bg</span><span class="p">))</span> <span class="p">{</span>
              <span class="n">if</span> <span class="p">((</span><span class="nf">strlen</span><span class="p">(</span><span class="n">bgC</span><span class="p">)</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">bgC</span><span class="p">,</span><span class="s">&quot;i)([0-9a-f]{6})&quot;</span><span class="p">)))</span>
                  <span class="n">bgC</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="n">bgC</span>
<span class="w">              </span><span class="nb">else</span> <span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">bgC</span><span class="p">,</span><span class="s">&quot;i)^0x([0-9a-f]{1,6})&quot;</span><span class="p">))</span>
                  <span class="n">bgC</span> <span class="o">:=</span> <span class="nv">%bgC%</span>
              <span class="n">if</span> <span class="p">(</span><span class="n">bgC</span><span class="o">+</span><span class="mi">0</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">PBM_SETBKCOLOR</span><span class="p">,</span> <span class="mi">0</span>
                      <span class="p">,</span> <span class="p">((</span><span class="n">bgC</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span><span class="n">bgC</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">bgC</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="c-Singleline"> ; BGR</span>
                      <span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hwndProg%</span>
         <span class="p">}</span><span class="c-Singleline"> ; If RegEx BGC</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bc(?P&lt;C&gt;[a-z0-9]+)\b&quot;</span><span class="p">,</span><span class="n">fg</span><span class="p">))</span> <span class="p">{</span>
              <span class="n">if</span> <span class="p">((</span><span class="nf">strlen</span><span class="p">(</span><span class="n">fgC</span><span class="p">)</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">fgC</span><span class="p">,</span><span class="s">&quot;i)([0-9a-f]{6})&quot;</span><span class="p">)))</span>
                  <span class="n">fgC</span> <span class="o">:=</span> <span class="s">&quot;0x&quot;</span> <span class="n">fgC</span>
<span class="w">              </span><span class="nb">else</span> <span class="n">if</span> <span class="o">!</span><span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">fgC</span><span class="p">,</span><span class="s">&quot;i)^0x([0-9a-f]{1,6})&quot;</span><span class="p">))</span>
                  <span class="n">fgC</span> <span class="o">:=</span> <span class="nv">%fgC%</span>
              <span class="n">if</span> <span class="p">(</span><span class="n">fgC</span><span class="o">+</span><span class="mi">0</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                  </span><span class="nb">SendMessage</span><span class="p">,</span> <span class="n">PBM_SETBARCOLOR</span><span class="p">,</span> <span class="mi">0</span>
                      <span class="p">,</span> <span class="p">((</span><span class="n">fgC</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span><span class="n">fgC</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">fgC</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="c-Singleline"> ; BGR</span>
                      <span class="p">,,</span> <span class="n">ahk_id</span> <span class="nv">%hwndProg%</span>
         <span class="p">}</span><span class="c-Singleline"> ; If RegEx FGC</span>

         <span class="n">If</span> <span class="p">((</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)(?P&lt;In&gt;[^ ])?range((?P&lt;Lo&gt;\-?\d+)\-(?P&lt;Hi&gt;\-?\d+))?&quot;</span><span class="p">,</span><span class="n">r</span><span class="p">))</span>
              <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">rIn</span><span class="o">!=</span><span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">rHi</span><span class="o">&gt;</span><span class="n">rLo</span><span class="p">))</span> <span class="p">{</span><span class="c-Singleline">    ; Set new LowRange and HighRange</span>
<span class="w">              </span><span class="nb">SendMessage</span><span class="p">,</span><span class="mh">0x406</span><span class="p">,</span><span class="n">rLo</span><span class="p">,</span><span class="n">rHi</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>
         <span class="p">}</span> <span class="n">else</span> <span class="n">if</span> <span class="p">((</span><span class="n">rIn</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">rLo</span><span class="o">&gt;</span><span class="n">rHi</span><span class="p">))</span> <span class="p">{</span><span class="c-Singleline">  ; restore defaults on remove or invalid values</span>
<span class="w">              </span><span class="nb">SendMessage</span><span class="p">,</span><span class="mh">0x406</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>
         <span class="p">}</span><span class="c-Singleline"> ; If RegEx Range</span>
     
         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bEnable\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="nb">Control</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bDisable\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="nb">Control</span><span class="p">,</span> <span class="n">Disable</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bHide\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="nb">Control</span><span class="p">,</span> <span class="n">Hide</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>
         <span class="n">If</span> <span class="p">(</span><span class="nf">RegExMatch</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="s">&quot;i)\bShow\b&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="nb">Control</span><span class="p">,</span> <span class="n">Show</span><span class="p">,,,</span> <span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>

<span class="w">         </span><span class="nb">ControlGetPos</span><span class="p">,</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">,,,,</span><span class="n">ahk_id</span> <span class="nv">%hwndBar%</span>
<span class="w">         </span><span class="nb">ControlMove</span><span class="p">,,</span><span class="n">xb</span><span class="o">+</span><span class="n">n1</span><span class="p">,</span><span class="n">yb</span><span class="o">+</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="o">-</span><span class="n">n1</span><span class="p">,</span><span class="n">n4</span><span class="o">-</span><span class="n">n2</span><span class="p">,</span><span class="n">ahk_id</span> <span class="nv">%hwndProg%</span>
<span class="w">         </span><span class="nb">SendMessage</span><span class="p">,</span><span class="n">PBM_SETPOS</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="mi">0</span><span class="p">,,</span><span class="n">ahk_id</span> <span class="nv">%hWndProg%</span>

      <span class="p">}</span><span class="c-Singleline"> ; if Seg greater than count</span>
   <span class="p">}</span><span class="c-Singleline"> ; if Seg greater zero</span>

   <span class="n">If</span> <span class="p">(</span><span class="nf">regExMatch</span><span class="p">(</span><span class="n">rErrorLevel</span><span class="p">,</span><span class="s">&quot;^FAIL&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">ErrorLevel</span> <span class="o">:=</span> <span class="n">rErrorLevel</span>
<span class="w">      </span><span class="nb">Return</span> <span class="o">-</span><span class="mi">1</span>
   <span class="p">}</span> <span class="n">else</span>
<span class="w">      </span><span class="nb">Return</span> <span class="n">hWndProg</span>

<span class="p">}</span>
</pre></div>
