<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; #Include strPut.ahk</span>
<span class="c-Singleline">; #Include strGet.ahk</span>
<span class="nb">#NoEnv</span>
<span class="nb">SendMode</span> <span class="n">Input</span>
<span class="nb">SetWorkingDir</span> <span class="nv">%A_ScriptDir%</span>

<span class="nb">input</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span>
<span class="n">output</span> <span class="o">:=</span> <span class="s">&quot;&quot;</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Write the string &quot;Hello World!&quot; into variable with default ANSI code page.</span>
<span class="c-Singleline">; Display how many characters are written.</span>
<span class="nb">MsgBox</span> <span class="o">%</span> <span class="n">StrPutVar</span><span class="p">(</span><span class="s">&quot;Hello World!&quot;</span><span class="p">,</span> <span class="n">input</span><span class="p">,</span> <span class="s">&quot;cp0&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Get string from adress of variable &quot;input&quot; with default ANSI code page.</span>
<span class="n">output</span> <span class="o">:=</span> <span class="nf">StrGet(</span><span class="o">&amp;</span><span class="n">input</span><span class="p">,</span> <span class="s">&quot;cp0&quot;</span><span class="p">)</span><span class="c-Singleline"></span>

<span class="c-Singleline">; Display the output string.</span>
<span class="nb">MsgBox</span> <span class="nv">%output%</span><span class="c-Singleline"></span>

<span class="c-Singleline">; If you use frequently StrPut() with variables, consider to add this function.</span>
<span class="c-Singleline">; Function copied from StrPutGet-documentation written by Lexikos.</span>
<span class="n">StrPutVar</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">var</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
<span class="p">{</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; Ensure capacity.</span>
    <span class="nf">VarSetCapacity(</span> <span class="n">var</span><span class="p">,</span> <span class="nf">StrPut(</span><span class="n">string</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">        ; StrPut returns char count, but VarSetCapacity needs bytes.</span>
        <span class="o">*</span> <span class="p">((</span><span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-16&quot;</span><span class="o">||</span><span class="n">encoding</span><span class="o">=</span><span class="s">&quot;cp1200&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span><span class="c-Singleline"></span>
<span class="c-Singleline">    ; Copy or convert the string.</span>
<span class="w">    </span><span class="nb">return</span> <span class="nf">StrPut(</span><span class="n">string</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
