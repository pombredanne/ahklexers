<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; Tuncay: I made small changes only.</span>
<span class="c-Singleline">; Thanks to tic for most of the demonstration script.</span>
<span class="c-Singleline">; #include regionGetColor.ahk</span>
<span class="nb">#NoEnv</span><span class="c-Singleline">  ; Recommended for performance and compatibility with future AutoHotkey releases.</span>
<span class="nb">SendMode</span> <span class="n">Input</span><span class="c-Singleline">  ; Recommended for new scripts due to its superior speed and reliability.</span>
<span class="nb">SetWorkingDir</span> <span class="nv">%A_ScriptDir%</span><span class="c-Singleline">  ; Ensures a consistent starting directory.</span>
<span class="c-Singleline">;region ;AutoExec; #######################################################################</span>
<span class="nb">#SingleInstance</span><span class="p">,</span> <span class="n">Force</span>
<span class="nb">CoordMode</span><span class="p">,</span> <span class="n">Mouse</span><span class="p">,</span> <span class="n">Screen</span>
<span class="nb">MsgBox</span> <span class="n">Press</span> <span class="n">Alt</span><span class="o">+</span><span class="n">LeftMouseButton</span> <span class="n">for</span> <span class="n">selecting</span> <span class="n">new</span> <span class="n">area</span><span class="o">.</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">nPress</span> <span class="n">Alt</span><span class="o">+</span><span class="n">r</span> <span class="n">for</span> <span class="n">rechecking</span> <span class="n">that</span> <span class="n">area</span> <span class="ow">and</span> <span class="n">refreshing</span> <span class="n">the</span> <span class="n">gui</span><span class="o">.</span>
<span class="nl">RegionMain:</span>
<span class="n">If</span> <span class="o">!</span><span class="n">regionInit</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb">OnExit</span><span class="p">,</span> <span class="n">Exit</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:+</span><span class="n">AlwaysOnTop</span> <span class="o">+</span><span class="n">ToolWindow</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">Color</span><span class="p">,</span> <span class="mh">0xffffff</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Edit</span><span class="p">,</span> <span class="n">vGuiTextVar</span> <span class="o">+</span><span class="n">ReadOnly</span> <span class="n">h160</span> <span class="n">w180</span><span class="p">,</span> <span class="n">Color</span><span class="o">:</span> <span class="mh">0xffffff</span><span class="err">`</span><span class="n">nCount</span><span class="o">:</span> <span class="err">`</span><span class="n">nTime</span><span class="o">:</span> <span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span><span class="err">`</span><span class="n">n</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">Show</span><span class="p">,</span> <span class="p">,</span> <span class="n">regionColor</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="n">Color</span><span class="p">,</span> <span class="mh">0xCCCCCC</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">2</span><span class="o">:+</span><span class="n">ToolWindow</span> <span class="o">-</span><span class="n">Caption</span> <span class="o">+</span><span class="n">Border</span> <span class="o">+</span><span class="n">AlwaysOnTop</span> <span class="o">+</span><span class="mh">0x20</span><span class="c-Singleline"> ; 0x20=click-thru</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">vGuiTextVar2</span> <span class="n">w80</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">2</span><span class="o">:+</span><span class="n">LastFound</span>
   <span class="mi">2</span><span class="n">GuiID</span> <span class="o">:=</span> <span class="nf">WinExist(</span><span class="p">)</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="n">Show</span><span class="p">,</span> <span class="n">X</span><span class="o">-</span><span class="mi">2000</span> <span class="n">Y</span><span class="o">-</span><span class="mi">2000</span> <span class="n">W1</span> <span class="n">H1</span>
<span class="w">   </span><span class="nb">WinSet</span><span class="p">,</span> <span class="n">Trans</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span><span class="c-Singleline"></span>
<span class="c-Singleline">;   CoordMode, Mouse, Screen</span>
<span class="w">   </span><span class="nb">Process</span><span class="p">,</span> <span class="n">Priority</span><span class="p">,,</span> <span class="n">High</span>
<span class="w">   </span><span class="nb">SetBatchLines</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<span class="w">   </span><span class="nb">SetWinDelay</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
   <span class="n">RegionInit</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="n">GuiX</span> <span class="o">:=</span> <span class="n">GuiY</span> <span class="o">:=</span> <span class="mi">0</span>
   <span class="n">GuiW</span> <span class="o">:=</span> <span class="n">GuiH</span> <span class="o">:=</span> <span class="mi">100</span>
<span class="p">}</span>
<span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">Show</span>
<span class="nb">return</span><span class="c-Singleline"></span>
<span class="c-Singleline">;end_region</span>

<span class="c-Singleline">;region ;Labels and Hotkeys; #############################################################</span>
<span class="nl">Esc::</span>
<span class="nb">Exit</span><span class="o">:</span>
<span class="nl">GuiClose:</span>
<span class="w">   </span><span class="nb">ExitApp</span>

<span class="nl">!LButton::</span><span class="c-Singleline"></span>
<span class="c-Singleline">; use gui 2 to create a rectangle for area selection</span>
   <span class="n">If</span> <span class="o">!</span><span class="n">RegionInit</span>
<span class="w">      </span><span class="nb">GoSub</span> <span class="n">RegionMain</span>
<span class="w">   </span><span class="nb">MouseGetPos</span><span class="p">,</span> <span class="n">s_MSX</span><span class="p">,</span> <span class="n">s_MSY</span><span class="p">,</span> <span class="n">s_ID</span><span class="p">,</span> <span class="n">s_CID</span><span class="p">,</span> <span class="mi">2</span><span class="c-Singleline"> ;start mouse X and Y</span>
<span class="w">   </span><span class="nb">WinSet</span><span class="p">,</span> <span class="n">AlwaysOnTop</span><span class="p">,</span> <span class="n">On</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span>
<span class="w">   </span><span class="nb">Loop</span>
   <span class="p">{</span>
<span class="w">      </span><span class="nb">Sleep</span> <span class="mi">20</span>
      <span class="n">If</span> <span class="o">!</span><span class="nf">GetKeyState(</span><span class="s">&quot;LButton&quot;</span><span class="p">,</span> <span class="s">&quot;P&quot;</span><span class="p">)</span><span class="c-Singleline">                  ;break if user releases the mouse</span>
<span class="w">         </span><span class="nb">Break</span>   
<span class="w">      </span><span class="nb">MouseGetPos</span><span class="p">,</span> <span class="n">c_MSX</span><span class="p">,</span> <span class="n">c_MSY</span><span class="c-Singleline">                     ;current mouse X and Y</span>
      <span class="n">GuiX</span> <span class="o">:=</span> <span class="p">(</span><span class="n">s_MSX</span> <span class="o">&lt;</span> <span class="n">c_MSX</span> <span class="o">?</span> <span class="n">s_MSX</span> <span class="o">:</span> <span class="n">c_MSX</span><span class="p">)</span><span class="c-Singleline">            ;use whichever smaller for X and Y</span>
      <span class="n">GuiY</span> <span class="o">:=</span> <span class="p">(</span><span class="n">s_MSY</span> <span class="o">&lt;</span> <span class="n">c_MSY</span> <span class="o">?</span> <span class="n">s_MSY</span> <span class="o">:</span> <span class="n">c_MSY</span><span class="p">)</span>
      <span class="n">GuiW</span> <span class="o">:=</span> <span class="nf">Abs(Abs(</span><span class="n">s_MSX</span><span class="p">)</span><span class="o">-</span><span class="nf">Abs(</span><span class="n">c_MSX</span><span class="p">))</span><span class="c-Singleline">               ;doesn&#39;t matter which is bigger,</span>
      <span class="n">GuiH</span> <span class="o">:=</span> <span class="nf">Abs(Abs(</span><span class="n">s_MSY</span><span class="p">)</span><span class="o">-</span><span class="nf">Abs(</span><span class="n">c_MSY</span><span class="p">))</span><span class="c-Singleline">               ;the absloute difference will be the same</span>
<span class="w">      </span><span class="nb">WinMove</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span><span class="p">,,</span> <span class="n">GuiX</span><span class="p">,</span> <span class="n">GuiY</span><span class="p">,</span> <span class="n">GuiW</span><span class="p">,</span> <span class="n">GuiH</span><span class="c-Singleline">   ;move the window there</span>
<span class="w">      </span><span class="nb">GuiControl</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="p">,</span> <span class="n">GuiTextVar2</span><span class="p">,</span> <span class="o">%</span> <span class="n">GuiW</span> <span class="s">&quot;, &quot;</span> <span class="n">GuiH</span>
   <span class="p">}</span>
<span class="o">!</span><span class="n">r</span><span class="o">::</span><span class="c-Singleline">               ;to retry at the last used coord.</span>
<span class="w">   </span><span class="nb">WinMove</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span><span class="p">,,</span> <span class="n">GuiX</span><span class="p">,</span> <span class="n">GuiY</span><span class="p">,</span> <span class="n">GuiW</span><span class="p">,</span> <span class="n">GuiH</span><span class="c-Singleline">      ;to see where it&#39;s retrying</span>
<span class="w">   </span><span class="nb">Sleep</span> <span class="mi">100</span>
<span class="w">   </span><span class="nb">WinMove</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span><span class="p">,,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="c-Singleline">          ;hide the window away</span>
<span class="w">      </span><span class="nb">WinGetPos</span><span class="p">,</span> <span class="n">WinX</span><span class="p">,</span> <span class="n">WinY</span><span class="p">,</span> <span class="n">WinW</span><span class="p">,</span> <span class="n">WinH</span><span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%s_ID%</span>
<span class="w">      </span><span class="nb">ControlGetPos</span><span class="p">,</span> <span class="n">CtrX</span><span class="p">,</span> <span class="n">CtrY</span><span class="p">,</span> <span class="n">CtrW</span><span class="p">,</span> <span class="n">CtrH</span><span class="p">,</span> <span class="p">,</span> <span class="n">ahk_id</span> <span class="nv">%s_CID%</span>
      <span class="n">regionInfo</span> <span class="o">:=</span> <span class="s">&quot;Relative to:`n   Screen: &quot;</span> <span class="n">GuiX</span> <span class="s">&quot;,&quot;</span> <span class="n">GuiY</span>
      <span class="n">regionInfo</span> <span class="o">.=</span> <span class="s">&quot;`n   Window: &quot;</span> <span class="n">GuiX</span><span class="o">-</span><span class="n">WinX</span> <span class="s">&quot;,&quot;</span> <span class="n">GuiY</span><span class="o">-</span><span class="n">WinY</span>
      <span class="n">regionInfo</span> <span class="o">.=</span> <span class="s">&quot;`n   Control: &quot;</span> <span class="n">GuiX</span><span class="o">-</span><span class="n">WinX</span><span class="o">-</span><span class="n">CtrX</span> <span class="s">&quot;,&quot;</span> <span class="n">Guiy</span><span class="o">-</span><span class="n">WinY</span><span class="o">-</span><span class="n">CtrY</span>
      <span class="n">regionInfo</span> <span class="o">.=</span> <span class="s">&quot;`nWidth/Height: &quot;</span> <span class="n">GuiW</span> <span class="s">&quot;,&quot;</span> <span class="n">GuiH</span>
   <span class="n">Info1</span> <span class="o">:=</span> <span class="s">&quot;RGB:`t&quot;</span>
   <span class="n">Color1</span> <span class="o">:=</span> <span class="n">regionGetColor</span><span class="p">(</span><span class="n">GuiX</span><span class="p">,</span> <span class="n">GuiY</span><span class="p">,</span> <span class="n">GuiW</span><span class="p">,</span> <span class="n">GuiH</span><span class="p">)</span><span class="c-Singleline"> ;get the color of the region</span>
   <span class="n">Time1</span> <span class="o">:=</span> <span class="s">&quot;Time: &quot;</span> <span class="nv">ErrorLevel</span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">Color</span><span class="p">,</span> <span class="nv">%Color1%</span>
<span class="w">   </span><span class="nb">GuiControl</span><span class="p">,</span> <span class="p">,</span> <span class="n">GuiTextVar</span><span class="p">,</span> <span class="o">%</span> <span class="n">Info1</span> <span class="n">Color1</span> <span class="s">&quot;`n`t&quot;</span> <span class="n">Time1</span> <span class="s">&quot;`n`n&quot;</span> <span class="n">regionInfo</span>
<span class="nb">return</span><span class="c-Singleline"></span>
<span class="c-Singleline">;end_region</span>
</pre></div>
