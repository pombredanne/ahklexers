<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="c-Singleline">; Tuncay: I made small changes only.</span>
<span class="c-Singleline">; Thanks to tic for most of the demonstration script.</span>
<span class="c-Singleline">; #include regionGetColor.ahk</span><span class="w"></span>
<span class="nb">#NoEnv</span><span class="c-Singleline">  ; Recommended for performance and compatibility with future AutoHotkey releases.</span><span class="w"></span>

<span class="nb">SendMode</span><span class="w"> </span><span class="s">Input  </span><span class="c-Singleline">; Recommended for new scripts due to its superior speed and reliability.</span><span class="w"></span>

<span class="nb">SetWorkingDir</span><span class="w"> </span><span class="nv">%A_ScriptDir%</span><span class="c-Singleline">  ; Ensures a consistent starting directory.</span><span class="w"></span>

<span class="c-Singleline">;region ;AutoExec; #######################################################################</span><span class="w"></span>
<span class="nb">#SingleInstance</span><span class="p">,</span><span class="s"> Force</span><span class="w"></span>

<span class="nb">CoordMode</span><span class="p">,</span><span class="s"> Mouse</span><span class="p">,</span><span class="s"> Screen</span><span class="w"></span>

<span class="nb">MsgBox</span><span class="w"> </span><span class="s">Press Alt+LeftMouseButton for selecting new area.`n`nPress Alt+r for rechecking that area and refreshing the gui.</span><span class="w"></span>

<span class="nl">RegionMain:</span><span class="w"></span>
<span class="n">If</span><span class="p"> </span><span class="o">!</span><span class="n">regionInit</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nb">OnExit</span><span class="p">,</span><span class="s"> Exit</span><span class="w"></span>
<span class="w">    </span><span class="n">Gui</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">:+</span><span class="n">AlwaysOnTop</span><span class="w"> </span><span class="o">+</span><span class="n">ToolWindow</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 1:Color</span><span class="p">,</span><span class="s"> 0xffffff</span><span class="w"></span>
<span class="w">    </span><span class="n">Gui</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span><span class="w"> </span><span class="n">Edit</span><span class="p">,</span><span class="w"> </span><span class="n">vGuiTextVar</span><span class="w"> </span><span class="o">+</span><span class="n">ReadOnly</span><span class="w"> </span><span class="n">h160</span><span class="w"> </span><span class="n">w180</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="o">:</span><span class="w"> </span><span class="mh">0xffffff</span><span class="se">`n</span><span class="n">Count</span><span class="o">:</span><span class="w"> </span><span class="se">`n</span><span class="n">Time</span><span class="o">:</span><span class="w"> </span><span class="se">`n`n`n`n`n`n`n</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 1:Show</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> regionColor</span><span class="w"></span>
<span class="w">    </span><span class="n">Gui</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">Color</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCCCCCC</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 2:+ToolWindow -Caption +Border +AlwaysOnTop +0x20 </span><span class="c-Singleline">; 0x20=click-thru</span><span class="w"></span>
<span class="w">    </span><span class="n">Gui</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">Add</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">vGuiTextVar2</span><span class="w"> </span><span class="n">w80</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 2:+LastFound</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span><span class="n">GuiID</span><span class="w"> </span><span class="o">:=</span><span class="nf"> WinExist</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 2:Show</span><span class="p">,</span><span class="s"> X-2000 Y-2000 W1 H1</span><span class="w"></span>
<span class="w">    </span><span class="n">WinSet</span><span class="p">,</span><span class="w"> </span><span class="n">Trans</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="n">ahk_id</span><span class="w"> </span><span class="o">%</span><span class="mi">2</span><span class="n">GuiID</span><span class="o">%</span><span class="c-Singleline"></span>
<span class="c-Singleline">;   CoordMode, Mouse, Screen</span><span class="w"></span>
<span class="w">   </span><span class="nb">Process</span><span class="p">,</span><span class="s"> Priority</span><span class="p">,,</span><span class="s"> High</span><span class="w"></span>
<span class="w">    </span><span class="n">SetBatchLines</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="nb">SetWinDelay</span><span class="p">,</span><span class="s"> -1</span><span class="w"></span>
<span class="w">    </span><span class="n">RegionInit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">   </span><span class="n">GuiX</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="n">GuiY</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">   </span><span class="n">GuiW</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="n">GuiH</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nb">Gui</span><span class="p">,</span><span class="s"> 1:Show</span><span class="w"></span>

<span class="nf">return</span><span class="c-Singleline"></span>
<span class="c-Singleline">;end_region</span>

<span class="c-Singleline">;region ;Labels and Hotkeys; #############################################################</span><span class="w"></span>
<span class="nl">Esc::</span><span class="w"></span>
<span class="nl">Exit:</span><span class="w"></span>
<span class="nl">GuiClose:</span><span class="w"></span>
<span class="w">   </span><span class="nb">ExitApp</span><span class="w"></span>

<span class="o">!</span><span class="n">LButton</span><span class="o">::</span><span class="c-Singleline"></span>
<span class="c-Singleline">; use gui 2 to create a rectangle for area selection</span><span class="w"></span>
<span class="w">   </span><span class="n">If</span><span class="p"> </span><span class="o">!</span><span class="n">RegionInit</span><span class="w"></span>
<span class="w">      </span><span class="nb">GoSub</span><span class="w"> </span><span class="s">RegionMain</span><span class="w"></span>
<span class="w">    </span><span class="n">MouseGetPos</span><span class="p">,</span><span class="w"> </span><span class="n">s_MSX</span><span class="p">,</span><span class="w"> </span><span class="n">s_MSY</span><span class="p">,</span><span class="w"> </span><span class="n">s_ID</span><span class="p">,</span><span class="w"> </span><span class="n">s_CID</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="c-Singleline"> ;start mouse X and Y</span><span class="w"></span>
<span class="w">   </span><span class="nb">WinSet</span><span class="p">,</span><span class="s"> AlwaysOnTop</span><span class="p">,</span><span class="s"> On</span><span class="p">,</span><span class="s"> ahk_id %2GuiID%</span><span class="w"></span>
<span class="w">    </span><span class="n">Loop</span><span class="w"></span>
<span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">Sleep</span><span class="w"> </span><span class="s">20</span><span class="w"></span>
<span class="w">       </span><span class="n">If</span><span class="w"> </span><span class="o">!</span><span class="nf">GetKeyState</span><span class="p">(</span><span class="s">&quot;LButton&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">)</span><span class="c-Singleline">                  ;break if user releases the mouse</span><span class="w"></span>
<span class="w">         </span><span class="nb">Break</span><span class="w">   </span>
<span class="w">      </span><span class="s">MouseGetPos</span><span class="p">,</span><span class="s"> c_MSX</span><span class="p">,</span><span class="s"> c_MSY                     </span><span class="c-Singleline">;current mouse X and Y</span><span class="w"></span>
<span class="w">       </span><span class="n">GuiX</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span><span class="n">s_MSX</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">c_MSX</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">s_MSX</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">c_MSX</span><span class="p">)</span><span class="c-Singleline">            ;use whichever smaller for X and Y</span><span class="w"></span>
<span class="w">      </span><span class="n">GuiY</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="p">(</span><span class="n">s_MSY</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">c_MSY</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">s_MSY</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">c_MSY</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">GuiW</span><span class="p"> </span><span class="o">:=</span><span class="nf"> Abs</span><span class="p">(</span><span class="nf">Abs</span><span class="p">(</span><span class="n">s_MSX</span><span class="p">)</span><span class="o">-</span><span class="nf">Abs</span><span class="p">(</span><span class="n">c_MSX</span><span class="p">))</span><span class="c-Singleline">               ;doesn&#39;t matter which is bigger,</span><span class="w"></span>
<span class="w">      </span><span class="n">GuiH</span><span class="p"> </span><span class="o">:=</span><span class="nf"> Abs</span><span class="p">(</span><span class="nf">Abs</span><span class="p">(</span><span class="n">s_MSY</span><span class="p">)</span><span class="o">-</span><span class="nf">Abs</span><span class="p">(</span><span class="n">c_MSY</span><span class="p">))</span><span class="c-Singleline">               ;the absloute difference will be the same</span><span class="w"></span>
<span class="w">      </span><span class="nb">WinMove</span><span class="p">,</span><span class="s"> ahk_id %2GuiID%</span><span class="p">,,</span><span class="s"> GuiX</span><span class="p">,</span><span class="s"> GuiY</span><span class="p">,</span><span class="s"> GuiW</span><span class="p">,</span><span class="s"> GuiH   </span><span class="c-Singleline">;move the window there</span><span class="w"></span>
<span class="w">       </span><span class="n">GuiControl</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="p">,</span><span class="w"> </span><span class="n">GuiTextVar2</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">GuiW</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="n">GuiH</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="nl">!r::</span><span class="c-Singleline">               ;to retry at the last used coord.</span><span class="w"></span>
<span class="w">   </span><span class="nb">WinMove</span><span class="p">,</span><span class="s"> ahk_id %2GuiID%</span><span class="p">,,</span><span class="s"> GuiX</span><span class="p">,</span><span class="s"> GuiY</span><span class="p">,</span><span class="s"> GuiW</span><span class="p">,</span><span class="s"> GuiH      </span><span class="c-Singleline">;to see where it&#39;s retrying</span><span class="w"></span>
<span class="w">    </span><span class="n">Sleep</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="w">   </span><span class="nb">WinMove</span><span class="p">,</span><span class="s"> ahk_id %2GuiID%</span><span class="p">,,</span><span class="s"> -2000</span><span class="p">,</span><span class="s">-2000</span><span class="p">,</span><span class="s"> 2</span><span class="p">,</span><span class="s"> 2          </span><span class="c-Singleline">;hide the window away</span><span class="w"></span>
<span class="w">       </span><span class="n">WinGetPos</span><span class="p">,</span><span class="w"> </span><span class="n">WinX</span><span class="p">,</span><span class="w"> </span><span class="n">WinY</span><span class="p">,</span><span class="w"> </span><span class="n">WinW</span><span class="p">,</span><span class="w"> </span><span class="n">WinH</span><span class="p">,</span><span class="w"> </span><span class="n">ahk_id</span><span class="w"> </span><span class="nv">%s_ID%</span><span class="w"></span>
<span class="w">      </span><span class="nb">ControlGetPos</span><span class="p">,</span><span class="s"> CtrX</span><span class="p">,</span><span class="s"> CtrY</span><span class="p">,</span><span class="s"> CtrW</span><span class="p">,</span><span class="s"> CtrH</span><span class="p">,</span><span class="s"> </span><span class="p">,</span><span class="s"> ahk_id %s_CID%</span><span class="w"></span>
<span class="w">       </span><span class="n">regionInfo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Relative to:`n   Screen: &quot;</span><span class="w"> </span><span class="n">GuiX</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="n">GuiY</span><span class="w"></span>
<span class="w">      </span><span class="n">regionInfo</span><span class="p"> </span><span class="o">.=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">   Window: &quot;</span><span class="w"> </span><span class="n">GuiX</span><span class="o">-</span><span class="n">WinX</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="n">GuiY</span><span class="o">-</span><span class="n">WinY</span><span class="w"></span>
<span class="w">      </span><span class="n">regionInfo</span><span class="p"> </span><span class="o">.=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">   Control: &quot;</span><span class="w"> </span><span class="n">GuiX</span><span class="o">-</span><span class="n">WinX</span><span class="o">-</span><span class="n">CtrX</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="n">Guiy</span><span class="o">-</span><span class="n">WinY</span><span class="o">-</span><span class="n">CtrY</span><span class="w"></span>
<span class="w">      </span><span class="n">regionInfo</span><span class="p"> </span><span class="o">.=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">Width/Height: &quot;</span><span class="w"> </span><span class="n">GuiW</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="n">GuiH</span><span class="w"></span>
<span class="w">   </span><span class="n">Info1</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;RGB:`t&quot;</span><span class="w"></span>
<span class="w">   </span><span class="n">Color1</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="n">regionGetColor</span><span class="p">(</span><span class="n">GuiX</span><span class="p">,</span><span class="w"> </span><span class="n">GuiY</span><span class="p">,</span><span class="w"> </span><span class="n">GuiW</span><span class="p">,</span><span class="w"> </span><span class="n">GuiH</span><span class="p">)</span><span class="c-Singleline"> ;get the color of the region</span><span class="w"></span>
<span class="w">   </span><span class="n">Time1</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Time: &quot;</span><span class="w"> </span><span class="nv">ErrorLevel</span><span class="w"></span>
<span class="w">   </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> 1:Color</span><span class="p">,</span><span class="s"> %Color1%</span><span class="w"></span>
<span class="w">    </span><span class="n">GuiControl</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">GuiTextVar</span><span class="p">,</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Info1</span><span class="w"> </span><span class="n">Color1</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n`t</span><span class="s">&quot;</span><span class="w"> </span><span class="n">Time1</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n`n</span><span class="s">&quot;</span><span class="w"> </span><span class="n">regionInfo</span><span class="nf"></span>
<span class="nf">return</span><span class="c-Singleline"></span>
<span class="c-Singleline">;end_region</span><span class="w"></span>
</pre></div>
