<LINK href="styles.css" rel="stylesheet" type="text/css"><div class="highlight"><pre><span class="nb">#NoEnv</span><span class="w"></span>

<span class="nb">#SingleInstance</span><span class="w"> </span><span class="s">force</span><span class="w"></span>
<span class="w">	</span>
<span class="w">		</span><span class="nb">gosub</span><span class="w"> </span><span class="s">CreateGui</span><span class="w"></span>
<span class="w">		</span><span class="nb">gosub</span><span class="w"> </span><span class="s">FillTV</span><span class="w"></span>


<span class="w">		</span><span class="n">TVX</span><span class="p">(</span><span class="s">&quot;MyTree&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Handler&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;HasRoot CollapseOnMove &quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;aTooltip&quot;</span><span class="p">)</span><span class="c-Singleline">		;!!!!!</span><span class="w"></span>
<span class="w">	</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Show</span><span class="p">,</span><span class="s"> h410 w430</span><span class="w"></span>

<span class="nf">return</span><span class="w"></span>


<span class="nl">Handler:</span><span class="nf"></span>
<span class="nf">	if </span><span class="nv">A_GuiEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="w"></span>
<span class="w">		</span><span class="nb">Tooltip</span><span class="p"> % </span><span class="n">aTooltip</span><span class="nv">%A_EventInfo%</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="nf"></span>
<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;-------------------------------------------------------------------------------</span><span class="w"></span>

<span class="nl">Save:</span><span class="w"></span>
<span class="w">	</span><span class="n">TVX_Walk</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SaveHandler&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">,</span><span class="w"> </span><span class="n">Item</span><span class="p">)</span><span class="nf"></span>
<span class="nf">return</span><span class="w"></span>

<span class="nl">SaveHandler:</span><span class="nf"></span>
<span class="nf">	TV_GetText</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">Item</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	if </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nb">FileDelete</span><span class="p">,</span><span class="s"> _out.txt </span><span class="w"></span>
<span class="w">			</span><span class="n">FileAppend</span><span class="w"> </span><span class="nv">%txt%</span><span class="se">`n</span><span class="p">,</span><span class="w"> </span><span class="n">_out</span><span class="o">.</span><span class="n">txt</span><span class="w"></span>
<span class="w">		</span><span class="n">line</span><span class="p"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;|-&quot;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="nf"></span>

<span class="nf">	if </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="w"></span>
<span class="w">		</span><span class="nb">StringTrimRight</span><span class="p">,</span><span class="s"> line</span><span class="p">,</span><span class="s"> line</span><span class="p">,</span><span class="s"> 2</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="nf">	if </span><span class="n">Event</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">I</span><span class="p">,</span><span class="n">M</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="nb">FileAppend</span><span class="w"> </span><span class="nv">%line%%txt%</span><span class="p">,</span><span class="s"> _out.txt</span><span class="w"></span>
<span class="w">			</span><span class="n">FileAppend</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;    &quot;</span><span class="w"> </span><span class="n">aTooltip</span><span class="nv">%item%</span><span class="w"> </span><span class="s">&quot;</span><span class="se">`n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_out</span><span class="o">.</span><span class="n">txt</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="nf"></span>

<span class="nf">	if </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="w"></span>
<span class="w">		</span><span class="n">line</span><span class="p"> </span><span class="o">.=</span><span class="w"> </span><span class="s">&quot;--&quot;</span><span class="nf"></span>
<span class="nf">	</span>
<span class="nf">	if </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"></span>
<span class="w">	  	</span><span class="nb">Msgbox</span><span class="p">,</span><span class="s"> TVX saved in _out.txt</span><span class="w"></span>

<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;---------------------------------------------------------------------------------</span><span class="w"></span>

<span class="nl">OnButton:</span><span class="w"></span>
<span class="w">    </span><span class="nb">ControlSend</span><span class="p">,</span><span class="s"> SysTreeView321</span><span class="p">,</span><span class="s"> {SHIFT down}</span><span class="w"></span>
<span class="w">		</span><span class="nb">ControlSend</span><span class="p">,</span><span class="s"> SysTreeView321</span><span class="p">,</span><span class="s"> {%A_GuiControl%}</span><span class="w"></span>
<span class="w">		</span><span class="nb">sleep</span><span class="w"> </span><span class="s">50	</span><span class="w"></span>
<span class="w">     </span><span class="n">ControlSend</span><span class="p">,</span><span class="w"> </span><span class="n">SysTreeView321</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">SHIFT</span><span class="w"> </span><span class="n">up</span><span class="p">}</span><span class="c-Singleline"></span>

<span class="c-Singleline">;	h := TVX_Move(TV_GetSelection(), A_GuiControl=&quot;Up&quot; ? &quot;u&quot; : &quot;d&quot;)</span>
<span class="c-Singleline">;   TV_Modify(h, &quot;Select&quot;)</span><span class="nf"></span>
<span class="nf">return</span><span class="w"></span>

<span class="nl">Modify:</span><span class="nf"></span>

<span class="nf">	if </span><span class="nv">A_GuiControl</span><span class="o">=</span><span class="n">Delete</span><span class="w"></span>
<span class="w">	    </span><span class="nb">ControlSend</span><span class="p">,</span><span class="s"> SysTreeView321</span><span class="p">,</span><span class="s"> {DELETE}</span><span class="w"></span>

<span class="w">	</span><span class="nf">	if </span><span class="nv">A_GuiControl</span><span class="o">=</span><span class="nf">Insert</span><span class="w"></span>
<span class="w">	    </span><span class="nb">ControlSend</span><span class="p">,</span><span class="s"> SysTreeView321</span><span class="p">,</span><span class="s"> {INSERT}</span><span class="w"></span>

<span class="w">	</span><span class="nf">	if </span><span class="nv">A_GuiControl</span><span class="o">=</span><span class="nf">Insert</span><span class="w"> </span><span class="n">Submenu</span><span class="w"></span>
<span class="w">	</span><span class="p">{</span><span class="w"></span>
<span class="w">	    </span><span class="nb">ControlSend</span><span class="p">,</span><span class="s"> SysTreeView321</span><span class="p">,</span><span class="s"> {SHIFT down}</span><span class="w"></span>
<span class="w">	     </span><span class="n">ControlSend</span><span class="p">,</span><span class="w"> </span><span class="n">SysTreeView321</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nf">INSERT</span><span class="p">}</span><span class="w"></span>
<span class="w">		</span><span class="nb">Sleep</span><span class="w"> </span><span class="s">50</span><span class="w"></span>
<span class="w">	     </span><span class="n">ControlSend</span><span class="p">,</span><span class="w"> </span><span class="n">SysTreeView321</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">SHIFT</span><span class="w"> </span><span class="n">up</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="nf"></span>
<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;---------------------------------------------------------------------------------</span><span class="w"></span>

<span class="nl">FillTV:</span><span class="w"></span>
<span class="w">	</span><span class="n">root</span><span class="p"> </span><span class="w"> </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;Root&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Expand&quot;</span><span class="p">)</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">A_Index</span><span class="w"> </span><span class="s">&quot;    &quot;</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="nb">loop</span><span class="p">,</span><span class="s"> 10 {</span><span class="w"></span>
<span class="w">			</span><span class="n">P</span><span class="w">     </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="nf"></span>
<span class="nf">		TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">A_Index</span><span class="w"> </span><span class="s">&quot;    &quot;</span><span class="w"> </span><span class="n">P</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">aTooltip</span><span class="nv">%P%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip &quot;</span><span class="w"> </span><span class="nv">A_Index</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span>
<span class="w">	</span><span class="n">P2</span><span class="p"> </span><span class="w"> </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">),</span><span class="w">		</span><span class="n">aTooltip</span><span class="nv">%P2%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip 2.1&quot;</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.1    &quot;</span><span class="w"> </span><span class="n">P2</span><span class="p">)</span><span class="w"></span>

<span class="w">	</span><span class="n">P2</span><span class="p"> </span><span class="w">  </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">),</span><span class="w"> 		</span><span class="n">aTooltip</span><span class="nv">%P2%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip 2.2&quot;</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.2    &quot;</span><span class="w"> </span><span class="n">P2</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">P3</span><span class="p"> </span><span class="w">  </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">P2</span><span class="p">),</span><span class="w">		</span><span class="n">aTooltip</span><span class="nv">%P3%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip 2.2.1&quot;</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.2.1    &quot;</span><span class="w"> </span><span class="n">P3</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">P3</span><span class="p"> </span><span class="w">  </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">P2</span><span class="p">),</span><span class="w">		</span><span class="n">aTooltip</span><span class="nv">%P3%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip 2.2.2&quot;</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.2.2   &quot;</span><span class="w"> </span><span class="n">P3</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="n">P3</span><span class="p"> </span><span class="w">  </span><span class="o">:=</span><span class="nf"> TV_Add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">P2</span><span class="p">),</span><span class="w">		</span><span class="n">aTooltip</span><span class="nv">%P3%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;My Tooltip 2.2.3&quot;</span><span class="nf"></span>
<span class="nf">	TV_Modify</span><span class="p">(</span><span class="w"> </span><span class="n">P3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.2.3    &quot;</span><span class="w"> </span><span class="n">P3</span><span class="p">)</span><span class="nf"></span>
<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;---------------------------------------------------------------------------------</span><span class="w"></span>

<span class="nl">CreateGui:</span><span class="w"></span>
<span class="w">	</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> TreeView</span><span class="p">,</span><span class="s"> h400 w300 vMyTree</span><span class="w"></span>
<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> w100 gOnButton x+10 </span><span class="p">,</span><span class="s"> Up</span><span class="w"></span>
<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> wp gOnButton</span><span class="p">,</span><span class="s">Down</span><span class="w"></span>

<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> y+20 wp gModify</span><span class="p">,</span><span class="s"> Insert</span><span class="w"></span>
<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> wp gModify</span><span class="p">,</span><span class="s"> Insert Submenu</span><span class="w"></span>

<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> y+20 wp gModify</span><span class="p">,</span><span class="s"> Delete</span><span class="w"></span>

<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Edit</span><span class="p">,</span><span class="s"> y+50 wp vMyEdit gEdit</span><span class="p">,</span><span class="w"> </span>
<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Text</span><span class="p">,</span><span class="s"> yp-30 wp</span><span class="p">,</span><span class="s"> Change tooltip for selection</span><span class="w"></span>

<span class="w">		</span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Add</span><span class="p">,</span><span class="s"> Button</span><span class="p">,</span><span class="s"> y+150 w100 gSave</span><span class="p">,</span><span class="s"> Save to file</span><span class="w"></span>

<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">;---------------------------------------------------------------------------------</span><span class="w"></span>

<span class="nl">Edit:</span><span class="w"></span>
<span class="w">	 </span><span class="nb">Gui</span><span class="p">,</span><span class="s"> Submit</span><span class="p">,</span><span class="s"> Nohide</span><span class="w"></span>
<span class="w">	  </span><span class="n">c</span><span class="w"> </span><span class="o">:=</span><span class="nf"> TV_GetSelection</span><span class="p">()</span><span class="w"></span>
<span class="w">	 </span><span class="n">aTooltip</span><span class="nv">%c%</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">MyEdit</span><span class="nf"></span>
<span class="nf">return</span><span class="w"></span>

<span class="nl">GuiClose:</span><span class="w"></span>
<span class="nl">GuiEscape:</span><span class="w"></span>
<span class="w">	 </span><span class="nb">ExitApp</span><span class="w"></span>

<span class="nf">return</span><span class="c-Singleline"></span>

<span class="c-Singleline">; #include TVX.ahk</span><span class="w"></span>
</pre></div>
